{"version":3,"file":"adapt.min.js","sources":["../../core/js/wait.js","../../core/js/models/lockingModel.js","../../core/js/adapt.js","../../core/js/templateRenderEvent.js","../../core/js/templates.js","../../core/js/reactHelpers.js","../../core/js/fixes/img.lazyload.js","../../core/js/a11y/browserFocus.js","../../core/js/a11y/focusOptions.js","../../core/js/a11y/keyboardFocusOutline.js","../../core/js/a11y/log.js","../../core/js/a11y/scroll.js","../../core/js/a11y/wrapFocus.js","../../core/js/a11y/popup.js","../../core/js/a11y/deprecated.js","../../core/js/a11y.js","../../core/js/accessibility.js","../../core/js/collections/adaptCollection.js","../../core/js/enums/logLevelEnum.js","../../core/js/logging.js","../../core/js/models/buildModel.js","../../core/js/models/configModel.js","../../core/js/modelEvent.js","../../core/js/models/adaptModel.js","../../core/js/models/contentObjectModel.js","../../core/js/models/menuModel.js","../../core/js/models/courseModel.js","../../core/js/startController.js","../../core/js/data.js","../../core/js/offlineStorage.js","../../core/js/enums/completionStateEnum.js","../../core/js/tracking.js","../../core/js/device.js","../../core/js/views/drawerItemView.js","../../core/js/views/drawerView.js","../../core/js/drawer.js","../../core/js/views/notifyPushView.js","../../core/js/models/notifyModel.js","../../core/js/collections/notifyPushCollection.js","../../core/js/childEvent.js","../../core/js/views/adaptView.js","../../core/js/views/notifyView.js","../../core/js/notify.js","../../core/js/models/routerModel.js","../../core/js/router.js","../../core/js/collections/adaptSubsetCollection.js","../../core/js/models/articleModel.js","../../core/js/models/blockModel.js","../../core/js/models/componentModel.js","../../core/js/models/pageModel.js","../../core/js/views/contentObjectView.js","../../core/js/views/pageView.js","../../core/js/views/articleView.js","../../core/js/views/blockView.js","../../core/js/mpabc.js","../../core/js/helpers.js","../../core/js/scrolling.js","../../core/js/views/headingView.js","../../core/js/headings.js","../../core/js/views/navigationView.js","../../core/js/navigation.js","../../core/js/models/itemModel.js","../../core/js/models/itemsComponentModel.js","../../components/adapt-contrib-accordion/js/accordionModel.js","../../core/js/views/componentView.js","../../components/adapt-contrib-accordion/js/accordionView.js","../../components/adapt-contrib-accordion/js/adapt-contrib-accordion.js","../../components/adapt-contrib-assessmentResults/js/assessmentResultsModel.js","../../components/adapt-contrib-assessmentResults/js/assessmentResultsView.js","../../components/adapt-contrib-assessmentResults/js/adapt-contrib-assessmentResults.js","../../components/adapt-contrib-blank/js/adapt-contrib-blank.js","../../core/js/enums/buttonStateEnum.js","../../core/js/views/buttonsView.js","../../core/js/models/questionModel.js","../../core/js/views/questionView.js","../../components/adapt-contrib-mcq/js/mcqView.js","../../core/js/models/itemsQuestionModel.js","../../components/adapt-contrib-mcq/js/adapt-contrib-mcq.js","../../components/adapt-contrib-gmcq/js/adapt-contrib-gmcq.js","../../components/adapt-contrib-graphic/js/adapt-contrib-graphic.js","../../components/adapt-contrib-hotgraphic/js/hotgraphicPopupView.js","../../components/adapt-contrib-hotgraphic/js/hotgraphicView.js","../../components/adapt-contrib-hotgraphic/js/adapt-contrib-hotgraphic.js","../../components/adapt-contrib-matching/js/dropdownOption.js","../../components/adapt-contrib-matching/js/dropdown.js","../../components/adapt-contrib-matching/js/matchingView.js","../../components/adapt-contrib-matching/js/matchingModel.js","../../components/adapt-contrib-matching/js/adapt-contrib-matching.js","../../components/adapt-contrib-media/libraries/mediaelement-fullscreen-hook.js","../../components/adapt-contrib-media/js/mediaView.js","../../components/adapt-contrib-media/js/adapt-contrib-media.js","../../components/adapt-contrib-narrative/js/modeEnum.js","../../components/adapt-contrib-narrative/js/narrativeView.js","../../components/adapt-contrib-narrative/js/adapt-contrib-narrative.js","../../components/adapt-contrib-slider/js/sliderView.js","../../components/adapt-contrib-slider/js/sliderModel.js","../../components/adapt-contrib-slider/js/adapt-contrib-slider.js","../../components/adapt-contrib-text/js/adapt-contrib-text.js","../../components/adapt-contrib-textInput/js/textInputView.js","../../components/adapt-contrib-textInput/js/textInputModel.js","../../components/adapt-contrib-textInput/js/adapt-contrib-textInput.js","../../extensions/adapt-contrib-assessment/js/adapt-assessmentArticleView.js","../../extensions/adapt-contrib-assessment/js/adapt-assessmentQuestionBank.js","../../extensions/adapt-contrib-assessment/js/adapt-assessmentArticleModel.js","../../extensions/adapt-contrib-assessment/js/assessment.js","../../extensions/adapt-contrib-assessment/js/adapt-assessmentArticleExtension.js","../../extensions/adapt-contrib-bookmarking/js/adapt-contrib-bookmarking.js","../../extensions/adapt-contrib-languagePicker/js/languagePickerNavigationView.js","../../extensions/adapt-contrib-languagePicker/js/languagePickerView.js","../../extensions/adapt-contrib-languagePicker/js/languagePickerDrawerView.js","../../extensions/adapt-contrib-languagePicker/js/languagePickerNavView.js","../../extensions/adapt-contrib-languagePicker/js/languagePickerModel.js","../../extensions/adapt-contrib-languagePicker/js/adapt-languagePicker.js","../../extensions/adapt-contrib-pageLevelProgress/js/completionCalculations.js","../../extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressIndicatorView.js","../../extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressItemView.js","../../extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressView.js","../../extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressNavigationView.js","../../extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressCollection.js","../../extensions/adapt-contrib-pageLevelProgress/js/adapt-contrib-pageLevelProgress.js","../../extensions/adapt-contrib-resources/js/adapt-contrib-resourcesView.js","../../extensions/adapt-contrib-resources/js/adapt-contrib-resourcesHelpers.js","../../extensions/adapt-contrib-resources/js/adapt-contrib-resources.js","../../extensions/adapt-contrib-spoor/js/scorm/logger.js","../../extensions/adapt-contrib-spoor/js/scorm/error.js","../../extensions/adapt-contrib-spoor/js/scorm/wrapper.js","../../extensions/adapt-contrib-spoor/js/serializers/SCORMSuspendData.js","../../extensions/adapt-contrib-spoor/js/serializers/ComponentSerializer.js","../../extensions/adapt-contrib-spoor/js/adapt-stateful-session.js","../../extensions/adapt-contrib-spoor/js/adapt-offlineStorage-scorm.js","../../extensions/adapt-contrib-spoor/js/adapt-contrib-spoor.js","../../extensions/adapt-contrib-trickle/js/trickleView.js","../../extensions/adapt-contrib-trickle/js/pageView.js","../../extensions/adapt-contrib-trickle/js/handlers/buttonView.js","../../extensions/adapt-contrib-trickle/js/handlers/button.js","../../extensions/adapt-contrib-trickle/js/handlers/completion.js","../../extensions/adapt-contrib-trickle/js/handlers/notify.js","../../extensions/adapt-contrib-trickle/js/handlers/resize.js","../../extensions/adapt-contrib-trickle/js/handlers/tutor.js","../../extensions/adapt-contrib-trickle/js/handlers/visibility.js","../../extensions/adapt-contrib-trickle/js/handlers/done.js","../../extensions/adapt-contrib-trickle/js/adapt-contrib-trickle.js","../../extensions/adapt-contrib-tutor/js/adapt-contrib-tutor.js","../../extensions/adapt-globalAudio/js/injector.js","../../extensions/adapt-globalAudio/js/AudioView.js","../../extensions/adapt-globalAudio/js/adapt-globalAudio.js","../../core/js/views/menuItemView.js","../../core/js/views/menuView.js","../../menu/adapt-contrib-boxMenu/js/adapt-contrib-boxMenuItemView.js","../../menu/adapt-contrib-boxMenu/js/adapt-contrib-boxMenuGroupView.js","../../menu/adapt-contrib-boxMenu/js/adapt-contrib-boxMenu.js","../../theme/adapt-contrib-vanilla/js/themeView.js","../../theme/adapt-contrib-vanilla/js/themePageView.js","../../theme/adapt-contrib-vanilla/js/themeArticleView.js","../../theme/adapt-contrib-vanilla/js/themeBlockView.js","../../theme/adapt-contrib-vanilla/js/theme.js","../../core/templates/partials/component.jsx","../../core/js/app.js"],"sourcesContent":["export default class Wait extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this._waitCount = 0;\r\n    this._callbackHandle = null;\r\n    this.being = this.begin.bind(this);\r\n    this.end = this.end.bind(this);\r\n  }\r\n\r\n  /**\r\n   * Returns true if there are items in the waiting count.\r\n   *\r\n   * @return {Boolean}\r\n   */\r\n  isWaiting() {\r\n    return (this._waitCount !== 0);\r\n  }\r\n\r\n  /**\r\n   * Add one item to the waiting count.\r\n   *\r\n   * @return {Object}\r\n   */\r\n  begin() {\r\n    if (!this.isWaiting()) this.trigger('wait');\r\n\r\n    this._waitCount++;\r\n\r\n    if (this._callbackHandle) {\r\n      clearTimeout(this._callbackHandle);\r\n      this._callbackHandle = null;\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Remove an item from the waiting count and trigger ready asynchronously if no more items are waiting.\r\n   *\r\n   * @return {Object}\r\n   */\r\n  end() {\r\n    if (!this.isWaiting()) return this;\r\n\r\n    this._waitCount--;\r\n\r\n    if (this.isWaiting() || this._callbackHandle) return this;\r\n\r\n    this._callbackHandle = setTimeout(function() {\r\n      this._callbackHandle = null;\r\n      this.trigger('ready');\r\n    }.bind(this), 0);\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Queue this function until all open waits have been ended.\r\n   *\r\n   * @param  {Function} [callback]\r\n   * @return {Object|Promise}\r\n   */\r\n  queue(callback) {\r\n    if (!callback) {\r\n      this.begin();\r\n\r\n      return new Promise(resolve => {\r\n        this.once('ready', resolve);\r\n        this.end();\r\n      });\r\n    }\r\n\r\n    this.begin();\r\n    this.once('ready', callback);\r\n    this.end();\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Wait for this asynchronous function to execute before triggering ready event.\r\n   *\r\n   * @param  {Function} callback   [ Function to execute whilst holding queued callback. Once complete run first argument, done(). ]\r\n   * @return {Object}\r\n   */\r\n  for(callback) {\r\n    this.begin();\r\n    _.defer(() => callback(_.once(this.end)));\r\n    return this;\r\n  }\r\n\r\n}\r\n","export default class LockingModel extends Backbone.Model {\r\n\r\n  set(attrName, attrVal, options = {}) {\r\n    const stopProcessing = (typeof attrName === 'object' || typeof attrVal !== 'boolean' || !this.isLocking(attrName));\r\n    if (stopProcessing) return super.set(...arguments);\r\n\r\n    const isSettingValueForSpecificPlugin = options?.pluginName;\r\n    if (!isSettingValueForSpecificPlugin) {\r\n      console.error('Must supply a pluginName to change a locked attribute');\r\n      options.pluginName = 'compatibility';\r\n    }\r\n\r\n    const pluginName = options.pluginName;\r\n    if (this.defaults[attrName] !== undefined) {\r\n      this._lockedAttributes[attrName] = !this.defaults[attrName];\r\n    }\r\n    const lockingValue = this._lockedAttributes[attrName];\r\n    const isAttemptingToLock = (lockingValue === attrVal);\r\n\r\n    if (isAttemptingToLock) {\r\n      this.setLockState(attrName, true, { pluginName: pluginName, skipcheck: true });\r\n      return super.set(attrName, lockingValue);\r\n    }\r\n\r\n    this.setLockState(attrName, false, { pluginName: pluginName, skipcheck: true });\r\n\r\n    const totalLockValue = this.getLockCount(attrName, { skipcheck: true });\r\n    if (totalLockValue === 0) {\r\n      return super.set(attrName, !lockingValue);\r\n    }\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  setLocking(attrName, defaultLockValue) {\r\n    if (this.isLocking(attrName)) return;\r\n    if (!this._lockedAttributes) this._lockedAttributes = {};\r\n    this._lockedAttributes[attrName] = defaultLockValue;\r\n  }\r\n\r\n  unsetLocking(attrName) {\r\n    if (!this.isLocking(attrName)) return;\r\n    if (!this._lockedAttributes) return;\r\n    delete this._lockedAttributes[attrName];\r\n    delete this._lockedAttributesValues[attrName];\r\n    if (Object.keys(this._lockedAttributes).length === 0) {\r\n      delete this._lockedAttributes;\r\n      delete this._lockedAttributesValues;\r\n    }\r\n  }\r\n\r\n  isLocking(attrName) {\r\n    const isCheckingGeneralLockingState = (attrName === undefined);\r\n    const isUsingLockedAttributes = Boolean(this.lockedAttributes || this._lockedAttributes);\r\n\r\n    if (isCheckingGeneralLockingState) {\r\n      return isUsingLockedAttributes;\r\n    }\r\n\r\n    if (!isUsingLockedAttributes) return false;\r\n\r\n    if (!this._lockedAttributes) {\r\n      this._lockedAttributes = _.result(this, 'lockedAttributes');\r\n    }\r\n\r\n    const isAttributeALockingAttribute = this._lockedAttributes.hasOwnProperty(attrName);\r\n    if (!isAttributeALockingAttribute) return false;\r\n\r\n    if (!this._lockedAttributesValues) {\r\n      this._lockedAttributesValues = {};\r\n    }\r\n\r\n    if (!this._lockedAttributesValues[attrName]) {\r\n      this._lockedAttributesValues[attrName] = {};\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  isLocked(attrName, options) {\r\n    const shouldSkipCheck = options?.skipcheck;\r\n    if (!shouldSkipCheck) {\r\n      const stopProcessing = !this.isLocking(attrName);\r\n      if (stopProcessing) return;\r\n    }\r\n\r\n    return this.getLockCount(attrName) > 0;\r\n  }\r\n\r\n  getLockCount(attrName, options) {\r\n    const shouldSkipCheck = options?.skipcheck;\r\n    if (!shouldSkipCheck) {\r\n      const stopProcessing = !this.isLocking(attrName);\r\n      if (stopProcessing) return;\r\n    }\r\n\r\n    const isGettingValueForSpecificPlugin = options?.pluginName;\r\n    if (isGettingValueForSpecificPlugin) {\r\n      return this._lockedAttributesValues[attrName][options.pluginName] ? 1 : 0;\r\n    }\r\n\r\n    const lockingAttributeValues = Object.values(this._lockedAttributesValues[attrName]);\r\n    const lockingAttributeValuesSum = lockingAttributeValues.reduce((sum, value) => sum + (value ? 1 : 0), 0);\r\n\r\n    return lockingAttributeValuesSum;\r\n  }\r\n\r\n  setLockState(attrName, value, options) {\r\n    const shouldSkipCheck = options?.skipcheck;\r\n    if (!shouldSkipCheck) {\r\n      const stopProcessing = !this.isLocking(attrName);\r\n      if (stopProcessing) return this;\r\n    }\r\n\r\n    const isSettingValueForSpecificPlugin = options?.pluginName;\r\n    if (!isSettingValueForSpecificPlugin) {\r\n      console.error('Must supply a pluginName to set a locked attribute lock value');\r\n      options.pluginName = 'compatibility';\r\n    }\r\n\r\n    if (value) {\r\n      this._lockedAttributesValues[attrName][options.pluginName] = value;\r\n    } else {\r\n      delete this._lockedAttributesValues[attrName][options.pluginName];\r\n    }\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n}\r\n","import Wait from 'core/js/wait';\r\nimport LockingModel from 'core/js/models/lockingModel';\r\n\r\nclass AdaptSingleton extends LockingModel {\r\n\r\n  initialize() {\r\n    this.loadScript = window.__loadScript;\r\n    this.location = {};\r\n    this.store = {};\r\n    this.setupWait();\r\n  }\r\n\r\n  defaults() {\r\n    return {\r\n      _canScroll: true, // to stop scrollTo behaviour,\r\n      _outstandingCompletionChecks: 0,\r\n      _pluginWaitCount: 0,\r\n      _isStarted: false,\r\n      _shouldDestroyContentObjects: true\r\n    };\r\n  }\r\n\r\n  lockedAttributes() {\r\n    return {\r\n      _canScroll: false\r\n    };\r\n  }\r\n\r\n  /**\r\n   * @deprecated since v6.0.0 - please use `Adapt.store` instead\r\n   */\r\n  get componentStore() {\r\n    this.log.deprecated('Adapt.componentStore, please use Adapt.store instead');\r\n    return this.store;\r\n  }\r\n\r\n  init() {\r\n    this.addDirection();\r\n    this.disableAnimation();\r\n    this.trigger('adapt:preInitialize');\r\n\r\n    // wait until no more completion checking\r\n    this.deferUntilCompletionChecked(() => {\r\n\r\n      // start adapt in a full restored state\r\n      this.trigger('adapt:start');\r\n\r\n      if (!Backbone.History.started) {\r\n        Backbone.history.start();\r\n      }\r\n\r\n      this.set('_isStarted', true);\r\n\r\n      this.trigger('adapt:initialize');\r\n\r\n    });\r\n  }\r\n\r\n  /**\r\n   * call when entering an asynchronous completion check\r\n   */\r\n  checkingCompletion() {\r\n    const outstandingChecks = this.get('_outstandingCompletionChecks');\r\n    this.set('_outstandingCompletionChecks', outstandingChecks + 1);\r\n  }\r\n\r\n  /**\r\n   * call when exiting an asynchronous completion check\r\n   */\r\n  checkedCompletion() {\r\n    const outstandingChecks = this.get('_outstandingCompletionChecks');\r\n    this.set('_outstandingCompletionChecks', outstandingChecks - 1);\r\n  }\r\n\r\n  /**\r\n   * wait until there are no outstanding completion checks\r\n   * @param {Function} [callback] Function to be called after all completion checks have been completed\r\n   */\r\n  async deferUntilCompletionChecked(callback = () => {}) {\r\n    if (this.get('_outstandingCompletionChecks') === 0) return callback();\r\n    return new Promise(resolve => {\r\n      const checkIfAnyChecksOutstanding = (model, outstandingChecks) => {\r\n        if (outstandingChecks !== 0) return;\r\n        this.off('change:_outstandingCompletionChecks', checkIfAnyChecksOutstanding);\r\n        callback();\r\n        resolve();\r\n      };\r\n      this.on('change:_outstandingCompletionChecks', checkIfAnyChecksOutstanding);\r\n    });\r\n  }\r\n\r\n  setupWait() {\r\n\r\n    this.wait = new Wait();\r\n\r\n    // Setup legacy events and handlers\r\n    const beginWait = () => {\r\n      this.log.deprecated(`Use Adapt.wait.begin() as Adapt.trigger('plugin:beginWait') may be removed in the future`);\r\n      this.wait.begin();\r\n    };\r\n\r\n    const endWait = () => {\r\n      this.log.deprecated(`Use Adapt.wait.end() as Adapt.trigger('plugin:endWait') may be removed in the future`);\r\n      this.wait.end();\r\n    };\r\n\r\n    const ready = () => {\r\n      if (this.wait.isWaiting()) {\r\n        return;\r\n      }\r\n      const isEventListening = (this._events['plugins:ready']);\r\n      if (!isEventListening) {\r\n        return;\r\n      }\r\n      this.log.deprecated(\"Use Adapt.wait.queue(callback) as Adapt.on('plugins:ready', callback) may be removed in the future\");\r\n      this.trigger('plugins:ready');\r\n    };\r\n\r\n    this.listenTo(this.wait, 'ready', ready);\r\n    this.listenTo(this, {\r\n      'plugin:beginWait': beginWait,\r\n      'plugin:endWait': endWait\r\n    });\r\n\r\n  }\r\n\r\n  isWaitingForPlugins() {\r\n    this.log.deprecated('Use Adapt.wait.isWaiting() as Adapt.isWaitingForPlugins() may be removed in the future');\r\n    return this.wait.isWaiting();\r\n  }\r\n\r\n  checkPluginsReady() {\r\n    this.log.deprecated('Use Adapt.wait.isWaiting() as Adapt.checkPluginsReady() may be removed in the future');\r\n    if (this.isWaitingForPlugins()) {\r\n      return;\r\n    }\r\n    this.trigger('plugins:ready');\r\n  }\r\n\r\n  /**\r\n   * Allows a selector to be passed in and Adapt will navigate to this element. Resolves\r\n   * asynchronously when the element has been navigated to.\r\n   * @param {string} selector CSS selector of the Adapt element you want to navigate to e.g. `\".co-05\"`\r\n   * @param {Object} [settings] The settings for the `$.scrollTo` function (See https://github.com/flesler/jquery.scrollTo#settings).\r\n   * @param {Object} [settings.replace=false] Set to `true` if you want to update the URL without creating an entry in the browser's history.\r\n   */\r\n  async navigateToElement() {}\r\n\r\n  /**\r\n   * Allows a selector to be passed in and Adapt will scroll to this element. Resolves\r\n   * asynchronously when the element has been navigated/scrolled to.\r\n   * @param {string} selector CSS selector of the Adapt element you want to navigate to e.g. `\".co-05\"`\r\n   * @param {Object} [settings={}] The settings for the `$.scrollTo` function (See https://github.com/flesler/jquery.scrollTo#settings).\r\n   * @param {Object} [settings.replace=false] Set to `true` if you want to update the URL without creating an entry in the browser's history.\r\n   */\r\n  async scrollTo() {}\r\n\r\n  /**\r\n   * Used to register models and views with `Adapt.store`\r\n   * @param {string|Array} name The name(s) of the model/view to be registered\r\n   * @param {object} object Object containing properties `model` and `view` or (legacy) an object representing the view\r\n   */\r\n  register(name, object) {\r\n    if (Array.isArray(name)) {\r\n      // if an array is passed, iterate by recursive call\r\n      name.forEach(name => this.register(name, object));\r\n      return object;\r\n    }\r\n\r\n    if (name.split(' ').length > 1) {\r\n      // if name with spaces is passed, split and pass as array\r\n      this.register(name.split(' '), object);\r\n      return object;\r\n    }\r\n\r\n    if ((!object.view && !object.model) || object instanceof Backbone.View) {\r\n      this.log.deprecated('View-only registrations are no longer supported');\r\n      object = { view: object };\r\n    }\r\n\r\n    if (object.view && !object.view.template) {\r\n      object.view.template = name;\r\n    }\r\n\r\n    const isModelSetAndInvalid = (object.model &&\r\n      !(object.model.prototype instanceof Backbone.Model) &&\r\n      !(object.model instanceof Function));\r\n    if (isModelSetAndInvalid) {\r\n      throw new Error('The registered model is not a Backbone.Model or Function');\r\n    }\r\n\r\n    const isViewSetAndInvalid = (object.view &&\r\n      !(object.view.prototype instanceof Backbone.View) &&\r\n      !(object.view instanceof Function));\r\n    if (isViewSetAndInvalid) {\r\n      throw new Error('The registered view is not a Backbone.View or Function');\r\n    }\r\n\r\n    this.store[name] = Object.assign({}, this.store[name], object);\r\n\r\n    return object;\r\n  }\r\n\r\n  /**\r\n   * Parses a view class name.\r\n   * @param {string|Backbone.Model|Backbone.View|object} nameModelViewOrData The name of the view class you want to fetch e.g. `\"hotgraphic\"` or its model or its json data\r\n   */\r\n  getViewName(nameModelViewOrData) {\r\n    if (typeof nameModelViewOrData === 'string') {\r\n      return nameModelViewOrData;\r\n    }\r\n    if (nameModelViewOrData instanceof Backbone.Model) {\r\n      nameModelViewOrData = nameModelViewOrData.toJSON();\r\n    }\r\n    if (nameModelViewOrData instanceof Backbone.View) {\r\n      let foundName;\r\n      Object.entries(this.store).forEach(([key, entry]) => {\r\n        if (!entry?.view) return;\r\n        if (!(nameModelViewOrData instanceof entry.view)) return;\r\n        foundName = key;\r\n        return true;\r\n      });\r\n      return foundName;\r\n    }\r\n    if (nameModelViewOrData instanceof Object) {\r\n      const names = [\r\n        typeof nameModelViewOrData._view === 'string' && nameModelViewOrData._view,\r\n        typeof nameModelViewOrData._component === 'string' && nameModelViewOrData._component,\r\n        typeof nameModelViewOrData._type === 'string' && nameModelViewOrData._type\r\n      ].filter(Boolean);\r\n      if (names.length) {\r\n        // find first fitting view name\r\n        const name = names.find(name => this.store[name]?.view);\r\n        return name || names.pop(); // return last available if none found\r\n      }\r\n    }\r\n    throw new Error('Cannot derive view class name from input');\r\n  }\r\n\r\n  /**\r\n   * Fetches a view class from the store. For a usage example, see either HotGraphic or Narrative\r\n   * @param {string|Backbone.Model|Backbone.View|object} nameModelViewOrData The name of the view class you want to fetch e.g. `\"hotgraphic\"` or its model or its json data\r\n   * @returns {Backbone.View} Reference to the view class\r\n   */\r\n  getViewClass(nameModelViewOrData) {\r\n    const name = this.getViewName(nameModelViewOrData);\r\n    const object = this.store[name];\r\n    if (!object) {\r\n      this.log.warnOnce(`A view for '${name}' isn't registered in your project`);\r\n      return;\r\n    }\r\n    const isBackboneView = (object.view?.prototype instanceof Backbone.View);\r\n    if (!isBackboneView && object.view instanceof Function) {\r\n      return object.view();\r\n    }\r\n    return object.view;\r\n  }\r\n\r\n  /**\r\n   * Parses a model class name.\r\n   * @param {string|Backbone.Model|object} name The name of the model you want to fetch e.g. `\"hotgraphic\"`, the model to process or its json data\r\n   */\r\n  getModelName(nameModelOrData) {\r\n    if (typeof nameModelOrData === 'string') {\r\n      return nameModelOrData;\r\n    }\r\n    if (nameModelOrData instanceof Backbone.Model) {\r\n      nameModelOrData = nameModelOrData.toJSON();\r\n    }\r\n    if (nameModelOrData instanceof Object) {\r\n      const name = nameModelOrData._component;\r\n      const entry = this.store[name];\r\n      const isViewOnlyQuestion = entry && !entry.model && entry.view?._isQuestionType;\r\n      if (isViewOnlyQuestion) {\r\n        // Use question model by default\r\n        this.log.deprecated(`Assuming a question model for a view-only question: ${name}`);\r\n        return 'question';\r\n      }\r\n      const names = [\r\n        typeof nameModelOrData._model === 'string' && nameModelOrData._model,\r\n        typeof nameModelOrData._component === 'string' && nameModelOrData._component,\r\n        typeof nameModelOrData._type === 'string' && nameModelOrData._type\r\n      ].filter(Boolean);\r\n      if (names.length) {\r\n        // find first fitting model name\r\n        const name = names.find(name => this.store[name]?.model);\r\n        return name || names.pop(); // return last available if none found\r\n      }\r\n    }\r\n    throw new Error('Cannot derive model class name from input');\r\n  }\r\n\r\n  /**\r\n   * Fetches a model class from the store. For a usage example, see either HotGraphic or Narrative\r\n   * @param {string|Backbone.Model|object} name The name of the model you want to fetch e.g. `\"hotgraphic\"` or its json data\r\n   * @returns {Backbone.Model} Reference to the view class\r\n   */\r\n  getModelClass(nameModelOrData) {\r\n    const name = this.getModelName(nameModelOrData);\r\n    const object = this.store[name];\r\n    if (!object) {\r\n      this.log.warnOnce(`A model for '${name}' isn't registered in your project`);\r\n      return;\r\n    }\r\n    const isBackboneModel = (object.model?.prototype instanceof Backbone.Model);\r\n    if (!isBackboneModel && object.model instanceof Function) {\r\n      return object.model();\r\n    }\r\n    return object.model;\r\n  }\r\n\r\n  /**\r\n   * Looks up a model by its `_id` property\r\n   * @param {string} id The id of the item e.g. \"co-05\"\r\n   * @return {Backbone.Model}\r\n   */\r\n  findById(id) {\r\n    return this.data.findById(id);\r\n  }\r\n\r\n  findViewByModelId(id) {\r\n    const model = this.data.findById(id);\r\n    if (!model) return;\r\n\r\n    if (model === this.parentView.model) return this.parentView;\r\n\r\n    const idPathToView = [id];\r\n    const currentLocationId = this.location._currentId;\r\n    const currentLocationModel = model.getAncestorModels().find(model => {\r\n      const modelId = model.get('_id');\r\n      if (modelId === currentLocationId) return true;\r\n      idPathToView.unshift(modelId);\r\n    });\r\n\r\n    if (!currentLocationModel) {\r\n      return console.warn(`Adapt.findViewByModelId() unable to find view for model id: ${id}`);\r\n    }\r\n\r\n    const foundView = idPathToView.reduce((view, currentId) => {\r\n      if (!view) return;\r\n      const childViews = view.getChildViews();\r\n      return childViews?.find(view => view.model.get('_id') === currentId);\r\n    }, this.parentView);\r\n\r\n    return foundView;\r\n  }\r\n\r\n  /**\r\n   * Returns the model represented by the trackingPosition.\r\n   * @param {Array<Number, Number>} trackingPosition Represents the relative location of a model to a _trackingId\r\n   * @returns {Backbone.Model}\r\n   */\r\n  findByTrackingPosition(trackingPosition) {\r\n    return this.data.findByTrackingPosition(trackingPosition);\r\n  }\r\n\r\n  /**\r\n   * Relative strings describe the number and type of hops in the model hierarchy\r\n   * @param {string} relativeString \"@component +1\" means to move one component forward from the current model\r\n   * This function would return the following:\r\n   * {\r\n   *     type: \"component\",\r\n   *     offset: 1\r\n   * }\r\n   * Trickle uses this function to determine where it should scrollTo after it unlocks\r\n   */\r\n  parseRelativeString(relativeString) {\r\n    const splitIndex = relativeString.search(/[ +\\-\\d]{1}/);\r\n    const type = relativeString.slice(0, splitIndex).replace(/^@/, '');\r\n    const offset = parseInt(relativeString.slice(splitIndex).trim() || 0);\r\n    return {\r\n      type: type,\r\n      offset: offset\r\n    };\r\n  }\r\n\r\n  addDirection() {\r\n    const defaultDirection = this.config.get('_defaultDirection');\r\n\r\n    $('html')\r\n      .addClass('dir-' + defaultDirection)\r\n      .attr('dir', defaultDirection);\r\n  }\r\n\r\n  disableAnimation() {\r\n    const disableAnimationArray = this.config.get('_disableAnimationFor');\r\n    const disableAnimation = this.config.get('_disableAnimation');\r\n\r\n    // Check if animations should be disabled\r\n    if (disableAnimationArray) {\r\n      for (let i = 0, l = disableAnimationArray.length; i < l; i++) {\r\n        if (!$('html').is(disableAnimationArray[i])) continue;\r\n        this.config.set('_disableAnimation', true);\r\n        $('html').addClass('disable-animation');\r\n        console.log('Animation disabled.');\r\n      }\r\n      return;\r\n    }\r\n\r\n    $('html').toggleClass('disable-animation', (disableAnimation === true));\r\n  }\r\n\r\n  async remove() {\r\n    const currentView = this.parentView;\r\n    if (currentView) {\r\n      currentView.model.setOnChildren({\r\n        '_isReady': false,\r\n        '_isRendered': false\r\n      });\r\n    }\r\n    this.trigger('preRemove', currentView);\r\n    await this.wait.queue();\r\n    // Facilitate contentObject transitions\r\n    if (currentView && this.get('_shouldDestroyContentObjects')) {\r\n      currentView.destroy();\r\n    }\r\n    this.trigger('remove', currentView);\r\n    _.defer(this.trigger.bind(this), 'postRemove', currentView);\r\n  }\r\n\r\n}\r\n\r\nexport default new AdaptSingleton();\r\n","export default class TemplateRenderEvent extends Backbone.Controller {\r\n\r\n  /**\r\n   * Template render event\r\n   * @param {string} type Event type\r\n   * @param {string} name Template name\r\n   * @param {string} mode \"template\" / \"partial\"\r\n   * @param {string} value Rendered template string\r\n   * @param {[*]} args Arguments passed to template for render\r\n   */\r\n  initialize(type, name, mode, value, args) {\r\n    /** @type {string} Event type */\r\n    this.type = type;\r\n    /** @type {string} Template name */\r\n    this.name = name;\r\n    /** @type {string} \"template\" / \"partial\" */\r\n    this.mode = mode;\r\n    /** @type {string} Rendered template string */\r\n    this.value = value;\r\n    /** @type {[*]} Arguments passed to template for render */\r\n    this.args = args;\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport TemplateRenderEvent from 'core/js/templateRenderEvent';\r\n\r\n/**\r\n * Adds template and partial, preRender and postRender events to Adapt\r\n */\r\n\r\nfunction onRender(cb) {\r\n  const intercept = (object, name, mode, cb) => {\r\n    return (object[name] = cb.bind(object, object[name], name, mode));\r\n  };\r\n  Object.keys(Handlebars.templates).forEach(name => {\r\n    intercept(Handlebars.templates, name, 'template', cb);\r\n  });\r\n  Object.keys(Handlebars.partials).forEach(name => {\r\n    intercept(Handlebars.partials, name, 'partial', cb);\r\n  });\r\n}\r\n\r\nonRender((template, name, mode, ...args) => {\r\n  // Send preRender event to allow modification of args\r\n  const preRenderEvent = new TemplateRenderEvent(`${mode}:preRender`, name, mode, null, args);\r\n  Adapt.trigger(preRenderEvent.type, preRenderEvent);\r\n\r\n  // Execute template\r\n  const value = template(...preRenderEvent.args);\r\n\r\n  // Send postRender event to allow modification of rendered template\r\n  const postRenderEvent = new TemplateRenderEvent(`${mode}:postRender`, name, mode, value, preRenderEvent.args);\r\n  Adapt.trigger(postRenderEvent.type, postRenderEvent);\r\n\r\n  // Return rendered, modified template\r\n  return postRenderEvent.value;\r\n});\r\n","import Adapt from 'core/js/adapt';\r\nimport TemplateRenderEvent from './templateRenderEvent';\r\nimport HTMLReactParser from 'html-react-parser';\r\n\r\n/**\r\n * Finds a node in a react node hierarchy\r\n * Return true from the iterator to stop traversal\r\n * @param {object} hierarchy\r\n * @param {function} iterator\r\n */\r\nexport function find(hierarchy, iterator) {\r\n  if (iterator(hierarchy)) {\r\n    return true;\r\n  }\r\n  if (!hierarchy.props || !hierarchy.props.children) return;\r\n  if (Array.isArray(hierarchy.props.children)) {\r\n    return hierarchy.props.children.find(child => {\r\n      if (!child) return;\r\n      return find(child, iterator);\r\n    });\r\n  }\r\n  return find(hierarchy.props.children, iterator);\r\n};\r\n\r\n/**\r\n * Allows clone and modification of a react node hierarchy\r\n * @param {*} value\r\n * @param {boolean} isDeep=false\r\n * @param {function} modifier\r\n * @returns {*}\r\n */\r\nexport function clone(value, isDeep = false, modifier = null) {\r\n  if (typeof value !== 'object' || value === null) {\r\n    return value;\r\n  }\r\n  const cloned = Array.isArray(value) ? [] : {};\r\n  const descriptors = Object.getOwnPropertyDescriptors(value);\r\n  for (let name in descriptors) {\r\n    const descriptor = descriptors[name];\r\n    if (!descriptor.hasOwnProperty('value')) {\r\n      Object.defineProperty(cloned, name, descriptor);\r\n      continue;\r\n    }\r\n    let value = descriptor.value;\r\n    if (typeof value === 'object' && value !== null) {\r\n      if (isDeep) {\r\n        value = descriptor.value = clone(value, isDeep, modifier);\r\n      }\r\n      if (modifier && typeof value.$$typeof === 'symbol') {\r\n        modifier(value);\r\n      }\r\n    }\r\n    descriptor.writable = true;\r\n    Object.defineProperty(cloned, name, descriptor);\r\n  }\r\n  if (modifier && typeof cloned.$$typeof === 'symbol') {\r\n    modifier(cloned);\r\n  }\r\n  return cloned;\r\n};\r\n\r\n/**\r\n * Used by babel plugin babel-plugin-transform-react-templates to inject react templates\r\n */\r\nexport default function register(name, component) {\r\n  templates[name] = (...args) => {\r\n    // Trap render calls to emit preRender and postRender events\r\n    const mode = 'reactTemplate';\r\n    // Send preRender event to allow modification of args\r\n    const preRenderEvent = new TemplateRenderEvent(`${mode}:preRender`, name, mode, null, args);\r\n    Adapt.trigger(preRenderEvent.type, preRenderEvent);\r\n    // Execute template\r\n    const value = component(...preRenderEvent.args);\r\n    // Send postRender event to allow modification of rendered template\r\n    const postRenderEvent = new TemplateRenderEvent(`${mode}:postRender`, name, mode, value, preRenderEvent.args);\r\n    Adapt.trigger(postRenderEvent.type, postRenderEvent);\r\n    // Return rendered, modified template\r\n    return postRenderEvent.value;\r\n  };\r\n};\r\n\r\n/**\r\n * Storage for react templates\r\n */\r\nexport const templates = {};\r\n\r\n/**\r\n * Convert html strings to react dom, equivalent to handlebars {{{html}}}\r\n * @param {string} html\r\n */\r\nexport function html(html, ref = null) {\r\n  if (!html) return;\r\n  let node = html ? HTMLReactParser(html) : '';\r\n  if (typeof node === 'object' && ref) {\r\n    // Strip object freeze and write locks by cloning\r\n    node = clone(node);\r\n    node.ref = ref;\r\n  }\r\n  return node;\r\n}\r\n\r\n/**\r\n * Render the named react component\r\n * @param {string} name React template name\r\n * @param {...any} args React template arguments\r\n */\r\nexport function render(name, ...args) {\r\n  const template = templates[name];\r\n  const component = template(...args);\r\n  return component;\r\n};\r\n\r\n/**\r\n * Handlebars compile integration\r\n * @param {string} name Handlebars template\r\n * @param {...any} args Template arguments\r\n */\r\nexport function compile(template, ...args) {\r\n  const output = Handlebars.compile(template)(...args);\r\n  return output;\r\n};\r\n\r\n/**\r\n * Handlebars partials integration\r\n * @param {string} name Partial name\r\n * @param {...any} args Partial arguments\r\n */\r\nexport function partial(name, ...args) {\r\n  const output = Handlebars.partials[name](...args);\r\n  return output;\r\n};\r\n\r\n/**\r\n * Handlebars helpers integration\r\n * @param {string} name Helper name\r\n * @param {...any} args Helper arguments\r\n */\r\nexport function helper(name, ...args) {\r\n  const output = Handlebars.helpers[name].call(args[0]);\r\n  return (output && output.string) || output;\r\n};\r\n\r\n/**\r\n * Helper for a list of classes, filtering out falsies and joining with spaces\r\n * @param  {...any} args List or arrays of classes\r\n */\r\nexport function classes(...args) {\r\n  return _.flatten(args).filter(Boolean).join(' ');\r\n};\r\n","import Adapt from 'core/js/adapt';\r\nimport 'core/js/templates';\r\nimport { find, clone } from 'core/js/reactHelpers';\r\n\r\n/**\r\n * 27 April 2020 https://github.com/adaptlearning/adapt_framework/issues/2734\r\n * Chrome on Android defers load events on images when lite mode is enabled\r\n * and as part of a data saving technique.\r\n *\r\n * Add a loading=\"eager\" attribute to all template and partial img tags where\r\n * the loading attribute is missing.\r\n */\r\nAdapt.on('app:dataReady', () => {\r\n  const config = Adapt.config.get('_fixes');\r\n  if (config?._imgLazyLoad === false) return;\r\n  applyImgLoadingFix();\r\n});\r\n\r\nfunction applyImgLoadingFix() {\r\n  const findImgTag = /<img([^>]*)>/gi;\r\n  const hasLoadingAttr = / loading=/gi;\r\n  Adapt.on('template:postRender partial:postRender', event => {\r\n    const imgTagsFound = event.value.match(findImgTag);\r\n    if (!imgTagsFound) {\r\n      return;\r\n    }\r\n    event.value = imgTagsFound.reduce((value, img) => {\r\n      if (hasLoadingAttr.test(img)) {\r\n        return value;\r\n      }\r\n      // Add loading=\"eager\" by default\r\n      return value.replace(img, img.replace(findImgTag, '<img loading=\"eager\"$1>'));\r\n    }, event.value);\r\n  });\r\n  Adapt.on('reactTemplate:postRender', function(event) {\r\n    const hasImageTagWithNoLoadingAttr = find(event.value, component => {\r\n      if (component.type !== 'img') return;\r\n      if (component.props.loading) return;\r\n      return true;\r\n    });\r\n    if (!hasImageTagWithNoLoadingAttr) return;\r\n    // Strip object freeze and write locks by cloning\r\n    event.value = clone(event.value, true, component => {\r\n      if (component.type !== 'img') return;\r\n      if (component.props.loading) return;\r\n      component.props.loading = 'eager';\r\n    });\r\n  });\r\n}\r\n","import Adapt from 'core/js/adapt';\r\n\r\n/**\r\n * Browser modifications to focus handling.\r\n * @class\r\n */\r\nexport default class BrowserFocus extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this._onBlur = this._onBlur.bind(this);\r\n    this._onClick = this._onClick.bind(this);\r\n    this.$body = $('body');\r\n    this.listenTo(Adapt, {\r\n      'accessibility:ready': this._attachEventListeners\r\n    });\r\n  }\r\n\r\n  _attachEventListeners() {\r\n    this.$body\r\n      .on('blur', '*', this._onBlur)\r\n      .on('blur', this._onBlur);\r\n    // 'Capture' event attachment for click\r\n    this.$body[0].addEventListener('click', this._onClick, true);\r\n  }\r\n\r\n  /**\r\n   * When any element in the document receives a blur event,\r\n   * check to see if it needs the `data-a11y-force-focus` attribute removing\r\n   * and check to see if it was blurred because a disabled attribute was added.\r\n   * If a disabled attribute was added, the focus will be moved forward.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   */\r\n  _onBlur(event) {\r\n    const config = Adapt.a11y.config;\r\n    if (!config._isEnabled || !config._options._isFocusNextOnDisabled) {\r\n      return;\r\n    }\r\n    const $element = $(event.target);\r\n    if ($element.is('[data-a11y-force-focus]')) {\r\n      _.defer(() => $element.removeAttr('tabindex data-a11y-force-focus'));\r\n    }\r\n    // From here, only check source elements\r\n    if (event.target !== event.currentTarget) {\r\n      return;\r\n    }\r\n    // Check if element losing focus is losing focus\r\n    // due to the addition of a disabled class\r\n    if (!$element.is('[disabled]')) {\r\n      return;\r\n    }\r\n    // Move focus to next readable element\r\n    Adapt.a11y.focusNext($element);\r\n  }\r\n\r\n  /**\r\n   * Force focus when clicked on a tabbable element,\r\n   * making sure `document.activeElement` is updated.\r\n   * Stop event handling on aria-disabled elements.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   */\r\n  _onClick(event) {\r\n    const $element = $(event.target);\r\n    // search element and parents for aria-disabled - see https://github.com/adaptlearning/adapt_framework/issues/3097\r\n    const isAriaDisabled = $element.closest('[aria-disabled=true]').length === 1;\r\n    if (isAriaDisabled) {\r\n      event.preventDefault();\r\n      event.stopImmediatePropagation();\r\n    }\r\n    const config = Adapt.a11y.config;\r\n    if (!config._isEnabled || !config._options._isFocusOnClickEnabled) {\r\n      return;\r\n    }\r\n    const $stack = $([...$element.toArray(), ...$element.parents().toArray()]);\r\n    const $focusable = $stack.filter(config._options._tabbableElements);\r\n    if (!$focusable.length) {\r\n      return;\r\n    }\r\n    // Force focus for screen reader enter / space press\r\n    $focusable[0].focus();\r\n  }\r\n\r\n}\r\n","export default class FocusOptions {\r\n\r\n  /**\r\n   * Options parser for focus functions.\r\n   * @param {Object} options\r\n   * @param {boolean} [options.preventScroll=false] Stops the browser from scrolling to the focused point. https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/focus\r\n   * @param {boolean} [options.defer=false] Add a defer to the focus call, allowing for user interface settling.\r\n   */\r\n  constructor({\r\n    preventScroll = false,\r\n    defer = false\r\n  } = {}) {\r\n    /**\r\n    * Stops the browser from scrolling to the focused point.\r\n    * https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/focus\r\n    * @type {boolean}\r\n    */\r\n    this.preventScroll = preventScroll;\r\n    /**\r\n     * Add a defer to the focus call, allowing for user interface settling.\r\n     * @type {boolean}\r\n     */\r\n    this.defer = defer;\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\n\r\n/**\r\n * Manages whether or not the focus outline should be entirely removed\r\n * or removed until a key is pressed on a tabbable element.\r\n * @class\r\n */\r\nexport default class KeyboardFocusOutline extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this._onKeyDown = this._onKeyDown.bind(this);\r\n    this.$html = $('html');\r\n    this.showOnKeys = {\r\n      9: true, // tab\r\n      13: true, // enter\r\n      32: true, // space\r\n      37: true, // arrow left\r\n      38: true, // arrow up\r\n      39: true, // arrow right\r\n      40: true // arrow down\r\n    };\r\n    this.listenTo(Adapt, {\r\n      'accessibility:ready': this._attachEventListeners\r\n    });\r\n  }\r\n\r\n  _attachEventListeners() {\r\n    document.addEventListener('keydown', this._onKeyDown);\r\n    this._start();\r\n  }\r\n\r\n  /**\r\n   * Add styling classes if required.\r\n   */\r\n  _start() {\r\n    const config = Adapt.a11y.config;\r\n    if (config._options._isFocusOutlineDisabled) {\r\n      this.$html.addClass('a11y-disable-focusoutline');\r\n      return;\r\n    }\r\n    if (!config._isEnabled || !config._options._isFocusOutlineKeyboardOnlyEnabled) {\r\n      return;\r\n    }\r\n    this.$html.addClass('a11y-disable-focusoutline');\r\n  }\r\n\r\n  /**\r\n   * Handle key down events for on a tabbable element.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   */\r\n  _onKeyDown(event) {\r\n    const config = Adapt.a11y.config;\r\n    if (config._options._isFocusOutlineDisabled) {\r\n      this.$html.addClass('a11y-disable-focusoutline');\r\n      return;\r\n    }\r\n    if (!config._isEnabled || !config._options._isFocusOutlineKeyboardOnlyEnabled || !this.showOnKeys[event.keyCode]) {\r\n      return;\r\n    }\r\n    const $element = $(event.target);\r\n    if (!$element.is(config._options._tabbableElements) || $element.is(config._options._focusOutlineKeyboardOnlyIgnore)) {\r\n      return;\r\n    }\r\n    this.$html.removeClass('a11y-disable-focusoutline');\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\n\r\n/**\r\n * Controller for managing accessibilty logging, specifically used for\r\n * controlling the display of removed or deprecated API warnings.\r\n */\r\nexport default class Log extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this._warned = {};\r\n  }\r\n\r\n  _hasWarned(args) {\r\n    const config = Adapt.a11y.config;\r\n    if (!config._options._warnFirstOnly) {\r\n      return false;\r\n    }\r\n    const hash = args.map(String).join(':');\r\n    if (this._warned[hash]) {\r\n      return true;\r\n    }\r\n    this._warned[hash] = true;\r\n    return false;\r\n  }\r\n\r\n  _canWarn() {\r\n    const config = Adapt.a11y.config;\r\n    return Boolean(config._options._warn);\r\n  }\r\n\r\n  removed(...args) {\r\n    if (!this._canWarn) {\r\n      return;\r\n    }\r\n    args = ['A11Y'].concat(args);\r\n    if (this._hasWarned(args)) {\r\n      return;\r\n    }\r\n    Adapt.log.removed(...args);\r\n    return this;\r\n  }\r\n\r\n  deprecated(...args) {\r\n    if (!this._canWarn) {\r\n      return;\r\n    }\r\n    args = ['A11Y'].concat(args);\r\n    if (this._hasWarned(args)) {\r\n      return;\r\n    }\r\n    Adapt.log.deprecated(...args);\r\n    return this;\r\n  }\r\n\r\n}\r\n","/**\r\n * Controller for blocking scroll events on specified elements.\r\n * @class\r\n */\r\nexport default class Scroll extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this._onTouchStart = this._onTouchStart.bind(this);\r\n    this._onTouchEnd = this._onTouchEnd.bind(this);\r\n    this._onScrollEvent = this._onScrollEvent.bind(this);\r\n    this._onKeyDown = this._onKeyDown.bind(this);\r\n    this._scrollDisabledElements = $([]);\r\n    this.$window = $(window);\r\n    this.$body = $('body');\r\n    this._preventScrollOnKeys = {\r\n      37: true, // left\r\n      38: true, // up\r\n      39: true, // right\r\n      40: true // down\r\n    };\r\n    this._ignoreKeysOnElementsMatching = 'textarea, input, select';\r\n    this._isRunning = false;\r\n    this._touchStartEventObject = null;\r\n  }\r\n\r\n  /**\r\n   * Block scrolling on the given elements.\r\n   *\r\n   * @param {Object|string|Array} $elements\r\n   */\r\n  disable($elements) {\r\n    $elements = $($elements);\r\n    this._scrollDisabledElements = this._scrollDisabledElements.add($elements);\r\n    this._checkRunning();\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Stop blocking scrolling on the given elements.\r\n   *\r\n   * @param {Object|string|Array} $items\r\n   */\r\n  enable($elements) {\r\n    $elements = $($elements);\r\n    if (!$elements.length) {\r\n      this.clear();\r\n      return this;\r\n    }\r\n    this._scrollDisabledElements = this._scrollDisabledElements.not($elements);\r\n    this._checkRunning();\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Stop blocking all scrolling.\r\n   */\r\n  clear() {\r\n    this._scrollDisabledElements = $([]);\r\n    this._checkRunning();\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Start or stop listening for events to block if and when needed.\r\n   */\r\n  _checkRunning() {\r\n    if (!this._scrollDisabledElements.length) {\r\n      this._stop();\r\n      return;\r\n    }\r\n    this._start();\r\n  }\r\n\r\n  /**\r\n   * Start listening for events to block.\r\n   */\r\n  _start() {\r\n    if (this._isRunning) {\r\n      return;\r\n    }\r\n    this._isRunning = true;\r\n    window.addEventListener('touchstart', this._onTouchStart); // mobile\r\n    window.addEventListener('touchend', this._onTouchEnd); // mobile\r\n    window.addEventListener('touchmove', this._onScrollEvent, { passive: false }); // mobile\r\n    window.addEventListener('wheel', this._onScrollEvent, { passive: false });\r\n    document.addEventListener('wheel', this._onScrollEvent, { passive: false });\r\n    document.addEventListener('keydown', this._onKeyDown);\r\n  }\r\n\r\n  /**\r\n   * Capture the touchstart event object for deltaY calculations.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   */\r\n  _onTouchStart(event) {\r\n    event = $.event.fix(event);\r\n    this._touchStartEventObject = event;\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Clear touchstart event object.\r\n   */\r\n  _onTouchEnd() {\r\n    this._touchStartEventObject = null;\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Process a native scroll event.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   */\r\n  _onScrollEvent(event) {\r\n    event = $.event.fix(event);\r\n    return this._preventScroll(event);\r\n  }\r\n\r\n  /**\r\n   * Process a native keydown event.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   */\r\n  _onKeyDown(event) {\r\n    event = $.event.fix(event);\r\n    if (!this._preventScrollOnKeys[event.keyCode]) {\r\n      return;\r\n    }\r\n    const $target = $(event.target);\r\n    if ($target.is(this._ignoreKeysOnElementsMatching)) {\r\n      return;\r\n    }\r\n    return this._preventScroll(event);\r\n  }\r\n\r\n  /**\r\n   * Process jquery event object.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   */\r\n  _preventScroll(event) {\r\n    const isGesture = (event.touches?.length > 1);\r\n    if (isGesture) {\r\n      // allow multiple finger gestures through\r\n      // this will unfortunately allow two finger background scrolling on mobile devices\r\n      // one finger background scrolling will still be disabled\r\n      return;\r\n    }\r\n    const $target = $(event.target);\r\n    if (this._scrollDisabledElements.length) {\r\n      const scrollingParent = this._getScrollingParent(event, $target);\r\n      if (scrollingParent.filter(this._scrollDisabledElements).length === 0) {\r\n        this.$window.scroll();\r\n        return;\r\n      }\r\n    }\r\n    event.preventDefault();\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Return the parent which will be scrolling from the current scroll event.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   * @param {Object} $target jQuery element object.\r\n   */\r\n  _getScrollingParent(event, $target) {\r\n    const isTouchEvent = event.type === 'touchmove';\r\n    const hasTouchStartEvent = this._touchStartEventObject?.originalEvent;\r\n    if (isTouchEvent && !hasTouchStartEvent) {\r\n      return $target;\r\n    }\r\n    const directionY = this._getScrollDirection(event);\r\n    if (directionY === 'none') {\r\n      return this.$body;\r\n    }\r\n    const parents = $target.parents();\r\n    for (let i = 0, l = parents.length; i < l; i++) {\r\n      const $parent = $(parents[i]);\r\n      if ($parent.is('body')) {\r\n        return this.$body;\r\n      }\r\n      if (!this._isScrollable($parent)) {\r\n        continue;\r\n      }\r\n      if (!this._isScrolling($parent, directionY)) {\r\n        continue;\r\n      }\r\n      return $parent;\r\n    }\r\n    return this.$body;\r\n  }\r\n\r\n  /**\r\n   * Returns true if the specified target is scrollable.\r\n   *\r\n   * @param {Object} $target jQuery element object.\r\n   * @returns {boolean}\r\n   */\r\n  _isScrollable($target) {\r\n    const scrollType = $target.css('overflow-y');\r\n    if (scrollType !== 'auto' && scrollType !== 'scroll') {\r\n      return false;\r\n    }\r\n    const pointerEvents = $target.css('pointer-events');\r\n    if (pointerEvents === 'none') {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Returns true if the specified target is the scrolling target.\r\n   *\r\n   * @param {Object} $target jQuery element object.\r\n   * @param {string} directionY 'none' | 'up' | 'down'\r\n   *\r\n   * @returns {boolean}\r\n   */\r\n  _isScrolling($target, directionY) {\r\n    const scrollTop = Math.ceil($target.scrollTop());\r\n    const innerHeight = $target.outerHeight();\r\n    const scrollHeight = $target[0].scrollHeight;\r\n    let hasScrollingSpace = false;\r\n    switch (directionY) {\r\n      case 'down':\r\n        hasScrollingSpace = scrollTop + innerHeight < scrollHeight;\r\n        if (hasScrollingSpace) {\r\n          return true;\r\n        }\r\n        break;\r\n      case 'up':\r\n        hasScrollingSpace = scrollTop > 0;\r\n        if (hasScrollingSpace) {\r\n          return true;\r\n        }\r\n        break;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Returns the vertical direction of scroll.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   * @returns {string} 'none' | 'up' | 'down'\r\n   */\r\n  _getScrollDirection(event) {\r\n    const deltaY = this._getScrollDelta(event);\r\n    if (deltaY === 0) {\r\n      return 'none';\r\n    }\r\n    return deltaY > 0 ? 'up' : 'down';\r\n  }\r\n\r\n  /**\r\n   * Returns the number of pixels which is intended to be scrolled.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   * @returns {number}\r\n   */\r\n  _getScrollDelta(event) {\r\n    let deltaY = 0;\r\n    const isTouchEvent = event.type === 'touchmove';\r\n    const originalEvent = event.originalEvent;\r\n    if (isTouchEvent) {\r\n      // Touch events\r\n      // iOS previous + current scroll pos\r\n      const startOriginalEvent = this._touchStartEventObject.originalEvent;\r\n      let currentY = originalEvent.pageY;\r\n      let previousY = startOriginalEvent.pageY;\r\n      if (currentY === 0 || currentY === previousY) {\r\n        // Android chrome current scroll pos\r\n        currentY = originalEvent.touches[0].pageY;\r\n        previousY = startOriginalEvent.touches[0].pageY;\r\n      }\r\n      // Touch: delta calculated from touchstart pos vs touchmove pos\r\n      deltaY = currentY - previousY;\r\n    } else {\r\n      // Mouse events\r\n      const hasDeltaY = (originalEvent.wheelDeltaY || originalEvent.deltaY !== undefined);\r\n      if (hasDeltaY) {\r\n        // Desktop: Firefox & IE delta inverted\r\n        deltaY = -originalEvent.deltaY;\r\n      } else {\r\n        // Desktop: Chrome & Safari wheel delta\r\n        deltaY = (originalEvent.wheelDelta || 0);\r\n      }\r\n    }\r\n    return deltaY;\r\n  }\r\n\r\n  /**\r\n   * Stop listening for events to block.\r\n   */\r\n  _stop() {\r\n    if (!this._isRunning) {\r\n      return;\r\n    }\r\n    this._isRunning = false;\r\n    window.removeEventListener('touchstart', this._onTouchStart); // mobile\r\n    window.removeEventListener('touchend', this._onTouchEnd); // mobile\r\n    // shouldn't need to supply 3rd arg when removing, but IE11 won't remove the event listener if you don't - see https://github.com/adaptlearning/adapt_framework/issues/2466\r\n    window.removeEventListener('touchmove', this._onScrollEvent, { passive: false }); // mobile\r\n    window.removeEventListener('wheel', this._onScrollEvent, { passive: false });\r\n    document.removeEventListener('wheel', this._onScrollEvent, { passive: false });\r\n    document.removeEventListener('keydown', this._onKeyDown);\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\n\r\n/**\r\n * Controller for managing tab wrapping for popups.\r\n * @class\r\n */\r\nexport default class WrapFocus extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    _.bindAll(this, '_onWrapAround');\r\n    this.listenTo(Adapt, {\r\n      'accessibility:ready': this._attachEventListeners\r\n    });\r\n  }\r\n\r\n  _attachEventListeners() {\r\n    const config = Adapt.a11y.config;\r\n    $('body').on('click focus', config._options._focusguard, this._onWrapAround);\r\n  }\r\n\r\n  /**\r\n   * If click or focus is received on any element with the focusguard class,\r\n   * loop focus around to the top of the document.\r\n   *\r\n   * @param {JQuery.Event} event\r\n   */\r\n  _onWrapAround(event) {\r\n    const config = Adapt.a11y.config;\r\n    if (!config._isEnabled || !config._options._isPopupWrapFocusEnabled) {\r\n      return;\r\n    }\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n    Adapt.a11y.focusFirst('body', { defer: false });\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\n\r\n/**\r\n * Tabindex and aria-hidden manager for popups.\r\n * @class\r\n */\r\nexport default class Popup extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    /**\r\n     * List of elements which form the base at which elements are generally tabbale\r\n     * and aria-hidden='false'.\r\n     *\r\n     * @type {Array<Object>}\r\n     */\r\n    this._floorStack = [$('body')];\r\n    /**\r\n     * List of elements to return the focus to once leaving each stack.\r\n     *\r\n     * @type {Array<Object>}\r\n     */\r\n    this._focusStack = [];\r\n    /**\r\n     * Hash of tabindex states for each tabbable element in the popup stack.\r\n     *\r\n     * @type {Object}\r\n     */\r\n    this._tabIndexes = {};\r\n    /**\r\n     * Hash of aria-hidden states for each tabbable element in the popup stack.\r\n     *\r\n     * @type {Object}\r\n     */\r\n    this._ariaHiddens = {};\r\n    /**\r\n     * Incremented unique ids for elements belonging to a popup stack with saved\r\n     * states,\r\n     */\r\n    this._elementUIDIndex = 0;\r\n    this.listenTo(Adapt, {\r\n      'popup:opened'($element, ignoreInternalTrigger) {\r\n        if (ignoreInternalTrigger) {\r\n          return;\r\n        }\r\n        Adapt.a11y.log.deprecated('Adapt.trigger(\"popup:opened\", $element) is replaced with Adapt.a11y.popupOpened($element);');\r\n        this.opened($element, true);\r\n      },\r\n      'popup:closed'($target, ignoreInternalTrigger) {\r\n        if (ignoreInternalTrigger) {\r\n          return;\r\n        }\r\n        Adapt.a11y.log.deprecated('Adapt.trigger(\"popup:closed\", $target) is replaced with Adapt.a11y.popupClosed($target);');\r\n        this.closed($target, true);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Reorganise the tabindex and aria-hidden attributes in the document to\r\n   * restrict user interaction to the element specified.\r\n   *\r\n   * @param {Object} [$popupElement] Element encapulating the popup.\r\n   * @returns {Object} Returns `Adapt.a11y._popup`.\r\n   */\r\n  opened($popupElement, silent) {\r\n    // Capture currently active element or element specified\r\n    $popupElement = $popupElement || $(document.activeElement);\r\n    this._addPopupLayer($popupElement);\r\n    if (!silent) {\r\n      Adapt.trigger('popup:opened', $popupElement, true);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Restrict tabbing and screen reader access to selected element only.\r\n   *\r\n   * @param {Object} $popupElement Element encapulating the popup.\r\n   */\r\n  _addPopupLayer($popupElement) {\r\n    $popupElement = $($popupElement);\r\n    const config = Adapt.a11y.config;\r\n    if (!config._isEnabled || !config._options._isPopupManagementEnabled || $popupElement.length === 0) {\r\n      return $popupElement;\r\n    }\r\n    this._floorStack.push($popupElement);\r\n    this._focusStack.push($(document.activeElement));\r\n    let $elements = $(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes);\r\n    const $branch = $popupElement.add($popupElement.parents());\r\n    const $siblings = $branch.siblings().filter(config._options._tabbableElementsExcludes);\r\n    $elements = $elements.add($siblings);\r\n    $elements.each((index, item) => {\r\n      const $item = $(item);\r\n      let elementUID;\r\n      if (typeof item.a11y_uid === 'undefined') {\r\n        item.a11y_uid = 'UID' + ++this._elementUIDIndex;\r\n      }\r\n      elementUID = item.a11y_uid;\r\n      if (this._tabIndexes[elementUID] === undefined) {\r\n        this._tabIndexes[elementUID] = [];\r\n      }\r\n      if (this._ariaHiddens[elementUID] === undefined) {\r\n        this._ariaHiddens[elementUID] = [];\r\n      }\r\n      const tabindex = $item.attr('tabindex');\r\n      const ariaHidden = $item.attr('aria-hidden');\r\n      this._tabIndexes[elementUID].push(tabindex === undefined ? '' : tabindex);\r\n      this._ariaHiddens[elementUID].push(ariaHidden === undefined ? '' : ariaHidden);\r\n      if (config._options._isPopupTabIndexManagementEnabled) {\r\n        $item.attr('tabindex', -1);\r\n      }\r\n      if (config._options._isPopupAriaHiddenManagementEnabled) {\r\n        $item.attr('aria-hidden', true);\r\n      }\r\n    });\r\n    const $items = $popupElement.find(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes);\r\n    if (config._options._isPopupTabIndexManagementEnabled) {\r\n      $items.attr('tabindex', 0);\r\n    }\r\n    if (config._options._isPopupAriaHiddenManagementEnabled) {\r\n      $items\r\n        .removeAttr('aria-hidden')\r\n        .removeClass('aria-hidden')\r\n        .parents(config._options._ariaHiddenExcludes)\r\n        .removeAttr('aria-hidden')\r\n        .removeClass('aria-hidden');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Close the last popup on the stack, restoring tabindex and aria-hidden\r\n   * attributes.\r\n   *\r\n   * @param {Object} [$focusElement] Element at which to move focus.\r\n   * @returns {Object} Returns `Adapt.a11y._popup`.\r\n   */\r\n  closed($focusElement, silent) {\r\n    const $previousFocusElement = this._removeLastPopupLayer();\r\n    $focusElement = $focusElement || $previousFocusElement || $('body');\r\n    if (!silent) {\r\n      Adapt.trigger('popup:closed', $focusElement, true);\r\n    }\r\n    Adapt.a11y.focusFirst($($focusElement), { preventScroll: true });\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Restores tabbing and screen reader access to the state before the last\r\n   * `_addPopupLayer` call.\r\n   *\r\n   * @returns {Object} Returns previously active element.\r\n   */\r\n  _removeLastPopupLayer() {\r\n    const config = Adapt.a11y.config;\r\n    if (!config._isEnabled || !config._options._isPopupManagementEnabled) {\r\n      return $(document.activeElement);\r\n    }\r\n    // the body layer is the first element and must always exist\r\n    if (this._floorStack.length <= 1) {\r\n      return;\r\n    }\r\n    this._floorStack.pop();\r\n    $(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes).each((index, item) => {\r\n      const $item = $(item);\r\n      let previousTabIndex = '';\r\n      let previousAriaHidden = '';\r\n      let elementUID;\r\n      if (typeof item.a11y_uid === 'undefined') {\r\n        // assign element a unique id\r\n        item.a11y_uid = 'UID' + ++this._elementUIDIndex;\r\n      }\r\n      elementUID = item.a11y_uid;\r\n      if (this._tabIndexes[elementUID]?.length) {\r\n        // get previous tabindex if saved\r\n        previousTabIndex = this._tabIndexes[elementUID].pop();\r\n        previousAriaHidden = this._ariaHiddens[elementUID].pop();\r\n      }\r\n      if (this._tabIndexes[elementUID]?.length) {\r\n        // delete element tabindex store if empty\r\n        delete this._tabIndexes[elementUID];\r\n        delete this._ariaHiddens[elementUID];\r\n      }\r\n      if (config._options._isPopupTabIndexManagementEnabled) {\r\n        if (previousTabIndex === '') {\r\n          $item.removeAttr('tabindex');\r\n        } else {\r\n          $item.attr({\r\n            'tabindex': previousTabIndex\r\n          });\r\n        }\r\n      }\r\n      if (config._options._isPopupAriaHiddenManagementEnabled) {\r\n        if (previousAriaHidden === '') {\r\n          $item.removeAttr('aria-hidden');\r\n        } else {\r\n          $item.attr({\r\n            'aria-hidden': previousAriaHidden\r\n          });\r\n        }\r\n      }\r\n    });\r\n    return this._focusStack.pop();\r\n  }\r\n\r\n  /**\r\n   * When a popup is open, this function makes it possible to swap the element\r\n   * that should receive focus on popup close.\r\n   *\r\n   * @param {Object} $focusElement Set a new element to focus on.\r\n   * @returns {Object} Returns previously set focus element.\r\n   */\r\n  setCloseTo($focusElement) {\r\n    const $original = this._focusStack.pop();\r\n    this._focusStack.push($focusElement);\r\n    return $original;\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\n\r\n/**\r\n * The old API is rerouted to the new API with warnings.\r\n */\r\n\r\nObject.assign($.fn, {\r\n\r\n  isFixedPostion() {\r\n    Adapt.a11y.log.removed('$(\"..\").isFixedPostion was unneeded and has been removed, let us know if you need it back.');\r\n    return false;\r\n  },\r\n\r\n  a11y_aria_label() {\r\n    Adapt.a11y.log.removed('$(\"..\").a11y_aria_label was incorrect behaviour.');\r\n    return this;\r\n  },\r\n\r\n  limitedScrollTo() {\r\n    Adapt.a11y.log.removed('$.limitedScrollTo had no impact on the screen reader cursor.');\r\n    return this;\r\n  },\r\n\r\n  a11y_text() {\r\n    Adapt.a11y.log.removed('a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/');\r\n    return this;\r\n  },\r\n\r\n  a11y_selected() {\r\n    Adapt.a11y.log.removed('$(\"..\").a11y_selected is removed. Please use aria-live instead.');\r\n    return this;\r\n  },\r\n\r\n  a11y_on(isOn) {\r\n    Adapt.a11y.log.deprecated('$(\"..\").a11y_on, use Adapt.a11y.findTabbable($element); and Adapt.a11y.toggleAccessible($elements, isAccessible); instead.');\r\n    const $tabbable = Adapt.a11y.findTabbable(this);\r\n    Adapt.a11y.toggleAccessible($tabbable, isOn);\r\n    return this;\r\n  },\r\n\r\n  a11y_only() {\r\n    Adapt.a11y.log.removed('$(\"..\").a11y_only, use Adapt.a11y.popupOpened($popupElement); instead.');\r\n    return this;\r\n  },\r\n\r\n  scrollDisable() {\r\n    if (Adapt.a11y.config._options._isScrollDisableEnabled === false) {\r\n      return this;\r\n    }\r\n    Adapt.a11y.log.deprecated('$(\"..\").scrollDisable, use Adapt.a11y.scrollDisable($elements); instead.');\r\n    Adapt.a11y.scrollDisable(this);\r\n    return this;\r\n  },\r\n\r\n  scrollEnable() {\r\n    if (Adapt.a11y.config._options._isScrollDisableEnabled === false) {\r\n      return this;\r\n    }\r\n    Adapt.a11y.log.deprecated('$(\"..\").scrollEnable, use Adapt.a11y.scrollEnable($elements); instead.');\r\n    Adapt.a11y.scrollEnable(this);\r\n    return this;\r\n  },\r\n\r\n  a11y_popup() {\r\n    Adapt.a11y.log.deprecated('$(\"..\").a11y_popup, use Adapt.a11y.popupOpened($popupElement); instead.');\r\n    return Adapt.a11y.popupOpened(this);\r\n  },\r\n\r\n  a11y_cntrl(isOn, withDisabled) {\r\n    Adapt.a11y.log.deprecated('$(\"..\").a11y_cntrl, use Adapt.a11y.toggleAccessible($elements, isAccessible); and if needed Adapt.a11y.toggleEnabled($elements, isEnabled); instead.');\r\n    Adapt.a11y.toggleAccessible(this, isOn);\r\n    if (withDisabled) Adapt.a11y.toggleEnabled(this, isOn);\r\n    return this;\r\n  },\r\n\r\n  a11y_cntrl_enabled(isOn) {\r\n    Adapt.a11y.log.deprecated('$(\"..\").a11y_cntrl_enabled, use Adapt.a11y.toggleAccessibleEnabled($elements, isAccessibleEnabled); instead.');\r\n    Adapt.a11y.toggleAccessibleEnabled(this, isOn);\r\n    return this;\r\n  },\r\n\r\n  isReadable() {\r\n    Adapt.a11y.log.deprecated('$(\"..\").isReadable, use Adapt.a11y.isReadable($element); instead.');\r\n    return Adapt.a11y.isReadable(this);\r\n  },\r\n\r\n  findForward(selector) {\r\n    Adapt.a11y.log.removed('$(\"..\").findForward has been removed as the use cases are very small, let us know if you need it back.');\r\n    return Adapt.a11y._findFirstForward(this, selector);\r\n  },\r\n\r\n  findWalk(selector) {\r\n    Adapt.a11y.log.removed('$(\"..\").findWalk has been removed as the use cases are very small, let us know if you need it back.');\r\n    return Adapt.a11y._findFindForwardDescendant(this, selector);\r\n  },\r\n\r\n  focusNoScroll() {\r\n    Adapt.a11y.log.deprecated('$(\"..\").focusNoScroll, use Adapt.a11y.focus($element); instead.');\r\n    return Adapt.a11y.focus(this);\r\n  },\r\n\r\n  focusNext(returnOnly) {\r\n    Adapt.a11y.log.deprecated('$(\"..\").focusNext, use Adapt.a11y.focusNext($element); or if needed Adapt.a11y.findFirstReadable($element); instead.');\r\n    if (returnOnly) {\r\n      return Adapt.a11y.findFirstReadable(this);\r\n    }\r\n    return Adapt.a11y.focusNext(this);\r\n  },\r\n\r\n  focusOrNext(returnOnly) {\r\n    Adapt.a11y.log.deprecated('$(\"..\").focusOrNext, use Adapt.a11y.focusFirst($element); or if needed Adapt.a11y.findFirstReadable($element); or Adapt.a11y.isReadable($element); instead.');\r\n    if (returnOnly) {\r\n      if (Adapt.a11y.isReadable(this)) return this;\r\n      return Adapt.a11y.findFirstReadable(this);\r\n    }\r\n    return Adapt.a11y.focusFirst(this);\r\n  },\r\n\r\n  a11y_focus(dontDefer) {\r\n    Adapt.a11y.log.deprecated('$(\"..\").a11y_focus, use Adapt.a11y.focusFirst($element, { defer: true }); instead.');\r\n    Adapt.a11y.focusFirst(this, { defer: !dontDefer });\r\n    return this;\r\n  }\r\n\r\n});\r\n\r\nObject.assign($, {\r\n\r\n  a11y_alert() {\r\n    Adapt.a11y.log.removed('$.a11y_alert is removed. Please use aria-live instead.');\r\n    return this;\r\n  },\r\n\r\n  a11y_update() {\r\n    Adapt.a11y.log.removed('a11y_update is no longer required.');\r\n    return this;\r\n  },\r\n\r\n  a11y_text(text) {\r\n    Adapt.a11y.log.removed('a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/');\r\n    return text;\r\n  },\r\n\r\n  a11y_on(isOn, selector) {\r\n    Adapt.a11y.log.deprecated('$(\"..\").a11y_on, use Adapt.a11y.toggleHidden($elements, isHidden); instead.');\r\n    return Adapt.a11y.toggleHidden(selector, !isOn);\r\n  },\r\n\r\n  a11y_popdown($focusTarget) {\r\n    Adapt.a11y.log.removed('$.a11y_popdown, use Adapt.a11y.popupClosed($focusTarget); instead.');\r\n    return Adapt.a11y.popupClosed($focusTarget);\r\n  },\r\n\r\n  a11y_focus(dontDefer) {\r\n    Adapt.a11y.log.deprecated('$.a11y_focus, use Adapt.a11y.focusFirst(\"body\", { defer: true }); instead.');\r\n    Adapt.a11y.focusFirst('body', { defer: !dontDefer });\r\n    return this;\r\n  },\r\n\r\n  a11y_normalize(html) {\r\n    Adapt.a11y.log.deprecated('$.a11y_normalize, use Adapt.a11y.normalize(\"html\"); instead.');\r\n    return Adapt.a11y.normalize(html);\r\n  },\r\n\r\n  a11y_remove_breaks(html) {\r\n    Adapt.a11y.log.deprecated('$.a11y_remove_breaks, use Adapt.a11y.removeBreaks(\"html\"); instead.');\r\n    return Adapt.a11y.removeBreaks(html);\r\n  }\r\n\r\n});\r\n","import Adapt from 'core/js/adapt';\r\nimport BrowserFocus from 'core/js/a11y/browserFocus';\r\nimport FocusOptions from 'core/js/a11y/focusOptions';\r\nimport KeyboardFocusOutline from 'core/js/a11y/keyboardFocusOutline';\r\nimport Log from 'core/js/a11y/log';\r\nimport Scroll from 'core/js/a11y/scroll';\r\nimport WrapFocus from 'core/js/a11y/wrapFocus';\r\nimport Popup from 'core/js/a11y/popup';\r\n\r\nimport 'core/js/a11y/deprecated';\r\n\r\nclass A11y extends Backbone.Controller {\r\n\r\n  defaults() {\r\n    return {\r\n      _isFocusOutlineKeyboardOnlyEnabled: true,\r\n      /**\r\n       * `_isFocusOutlineDisabled` ignores `_isEnabled` and can be used when all other\r\n       * accessibility features have been disabled.\r\n       */\r\n      _isFocusOutlineDisabled: false,\r\n      _isFocusAssignmentEnabled: true,\r\n      _isFocusOnClickEnabled: true,\r\n      _isFocusNextOnDisabled: true,\r\n      _isScrollDisableEnabled: true,\r\n      _isAriaHiddenManagementEnabled: true,\r\n      _isPopupManagementEnabled: true,\r\n      _isPopupWrapFocusEnabled: true,\r\n      _isPopupAriaHiddenManagementEnabled: true,\r\n      _isPopupTabIndexManagementEnabled: true,\r\n      /**\r\n       * Do not change aria-hidden on these elements.\r\n       */\r\n      _ariaHiddenExcludes: ':not(#wrapper):not(body)',\r\n      _tabbableElements: 'a,button,input,select,textarea,[tabindex]:not([data-a11y-force-focus])',\r\n      _focusOutlineKeyboardOnlyIgnore: 'input,textarea',\r\n      /**\r\n       * Designate these elements as not tabbable.\r\n       */\r\n      _tabbableElementsExcludes: ':not(.a11y-ignore):not([data-a11y-force-focus])',\r\n      _focusableElements: 'a,button,input,select,textarea,[tabindex],label',\r\n      _readableElements: '[role=heading],[aria-label],[aria-labelledby],[alt]',\r\n      /**\r\n       * Selector for elements which cause tab wrapping.\r\n       */\r\n      _focusguard: '.a11y-focusguard',\r\n      /**\r\n       * Specifies all stylistic elements.\r\n       */\r\n      _wrapStyleElements: 'b,i,abbr,strong,em,small,sub,sup,ins,del,mark,zw,nb',\r\n\r\n      /**\r\n       * Logging settings\r\n       */\r\n      _warnFirstOnly: true,\r\n      _warn: true\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this.isReadable = this.isReadable.bind(this);\r\n    this.isTabbable = this.isTabbable.bind(this);\r\n    this.$html = $('html');\r\n    this._htmlCharRegex = /&.*;/g;\r\n    /** @type {Object} */\r\n    this.config = null;\r\n    this._browserFocus = new BrowserFocus();\r\n    this._keyboardFocusOutline = new KeyboardFocusOutline();\r\n    this._wrapFocus = new WrapFocus();\r\n    this._popup = new Popup();\r\n    this._scroll = new Scroll();\r\n    this.log = new Log();\r\n\r\n    this._removeLegacyElements();\r\n    this.listenToOnce(Adapt, {\r\n      'configModel:dataLoaded': this._onConfigDataLoaded,\r\n      'navigationView:postRender': this._removeLegacyElements\r\n    }, this);\r\n    Adapt.on('device:changed', this._setupNoSelect);\r\n    this.listenTo(Adapt, {\r\n      'router:location': this._onNavigationStart,\r\n      'contentObjectView:ready router:plugin': this._onNavigationEnd\r\n    });\r\n  }\r\n\r\n  _onConfigDataLoaded() {\r\n    this.config = Adapt.config.get('_accessibility');\r\n    this.config._isActive = false;\r\n    this.config._options = _.defaults(this.config._options || {}, this.defaults());\r\n    Adapt.offlineStorage.set('a11y', false);\r\n    this.$html.toggleClass('has-accessibility', this.isEnabled());\r\n    this._setupNoSelect();\r\n    this._addFocuserDiv();\r\n    if (this._isReady) {\r\n      return;\r\n    }\r\n    this._isReady = true;\r\n    Adapt.trigger('accessibility:ready');\r\n  }\r\n\r\n  _setupNoSelect() {\r\n    if (!this.config?._disableTextSelectOnClasses) {\r\n      return;\r\n    }\r\n    const classes = this.config._disableTextSelectOnClasses.split(' ');\r\n    const isMatch = classes.some(className => this.$html.is(className));\r\n    this.$html.toggleClass('u-no-select', isMatch);\r\n  }\r\n\r\n  _addFocuserDiv() {\r\n    if ($('#a11y-focuser').length) {\r\n      return;\r\n    }\r\n    $('body').append($('<div id=\"a11y-focuser\" class=\"a11y-ignore\" tabindex=\"-1\">&nbsp;</div>'));\r\n  }\r\n\r\n  _removeLegacyElements() {\r\n    const $legacyElements = $('body').children('#accessibility-toggle, #accessibility-instructions');\r\n    const $navigationElements = $('.nav').find('#accessibility-toggle, #accessibility-instructions');\r\n    if (!$legacyElements.length && !$navigationElements.length) {\r\n      return;\r\n    }\r\n    Adapt.log.warn('REMOVED: #accessibility-toggle and #accessibility-instructions have been removed. Please remove them from all of your .html files.');\r\n    $legacyElements.remove();\r\n    $navigationElements.remove();\r\n  }\r\n\r\n  _onNavigationStart() {\r\n    if (!this.isEnabled()) {\r\n      return;\r\n    }\r\n    // Stop document reading\r\n    _.defer(() => this.toggleHidden('.contentobject', true));\r\n  }\r\n\r\n  _onNavigationEnd(view) {\r\n    // Prevent sub-menu items provoking behaviour\r\n    if ((view?.model?.get('_id') !== Adapt.location._currentId) || !this.isEnabled()) {\r\n      return;\r\n    }\r\n    // Allow document to be read\r\n    this.toggleHidden('.contentobject', false);\r\n  }\r\n\r\n  isActive() {\r\n    this.log.removed('Accessibility is now always active when enabled. Please unify your user experiences.');\r\n    return false;\r\n  }\r\n\r\n  isEnabled() {\r\n    return this.config?._isEnabled;\r\n  }\r\n\r\n  /**\r\n   * Adds or removes `aria-hidden` attribute to elements.\r\n   *\r\n   * @param {Object|string|Array} $elements\r\n   * @param {boolean} [isHidden=true]\r\n   * @returns {Object} Chainable\r\n   */\r\n  toggleHidden($elements, isHidden = true) {\r\n    $elements = $($elements);\r\n    const config = this.config;\r\n    if (!config._isEnabled || !config._options._isAriaHiddenManagementEnabled) {\r\n      return this;\r\n    }\r\n    if (isHidden === true) {\r\n      $elements.attr('aria-hidden', true);\r\n    } else {\r\n      $elements.removeAttr('aria-hidden');\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Adds or removes `aria-hidden` and `disabled` attributes and `disabled`\r\n   * classes to elements.\r\n   *\r\n   * @param {Object|string|Array} $elements\r\n   * @param {boolean} [isHidden=true]\r\n   * @returns {Object} Chainable\r\n   */\r\n  toggleAccessibleEnabled($elements, isAccessibleEnabled) {\r\n    this.toggleAccessible($elements, isAccessibleEnabled);\r\n    this.toggleEnabled($elements, isAccessibleEnabled);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Adds or removes `aria-hidden` attribute and disables `tabindex` on elements.\r\n   *\r\n   * @param {Object|string|Array} $elements\r\n   * @param {boolean} [isReadable=true]\r\n   * @returns {Object} Chainable\r\n   */\r\n  toggleAccessible($elements, isReadable = true) {\r\n    $elements = $($elements);\r\n    const config = this.config;\r\n    if (!config._isEnabled || !config._options._isAriaHiddenManagementEnabled || $elements.length === 0) {\r\n      return this;\r\n    }\r\n    if (!isReadable) {\r\n      $elements.attr({\r\n        tabindex: '-1',\r\n        'aria-hidden': 'true'\r\n      }).addClass('aria-hidden');\r\n    } else {\r\n      $elements.removeAttr('aria-hidden tabindex').removeClass('aria-hidden');\r\n      $elements.parents(config._options._ariaHiddenExcludes).removeAttr('aria-hidden').removeClass('aria-hidden');\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Adds or removes `disabled` attribute and `disabled` class.\r\n   *\r\n   * @param {Object|string|Array} $elements\r\n   * @param {boolean} [isEnabled=true]\r\n   * @returns {Object} Chainable\r\n   */\r\n  toggleEnabled($elements, isEnabled = true) {\r\n    $elements = $($elements);\r\n    if ($elements.length === 0) {\r\n      return this;\r\n    }\r\n    if (!isEnabled) {\r\n      $elements.attr({\r\n        tabindex: '-1',\r\n        'aria-disabled': 'true'\r\n      }).addClass('is-disabled');\r\n    } else {\r\n      $elements.removeAttr('aria-disabled tabindex').removeClass('is-disabled');\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Find the first tabbable element after the specified element.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   * @returns {Object}\r\n   */\r\n  findFirstTabbable($element) {\r\n    $element = $($element).first();\r\n    return this._findFirstForward($element, this.isTabbable);\r\n  }\r\n\r\n  /**\r\n   * Find the first readable element after the specified element.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   * @returns {Object}\r\n   */\r\n  findFirstReadable($element) {\r\n    $element = $($element).first();\r\n    return this._findFirstForward($element, this.isReadable);\r\n  }\r\n\r\n  /**\r\n   * Find all tabbable elements in the specified element.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   * @returns {Object}\r\n   */\r\n  findTabbable($element) {\r\n    const config = this.config;\r\n    return $($element).find(config._options._tabbableElements).filter(config._options._tabbableElementsExcludes);\r\n  }\r\n\r\n  /**\r\n   * Find all readable elements in the specified element.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   */\r\n  findReadable($element) {\r\n    return $($element).find('*').filter((index, element) => this.isReadable(element));\r\n  }\r\n\r\n  /**\r\n   * Check if the element is natively or explicitly tabbable.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   * @returns {boolean|undefined}\r\n   */\r\n  isTabbable($element) {\r\n    const config = this.config;\r\n    const value = $($element).is(config._options._tabbableElements).is(config._options._tabbableElementsExcludes);\r\n    if (!value) {\r\n      return undefined; // Allow _findForward to descend\r\n    }\r\n    return value;\r\n  }\r\n\r\n  /**\r\n   * Check if the first item is readable by a screen reader.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   * @param {boolean} [checkParents=true] Check if parents are inaccessible.\r\n   * @returns {boolean}\r\n   */\r\n  isReadable($element, checkParents = true) {\r\n    const config = this.config;\r\n    $element = $($element).first();\r\n\r\n    const $branch = checkParents\r\n      ? $element.add($element.parents())\r\n      : $element;\r\n\r\n    const isNotVisible = $branch.toArray().some(item => {\r\n      const $item = $(item);\r\n      // make sure item is not explicitly invisible\r\n      return $item.css('display') === 'none' ||\r\n        $item.css('visibility') === 'hidden' ||\r\n        $item.attr('aria-hidden') === 'true';\r\n    });\r\n    if (isNotVisible) {\r\n      return false;\r\n    }\r\n\r\n    // check that the component is natively tabbable or\r\n    // will be knowingly read by a screen reader\r\n    const hasNativeFocusOrIsScreenReadable = $element.is(config._options._focusableElements) ||\r\n      $element.is(config._options._readableElements);\r\n    if (hasNativeFocusOrIsScreenReadable) {\r\n      return true;\r\n    }\r\n    const childNodes = $element[0].childNodes;\r\n    for (let c = 0, cl = childNodes.length; c < cl; c++) {\r\n      const childNode = childNodes[c];\r\n      const isTextNode = (childNode.nodeType === 3);\r\n      if (!isTextNode) {\r\n        continue;\r\n      }\r\n      const isOnlyWhiteSpace = /^\\s*$/.test(childNode.nodeValue);\r\n      if (isOnlyWhiteSpace) {\r\n        continue;\r\n      }\r\n      return true;\r\n    }\r\n    return undefined; // Allows _findForward to decend.\r\n  }\r\n\r\n  /**\r\n   * Find forward in the DOM, descending and ascending to move forward\r\n   * as appropriate.\r\n   *\r\n   * If the selector is a function it should returns true, false or undefined.\r\n   * Returning true matches the item and returns it. Returning false means do\r\n   * not match or descend into this item, returning undefined means do not match,\r\n   * but descend into this item.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   * @param {string|function|undefined} selector\r\n   * @returns {Object} Returns found descendant.\r\n   */\r\n  _findFirstForward($element, selector) {\r\n    $element = $($element).first();\r\n\r\n    // make sure iterator is correct, use boolean or selector comparison\r\n    // appropriately\r\n    let iterator;\r\n    switch (typeof selector) {\r\n      case 'string':\r\n        // make selector iterator\r\n        iterator = function($tag) {\r\n          return $tag.is(selector) || undefined;\r\n        };\r\n        break;\r\n      case 'function':\r\n        iterator = selector;\r\n        break;\r\n      case 'undefined':\r\n        // find first next element\r\n        iterator = Boolean;\r\n    }\r\n\r\n    if ($element.length === 0) {\r\n      return $element.not('*');\r\n    }\r\n\r\n    // check children by walking the tree\r\n    let $found = this._findFirstForwardDescendant($element, iterator);\r\n    if ($found.length) {\r\n      return $found;\r\n    }\r\n\r\n    // check subsequent siblings\r\n    $element.nextAll().toArray().some(sibling => {\r\n      const $sibling = $(sibling);\r\n      const value = iterator($sibling);\r\n\r\n      // skip this sibling if explicitly instructed\r\n      if (value === false) {\r\n        return;\r\n      }\r\n\r\n      if (value) {\r\n        // sibling matched\r\n        $found = $sibling;\r\n        return true;\r\n      }\r\n\r\n      // check parent sibling children by walking the tree\r\n      $found = this._findFirstForwardDescendant($sibling, iterator);\r\n      if ($found.length) return true;\r\n    });\r\n    if ($found.length) {\r\n      return $found;\r\n    }\r\n\r\n    // move through parents towards the body element\r\n    $element.add($element.parents()).toArray().reverse().some(parent => {\r\n      const $parent = $(parent);\r\n      if (iterator($parent) === false) {\r\n        // skip this parent if explicitly instructed\r\n        return false;\r\n      }\r\n\r\n      // move through parents nextAll siblings\r\n      return $parent.nextAll().toArray().some(sibling => {\r\n        const $sibling = $(sibling);\r\n        const value = iterator($sibling);\r\n\r\n        // skip this sibling if explicitly instructed\r\n        if (value === false) {\r\n          return;\r\n        }\r\n\r\n        if (value) {\r\n          // sibling matched\r\n          $found = $sibling;\r\n          return true;\r\n        }\r\n\r\n        // check parent sibling children by walking the tree\r\n        $found = this._findFirstForwardDescendant($sibling, iterator);\r\n        if ($found.length) {\r\n          return true;\r\n        }\r\n      });\r\n    });\r\n\r\n    if (!$found.length) {\r\n      return $element.not('*');\r\n    }\r\n    return $found;\r\n  }\r\n\r\n  /**\r\n   * Find descendant in a DOM tree, work from selected to branch-end, through allowed\r\n   * branch structures in hierarchy order\r\n   *\r\n   * If the selector is a function it should returns true, false or undefined.\r\n   * Returning true matches the item and returns it. Returning false means do\r\n   * not match or descend into this item, returning undefined means do not match,\r\n   * but descend into this item.\r\n   *\r\n   * @param {Object|string|Array} $element jQuery element to start from.\r\n   * @param {string|function|undefined} selector\r\n   * @returns {Object} Returns found descendant.\r\n   */\r\n  _findFirstForwardDescendant($element, selector) {\r\n    $element = $($element).first();\r\n\r\n    // make sure iterator is correct, use boolean or selector comparison\r\n    // appropriately\r\n    let iterator;\r\n    switch (typeof selector) {\r\n      case 'string':\r\n        // make selector iterator\r\n        iterator = function($tag) {\r\n          return $tag.is(selector) || undefined;\r\n        };\r\n        break;\r\n      case 'function':\r\n        iterator = selector;\r\n        break;\r\n      case 'undefined':\r\n        // find first next element\r\n        iterator = Boolean;\r\n    }\r\n\r\n    const $notFound = $element.not('*');\r\n    if ($element.length === 0) {\r\n      return $notFound;\r\n    }\r\n\r\n    // keep walked+passed children in a stack\r\n    const stack = [{\r\n      item: $element[0],\r\n      value: undefined\r\n    }];\r\n    let stackIndexPosition = 0;\r\n    let childIndexPosition = stackIndexPosition + 1;\r\n    do {\r\n\r\n      const stackEntry = stack[stackIndexPosition];\r\n      const $stackItem = $(stackEntry.item);\r\n\r\n      // check current item\r\n      switch (stackEntry.value) {\r\n        case true:\r\n          return $stackItem;\r\n        case false:\r\n          return $notFound;\r\n      }\r\n\r\n      // get i stack children\r\n      $stackItem.children().toArray().forEach(item => {\r\n        const $item = $(item);\r\n        const value = iterator($item);\r\n\r\n        // item explicitly not allowed, don't add to stack,\r\n        // skip children\r\n        if (value === false) {\r\n          return;\r\n        }\r\n\r\n        // item passed or readable, add to stack before any parent\r\n        // siblings\r\n        stack.splice(childIndexPosition++, 0, {\r\n          item: item,\r\n          value: value\r\n        });\r\n      });\r\n\r\n      // move to next stack item\r\n      stackIndexPosition++;\r\n      // keep place to inject children\r\n      childIndexPosition = stackIndexPosition + 1;\r\n    } while (stackIndexPosition < stack.length);\r\n\r\n    return $notFound;\r\n  }\r\n\r\n  /**\r\n   * Assign focus to the next readable element.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   * @param {FocusOptions} options\r\n   * @returns {Object} Chainable\r\n   */\r\n  focusNext($element, options) {\r\n    options = new FocusOptions(options);\r\n    $element = $($element).first();\r\n    $element = this.findFirstReadable($element);\r\n    this.focus($element, options);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Assign focus to either the specified element if it is readable or the\r\n   * next readable element.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   * @param {FocusOptions} options\r\n   * @returns {Object}\r\n   */\r\n  focusFirst($element, options) {\r\n    options = new FocusOptions(options);\r\n    $element = $($element).first();\r\n    if (this.isReadable($element)) {\r\n      this.focus($element, options);\r\n      return $element;\r\n    }\r\n    $element = this.findFirstReadable($element);\r\n    this.focus($element, options);\r\n    return $element;\r\n  }\r\n\r\n  /**\r\n   * Force focus to the specified element with/without a defer or scroll.\r\n   *\r\n   * @param {Object|string|Array} $element\r\n   * @param {FocusOptions} options\r\n   * @returns {Object} Chainable\r\n   */\r\n  focus($element, options) {\r\n    options = new FocusOptions(options);\r\n    $element = $($element).first();\r\n    const config = this.config;\r\n    if (!config._isEnabled || !config._options._isFocusAssignmentEnabled || $element.length === 0) {\r\n      return this;\r\n    }\r\n    function perform() {\r\n      if ($element.attr('tabindex') === undefined) {\r\n        $element.attr({\r\n          'tabindex': '-1',\r\n          'data-a11y-force-focus': 'true'\r\n        });\r\n      }\r\n      if (options.preventScroll) {\r\n        const y = $(window).scrollTop();\r\n        try {\r\n          $element[0].focus({\r\n            preventScroll: true\r\n          });\r\n        } catch (e) {\r\n          // Drop focus errors as only happens when the element\r\n          // isn't attached to the DOM.\r\n        }\r\n        switch (Adapt.device.browser) {\r\n          case 'internet explorer':\r\n          case 'microsoft edge':\r\n          case 'safari':\r\n            // return to previous scroll position due to no support for preventScroll\r\n            window.scrollTo(null, y);\r\n        }\r\n      } else {\r\n        $element[0].focus();\r\n      }\r\n    }\r\n    if (options.defer) {\r\n      _.defer(perform);\r\n    } else {\r\n      perform();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Used to convert html to text aria-labels.\r\n   *\r\n   * @param {string} htmls Any html strings.\r\n   * @returns {string} Returns text without markup or html encoded characters.\r\n   */\r\n  normalize(htmls) {\r\n    htmls = [...arguments].filter(Boolean).filter(_.isString).join(' ');\r\n    const text = $('<div>' + htmls + '</div>').text();\r\n    // Remove all html encoded characters, such as &apos;\r\n    return text.replace(this._htmlCharRegex, '');\r\n  }\r\n\r\n  /**\r\n   * Removes all html tags except stylistic elements.\r\n   * Useful for producing uninterrupted text for screen readers from\r\n   * any html.\r\n   *\r\n   * @param  {string} htmls Any html strings.\r\n   * @return {string} Returns html string without markup which would cause screen reader to pause.\r\n   */\r\n  removeBreaks(htmls) {\r\n    htmls = [...arguments].filter(Boolean).filter(_.isString).join(' ');\r\n    const $div = $('<div>' + htmls + '</div>');\r\n    const stack = [ $div[0] ];\r\n    let stackIndex = 0;\r\n    const outputs = [];\r\n    do {\r\n      if (stack[stackIndex].childNodes.length) {\r\n        const nodes = stack[stackIndex].childNodes;\r\n        const usable = nodes.filter(node => {\r\n          const isTextNode = (node.nodeType === 3);\r\n          if (isTextNode) {\r\n            return true;\r\n          }\r\n          const isStyleElement = $(node).is(this.config._options._wrapStyleElements);\r\n          if (isStyleElement) {\r\n            return true;\r\n          }\r\n          return false;\r\n        });\r\n        outputs.push.apply(outputs, usable);\r\n        stack.push.apply(stack, nodes);\r\n      }\r\n      stackIndex++;\r\n    } while (stackIndex < stack.length);\r\n    let rtnText = '';\r\n    outputs.forEach(function(item) {\r\n      rtnText += item.outerHTML || item.textContent;\r\n    });\r\n    return rtnText;\r\n  }\r\n\r\n  /**\r\n   * @param {Object|string|Array} $elements\r\n   * @returns {Object} Chainable\r\n   */\r\n  scrollEnable($elements) {\r\n    this._scroll.enable($elements);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * @param {Object|string|Array} $elements\r\n   * @returns {Object} Chainable\r\n   */\r\n  scrollDisable($elements) {\r\n    this._scroll.disable($elements);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * To apply accessibilty handling to a tag, isolating the user.\r\n   *\r\n   * @param {Object} $popupElement Element encapsulating the popup.\r\n   * @returns {Object} Chainable\r\n   */\r\n  popupOpened($popupElement) {\r\n    this._popup.opened($popupElement);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Remove the isolation applied with a call to `popupOpened`.\r\n   *\r\n   * @param {Object} [$focusElement] Element to move focus to.\r\n   * @returns {Object} Chainable\r\n   */\r\n  popupClosed($focusElement) {\r\n    this._popup.closed($focusElement);\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * When a popup is open, this function makes it possible to swap the element\r\n   * that should receive focus on popup close.\r\n   *\r\n   * @param {Object} $focusElement Set a new element to focus on.\r\n   * @returns {Object} Returns previously set focus element.\r\n   */\r\n  setPopupCloseTo($focusElement) {\r\n    return this._popup.setCloseTo($focusElement);\r\n  }\r\n\r\n}\r\n\r\nexport default (Adapt.a11y = new A11y());\r\n","import Adapt from 'core/js/adapt';\r\nimport a11y from 'core/js/a11y';\r\n\r\n/**\r\n * Backwards compatibility `Adapt.accessibility` reroutes to `Adapt.a11y`\r\n * with a warning.\r\n */\r\nObject.defineProperty(Adapt, 'accessibility', {\r\n\r\n  get() {\r\n    a11y.log.deprecated('Adapt.accessibility has moved to Adapt.a11y');\r\n    return a11y;\r\n  }\r\n\r\n});\r\n","import Adapt from 'core/js/adapt';\r\n\r\nexport default class AdaptCollection extends Backbone.Collection {\r\n\r\n  initialize(models, options) {\r\n    this.once('reset', this.loadedData, this);\r\n  }\r\n\r\n  loadedData() {\r\n    Adapt.trigger('adaptCollection:dataLoaded');\r\n  }\r\n\r\n}\r\n","// Used to determine if log call should be printed based on log level\r\nconst LOG_LEVEL = ENUM([\r\n  'DEBUG',\r\n  'INFO',\r\n  'WARN',\r\n  'ERROR',\r\n  'FATAL'\r\n]);\r\n\r\nexport default LOG_LEVEL;\r\n","import Adapt from 'core/js/adapt';\r\nimport LOG_LEVEL from 'core/js/enums/logLevelEnum';\r\n\r\nclass Logging extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this._config = {\r\n      _isEnabled: true,\r\n      _level: LOG_LEVEL.INFO.asLowerCase, // Default log level\r\n      _console: true, // Log to console\r\n      _warnFirstOnly: true // Show only first of identical removed and deprecated warnings\r\n    };\r\n    this._warned = {};\r\n    this.listenToOnce(Adapt, 'configModel:dataLoaded', this.onLoadConfigData);\r\n  }\r\n\r\n  onLoadConfigData() {\r\n\r\n    this.loadConfig();\r\n\r\n    this.debug('Logging config loaded');\r\n\r\n    this.trigger('log:ready');\r\n\r\n  }\r\n\r\n  loadConfig() {\r\n\r\n    if (Adapt.config.has('_logging')) {\r\n      this._config = Adapt.config.get('_logging');\r\n    }\r\n\r\n    this.checkQueryStringOverride();\r\n\r\n  }\r\n\r\n  checkQueryStringOverride() {\r\n\r\n    // Override default log level with level present in query string\r\n    const matches = window.location.search.match(/[?&]loglevel=([a-z]*)/i);\r\n    if (!matches || matches.length < 2) return;\r\n\r\n    const override = LOG_LEVEL(matches[1].toUpperCase());\r\n    if (!override) return;\r\n\r\n    this._config._level = override.asLowerCase;\r\n    this.debug('Loglevel override in query string:', this._config._level);\r\n\r\n  }\r\n\r\n  debug(...args) {\r\n    this._log(LOG_LEVEL.DEBUG, args);\r\n  }\r\n\r\n  info(...args) {\r\n    this._log(LOG_LEVEL.INFO, args);\r\n  }\r\n\r\n  warn(...args) {\r\n    this._log(LOG_LEVEL.WARN, args);\r\n  }\r\n\r\n  error(...args) {\r\n    this._log(LOG_LEVEL.ERROR, args);\r\n  }\r\n\r\n  fatal(...args) {\r\n    this._log(LOG_LEVEL.FATAL, args);\r\n  }\r\n\r\n  removed(...args) {\r\n    args = ['REMOVED'].concat(args);\r\n    this.warnOnce(...args);\r\n  }\r\n\r\n  deprecated(...args) {\r\n    args = ['DEPRECATED'].concat(args);\r\n    this.warnOnce(...args);\r\n  }\r\n\r\n  warnOnce(...args) {\r\n    if (this._hasWarned(args)) {\r\n      return;\r\n    }\r\n    this._log(LOG_LEVEL.WARN, args);\r\n  }\r\n\r\n  _log(level, data) {\r\n\r\n    const isEnabled = (this._config._isEnabled);\r\n    if (!isEnabled) return;\r\n\r\n    const configLevel = LOG_LEVEL(this._config._level.toUpperCase());\r\n\r\n    const isLogLevelAllowed = (level >= configLevel);\r\n    if (!isLogLevelAllowed) return;\r\n\r\n    this._logToConsole(level, data);\r\n\r\n    // Allow error reporting plugins to hook and report to logging systems\r\n    this.trigger('log', level, data);\r\n    this.trigger('log:' + level.asLowerCase, level, data);\r\n\r\n  }\r\n\r\n  _logToConsole(level, data) {\r\n\r\n    const shouldLogToConsole = (this._config._console);\r\n    if (!shouldLogToConsole) return;\r\n\r\n    const log = [level.asUpperCase + ':'];\r\n    data && log.push(...data);\r\n\r\n    // is there a matching console method we can use e.g. console.error()?\r\n    if (console[level.asLowerCase]) {\r\n      console[level.asLowerCase](...log);\r\n    } else {\r\n      console.log(...log);\r\n    }\r\n  }\r\n\r\n  _hasWarned(args) {\r\n    if (!this._config._warnFirstOnly) {\r\n      return false;\r\n    }\r\n    const hash = args.map(String).join(':');\r\n    if (this._warned[hash]) {\r\n      return true;\r\n    }\r\n    this._warned[hash] = true;\r\n    return false;\r\n  }\r\n\r\n}\r\n\r\nexport default (Adapt.log = new Logging());\r\n","import Adapt from 'core/js/adapt';\r\nimport LockingModel from 'core/js/models/lockingModel';\r\nimport 'core/js/logging';\r\nimport semver from 'semver';\r\n\r\nexport default class BuildModel extends LockingModel {\r\n\r\n  defaults() {\r\n    return {\r\n      jsonext: 'json'\r\n    };\r\n  }\r\n\r\n  initialize(attrs, options) {\r\n    this.url = options.url;\r\n    // Fetch data & if successful trigger event to enable plugins to stop course files loading\r\n    // Then check if course files can load\r\n    // 'configModel:loadCourseData' event starts the core content collections and models being fetched\r\n    this.fetch({\r\n      success: () => {\r\n        this.isLoaded = true;\r\n        Adapt.trigger('buildModel:dataLoaded');\r\n      },\r\n      error: () => {\r\n        console.log('Unable to load adapt/js/build.js');\r\n        Adapt.trigger('buildModel:dataLoaded');\r\n      }\r\n    });\r\n  }\r\n\r\n  isFrameworkVersion(version) {\r\n    return semver.satisfies(this.get('package').version, version, { includePrerelease: true });\r\n  }\r\n\r\n  isPluginInstalled(name, version = '*') {\r\n    const plugin = this.get('plugins').find(plugin => {\r\n      if (plugin.name !== name) return false;\r\n      return semver.satisfies(plugin.version, version, { includePrerelease: true });\r\n    });\r\n    return Boolean(plugin);\r\n  }\r\n\r\n  whenReady() {\r\n    if (this.isLoaded) return Promise.resolve();\r\n    return new Promise(resolve => {\r\n      Adapt.once('buildModel:dataLoaded', resolve);\r\n    });\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport LockingModel from 'core/js/models/lockingModel';\r\n\r\nexport default class ConfigModel extends LockingModel {\r\n\r\n  defaults() {\r\n    return {\r\n      screenSize: {\r\n        large: 900,\r\n        medium: 760,\r\n        small: 520\r\n      },\r\n      _forceRouteLocking: false,\r\n      _canLoadData: true,\r\n      _disableAnimation: false\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Parse the incoming search queries for certain parameter values to use as defaults\r\n   */\r\n  setValuesFromURLParams() {\r\n    const paramMappings = {\r\n      dir: '_defaultDirection',\r\n      lang: '_defaultLanguage'\r\n    };\r\n\r\n    const params = new URLSearchParams(window.location.search);\r\n\r\n    Object.entries(paramMappings).forEach(([key, value]) => {\r\n      const passedVal = params.get(key);\r\n      if (!passedVal) return;\r\n      this.set(value, passedVal);\r\n    });\r\n  }\r\n\r\n  initialize(attrs, options) {\r\n    this.url = options.url;\r\n    // Fetch data & if successful trigger event to enable plugins to stop course files loading\r\n    // Then check if course files can load\r\n    // 'configModel:loadCourseData' event starts the core content collections and models being fetched\r\n    this.fetch({\r\n      success: () => {\r\n        this.setValuesFromURLParams();\r\n\r\n        Adapt.trigger('offlineStorage:prepare');\r\n        Adapt.wait.queue(() => {\r\n          Adapt.trigger('configModel:dataLoaded');\r\n          if (!this.get('_canLoadData')) return;\r\n          Adapt.trigger('configModel:loadCourseData');\r\n        });\r\n      },\r\n      error: () => console.log('Unable to load course/config.json')\r\n    });\r\n  }\r\n\r\n  loadData() {}\r\n\r\n}\r\n","export default class ModelEvent extends Backbone.Controller {\r\n\r\n  /**\r\n   * @param {string} type Event name / type\r\n   * @param {Backbone.Model} target Origin model\r\n   * @param {*} [value] Any value that should be carried through on the event\r\n   */\r\n  initialize(type, target, value) {\r\n    this.type = type;\r\n    this.target = target;\r\n    this.value = value;\r\n    this.canBubble = true;\r\n    this.deepPath = [target];\r\n    this.timeStamp = null;\r\n  }\r\n\r\n  stopPropagation() {\r\n    this.canBubble = false;\r\n  }\r\n\r\n  addPath(target) {\r\n    this.deepPath.unshift(target);\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport ModelEvent from 'core/js/modelEvent';\r\nimport LockingModel from 'core/js/models/lockingModel';\r\nimport 'core/js/logging';\r\n\r\nexport default class AdaptModel extends LockingModel {\r\n\r\n  toJSON() {\r\n    // Perform shallow clone\r\n    const json = { ...this.attributes };\r\n    // Remove deprecated values as they are not true json\r\n    delete json._children;\r\n    delete json._parent;\r\n    // Perform deep clone\r\n    return $.extend(true, {}, json);\r\n  }\r\n\r\n  get(name) {\r\n    switch (name) {\r\n      case '_parent':\r\n      case '_children':\r\n        Adapt.log.deprecated(`Use model.getChildren() or model.getParent() instead of model.get('_children') or model.get('_parent')`);\r\n    }\r\n    return super.get(name);\r\n  }\r\n\r\n  defaults() {\r\n    return {\r\n      _canShowFeedback: true,\r\n      _classes: '',\r\n      _canReset: false,\r\n      _canRequestChild: false,\r\n      _isComplete: false,\r\n      _isInteractionComplete: false,\r\n      _isA11yRegionEnabled: false,\r\n      _isA11yCompletionDescriptionEnabled: true,\r\n      _requireCompletionOf: -1,\r\n      _isEnabled: true,\r\n      _isResetOnRevisit: false,\r\n      _isAvailable: true,\r\n      _isOptional: false,\r\n      _isRendered: false,\r\n      _isReady: false,\r\n      _isVisible: true,\r\n      _isLocked: false,\r\n      _isHidden: false\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Fetch an array representing the relative location of the model to the nearest _trackingId\r\n   * @returns {Array<Number, Number>}\r\n   */\r\n  get trackingPosition() {\r\n    const firstDescendant = this.getAllDescendantModels(false).concat([this])[0];\r\n    const nearestTrackingIdModel = [firstDescendant].concat(firstDescendant.getAncestorModels()).find(model => model.has('_trackingId'));\r\n    if (!nearestTrackingIdModel) return;\r\n    const trackingId = nearestTrackingIdModel.get('_trackingId');\r\n    const trackingIdDescendants = [nearestTrackingIdModel].concat(nearestTrackingIdModel.getAllDescendantModels(true));\r\n    const indexInTrackingIdDescendants = trackingIdDescendants.findIndex(descendant => descendant === this);\r\n    if (indexInTrackingIdDescendants >= 0) {\r\n      // Is either the nearestTrackingIdModel (0) or one of its flattened descendants (>0)\r\n      return [ trackingId, indexInTrackingIdDescendants ];\r\n    }\r\n    // Is an ancestor of the nearestTrackingIdModel\r\n    const trackingIdAncestors = nearestTrackingIdModel.getAncestorModels();\r\n    const ancestorDistance = trackingIdAncestors.findIndex(ancestor => ancestor === this);\r\n    return [ trackingId, -(ancestorDistance + 1) ];\r\n  }\r\n\r\n  /**\r\n   * The AAT always sets the value of `_isResetOnRevisit` to a String\r\n   * which is fine for the 'soft' and 'hard' values - but 'false' needs\r\n   * converting to Boolean - see #2825\r\n   */\r\n  parse(data) {\r\n    if (data._isResetOnRevisit === 'false') {\r\n      data._isResetOnRevisit = false;\r\n    }\r\n    return data;\r\n  }\r\n\r\n  trackable() {\r\n    return [\r\n      '_id',\r\n      '_isComplete',\r\n      '_isInteractionComplete'\r\n    ];\r\n  }\r\n\r\n  trackableType() {\r\n    return [\r\n      String,\r\n      Boolean,\r\n      Boolean\r\n    ];\r\n  }\r\n\r\n  bubblingEvents() {\r\n    return [\r\n      'change:_isComplete',\r\n      'change:_isInteractionComplete',\r\n      'change:_isActive'\r\n    ];\r\n  }\r\n\r\n  setupModel() {\r\n    if (this.hasManagedChildren) {\r\n      this.setupChildListeners();\r\n    }\r\n\r\n    this.init();\r\n\r\n    _.defer(() => {\r\n      if (this.hasManagedChildren) {\r\n        this.checkCompletionStatus();\r\n\r\n        this.checkInteractionCompletionStatus();\r\n\r\n        this.checkLocking();\r\n      }\r\n\r\n      this.setupTrackables();\r\n\r\n    });\r\n\r\n  }\r\n\r\n  setupTrackables() {\r\n\r\n    // Limit state trigger calls and make state change callbacks batched-asynchronous\r\n    const originalTrackableStateFunction = this.triggerTrackableState;\r\n    this.triggerTrackableState = _.compose(\r\n      () => {\r\n\r\n        // Flag that the function is awaiting trigger\r\n        this.triggerTrackableState.isQueued = true;\r\n\r\n      },\r\n      _.debounce(() => {\r\n\r\n        // Trigger original function\r\n        originalTrackableStateFunction.apply(this);\r\n\r\n        // Unset waiting flag\r\n        this.triggerTrackableState.isQueued = false;\r\n\r\n      }, 17)\r\n    );\r\n\r\n    // Listen to model changes, trigger trackable state change when appropriate\r\n    this.listenTo(this, 'change', ({ changed }) => {\r\n\r\n      // Skip if trigger queued or adapt hasn't started yet\r\n      if (this.triggerTrackableState.isQueued || !Adapt.attributes._isStarted) {\r\n        return;\r\n      }\r\n\r\n      // Check that property is trackable\r\n      const trackablePropertyNames = _.result(this, 'trackable', []);\r\n      const changedPropertyNames = Object.keys(changed);\r\n      const isTrackable = changedPropertyNames.find(item => {\r\n        return trackablePropertyNames.includes(item);\r\n      });\r\n\r\n      if (isTrackable) {\r\n        // Trigger trackable state change\r\n        this.triggerTrackableState();\r\n      }\r\n    });\r\n  }\r\n\r\n  setupChildListeners() {\r\n    const children = this.getChildren();\r\n    if (!children.length) {\r\n      return;\r\n    }\r\n\r\n    this.listenTo(children, {\r\n      'all': this.onAll,\r\n      'bubble': this.bubble,\r\n      'change:_isReady': this.checkReadyStatus,\r\n      'change:_isComplete': this.onIsComplete,\r\n      'change:_isInteractionComplete': this.checkInteractionCompletionStatus\r\n    });\r\n  }\r\n\r\n  init() {}\r\n\r\n  getTrackableState() {\r\n\r\n    const trackable = this.resultExtend('trackable', []);\r\n    const json = this.toJSON();\r\n\r\n    const args = trackable;\r\n    args.unshift(json);\r\n\r\n    return _.pick(...args);\r\n\r\n  }\r\n\r\n  setTrackableState(state) {\r\n\r\n    const trackable = this.resultExtend('trackable', []);\r\n\r\n    const args = trackable;\r\n    args.unshift(state);\r\n\r\n    state = _.pick(...args);\r\n\r\n    this.set(state);\r\n\r\n    return this;\r\n\r\n  }\r\n\r\n  triggerTrackableState() {\r\n\r\n    Adapt.trigger('state:change', this, this.getTrackableState());\r\n\r\n  }\r\n\r\n  reset(type, force) {\r\n    if (!this.get('_canReset') && !force) return;\r\n\r\n    type = type || true;\r\n\r\n    switch (type) {\r\n      case 'hard': case true:\r\n        this.set({\r\n          _isEnabled: true,\r\n          _isComplete: false,\r\n          _isInteractionComplete: false\r\n        });\r\n        break;\r\n      case 'soft':\r\n        this.set({\r\n          _isEnabled: true,\r\n          _isInteractionComplete: false\r\n        });\r\n        break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Checks if any child models which have been _isRendered are not _isReady.\r\n   * If all rendered child models are marked ready then this model will be\r\n   * marked _isReady: true as well.\r\n   * @param {AdaptModel} [model]\r\n   * @param {boolean} [value]\r\n   * @returns {boolean}\r\n   */\r\n  checkReadyStatus(model, value) {\r\n    if (value === false) {\r\n      // Do not respond to _isReady: false as _isReady is unset throughout\r\n      // the rendering process\r\n      return false;\r\n    }\r\n    // Filter children based upon whether they are available\r\n    // Check if any _isRendered: true children return _isReady: false\r\n    // If not - set this model to _isReady: true\r\n    const children = this.getAvailableChildModels();\r\n    if (children.find(child => child.get('_isReady') === false && child.get('_isRendered'))) {\r\n      return false;\r\n    }\r\n\r\n    this.set('_isReady', true);\r\n    return true;\r\n  }\r\n\r\n  setCompletionStatus() {\r\n    if (!this.get('_isVisible')) return;\r\n\r\n    this.set({\r\n      _isComplete: true,\r\n      _isInteractionComplete: true\r\n    });\r\n  }\r\n\r\n  checkCompletionStatus() {\r\n    // defer to allow other change:_isComplete handlers to fire before cascading to parent\r\n    Adapt.checkingCompletion();\r\n    _.defer(this.checkCompletionStatusFor.bind(this), '_isComplete');\r\n  }\r\n\r\n  checkInteractionCompletionStatus() {\r\n    // defer to allow other change:_isInteractionComplete handlers to fire before cascading to parent\r\n    Adapt.checkingCompletion();\r\n    _.defer(this.checkCompletionStatusFor.bind(this), '_isInteractionComplete');\r\n  }\r\n\r\n  /**\r\n   * Function for checking whether the supplied completion attribute should be set to true or false.\r\n   * It iterates over our immediate children, checking the same completion attribute on any mandatory child\r\n   * to see if enough/all of them them have been completed. If enough/all have, we set our attribute to true;\r\n   * if not, we set it to false.\r\n   * @param {string} [completionAttribute] Either '_isComplete' or '_isInteractionComplete'. Defaults to '_isComplete' if not supplied.\r\n   */\r\n\r\n  checkCompletionStatusFor(completionAttribute = '_isComplete') {\r\n    let completed = false;\r\n    const children = this.getAvailableChildModels();\r\n    const requireCompletionOf = this.get('_requireCompletionOf');\r\n\r\n    if (requireCompletionOf === -1) { // a value of -1 indicates that ALL mandatory children must be completed\r\n      completed = children.every(child => {\r\n        return child.get(completionAttribute) || child.get('_isOptional');\r\n      });\r\n    } else {\r\n      completed = (children.filter(child => {\r\n        return child.get(completionAttribute) && !child.get('_isOptional');\r\n      }).length >= requireCompletionOf);\r\n    }\r\n\r\n    this.set(completionAttribute, completed);\r\n\r\n    Adapt.checkedCompletion();\r\n  }\r\n\r\n  /**\r\n   * Returns a string describing the type group of this model.\r\n   * Strings should be lowercase and not plurlaized.\r\n   * i.e. 'page', 'menu', 'contentobject', 'component', 'article', 'block'\r\n   * Override in inheritance chain.\r\n   * @returns {string}\r\n   */\r\n  getTypeGroup() {}\r\n\r\n  /**\r\n   * Returns true if this model is of the type group described.\r\n   * Automatically manages pluralization typeGroup and matches lowercase only.\r\n   * Pluralized typeGroups and uppercase characters in typeGroups are discouraged.\r\n   * @param {string} type Type group name i.e. course, contentobject, article, block, component\r\n   * @returns {boolean}\r\n   */\r\n  isTypeGroup(typeGroup) {\r\n    const hasUpperCase = /[A-Z]+/.test(typeGroup);\r\n    const isPluralized = typeGroup.slice(-1) === 's';\r\n    const lowerCased = typeGroup.toLowerCase();\r\n    const singular = isPluralized && lowerCased.slice(0, -1); // remove pluralization if ending in s\r\n    const singularLowerCased = (singular || lowerCased).toLowerCase();\r\n    if (isPluralized || hasUpperCase) {\r\n      Adapt.log.deprecated(`'${typeGroup}' appears pluralized or contains uppercase characters, suggest using the singular, lowercase type group '${singularLowerCased}'.`);\r\n    }\r\n    const pluralizedLowerCaseTypes = [\r\n      singularLowerCased,\r\n      !isPluralized && `${lowerCased}s` // pluralize if not ending in s\r\n    ].filter(Boolean);\r\n    const typeGroups = this.getTypeGroups();\r\n    if (_.intersection(pluralizedLowerCaseTypes, typeGroups).length) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Returns an array of strings describing the model type groups.\r\n   * All strings are lowercase and should not be pluralized.\r\n   * i.e. ['course', 'menu', 'contentobject'], ['page', 'contentobject'], ['component']\r\n   * @returns {[string]}\r\n   */\r\n  getTypeGroups() {\r\n    if (this._typeGroups) return this._typeGroups;\r\n    const typeGroups = [ this.get('_type') ];\r\n    let parentClass = this;\r\n    while ((parentClass = Object.getPrototypeOf(parentClass))) {\r\n      if (!parentClass.hasOwnProperty('getTypeGroup')) continue;\r\n      typeGroups.push(parentClass.getTypeGroup.call(this));\r\n    }\r\n    return (this._typeGroups = _.uniq(typeGroups.filter(Boolean).map(s => s.toLowerCase())));\r\n  }\r\n\r\n  /**\r\n   * Searches the model's ancestors to find the first instance of the specified ancestor type\r\n   * @param {string} [ancestorType] Valid values are 'course', 'pages', 'contentObjects', 'articles' or 'blocks'.\r\n   * If left blank, the immediate ancestor (if there is one) is returned\r\n   * @return {object} Reference to the model of the first ancestor of the specified type that's found - or `undefined` if none found\r\n   */\r\n  findAncestor(ancestorType) {\r\n    const parent = this.getParent();\r\n    if (!parent) return;\r\n    if (!ancestorType || parent.isTypeGroup(ancestorType)) {\r\n      return parent;\r\n    }\r\n    return parent.findAncestor(ancestorType);\r\n  }\r\n\r\n  /**\r\n   * Returns all the descendant models of a specific type\r\n   * @param {string} descendants Valid values are 'contentobject', 'page', 'menu', 'article', 'block', 'component', 'question'\r\n   * @param {object} options an object that defines the search type and the properties/values to search on. Currently only the `where` search type (equivalent to `Backbone.Collection.where()`) is supported.\r\n   * @param {object} options.where\r\n   * @return {array}\r\n   * @example\r\n   * //find all available, non-optional components\r\n   * this.findDescendantModels('component', { where: { _isAvailable: true, _isOptional: false }});\r\n   */\r\n  findDescendantModels(descendants, options) {\r\n    const allDescendantsModels = this.getAllDescendantModels();\r\n    const returnedDescendants = allDescendantsModels.filter(model => {\r\n      return model.isTypeGroup(descendants);\r\n    });\r\n\r\n    if (!options) {\r\n      return returnedDescendants;\r\n    }\r\n\r\n    if (options.where) {\r\n      return returnedDescendants.filter(descendant => {\r\n        for (let property in options.where) {\r\n          const value = options.where[property];\r\n          if (descendant.get(property) !== value) {\r\n            return false;\r\n          }\r\n        }\r\n        return true;\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Fetches the sub structure of a model as a flattened array\r\n   *\r\n   * Such that the tree:\r\n   *  { a1: { b1: [ c1, c2 ], b2: [ c3, c4 ] }, a2: { b3: [ c5, c6 ] } }\r\n   *\r\n   * will become the array (parent first = false):\r\n   *  [ c1, c2, b1, c3, c4, b2, a1, c5, c6, b3, a2 ]\r\n   *\r\n   * or (parent first = true):\r\n   *  [ a1, b1, c1, c2, b2, c3, c4, a2, b3, c5, c6 ]\r\n   *\r\n   * This is useful when sequential operations are performed on the menu/page/article/block/component hierarchy.\r\n   * @param {boolean} [isParentFirst]\r\n   * @return {array}\r\n   */\r\n  getAllDescendantModels(isParentFirst) {\r\n\r\n    const descendants = [];\r\n\r\n    if (!this.hasManagedChildren) {\r\n      return descendants;\r\n    }\r\n\r\n    const children = this.getChildren();\r\n\r\n    children.models.forEach(child => {\r\n\r\n      if (!child.hasManagedChildren) {\r\n        descendants.push(child);\r\n        return;\r\n      }\r\n\r\n      const subDescendants = child.getAllDescendantModels(isParentFirst);\r\n      if (isParentFirst === true) {\r\n        descendants.push(child);\r\n      }\r\n\r\n      descendants.push(...subDescendants);\r\n\r\n      if (isParentFirst !== true) {\r\n        descendants.push(child);\r\n      }\r\n    });\r\n\r\n    return descendants;\r\n\r\n  }\r\n\r\n  /**\r\n   * Returns a relative model from the Adapt hierarchy\r\n   *\r\n   * Such that in the tree:\r\n   *  { a1: { b1: [ c1, c2 ], b2: [ c3, c4 ] }, a2: { b3: [ c5, c6 ] } }\r\n   *\r\n   *  c1.findRelativeModel('@block +1') = b2;\r\n   *  c1.findRelativeModel('@component +4') = c5;\r\n   *\r\n   * @see Adapt.parseRelativeString for a description of relativeStrings\r\n   * @param {string} relativeString\r\n   * @param {object} options Search configuration settings\r\n   * @param {boolean} options.limitParentId\r\n   * @param {function} options.filter\r\n   * @param {boolean} options.loop\r\n   * @return {array}\r\n   */\r\n  findRelativeModel(relativeString, options = {}) {\r\n    // return a model relative to the specified one if opinionated\r\n    const rootModel = options.limitParentId ?\r\n      Adapt.findById(options.limitParentId) :\r\n      Adapt.course;\r\n\r\n    const relativeDescriptor = Adapt.parseRelativeString(relativeString);\r\n    const searchBackwards = (relativeDescriptor.offset < 0);\r\n    let moveBy = Math.abs(relativeDescriptor.offset);\r\n    let movementCount = 0;\r\n\r\n    const hasDescendantsOfType = Boolean(this.findDescendantModels(relativeDescriptor.type).length);\r\n    if (hasDescendantsOfType) {\r\n      // move by one less as first found is considered next\r\n      // will find descendants on either side but not inside\r\n      moveBy--;\r\n    }\r\n\r\n    let pageDescendants;\r\n    if (searchBackwards) {\r\n      // parents first [p1,a1,b1,c1,c2,a2,b2,c3,c4,p2,a3,b3,c6,c7,a4,b4,c8,c9]\r\n      pageDescendants = [rootModel];\r\n      pageDescendants.push(...rootModel.getAllDescendantModels(true));\r\n\r\n      // reverse so that we don't need a forward and a backward iterating loop\r\n      // reversed [c9,c8,b4,a4,c7,c6,b3,a3,p2,c4,c3,b2,a2,c2,c1,b1,a1,p1]\r\n      pageDescendants.reverse();\r\n    } else {\r\n      // children first [c1,c2,b1,a1,c3,c4,b2,a2,p1,c6,c7,b3,a3,c8,c9,b4,a4,p2]\r\n      pageDescendants = rootModel.getAllDescendantModels(false);\r\n      pageDescendants.push(rootModel);\r\n    }\r\n\r\n    // find current index in array\r\n    const modelId = this.get('_id');\r\n    const modelIndex = pageDescendants.findIndex(pageDescendant => {\r\n      if (pageDescendant.get('_id') === modelId) {\r\n        return true;\r\n      }\r\n      return false;\r\n    });\r\n    const isFilterFunction = (typeof options.filter === 'function');\r\n\r\n    if (options.loop) {\r\n      // normalize offset position to allow for overflow looping\r\n      const totalOfType = pageDescendants.reduce((count, model) => {\r\n        if (!model.isTypeGroup(relativeDescriptor.type)) return count;\r\n        return ++count;\r\n      }, 0);\r\n      // take the remainder after removing whole units of the type count\r\n      moveBy = moveBy % totalOfType;\r\n      // double up entries to allow for overflow looping\r\n      pageDescendants = pageDescendants.concat(pageDescendants.slice(0));\r\n    }\r\n\r\n    for (let i = modelIndex, l = pageDescendants.length; i < l; i++) {\r\n      const descendant = pageDescendants[i];\r\n      if (!descendant.isTypeGroup(relativeDescriptor.type)) continue;\r\n      const isSelf = (i === modelIndex);\r\n      // https://github.com/adaptlearning/adapt_framework/issues/3031\r\n      if (!isSelf && isFilterFunction && !options.filter(descendant)) continue;\r\n      if (movementCount > moveBy) {\r\n        // there is no descendant which matches this relativeString\r\n        // probably looking for the descendant 0 in a parent\r\n        break;\r\n      }\r\n      if (movementCount === moveBy) {\r\n        return Adapt.findById(descendant.get('_id'));\r\n      }\r\n      movementCount++;\r\n    }\r\n\r\n  }\r\n\r\n  get hasManagedChildren() {\r\n    return true;\r\n  }\r\n\r\n  getChildren() {\r\n    if (this._childrenCollection) {\r\n      return this._childrenCollection;\r\n    }\r\n\r\n    let childrenCollection;\r\n\r\n    if (!this.hasManagedChildren) {\r\n      childrenCollection = new Backbone.Collection();\r\n    } else {\r\n      const id = this.get('_id');\r\n      // Look up child by _parentId from Adapt.data\r\n      const children = Adapt.data.filter(model => model.get('_parentId') === id);\r\n      childrenCollection = new Backbone.Collection(children);\r\n    }\r\n\r\n    if (this.get('_type') === 'block' &&\r\n      childrenCollection.length === 2 &&\r\n      childrenCollection.models[0].get('_layout') !== 'left') {\r\n      // Components may have a 'left' or 'right' _layout,\r\n      // so ensure they appear in the correct order\r\n      // Re-order component models to correct it\r\n      childrenCollection.comparator = '_layout';\r\n      childrenCollection.sort();\r\n    }\r\n\r\n    this.setChildren(childrenCollection);\r\n    return this._childrenCollection;\r\n  }\r\n\r\n  setChildren(children) {\r\n    this._childrenCollection = children;\r\n    // Setup deprecated reference\r\n    this.set('_children', children);\r\n  }\r\n\r\n  getAvailableChildModels() {\r\n    return this.getChildren().where({\r\n      _isAvailable: true\r\n    });\r\n  }\r\n\r\n  getParent() {\r\n    if (this._parentModel) {\r\n      return this._parentModel;\r\n    }\r\n    const parentId = this.get('_parentId');\r\n    if (!parentId) return;\r\n    // Look up parent by id from Adapt.data\r\n    this.setParent(Adapt.findById(parentId));\r\n    return this._parentModel;\r\n  }\r\n\r\n  setParent(parent) {\r\n    this._parentModel = parent;\r\n    this.set('_parentId', this._parentModel.get('_id'));\r\n    // Set up deprecated reference\r\n    this.set('_parent', this._parentModel);\r\n  }\r\n\r\n  getAncestorModels(shouldIncludeChild) {\r\n    const parents = [];\r\n    let context = this;\r\n\r\n    if (shouldIncludeChild) parents.push(context);\r\n\r\n    while (context.has('_parentId')) {\r\n      context = context.getParent();\r\n      parents.push(context);\r\n    }\r\n\r\n    return parents.length ? parents : null;\r\n  }\r\n\r\n  getSiblings(passSiblingsAndIncludeSelf) {\r\n    const id = this.get('_id');\r\n    const parentId = this.get('_parentId');\r\n    let siblings;\r\n    if (!passSiblingsAndIncludeSelf) {\r\n      // returns a collection of siblings excluding self\r\n      if (this._hasSiblingsAndSelf === false) {\r\n        return this.get('_siblings');\r\n      }\r\n      siblings = Adapt.data.filter(model => {\r\n        return model.get('_parentId') === parentId &&\r\n          model.get('_id') !== id;\r\n      });\r\n\r\n      this._hasSiblingsAndSelf = false;\r\n\r\n    } else {\r\n      // returns a collection of siblings including self\r\n      if (this._hasSiblingsAndSelf) {\r\n        return this.get('_siblings');\r\n      }\r\n\r\n      siblings = Adapt.data.filter(model => {\r\n        return model.get('_parentId') === parentId;\r\n      });\r\n      this._hasSiblingsAndSelf = true;\r\n    }\r\n\r\n    const siblingsCollection = new Backbone.Collection(siblings);\r\n    this.set('_siblings', siblingsCollection);\r\n    return siblingsCollection;\r\n  }\r\n\r\n  /**\r\n   * @param  {string} key\r\n   * @param  {any} value\r\n   * @param  {Object} options\r\n   */\r\n  setOnChildren(...args) {\r\n\r\n    this.set(...args);\r\n\r\n    if (!this.hasManagedChildren) return;\r\n\r\n    const children = this.getChildren();\r\n    children.models.forEach(child => child.setOnChildren(...args));\r\n\r\n  }\r\n\r\n  /**\r\n   * @deprecated since v3.2.3 - please use `model.set('_isOptional', value)` instead\r\n   */\r\n  setOptional(value) {\r\n    Adapt.log.deprecated(`Use model.set('_isOptional', value) as setOptional() may be removed in the future`);\r\n    this.set({ _isOptional: value });\r\n  }\r\n\r\n  checkLocking() {\r\n    const lockType = this.get('_lockType');\r\n\r\n    if (!lockType) return;\r\n\r\n    switch (lockType) {\r\n      case 'sequential':\r\n        this.setSequentialLocking();\r\n        break;\r\n      case 'unlockFirst':\r\n        this.setUnlockFirstLocking();\r\n        break;\r\n      case 'lockLast':\r\n        this.setLockLastLocking();\r\n        break;\r\n      case 'custom':\r\n        this.setCustomLocking();\r\n        break;\r\n      default:\r\n        console.warn(`AdaptModel.checkLocking: unknown _lockType '${lockType}' found on ${this.get('_id')}`);\r\n    }\r\n  }\r\n\r\n  setSequentialLocking() {\r\n    const children = this.getAvailableChildModels();\r\n\r\n    for (let i = 1, j = children.length; i < j; i++) {\r\n      children[i].set('_isLocked', !children[i - 1].get('_isComplete'));\r\n    }\r\n  }\r\n\r\n  setUnlockFirstLocking() {\r\n    const children = this.getAvailableChildModels();\r\n    const isFirstChildComplete = children[0].get('_isComplete');\r\n\r\n    for (let i = 1, j = children.length; i < j; i++) {\r\n      children[i].set('_isLocked', !isFirstChildComplete);\r\n    }\r\n  }\r\n\r\n  setLockLastLocking() {\r\n    const children = this.getAvailableChildModels();\r\n    const lastIndex = children.length - 1;\r\n\r\n    for (let i = lastIndex - 1; i >= 0; i--) {\r\n      if (!children[i].get('_isComplete')) {\r\n        return children[lastIndex].set('_isLocked', true);\r\n      }\r\n    }\r\n\r\n    children[lastIndex].set('_isLocked', false);\r\n  }\r\n\r\n  setCustomLocking() {\r\n    const children = this.getAvailableChildModels();\r\n    children.forEach(child => {\r\n      child.set('_isLocked', this.shouldLock(child));\r\n    });\r\n  }\r\n\r\n  shouldLock(child) {\r\n    const lockedBy = child.get('_lockedBy');\r\n\r\n    if (!lockedBy) return false;\r\n\r\n    for (let i = lockedBy.length - 1; i >= 0; i--) {\r\n      const id = lockedBy[i];\r\n\r\n      try {\r\n        const model = Adapt.findById(id);\r\n\r\n        if (!model.get('_isAvailable')) continue;\r\n        if (!model.get('_isComplete')) return true;\r\n      } catch (e) {\r\n        console.warn(`AdaptModel.shouldLock: unknown _lockedBy ID '${id}' found on ${child.get('_id')}`);\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  onIsComplete() {\r\n    this.checkCompletionStatus();\r\n\r\n    this.checkLocking();\r\n  }\r\n\r\n  /**\r\n   * Used before a model is rendered to determine if it should be reset to its\r\n   * default values.\r\n   */\r\n  checkIfResetOnRevisit() {\r\n    const isResetOnRevisit = this.get('_isResetOnRevisit');\r\n    if (!isResetOnRevisit) {\r\n      return;\r\n    }\r\n    // If reset is enabled set defaults\r\n    this.reset(isResetOnRevisit);\r\n  }\r\n\r\n  /**\r\n   * Clones this model and all managed children returning a new branch.\r\n   * Assign new unique ids to each cloned model.\r\n   * @param {Function} [modifier] A callback function for each child to allow for custom modifications\r\n   * @returns {AdaptModel}\r\n   */\r\n  deepClone(modifier = null) {\r\n    // Fetch the class\r\n    const ModelClass = this.constructor;\r\n    // Clone the model\r\n    const clonedModel = new ModelClass(this.toJSON());\r\n    // Run the custom modifier on the clone\r\n    if (modifier) {\r\n      modifier(clonedModel, this);\r\n    }\r\n    let clonedId = clonedModel.get('_id');\r\n    const hasId = Boolean(clonedId);\r\n    const shouldAssignUniqueId = (this.get('_id') === clonedId);\r\n    if (hasId && shouldAssignUniqueId) {\r\n      // Create a unique id if none was set by the modifier\r\n      const cid = _.uniqueId(ModelClass.prototype.cidPrefix || 'c');\r\n      clonedId = `${clonedId}_${cid}`;\r\n      clonedModel.set('_id', clonedId);\r\n    }\r\n    // Add the cloned model to Adapt.data for Adapt.findById resolution\r\n    if (hasId) {\r\n      Adapt.data.add(clonedModel);\r\n    }\r\n    // Clone any children\r\n    if (this.hasManagedChildren) {\r\n      this.getChildren().each(child => {\r\n        if (!child.deepClone) {\r\n          throw new Error('Cannot deepClone child.');\r\n        }\r\n        child.deepClone((clone, child) => {\r\n          if (hasId) {\r\n            // Set the cloned child parent id\r\n            clone.set('_parentId', clonedId);\r\n          }\r\n          if (modifier) {\r\n            // Run the custom modifier function on the cloned child\r\n            modifier(clone, child);\r\n          }\r\n        });\r\n      });\r\n    }\r\n    // Add the cloned model to its parent for model.findDescendants resolution\r\n    clonedModel.getParent().getChildren().add(clonedModel);\r\n    // Setup the cloned model after setting the id, the parent and adding any children\r\n    clonedModel.setupModel();\r\n    return clonedModel;\r\n  }\r\n\r\n  /**\r\n   * Internal event handler for all module events. Triggers event bubbling\r\n   * through the module hierarchy when the event is included in\r\n   * `this.bubblingEvents`.\r\n   * @param {string} type Event name / type\r\n   * @param {Backbone.Model} model Origin backbone model\r\n   * @param {*} value New property value\r\n   */\r\n  onAll(type, model, value) {\r\n    if (!_.result(this, 'bubblingEvents').includes(type)) return;\r\n    const event = new ModelEvent(type, model, value);\r\n    this.bubble(event);\r\n  }\r\n\r\n  /**\r\n   * Internal event handler for bubbling events.\r\n   * @param {ModelEvent} event\r\n   */\r\n  bubble(event) {\r\n    if (!event.canBubble) return;\r\n    event.addPath(this);\r\n    this.trigger(`bubble:${event.type} bubble`, event);\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport AdaptModel from 'core/js/models/adaptModel';\r\n\r\nexport default class ContentObjectModel extends AdaptModel {\r\n\r\n  get _parent() {\r\n    Adapt.log.deprecated('contentObjectModel._parent, use contentObjectModel.getParent() instead, parent models are defined by the JSON');\r\n    const isParentCourse = (this.get('_parentId') === Adapt.course.get('_id'));\r\n    if (isParentCourse) {\r\n      return 'course';\r\n    }\r\n    return 'contentObjects';\r\n  }\r\n\r\n  get _siblings() {\r\n    Adapt.log.deprecated('contentObjectModel._siblings, use contentObjectModel.getSiblings() instead, sibling models are defined by the JSON');\r\n    return 'contentObjects';\r\n  }\r\n\r\n  get _children() {\r\n    Adapt.log.deprecated('contentObjectModel._children, use contentObjectModel.hasManagedChildren instead, child models are defined by the JSON');\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Returns a string of the model type group.\r\n   * @returns {string}\r\n   */\r\n  getTypeGroup() {\r\n    return 'contentobject';\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport ContentObjectModel from 'core/js/models/contentObjectModel';\r\n\r\nclass MenuModel extends ContentObjectModel {\r\n\r\n  get _children() {\r\n    Adapt.log.deprecated('menuModel._children, use menuModel.hasManagedChildren instead, child models are defined by the JSON');\r\n    return 'contentObjects';\r\n  }\r\n\r\n  /**\r\n   * Returns a string of the model type group.\r\n   * @returns {string}\r\n   */\r\n  getTypeGroup() {\r\n    return 'menu';\r\n  }\r\n\r\n  setCustomLocking() {\r\n    const children = this.getAvailableChildModels();\r\n    children.forEach(child => {\r\n      child.set('_isLocked', this.shouldLock(child));\r\n      if (!(child instanceof MenuModel)) return;\r\n      child.checkLocking();\r\n    });\r\n  }\r\n\r\n}\r\n\r\nAdapt.register('menu', { model: MenuModel });\r\n\r\nexport default MenuModel;\r\n","import Adapt from 'core/js/adapt';\r\nimport MenuModel from 'core/js/models/menuModel';\r\n\r\nclass CourseModel extends MenuModel {\r\n\r\n  get _parent() {\r\n    Adapt.log.deprecated('courseModel._parent, use courseModel.getParent() instead, parent models are defined by the JSON');\r\n    return null;\r\n  }\r\n\r\n  get _siblings() {\r\n    Adapt.log.deprecated('courseModel._siblings, use courseModel.getSiblings() instead, sibling models are defined by the JSON');\r\n    return null;\r\n  }\r\n\r\n}\r\n\r\nAdapt.register('course', { model: CourseModel });\r\n\r\nexport default CourseModel;\r\n","import Adapt from 'core/js/adapt';\r\nimport LockingModel from 'core/js/models/lockingModel';\r\n\r\nclass StartController extends Backbone.Controller {\r\n\r\n  initialize(...args) {\r\n    super.initialize(...args);\r\n    this.model = null;\r\n  }\r\n\r\n  loadCourseData() {\r\n    this.model = new LockingModel(Adapt.course.get('_start'));\r\n  }\r\n\r\n  setStartLocation() {\r\n    if (!this.isEnabled()) return;\r\n    window.history.replaceState('', '', this.getStartHash());\r\n  }\r\n\r\n  returnToStartLocation() {\r\n    const startIds = this.model.get('_startIds');\r\n    if (startIds) {\r\n      // ensure we can return to the start page even if it is completed\r\n      startIds.forEach(startId => (startId._skipIfComplete = false));\r\n    }\r\n    window.location.hash = this.getStartHash(true);\r\n  }\r\n\r\n  /**\r\n   * Returns a string in URL.hash format representing the route that the course should be sent to\r\n   * @param {boolean} [alwaysForce] Ignore any route specified in location.hash and force use of the start page instead\r\n   * @return {string}\r\n   */\r\n  getStartHash(alwaysForce) {\r\n    const startId = this.getStartId();\r\n    const isRouteSpecified = window.location.href.indexOf('#') > -1;\r\n    const shouldForceStartId = alwaysForce || this.model.get('_force');\r\n    const shouldNavigateToStartId = startId && (!isRouteSpecified || shouldForceStartId);\r\n\r\n    if (shouldNavigateToStartId && startId !== Adapt.course.get('_id')) {\r\n      return '#/id/' + startId;\r\n    }\r\n\r\n    // If there's a route specified in location.hash, use that - otherwise go to main menu\r\n    return window.location.hash || '#/';\r\n  }\r\n\r\n  isEnabled() {\r\n    return Boolean(this.model?.get('_isEnabled'));\r\n  }\r\n\r\n  getStartId() {\r\n    let startId = this.model.get('_id');\r\n    const startIds = this.model.get('_startIds');\r\n\r\n    if (!startIds?.length) return startId;\r\n\r\n    const $html = $('html');\r\n    for (let i = 0, l = startIds.length; i < l; i++) {\r\n      const item = startIds[i];\r\n      const className = item._className;\r\n      const skipIfComplete = item._skipIfComplete;\r\n\r\n      const model = Adapt.findById(item._id);\r\n\r\n      if (!model) {\r\n        console.log('startController: cannot find id', item._id);\r\n        continue;\r\n      }\r\n\r\n      if (skipIfComplete) {\r\n        if (model.get('_isComplete')) continue;\r\n      }\r\n\r\n      if (!className || $html.is(className) || $html.hasClass(className)) {\r\n        // See https://github.com/adaptlearning/adapt_framework/issues/1843\r\n        startId = item._id;\r\n        break;\r\n      }\r\n    }\r\n\r\n    return startId;\r\n  }\r\n\r\n}\r\n\r\nAdapt.once('adapt:start', () => {\r\n  Adapt.startController.loadCourseData();\r\n  Adapt.startController.setStartLocation();\r\n});\r\n\r\n/*\r\n* allows you to call returnToStartLocation either by calling `Adapt.trigger('navigation:returnToStart')`\r\n* or by including in the top navigation bar a button that has the attribute `data-event=\"returnToStart\"`\r\n*/\r\nAdapt.on('navigation:returnToStart', () => {\r\n  Adapt.startController.returnToStartLocation();\r\n});\r\n\r\nexport default (Adapt.startController = new StartController());\r\n","import Adapt from 'core/js/adapt';\r\nimport AdaptCollection from 'core/js/collections/adaptCollection';\r\nimport BuildModel from 'core/js/models/buildModel';\r\nimport ConfigModel from 'core/js/models/configModel';\r\nimport LockingModel from 'core/js/models/lockingModel';\r\n\r\nimport 'core/js/models/courseModel';\r\nimport 'core/js/startController';\r\n\r\nclass Data extends AdaptCollection {\r\n\r\n  model(json) {\r\n    const ModelClass = Adapt.getModelClass(json);\r\n    if (!ModelClass) {\r\n      return new LockingModel(json);\r\n    }\r\n    return new ModelClass(json, { parse: true });\r\n  }\r\n\r\n  initialize() {\r\n    super.initialize();\r\n    this.on({\r\n      'add': this.onAdded,\r\n      'remove': this.onRemoved\r\n    });\r\n  }\r\n\r\n  async init () {\r\n    this.reset();\r\n    this._byAdaptID = {};\r\n    Adapt.build = new BuildModel(null, { url: 'adapt/js/build.min.js', reset: true });\r\n    await Adapt.build.whenReady();\r\n    $('html').attr('data-adapt-framework-version', Adapt.build.get('package').version);\r\n    this.loadConfigData();\r\n  }\r\n\r\n  onAdded(model) {\r\n    this._byAdaptID[model.get('_id')] = model;\r\n  }\r\n\r\n  onRemoved(model) {\r\n    delete this._byAdaptID[model.get('_id')];\r\n  }\r\n\r\n  loadConfigData() {\r\n    Adapt.config = new ConfigModel(null, { url: 'course/config.' + Adapt.build.get('jsonext'), reset: true });\r\n    this.listenToOnce(Adapt, 'configModel:loadCourseData', this.onLoadCourseData);\r\n    this.listenTo(Adapt.config, {\r\n      'change:_activeLanguage': this.onLanguageChange,\r\n      'change:_defaultDirection': this.onDirectionChange\r\n    });\r\n  }\r\n\r\n  onDirectionChange(model, direction) {\r\n    if (direction === 'rtl') {\r\n      $('html').removeClass('dir-ltr').addClass('dir-rtl').attr('dir', 'rtl');\r\n    } else {\r\n      $('html').removeClass('dir-rtl').addClass('dir-ltr').attr('dir', 'ltr');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Before we actually go to load the course data, we first need to check to see if a language has been set\r\n   * If it has we can go ahead and start loading; if it hasn't, apply the defaultLanguage from config.json\r\n   */\r\n  onLoadCourseData() {\r\n    if (!Adapt.config.get('_activeLanguage')) {\r\n      Adapt.config.set('_activeLanguage', Adapt.config.get('_defaultLanguage'));\r\n      return;\r\n    }\r\n    this.loadCourseData();\r\n  }\r\n\r\n  onLanguageChange(model, language) {\r\n    Adapt.offlineStorage.set('lang', language);\r\n    // set `_isStarted` back to `false` when changing language so that the learner's answers\r\n    // to questions get restored in the new language when `_restoreStateOnLanguageChange: true`\r\n    // see https://github.com/adaptlearning/adapt_framework/issues/2977\r\n    if (Adapt.get('_isStarted')) {\r\n      Adapt.set('_isStarted', false);\r\n    }\r\n    this.loadCourseData(language);\r\n  }\r\n\r\n  async loadCourseData(newLanguage) {\r\n\r\n    // All code that needs to run before adapt starts should go here\r\n    const language = Adapt.config.get('_activeLanguage');\r\n    const courseFolder = 'course/' + language + '/';\r\n\r\n    $('html').attr('lang', language);\r\n\r\n    await this.loadManifestFiles(courseFolder);\r\n    await this.triggerDataLoaded();\r\n    await this.triggerDataReady(newLanguage);\r\n    this.triggerInit();\r\n\r\n  }\r\n\r\n  getJSON(path) {\r\n    return new Promise((resolve, reject) => {\r\n      $.getJSON(path, data => {\r\n        // Add path to data in case it's necessary later\r\n        data.__path__ = path;\r\n        resolve(data);\r\n      }).fail(reject);\r\n    });\r\n  }\r\n\r\n  async loadManifestFiles(languagePath) {\r\n    this.trigger('loading');\r\n    this.reset();\r\n    const manifestPath = languagePath + 'language_data_manifest.js';\r\n    let manifest;\r\n    try {\r\n      manifest = await this.getJSON(manifestPath);\r\n    } catch (err) {\r\n      manifest = ['course.json', 'contentObjects.json', 'articles.json', 'blocks.json', 'components.json'];\r\n      Adapt.log.warnOnce(`Manifest path '${manifestPath} not found. Using traditional files: ${manifest.join(', ')}`);\r\n    }\r\n    const allFileData = await Promise.all(manifest.map(filePath => {\r\n      return this.getJSON(`${languagePath}${filePath}`);\r\n    }));\r\n    // Flatten all file data into a single array of model data\r\n    const allModelData = allFileData.reduce((result, fileData) => {\r\n      if (Array.isArray(fileData)) {\r\n        result.push(...fileData);\r\n      } else if (fileData instanceof Object) {\r\n        result.push(fileData);\r\n      } else {\r\n        Adapt.log.warnOnce(`File data isn't an array or object: ${fileData.__path__}`);\r\n      }\r\n      return result;\r\n    }, []);\r\n    // Add course model first to allow other model/views to utilize its settings\r\n    const course = allModelData.find(modelData => modelData._type === 'course');\r\n    if (!course) {\r\n      throw new Error(`Expected a model data with \"_type\": \"course\", none found.`);\r\n    }\r\n    Adapt.trigger('courseModel:dataLoading');\r\n    Adapt.course = this.push(course);\r\n    Adapt.trigger('courseModel:dataLoaded');\r\n    // Add other models\r\n    allModelData.forEach(modelData => {\r\n      if (modelData._type === 'course') {\r\n        return;\r\n      }\r\n      this.push(modelData);\r\n    });\r\n    this.trigger('reset');\r\n    this.trigger('loaded');\r\n    await Adapt.wait.queue();\r\n  }\r\n\r\n  async triggerDataLoaded() {\r\n    Adapt.log.debug('Firing app:dataLoaded');\r\n    try {\r\n      // Setup the newly added models\r\n      this.forEach(model => model.setupModel?.());\r\n      Adapt.trigger('app:dataLoaded');\r\n    } catch (e) {\r\n      Adapt.log.error('Error during app:dataLoading trigger', e);\r\n    }\r\n    await Adapt.wait.queue();\r\n  }\r\n\r\n  async triggerDataReady(newLanguage) {\r\n    if (newLanguage) {\r\n      Adapt.trigger('app:languageChanged', newLanguage);\r\n      _.defer(() => {\r\n        Adapt.startController.loadCourseData();\r\n        const hash = Adapt.startController.isEnabled() ? Adapt.startController.getStartHash(false) : '#/';\r\n        Adapt.router.navigate(hash, { trigger: true, replace: true });\r\n      });\r\n    }\r\n    Adapt.log.debug('Firing app:dataReady');\r\n    try {\r\n      Adapt.trigger('app:dataReady');\r\n    } catch (e) {\r\n      Adapt.log.error('Error during app:dataReady trigger', e);\r\n    }\r\n    await Adapt.wait.queue();\r\n  }\r\n\r\n  triggerInit() {\r\n    this.isReady = true;\r\n    this.trigger('ready');\r\n  }\r\n\r\n  whenReady() {\r\n    if (this.isReady) return Promise.resolve();\r\n    return new Promise(resolve => {\r\n      this.once('ready', resolve);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Looks up a model by its `_id` property\r\n   * @param {string} id The id of the item e.g. \"co-05\"\r\n   * @return {Backbone.Model}\r\n   */\r\n  findById(id) {\r\n    const model = this._byAdaptID[id];\r\n    if (!model) {\r\n      console.warn(`Adapt.findById() unable to find id: ${id}`);\r\n      return;\r\n    }\r\n    return model;\r\n  }\r\n\r\n  /**\r\n   * Returns the model represented by the trackingPosition.\r\n   * @param {Array<Number, Number>} trackingPosition Represents the relative location of a model to a _trackingId\r\n   * @returns {Backbone.Model}\r\n   */\r\n  findByTrackingPosition(trackingPosition) {\r\n    const [ trackingId, indexInTrackingIdDescendants ] = trackingPosition;\r\n    const trackingIdModel = this.find(model => model.get('_trackingId') === trackingId);\r\n    if (!trackingIdModel) {\r\n      console.warn(`Adapt.findByTrackingPosition() unable to find trackingPosition: ${trackingPosition}`);\r\n      return;\r\n    }\r\n    if (indexInTrackingIdDescendants >= 0) {\r\n      // Model is either the trackingId model or a descendant\r\n      const trackingIdDescendants = [trackingIdModel].concat(trackingIdModel.getAllDescendantModels(true));\r\n      return trackingIdDescendants[indexInTrackingIdDescendants];\r\n    }\r\n    // Model is an ancestor of the trackingId model\r\n    const trackingIdAncestors = trackingIdModel.getAncestorModels();\r\n    const ancestorDistance = Math.abs(indexInTrackingIdDescendants) - 1;\r\n    return trackingIdAncestors[ancestorDistance];\r\n  }\r\n\r\n}\r\n\r\nexport default (Adapt.data = new Data());\r\n","import Adapt from 'core/js/adapt';\r\n\r\n// Basic API for setting and getting name+value pairs\r\n// Allows registration of a single handler.\r\n\r\nclass OfflineStorage extends Backbone.Controller {\r\n\r\n  /**\r\n   * set .ready to false if an offlineStorage handler is being attached - we'll need to wait until the handler lets us know\r\n   * it's ready before we can safely use offlineStorage\r\n   */\r\n  initialize(handler) {\r\n    /**\r\n     * set to true initially so that if there are no offlineStorage handlers (i.e. if contrib-spoor is not installed)\r\n     * this can still be accessed OK\r\n     */\r\n    this.ready = true;\r\n    this._handler = undefined;\r\n\r\n    if (!handler) {\r\n      return;\r\n    }\r\n\r\n    this.ready = false;\r\n    this._handler = handler;\r\n  }\r\n\r\n  /**\r\n   * Flag to indicate if an offlineStorage handler has been defined.\r\n   * @returns {boolean} true if an offlineStorage handler has been defined, false otherwise\r\n   */\r\n  hasHandler() {\r\n    return this._handler !== undefined;\r\n  }\r\n\r\n  /**\r\n   * Causes state to be serialized and saved.\r\n   */\r\n  save() {\r\n    Adapt.trigger('tracking:save');\r\n    return this._handler?.save?.apply(this._handler, arguments);\r\n  }\r\n\r\n  /**\r\n   * Serializes nested arrays, booleans and numbers into an encoded string.\r\n   * @param {Array|boolean|number} value\r\n   * @returns {string}\r\n   */\r\n  serialize(value) {\r\n    if (this._handler?.serialize) {\r\n      return this._handler.serialize.apply(this._handler, arguments);\r\n    }\r\n    return JSON.stringify(value);\r\n  }\r\n\r\n  /**\r\n   * Deserializes encoded strings back into nested arrays, booleans and numbers.\r\n   * @param {string} value\r\n   * @returns {Array|boolean|number}\r\n   */\r\n  deserialize(value) {\r\n    if (this._handler?.deserialize) {\r\n      return this._handler.deserialize.apply(this._handler, arguments);\r\n    }\r\n    return JSON.parse(value);\r\n  }\r\n\r\n  set(name, value) {\r\n    if (this._handler?.set) {\r\n      return this._handler.set.apply(this._handler, arguments);\r\n    }\r\n    // if no handler has been defined, just store the data locally\r\n    this[name] = value;\r\n  }\r\n\r\n  get(name) {\r\n    if (this._handler?.get) {\r\n      return this._handler.get.apply(this._handler, arguments);\r\n    }\r\n    // if no handler has been defined, check local data store\r\n    return this[name];\r\n  }\r\n\r\n  /**\r\n   * Some forms of offlineStorage could take time to initialise, this allows us to let plugins know when it's ready to be used\r\n   */\r\n  setReadyStatus() {\r\n    this.ready = true;\r\n    Adapt.trigger('offlineStorage:ready');\r\n  }\r\n\r\n}\r\n\r\nAdapt.offlineStorage = new OfflineStorage();\r\n\r\nexport default Adapt.offlineStorage;\r\n","const COMPLETION_STATE = ENUM([\r\n  'INCOMPLETE',\r\n  'COMPLETED',\r\n  'PASSED',\r\n  'FAILED'\r\n]);\r\n\r\nexport default COMPLETION_STATE;\r\n","import Adapt from 'core/js/adapt';\r\nimport COMPLETION_STATE from 'core/js/enums/completionStateEnum';\r\n\r\nclass Tracking extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this._config = {\r\n      _requireContentCompleted: true,\r\n      _requireAssessmentCompleted: false\r\n    };\r\n    this._assessmentState = null;\r\n\r\n    Adapt.once('configModel:dataLoaded', this.loadConfig.bind(this));\r\n    Adapt.on('app:dataReady', this.setupEventListeners.bind(this));\r\n  }\r\n\r\n  setupEventListeners() {\r\n    // Check if completion requires passing an assessment.\r\n    if (this._config._requireAssessmentCompleted) {\r\n      this.listenTo(Adapt, {\r\n        'assessment:complete': this.onAssessmentComplete,\r\n        'assessment:restored': this.onAssessmentRestored\r\n      });\r\n    }\r\n\r\n    // Check if completion requires completing all content.\r\n    if (this._config._requireContentCompleted) {\r\n      this.listenTo(Adapt.course, 'change:_isComplete', this.checkCompletion);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Store the assessment state.\r\n   * @param {object} assessmentState - The object returned by Adapt.assessment.getState()\r\n   */\r\n  onAssessmentComplete(assessmentState) {\r\n    this._assessmentState = assessmentState;\r\n\r\n    this.checkCompletion();\r\n  }\r\n\r\n  /**\r\n   * Restores the _assessmentState object when an assessment is registered.\r\n   * @param {object} assessmentState - An object representing the overall assessment state\r\n   */\r\n  onAssessmentRestored(assessmentState) {\r\n    this._assessmentState = assessmentState;\r\n  }\r\n\r\n  /**\r\n   * Evaluate the course and assessment completion.\r\n   */\r\n  checkCompletion() {\r\n    const completionData = this.getCompletionData();\r\n\r\n    if (completionData.status === COMPLETION_STATE.INCOMPLETE) {\r\n      return;\r\n    }\r\n\r\n    Adapt.trigger('tracking:complete', completionData);\r\n    Adapt.log.debug('tracking:complete', completionData);\r\n  }\r\n\r\n  /**\r\n   * The return value of this function should be passed to the trigger of 'tracking:complete'.\r\n   * @returns An object representing the user's course completion.\r\n   */\r\n  getCompletionData() {\r\n    const completionData = {\r\n      status: COMPLETION_STATE.INCOMPLETE,\r\n      assessment: null\r\n    };\r\n\r\n    // Course complete is required.\r\n    if (this._config._requireContentCompleted && !Adapt.course.get('_isComplete')) {\r\n      // INCOMPLETE: course not complete.\r\n      return completionData;\r\n    }\r\n\r\n    // Assessment completed required.\r\n    if (this._config._requireAssessmentCompleted) {\r\n      if (!this._assessmentState) {\r\n        // INCOMPLETE: assessment is not complete.\r\n        return completionData;\r\n      }\r\n\r\n      // PASSED/FAILED: assessment completed.\r\n      completionData.status = this._assessmentState.isPass ? COMPLETION_STATE.PASSED : COMPLETION_STATE.FAILED;\r\n      completionData.assessment = this._assessmentState;\r\n\r\n      return completionData;\r\n    }\r\n\r\n    // COMPLETED: criteria met, no assessment requirements.\r\n    completionData.status = COMPLETION_STATE.COMPLETED;\r\n\r\n    return completionData;\r\n  }\r\n\r\n  /**\r\n   * Set the _config object to the values retrieved from config.json.\r\n   */\r\n  loadConfig() {\r\n    if (Adapt.config.has('_completionCriteria')) {\r\n      this._config = Adapt.config.get('_completionCriteria');\r\n    }\r\n  }\r\n\r\n}\r\n\r\nAdapt.tracking = new Tracking();\r\n\r\nexport default Adapt.tracking;\r\n","import Adapt from 'core/js/adapt';\r\nimport Bowser from 'bowser';\r\n\r\nclass Device extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this.$html = $('html');\r\n    this.$window = $(window);\r\n    this.touch = Modernizr.touchevents;\r\n    this.screenWidth = this.getScreenWidth();\r\n    this.screenHeight = this.getScreenHeight();\r\n    this.browser = (Bowser.name || '').toLowerCase();\r\n    this.version = (Bowser.version || '').toLowerCase();\r\n    this.OS = this.getOperatingSystem().toLowerCase();\r\n    this.osVersion = Bowser.osversion || '';\r\n    this.renderingEngine = this.getRenderingEngine();\r\n    this.onWindowResize = _.debounce(this.onWindowResize.bind(this), 100);\r\n    this.listenTo(Adapt, {\r\n      'configModel:dataLoaded': this.onConfigDataLoaded\r\n    });\r\n    const browser = this.browser.toLowerCase();\r\n    // Convert 'msie' and 'internet explorer' to 'ie'.\r\n    let browserString = browser.replace(/msie|internet explorer/, 'ie');\r\n    browserString += ` version-${this.version} OS-${this.OS} ${this.getAppleDeviceType()}`;\r\n    browserString += browserString.replace('.', '-').toLowerCase();\r\n    browserString += ` pixel-density-${this.pixelDensity()}`;\r\n    this.$html.addClass(browserString);\r\n  }\r\n\r\n  get orientation() {\r\n    return (this.screenWidth >= this.screenHeight) ? 'landscape' : 'portrait';\r\n  }\r\n\r\n  get aspectRatio() {\r\n    return this.screenWidth / this.screenHeight;\r\n  }\r\n\r\n  onConfigDataLoaded() {\r\n    this.screenSize = this.checkScreenSize();\r\n    this.$html.addClass('size-' + this.screenSize);\r\n    if (this.orientation) {\r\n      this.$html.addClass('orientation-' + this.orientation);\r\n    }\r\n    // As Adapt.config is available it's ok to bind the 'resize'.\r\n    this.$window.on('resize orientationchange', this.onWindowResize);\r\n  }\r\n\r\n  /**\r\n   * Compares the calculated screen width to the breakpoints defined in config.json.\r\n   *\r\n   * @returns {string} 'large', 'medium' or 'small'\r\n   */\r\n  checkScreenSize() {\r\n    const screenSizeConfig = Adapt.config.get('screenSize');\r\n    let screenSize;\r\n\r\n    const screensizeEmThreshold = 300;\r\n    const baseFontSize = 16;\r\n\r\n    // Check to see if the screen size value is larger than the em threshold\r\n    // If value is larger than em threshold, convert value (assumed px) to ems\r\n    // Otherwise assume value is in ems\r\n    const mediumEmBreakpoint = screenSizeConfig.medium > screensizeEmThreshold\r\n      ? screenSizeConfig.medium / baseFontSize\r\n      : screenSizeConfig.medium;\r\n    const smallEmBreakpoint = screenSizeConfig.small > screensizeEmThreshold\r\n      ? screenSizeConfig.small / baseFontSize\r\n      : screenSizeConfig.small;\r\n\r\n    const fontSize = parseFloat($('html').css('font-size'));\r\n    const screenSizeEmWidth = (this.screenWidth / fontSize);\r\n\r\n    // Check to see if client screen width is larger than medium em breakpoint\r\n    // If so apply large, otherwise check to see if client screen width is\r\n    // larger than small em breakpoint. If so apply medium, otherwise apply small\r\n    if (screenSizeEmWidth >= mediumEmBreakpoint) {\r\n      screenSize = 'large';\r\n    } else if (screenSizeEmWidth >= smallEmBreakpoint) {\r\n      screenSize = 'medium';\r\n    } else {\r\n      screenSize = 'small';\r\n    }\r\n\r\n    return screenSize;\r\n  }\r\n\r\n  getScreenWidth() {\r\n    return this.isAppleDevice()\r\n      ? this.getAppleScreenWidth()\r\n      : window.innerWidth || this.$window.width();\r\n  }\r\n\r\n  getScreenHeight() {\r\n    return this.isAppleDevice()\r\n      ? this.getAppleScreenHeight()\r\n      : window.innerHeight || this.$window.height();\r\n  }\r\n\r\n  getOperatingSystem() {\r\n    const flags = ['windows', 'mac', 'linux', 'windowsphone', 'chromeos', 'android',\r\n      'ios', 'blackberry', 'firefoxos', 'webos', 'bada', 'tizen', 'sailfish'];\r\n    let os = flags.find(name => Bowser[name]) || '';\r\n\r\n    if (os === '') {\r\n      // Fall back to using navigator.platform in case Bowser can't detect the OS.\r\n      const platform = navigator.platform.toLowerCase();\r\n      const match = platform.match(/win|mac|linux/);\r\n      if (match) os = match[0];\r\n      // Set consistency with the Bowser flags.\r\n      if (os === 'win') os = 'windows';\r\n      if (!os) os = 'PlatformUnknown';\r\n    }\r\n\r\n    return os;\r\n  }\r\n\r\n  getRenderingEngine() {\r\n    const flags = ['webkit', 'blink', 'gecko', 'msie', 'msedge'];\r\n    return flags.find(name => Bowser[name]) || '';\r\n  }\r\n\r\n  onWindowResize() {\r\n    // Calculate the screen properties.\r\n    const previousWidth = this.screenWidth;\r\n    const previousHeight = this.screenHeight;\r\n\r\n    this.screenWidth = this.getScreenWidth();\r\n    this.screenHeight = this.getScreenHeight();\r\n\r\n    if (previousWidth === this.screenWidth && previousHeight === this.screenHeight) {\r\n      // Do not trigger a change if the viewport hasn't actually changed.  Scrolling on iOS will trigger a resize.\r\n      return;\r\n    }\r\n\r\n    const newScreenSize = this.checkScreenSize();\r\n\r\n    if (newScreenSize !== this.screenSize) {\r\n      this.screenSize = newScreenSize;\r\n\r\n      this.$html.removeClass('size-small size-medium size-large').addClass('size-' + this.screenSize);\r\n\r\n      if (this.orientation) {\r\n        this.$html.removeClass('orientation-landscape orientation-portrait').addClass('orientation-' + this.orientation);\r\n      }\r\n\r\n      Adapt.trigger('device:changed', this.screenSize);\r\n    }\r\n\r\n    Adapt.trigger('device:preResize device:resize device:postResize', this.screenWidth);\r\n\r\n  }\r\n\r\n  isAppleDevice() {\r\n    return /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\r\n  }\r\n\r\n  getAppleScreenWidth() {\r\n    return (Math.abs(window.orientation) === 90) ? window.screen.height : window.screen.width;\r\n  }\r\n\r\n  getAppleScreenHeight() {\r\n    return (Math.abs(window.orientation) === 90) ? window.screen.width : window.screen.height;\r\n  }\r\n\r\n  getAppleDeviceType() {\r\n    const flags = ['iphone', 'ipad', 'ipod'];\r\n    return flags.find(name => Bowser[name]) || '';\r\n  }\r\n\r\n  pixelDensity() {\r\n    const pixelDensity = (window.devicePixelRatio || 1);\r\n\r\n    if (pixelDensity >= 3) {\r\n      return 'ultra-high';\r\n    } else if (pixelDensity >= 2) {\r\n      return 'high';\r\n    } else if (pixelDensity >= 1.5) {\r\n      return 'medium';\r\n    } else {\r\n      return 'low';\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport default (Adapt.device = new Device());\r\n","import Adapt from 'core/js/adapt';\r\n\r\nclass DrawerItemView extends Backbone.View {\r\n\r\n  className() {\r\n    return 'drawer__menu drawer__item';\r\n  }\r\n\r\n  attributes() {\r\n    return {\r\n      role: 'list'\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, 'drawer:empty', this.remove);\r\n    this.render();\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      'click .drawer__item-btn': 'onDrawerItemClicked'\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const data = this.model.toJSON();\r\n    const template = Handlebars.templates['drawerItem'];\r\n    $(this.el).html(template(data)).appendTo('.drawer__holder');\r\n    return this;\r\n  }\r\n\r\n  onDrawerItemClicked(event) {\r\n    event.preventDefault();\r\n    const eventCallback = this.model.get('eventCallback');\r\n    Adapt.trigger(eventCallback);\r\n  }\r\n\r\n}\r\n\r\nDrawerItemView.type = 'drawerItem';\r\n\r\nexport default DrawerItemView;\r\n","import Adapt from 'core/js/adapt';\r\nimport DrawerItemView from 'core/js/views/drawerItemView';\r\n\r\nclass DrawerView extends Backbone.View {\r\n\r\n  className() {\r\n    return 'drawer u-display-none';\r\n  }\r\n\r\n  attributes() {\r\n    return {\r\n      'role': 'dialog',\r\n      'aria-modal': 'true',\r\n      'aria-labelledby': 'drawer-heading',\r\n      'aria-hidden': 'true'\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this._isVisible = false;\r\n    this.disableAnimation = Adapt.config.has('_disableAnimation') ? Adapt.config.get('_disableAnimation') : false;\r\n    this.drawerDir = Adapt.config.get('_defaultDirection') === 'rtl' ? 'left' : 'right';\r\n    this.drawerDuration = Adapt.config.get('_drawer')?._duration ?? 400;\r\n    this.setupEventListeners();\r\n    this.render();\r\n  }\r\n\r\n  setupEventListeners() {\r\n    this.listenTo(Adapt, {\r\n      'navigation:toggleDrawer': this.toggleDrawer,\r\n      'drawer:triggerCustomView': this.openCustomView,\r\n      'drawer:closeDrawer': this.onCloseDrawer,\r\n      'remove': this.onRemove,\r\n      'drawer:remove': this.remove\r\n    });\r\n\r\n    this.onKeyUp = this.onKeyUp.bind(this);\r\n    this.setupEscapeKey();\r\n  }\r\n\r\n  setupEscapeKey() {\r\n    $(window).on('keyup', this.onKeyUp);\r\n  }\r\n\r\n  onKeyUp(event) {\r\n    if (event.which !== 27) return;\r\n    event.preventDefault();\r\n\r\n    this.onCloseDrawer();\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      'click .drawer__back': 'onBackButtonClicked',\r\n      'click .drawer__close': 'onCloseClicked'\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const template = Handlebars.templates.drawer;\r\n    $(this.el).html(template({ _globals: Adapt.course.get('_globals') })).prependTo('body');\r\n    const shadowTemplate = Handlebars.templates.shadow;\r\n    $(shadowTemplate()).prependTo('body');\r\n    _.defer(this.postRender.bind(this));\r\n    return this;\r\n  }\r\n\r\n  postRender() {\r\n    this.$('a, button, input, select, textarea').attr('tabindex', -1);\r\n\r\n    this.checkIfDrawerIsAvailable();\r\n  }\r\n\r\n  openCustomView(view, hasBackButton) {\r\n    this._hasBackButton = hasBackButton;\r\n    this._isCustomViewVisible = true;\r\n    Adapt.trigger('drawer:empty');\r\n    this.showDrawer();\r\n    this.$('.drawer__holder').html(view);\r\n  }\r\n\r\n  checkIfDrawerIsAvailable() {\r\n    const isEmptyDrawer = (this.collection.length === 0);\r\n    $('.js-nav-drawer-btn').toggleClass('u-display-none', isEmptyDrawer);\r\n    if (isEmptyDrawer) {\r\n      Adapt.trigger('drawer:noItems');\r\n    }\r\n  }\r\n\r\n  onBackButtonClicked(event) {\r\n    event.preventDefault();\r\n    this.showDrawer(true);\r\n  }\r\n\r\n  onCloseClicked(event) {\r\n    event.preventDefault();\r\n    this.hideDrawer();\r\n  }\r\n\r\n  onCloseDrawer($toElement) {\r\n    this.hideDrawer($toElement);\r\n  }\r\n\r\n  onRemove() {\r\n    this.hideDrawer();\r\n  }\r\n\r\n  toggleDrawer() {\r\n    if (this._isVisible && this._isCustomViewVisible === false) {\r\n      this.hideDrawer();\r\n      return;\r\n    }\r\n    this.showDrawer(true);\r\n  }\r\n\r\n  showDrawer(emptyDrawer) {\r\n    this.$el.removeClass('u-display-none').removeAttr('aria-hidden');\r\n    // Only trigger popup:opened if drawer is visible, pass popup manager drawer element\r\n    if (!this._isVisible) {\r\n      Adapt.a11y.popupOpened(this.$el);\r\n      Adapt.a11y.scrollDisable('body');\r\n      this._isVisible = true;\r\n    }\r\n\r\n    // Sets tab index to 0 for all tabbable elements in Drawer\r\n    this.$('a, button, input, select, textarea').attr('tabindex', 0);\r\n\r\n    if (emptyDrawer) {\r\n      this.$('.drawer__back').addClass('u-display-none');\r\n      this._isCustomViewVisible = false;\r\n      this.emptyDrawer();\r\n      if (this.collection.models.length === 1) {\r\n        // This callback triggers openCustomView() and sets\r\n        // _isCustomViewVisible to true, causing toggleDrawer()\r\n        // to re-render the drawer on every toggle button press\r\n        Adapt.trigger(this.collection.models[0].get('eventCallback'));\r\n        // Set _isCustomViewVisible to false to prevent re-rendering\r\n        // the drawer and fix the toggle functionality on toggle button press\r\n        this._isCustomViewVisible = false;\r\n      } else {\r\n        this.renderItems();\r\n        Adapt.trigger('drawer:openedItemView');\r\n      }\r\n    } else {\r\n      const hideDrawerBackButton = (!this._hasBackButton || this.collection.models.length <= 1);\r\n      this.$('.drawer__back').toggleClass('u-display-none', hideDrawerBackButton);\r\n      Adapt.trigger('drawer:openedCustomView');\r\n    }\r\n\r\n    const complete = () => {\r\n      this.addShadowEvent();\r\n      Adapt.trigger('drawer:opened');\r\n\r\n      // focus on first tabbable element in drawer\r\n      Adapt.a11y.focusFirst(this.$el, { defer: true });\r\n    };\r\n\r\n    // delay drawer animation until after background fadeout animation is complete\r\n    const direction = {};\r\n    if (this.disableAnimation) {\r\n      $('.js-shadow').removeClass('u-display-none');\r\n      $('.js-drawer-holder').scrollTop(0);\r\n\r\n      direction[this.drawerDir] = 0;\r\n      this.$el.css(direction);\r\n      complete();\r\n    } else {\r\n      $('.js-shadow').velocity({ opacity: 1 }, {\r\n        duration: this.drawerDuration,\r\n        begin: () => {\r\n          $('.js-shadow').removeClass('u-display-none');\r\n          $('.js-drawer-holder').scrollTop(0);\r\n          complete();\r\n        }\r\n      });\r\n\r\n      const easing = Adapt.config.get('_drawer')?._showEasing || 'easeOutQuart';\r\n      direction[this.drawerDir] = 0;\r\n      this.$el.velocity(direction, this.drawerDuration, easing);\r\n    }\r\n\r\n  }\r\n\r\n  emptyDrawer() {\r\n    this.$('.drawer__holder').empty();\r\n  }\r\n\r\n  renderItems() {\r\n    Adapt.trigger('drawer:empty');\r\n    this.emptyDrawer();\r\n    this.collection.forEach(model => new DrawerItemView({ model }));\r\n  }\r\n\r\n  hideDrawer($toElement) {\r\n    if (!this._isVisible) return;\r\n\r\n    const direction = {};\r\n    Adapt.a11y.popupClosed($toElement);\r\n    this._isVisible = false;\r\n    Adapt.a11y.scrollEnable('body');\r\n\r\n    if (this.disableAnimation) {\r\n\r\n      direction[this.drawerDir] = -this.$el.width();\r\n      this.$el\r\n        .css(direction)\r\n        .addClass('u-display-none')\r\n        .attr('aria-hidden', 'true');\r\n\r\n      $('.js-shadow').addClass('u-display-none');\r\n\r\n      Adapt.trigger('drawer:closed');\r\n\r\n    } else {\r\n      const easing = Adapt.config.get('_drawer')?._hideEasing || 'easeInQuart';\r\n\r\n      direction[this.drawerDir] = -this.$el.width();\r\n      this.$el.velocity(direction, this.drawerDuration, easing, () => {\r\n        this.$el\r\n          .addClass('u-display-none')\r\n          .attr('aria-hidden', 'true');\r\n\r\n        Adapt.trigger('drawer:closed');\r\n      });\r\n\r\n      $('.js-shadow').velocity({ opacity: 0 }, { duration: this.drawerDuration,\r\n        complete() {\r\n          $('.js-shadow').addClass('u-display-none');\r\n        }\r\n      });\r\n\r\n    }\r\n\r\n    this._isCustomViewVisible = false;\r\n    this.removeShadowEvent();\r\n\r\n  }\r\n\r\n  addShadowEvent() {\r\n    $('.js-shadow').one('click touchstart', () => this.onCloseDrawer());\r\n  }\r\n\r\n  removeShadowEvent() {\r\n    $('.js-shadow').off('click touchstart');\r\n  }\r\n\r\n  remove() {\r\n    super.remove();\r\n    $(window).off('keyup', this.onKeyUp);\r\n\r\n    Adapt.trigger('drawer:empty');\r\n    this.collection.reset();\r\n    $('.js-shadow').remove();\r\n  }\r\n\r\n}\r\n\r\nObject.assign(DrawerView, {\r\n  childContainer: '.js-drawer-holder',\r\n  childView: DrawerItemView\r\n});\r\n\r\nexport default DrawerView;\r\n","import Adapt from 'core/js/adapt';\r\nimport DrawerView from 'core/js/views/drawerView';\r\n\r\nconst DrawerCollection = new Backbone.Collection(null, { comparator: 'drawerOrder' });\r\nconst Drawer = {};\r\n\r\nDrawer.addItem = function(drawerObject, eventCallback) {\r\n  drawerObject.eventCallback = eventCallback;\r\n  DrawerCollection.add(drawerObject);\r\n};\r\n\r\nDrawer.triggerCustomView = function(view, hasBackButton) {\r\n  if (hasBackButton !== false) {\r\n    hasBackButton = true;\r\n  }\r\n  Adapt.trigger('drawer:triggerCustomView', view, hasBackButton);\r\n};\r\n\r\nAdapt.on({\r\n  'adapt:start'() {\r\n    new DrawerView({ collection: DrawerCollection });\r\n  },\r\n  'app:languageChanged'() {\r\n    Adapt.trigger('drawer:remove');\r\n  }\r\n});\r\n\r\nexport default (Adapt.drawer = Drawer);\r\n","import Adapt from 'core/js/adapt';\r\n\r\nexport default class NotifyPushView extends Backbone.View {\r\n\r\n  className() {\r\n    let classes = 'notify-push ';\r\n    classes += (this.model.get('_classes') || '');\r\n    return classes;\r\n  }\r\n\r\n  attributes() {\r\n    return {\r\n      'role': 'dialog',\r\n      'aria-labelledby': 'notify-push-heading',\r\n      'aria-modal': 'false'\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, {\r\n      'notify:pushShown notify:pushRemoved': this.updateIndexPosition,\r\n      'remove': this.remove\r\n    });\r\n\r\n    this.listenTo(this.model.collection, {\r\n      'remove': this.updateIndexPosition,\r\n      'change:_index': this.updatePushPosition\r\n    });\r\n\r\n    this.preRender();\r\n    this.render();\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      'click .js-notify-push-close-btn': 'closePush',\r\n      'click .js-notify-push-inner': 'triggerEvent'\r\n    };\r\n  }\r\n\r\n  preRender() {\r\n    this.hasBeenRemoved = false;\r\n  }\r\n\r\n  render() {\r\n    const data = this.model.toJSON();\r\n    const template = Handlebars.templates['notifyPush'];\r\n    this.$el.html(template(data)).appendTo('#wrapper');\r\n\r\n    _.defer(this.postRender.bind(this));\r\n\r\n    return this;\r\n  }\r\n\r\n  postRender() {\r\n    this.$el.addClass('is-active');\r\n\r\n    _.delay(this.closePush.bind(this), this.model.get('_timeout'));\r\n\r\n    Adapt.trigger('notify:pushShown');\r\n  }\r\n\r\n  closePush(event) {\r\n    if (event) {\r\n      event.preventDefault();\r\n    }\r\n\r\n    // Check whether this view has been removed as the delay can cause it to be fired twice\r\n    if (this.hasBeenRemoved === false) {\r\n\r\n      this.hasBeenRemoved = true;\r\n\r\n      this.$el.removeClass('is-active');\r\n\r\n      _.delay(() => {\r\n        this.model.collection.remove(this.model);\r\n        Adapt.trigger('notify:pushRemoved', this);\r\n        this.remove();\r\n      }, 600);\r\n    }\r\n  }\r\n\r\n  triggerEvent(event) {\r\n    Adapt.trigger(this.model.get('_callbackEvent'));\r\n    this.closePush();\r\n  }\r\n\r\n  updateIndexPosition() {\r\n    if (this.hasBeenRemoved) return;\r\n    const models = this.model.collection.models;\r\n    models.forEach((model, index) => {\r\n      if (!model.get('_isActive')) return;\r\n      model.set('_index', index);\r\n      this.updatePushPosition();\r\n    });\r\n  }\r\n\r\n  updatePushPosition() {\r\n    if (this.hasBeenRemoved) {\r\n      return;\r\n    }\r\n\r\n    if (typeof this.model.get('_index') !== 'undefined') {\r\n      const elementHeight = this.$el.height();\r\n      const offset = 20;\r\n      const navigationHeight = $('.nav').height();\r\n      const currentIndex = this.model.get('_index');\r\n      let flippedIndex = (currentIndex === 0) ? 1 : 0;\r\n\r\n      if (this.model.collection.where({ _isActive: true }).length === 1) {\r\n        flippedIndex = 0;\r\n      }\r\n\r\n      const positionLowerPush = (elementHeight + offset) * flippedIndex + navigationHeight + offset;\r\n      this.$el.css('top', positionLowerPush);\r\n    }\r\n  }\r\n}\r\n","import LockingModel from 'core/js/models/lockingModel';\r\n\r\nexport default class NotifyModel extends LockingModel {\r\n\r\n  defaults() {\r\n    return {\r\n      _isActive: false,\r\n      _showIcon: false,\r\n      _timeout: 3000\r\n    };\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport NotifyPushView from 'core/js/views/notifyPushView';\r\nimport NotifyModel from 'core/js/models/notifyModel';\r\n\r\n// Build a collection to store push notifications\r\nexport default class NotifyPushCollection extends Backbone.Collection {\r\n\r\n  initialize() {\r\n    this.model = NotifyModel;\r\n    this.listenTo(this, 'add', this.onPushAdded);\r\n    this.listenTo(Adapt, 'notify:pushRemoved', this.onRemovePush);\r\n  }\r\n\r\n  onPushAdded(model) {\r\n    this.checkPushCanShow(model);\r\n  }\r\n\r\n  checkPushCanShow(model) {\r\n    if (!this.canShowPush()) return;\r\n    model.set('_isActive', true);\r\n    this.showPush(model);\r\n  }\r\n\r\n  canShowPush() {\r\n    const availablePushNotifications = this.where({ _isActive: true });\r\n    return (availablePushNotifications.length < 2);\r\n  }\r\n\r\n  showPush(model) {\r\n    new NotifyPushView({\r\n      model: model\r\n    });\r\n  }\r\n\r\n  onRemovePush(view) {\r\n    const inactivePushNotifications = this.where({ _isActive: false });\r\n    if (inactivePushNotifications.length > 0) {\r\n      this.checkPushCanShow(inactivePushNotifications[0]);\r\n    }\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\n\r\n/**\r\n * Event object triggered for controlling child view rendering.\r\n * Sent with 'view:addChild' and 'view:requestChild' events.\r\n * All plugins receive the same object reference in their event handler and\r\n * as such, this object becomes a place of consensus for plugins to decide how\r\n * to handle rendering for this child.\r\n */\r\nexport default class ChildEvent extends Backbone.Controller {\r\n\r\n  /**\r\n   * @param {string} type Event type\r\n   * @param {AdaptView} target Parent view\r\n   * @param {AdaptModel} model Child model\r\n   */\r\n  initialize(type, target, model) {\r\n    /** @type {string} */\r\n    this.type = type;\r\n    /** @type {AdaptView} */\r\n    this.target = target;\r\n    /** @type {boolean} Force the child model to render */\r\n    this.isForced = false;\r\n    /** @type {boolean} Stop rendering before the child model */\r\n    this.isStoppedImmediate = false;\r\n    /** @type {boolean} Stop rendering after the child model */\r\n    this.isStoppedNext = false;\r\n    /** @type {boolean} Contains a model to render in response to a requestChild event */\r\n    this.hasRequestChild = false;\r\n    this._model = model;\r\n  }\r\n\r\n  /**\r\n   * Get the model to be rendered.\r\n   * @returns {AdaptModel}\r\n   */\r\n  get model() {\r\n    return this._model;\r\n  }\r\n\r\n  /**\r\n   * Set the model to render in response to a 'view:requestChild' event.\r\n   * @param {AdaptModel}\r\n   */\r\n  set model(model) {\r\n    if (this.type !== 'requestChild') {\r\n      Adapt.log.warn(`Cannot change model in ${this.type} event.`);\r\n      return;\r\n    }\r\n    if (this._model) {\r\n      Adapt.log.warn(`Cannot inject two models in one sitting. ${model.get('_id')} attempts to overwrite ${this._model.get('_id')}`);\r\n      return;\r\n    }\r\n    this._model = model;\r\n    this.hasRequestChild = true;\r\n  }\r\n\r\n  /**\r\n   * Reset all render stops.\r\n   */\r\n  reset() {\r\n    this.isStoppedImmediate = false;\r\n    this.isStoppedNext = false;\r\n  }\r\n\r\n  /**\r\n   * Force model to render.\r\n   */\r\n  force() {\r\n    this.isForced = true;\r\n  }\r\n\r\n  /**\r\n   * General stop. Stop immediately or stop next with flag to false.\r\n   * @param {boolean} [immediate=true] Flag to stop immediate or next.\r\n   */\r\n  stop(immediate = true) {\r\n    if (!immediate) {\r\n      return this.stopNext();\r\n    }\r\n    this.isStoppedImmediate = true;\r\n  }\r\n\r\n  /**\r\n   * Shortcut to stop(false). Stop the render after the contained model is rendered.\r\n   */\r\n  stopNext() {\r\n    this.isStoppedNext = true;\r\n  }\r\n\r\n  /**\r\n   * Trigger an event to signify that a final decision has been reached.\r\n   */\r\n  close() {\r\n    this.trigger('closed');\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport ChildEvent from 'core/js/childEvent';\r\nimport { render } from 'core/js/reactHelpers';\r\nimport ReactDOM from 'react-dom';\r\n\r\nclass AdaptView extends Backbone.View {\r\n\r\n  attributes() {\r\n    return {\r\n      'data-adapt-id': this.model.get('_id')\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this.listenTo(this.model, {\r\n      'change:_isVisible': this.toggleVisibility,\r\n      'change:_isHidden': this.toggleHidden,\r\n      'change:_isComplete': this.onIsCompleteChange\r\n    });\r\n    this.isReact = (this.constructor.template || '').includes('.jsx');\r\n    if (this.isReact) {\r\n      this._classSet = new Set(_.result(this, 'className').trim().split(/\\s+/));\r\n      this.listenTo(this.model, 'all', this.changed);\r\n      // Facilitate adaptive react views\r\n      this.listenTo(Adapt, 'device:changed', this.changed);\r\n    }\r\n    this.model.set({\r\n      '_globals': Adapt.course.get('_globals'),\r\n      '_isReady': false\r\n    });\r\n    this._isRemoved = false;\r\n\r\n    if (Adapt.location._currentId === this.model.get('_id')) {\r\n      Adapt.parentView = this;\r\n    }\r\n\r\n    this.preRender();\r\n    this.render();\r\n    this.setupOnScreenHandler();\r\n  }\r\n\r\n  preRender() {}\r\n\r\n  async postRender() {\r\n    await this.addChildren();\r\n  }\r\n\r\n  render() {\r\n    const type = this.constructor.type;\r\n    Adapt.trigger(`${type}View:preRender view:preRender`, this);\r\n\r\n    if (this.isReact) {\r\n      this.changed();\r\n    } else {\r\n      const data = this.model.toJSON();\r\n      data.view = this;\r\n      const template = Handlebars.templates[this.constructor.template];\r\n      this.$el.html(template(data));\r\n    }\r\n\r\n    Adapt.trigger(`${type}View:render view:render`, this);\r\n\r\n    _.defer(async () => {\r\n      // don't call postRender after remove\r\n      if (this._isRemoved) return;\r\n\r\n      await this.postRender();\r\n      Adapt.trigger(`${type}View:postRender view:postRender`, this);\r\n    });\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Re-render a react template\r\n   * @param {string} eventName=null Backbone change event name\r\n   */\r\n  changed(eventName = null) {\r\n    if (!this.isReact) {\r\n      throw new Error('Cannot call changed on a non-react view');\r\n    }\r\n    if (typeof eventName === 'string' && eventName.startsWith('bubble')) {\r\n      // Ignore bubbling events as they are outside of this view's scope\r\n      return;\r\n    }\r\n    const element = render(this.constructor.template.replace('.jsx', ''), this.model, this);\r\n    this.updateViewProperties();\r\n    ReactDOM.render(element, this.el);\r\n  }\r\n\r\n  updateViewProperties() {\r\n    const classesToAdd = _.result(this, 'className').trim().split(/\\s+/);\r\n    classesToAdd.forEach(i => this._classSet.add(i));\r\n    const classesToRemove = [ ...this._classSet ].filter(i => !classesToAdd.includes(i));\r\n    classesToRemove.forEach(i => this._classSet.delete(i));\r\n    this._setAttributes({ ..._.result(this, 'attributes'), id: _.result(this, 'id') });\r\n    this.$el.removeClass(classesToRemove).addClass(classesToAdd);\r\n  }\r\n\r\n  setupOnScreenHandler() {\r\n    const onscreen = this.model.get('_onScreen');\r\n\r\n    if (!onscreen?._isEnabled) return;\r\n\r\n    this.$el.addClass(`has-animation ${onscreen._classes}-before`);\r\n    this.$el.on('onscreen.adaptView', (e, m) => {\r\n      if (!m.onscreen) return;\r\n      const minVerticalInview = onscreen._percentInviewVertical || 33;\r\n      if (m.percentInviewVertical < minVerticalInview) return;\r\n      this.$el.addClass(`${onscreen._classes}-after`).off('onscreen.adaptView');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Add children and descendant views, first-child-first. Wait until all possible\r\n   * views are added before resolving asynchronously.\r\n   * Will trigger 'view:addChild'(ChildEvent), 'view:requestChild'(ChildEvent)\r\n   * and 'view:childAdded'(ParentView, ChildView) accordingly.\r\n   * @returns {number} Count of views added\r\n   */\r\n  async addChildren() {\r\n    this.nthChild = this.nthChild || 0;\r\n    // Check descendants first\r\n    let addedCount = await this.addDescendants(false);\r\n    // Iterate through existing available children and/or request new children\r\n    // if required and allowed\r\n    while (true) {\r\n      const models = this.model.getAvailableChildModels();\r\n      const event = this._getAddChildEvent(models[this.nthChild]);\r\n      if (!event) {\r\n        break;\r\n      }\r\n      if (event.isForced) {\r\n        event.reset();\r\n      }\r\n      if (event.isStoppedImmediate || !event.model) {\r\n        // If addChild has been stopped before it is added then\r\n        // set all subsequent models and their children as not rendered\r\n        const subsequentModels = models.slice(this.nthChild);\r\n        subsequentModels.forEach(model => model.setOnChildren('_isRendered', false));\r\n        break;\r\n      }\r\n      // Set model state\r\n      const model = event.model;\r\n      model.set({\r\n        '_isRendered': true,\r\n        '_nthChild': ++this.nthChild\r\n      });\r\n      // Create child view\r\n      const ChildView = this.constructor.childView || Adapt.getViewClass(model);\r\n      if (!ChildView) {\r\n        throw new Error(`The component '${model.attributes._id}' ('${model.attributes._component}') has not been installed, and so is not available in your project.`);\r\n      }\r\n      const childView = new ChildView({ model });\r\n      this.addChildView(childView);\r\n      addedCount++;\r\n      if (event.isStoppedNext) {\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (!addedCount) {\r\n      return addedCount;\r\n    }\r\n\r\n    // Children were added, unset _isReady\r\n    this.model.set('_isReady', false);\r\n    return addedCount;\r\n  }\r\n\r\n  /**\r\n   * Child views can be added with '_renderPosition': 'outer-append' or\r\n   * 'inner-append' (default). Each child view will trigger a\r\n   * 'view:childAdded'(ParentView, ChildView) event and be added to the\r\n   * this.getChildViews() array on this parent.\r\n   * @param {AdaptView} childView\r\n   * @returns {AdaptView} Returns this childView\r\n   */\r\n  addChildView(childView) {\r\n    const childViews = this.getChildViews() || [];\r\n    childViews.push(childView);\r\n    this.setChildViews(childViews);\r\n    const $parentContainer = this.$(this.constructor.childContainer);\r\n    switch (childView.model.get('_renderPosition')) {\r\n      case 'outer-append':\r\n        // Useful for trickle buttons, inline feedback etc\r\n        this.$el.append(childView.$el);\r\n        break;\r\n      case 'inner-append':\r\n      default:\r\n        $parentContainer.append(childView.$el);\r\n        break;\r\n    }\r\n    // Signify that a child has been added to the view to enable updates to status bars\r\n    Adapt.trigger('view:childAdded', this, childView);\r\n    return childView;\r\n  }\r\n\r\n  /**\r\n   * Iterates through existing childViews and runs addChildren on them, resolving\r\n   * the total count of views added asynchronously.\r\n   * @returns {number} Count of views added\r\n   */\r\n  async addDescendants() {\r\n    let addedDescendantCount = 0;\r\n    const childViews = this.getChildViews();\r\n    if (!childViews) {\r\n      return addedDescendantCount;\r\n    }\r\n    for (let i = 0, l = childViews.length; i < l; i++) {\r\n      const view = childViews[i];\r\n      addedDescendantCount = view.addChildren ? await view.addChildren() : 0;\r\n      if (addedDescendantCount) {\r\n        break;\r\n      }\r\n    }\r\n    if (!addedDescendantCount) {\r\n      this.model.checkReadyStatus();\r\n      return addedDescendantCount;\r\n    }\r\n    // Descendants were added, unset _isReady\r\n    this.model.set('_isReady', false);\r\n    return addedDescendantCount;\r\n  }\r\n\r\n  /**\r\n   * Resolves after outstanding asynchronous view additions are finished\r\n   * and ready.\r\n   */\r\n  async whenReady() {\r\n    if (this.model.get('_isReady')) return;\r\n    return new Promise(resolve => {\r\n      const onReadyChange = (model, value) => {\r\n        if (!value) return;\r\n        this.stopListening(this.model, 'change:_isReady', onReadyChange);\r\n        resolve();\r\n      };\r\n      this.listenTo(this.model, 'change:_isReady', onReadyChange);\r\n      this.model.checkReadyStatus();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Triggers and returns a new ChildEvent object for render control.\r\n   * This function is used by addChildren to manage event triggering.\r\n   * @param {AdaptModel} model\r\n   * @returns {ChildEvent}\r\n   */\r\n  _getAddChildEvent(model) {\r\n    const isRequestChild = (!model);\r\n    let event = new ChildEvent(null, this, model);\r\n    if (isRequestChild) {\r\n      // No model has been supplied, we are at the end of the available child list\r\n      const canRequestChild = this.model.get('_canRequestChild');\r\n      if (!canRequestChild) {\r\n        // This model cannot request children\r\n        return;\r\n      }\r\n      event.type = 'requestChild';\r\n      // Send a request asking for a new model\r\n      Adapt.trigger('view:requestChild', event);\r\n      if (!event.hasRequestChild) {\r\n        // No new model was supplied\r\n        // Close the event so that the final state can be scrutinized\r\n        event.close();\r\n        return;\r\n      }\r\n      // A new model has been supplied for the end of the list.\r\n    }\r\n    // Trigger an event to signify that a new model is to be added\r\n    event.type = 'addChild';\r\n    Adapt.trigger('view:addChild', event);\r\n    // Close the event so that the final state can be scrutinized\r\n    event.close();\r\n    return event;\r\n  }\r\n\r\n  /**\r\n   * Return an array of all child and descendant views.\r\n   * @param {boolean} [isParentFirst=false] Array returns with parents before children\r\n   * @returns {[AdaptView]}\r\n   */\r\n  findDescendantViews(isParentFirst) {\r\n    const descendants = [];\r\n    const childViews = this.getChildViews();\r\n    childViews?.forEach(view => {\r\n      if (isParentFirst) descendants.push(view);\r\n      const children = view.findDescendantViews?.(isParentFirst);\r\n      if (children) descendants.push(...children);\r\n      if (!isParentFirst) descendants.push(view);\r\n    });\r\n    return descendants;\r\n  }\r\n\r\n  setReadyStatus() {\r\n    this.model.set('_isReady', true);\r\n  }\r\n\r\n  setCompletionStatus() {\r\n    if (!this.model.get('_isVisible')) return;\r\n    this.model.set({\r\n      _isComplete: true,\r\n      _isInteractionComplete: true\r\n    });\r\n  }\r\n\r\n  resetCompletionStatus(type) {\r\n    if (!this.model.get('_canReset')) return;\r\n\r\n    const descendantComponents = this.model.findDescendantModels('component');\r\n    if (descendantComponents.length === 0) {\r\n      this.model.reset(type);\r\n    } else {\r\n      descendantComponents.forEach(model => model.reset(type));\r\n    }\r\n  }\r\n\r\n  preRemove() {\r\n    const type = this.constructor.type;\r\n    Adapt.trigger(`${type}View:preRemove view:preRemove`, this);\r\n  }\r\n\r\n  remove() {\r\n    const type = this.constructor.type;\r\n    this.preRemove();\r\n    Adapt.trigger(`${type}View:remove view:remove`, this);\r\n    this._isRemoved = true;\r\n    this.stopListening();\r\n\r\n    Adapt.wait.for(end => {\r\n      if (this.isReact) {\r\n        ReactDOM.unmountComponentAtNode(this.el);\r\n      }\r\n      this.$el.off('onscreen.adaptView');\r\n      super.remove();\r\n      _.defer(() => {\r\n        Adapt.trigger(`${type}View:postRemove view:postRemove`, this);\r\n      });\r\n      end();\r\n    });\r\n\r\n    return this;\r\n  }\r\n\r\n  setVisibility() {\r\n    return this.model.get('_isVisible') ? '' : 'u-visibility-hidden';\r\n  }\r\n\r\n  toggleVisibility() {\r\n    this.$el.toggleClass('u-visibility-hidden', !this.model.get('_isVisible'));\r\n  }\r\n\r\n  setHidden() {\r\n    return this.model.get('_isHidden') ? 'u-display-none' : '';\r\n  }\r\n\r\n  toggleHidden() {\r\n    this.$el.toggleClass('u-display-none', this.model.get('_isHidden'));\r\n  }\r\n\r\n  onIsCompleteChange(model, isComplete) {\r\n    this.$el.toggleClass('is-complete', isComplete);\r\n  }\r\n\r\n  /**\r\n   * @returns {[AdaptView]}\r\n   */\r\n  getChildViews() {\r\n    if (!this._childViews) return this._childViews;\r\n    // Allow both a deprecated id/view map or a new array of child views\r\n    return Object.entries(this._childViews).map(([key, value]) => value);\r\n  }\r\n\r\n  /**\r\n   * @param {[AdaptView]} value\r\n   */\r\n  setChildViews(value) {\r\n    this._childViews = value;\r\n  }\r\n\r\n  /**\r\n   * Returns an indexed by id list of child views.\r\n   * @deprecated since 5.7.0\r\n   * @returns {{<string, AdaptView}}\r\n   */\r\n  get childViews() {\r\n    Adapt.log.deprecated(`view.childViews use view.getChildViews() and view.setChildViews([])`);\r\n    if (Array.isArray(this._childViews)) {\r\n      return _.indexBy(this._childViews, view => view.model.get('_id'));\r\n    }\r\n    return this._childViews;\r\n  }\r\n\r\n  /**\r\n   * Sets an indexed by id list of child views.\r\n   * @deprecated since 5.7.0\r\n   */\r\n  set childViews(value) {\r\n    Adapt.log.deprecated(`view.childViews use view.getChildViews() and view.setChildViews([])`);\r\n    this.setChildViews(value);\r\n  }\r\n\r\n}\r\n\r\nAdaptView.className = '';\r\n\r\nexport default AdaptView;\r\n","import Adapt from 'core/js/adapt';\r\nimport AdaptView from 'core/js/views/adaptView';\r\n\r\nexport default class NotifyView extends Backbone.View {\r\n\r\n  className() {\r\n    return `notify ${this.model.get('_classes') || ''}`;\r\n  }\r\n\r\n  attributes () {\r\n    return Object.assign({\r\n      role: 'dialog',\r\n      'aria-labelledby': 'notify-heading',\r\n      'aria-modal': 'true'\r\n    }, this.model.get('_attributes'));\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      'click .js-notify-btn-alert': 'onAlertButtonClicked',\r\n      'click .js-notify-btn-prompt': 'onPromptButtonClicked',\r\n      'click .js-notify-close-btn': 'onCloseButtonClicked',\r\n      'click .js-notify-shadow-click': 'onShadowClicked'\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    _.bindAll(this, 'resetNotifySize', 'onKeyUp');\r\n    this.disableAnimation = Adapt.config.get('_disableAnimation') || false;\r\n    this.isOpen = false;\r\n    this.hasOpened = false;\r\n    this.setupEventListeners();\r\n    this.render();\r\n  }\r\n\r\n  setupEventListeners() {\r\n    this.listenTo(Adapt, {\r\n      'remove page:scrollTo': this.closeNotify,\r\n      'notify:resize': this.resetNotifySize,\r\n      'notify:cancel': this.cancelNotify,\r\n      'notify:close': this.closeNotify,\r\n      'device:resize': this.resetNotifySize\r\n    });\r\n    this.setupEscapeKey();\r\n  }\r\n\r\n  setupEscapeKey() {\r\n    $(window).on('keyup', this.onKeyUp);\r\n  }\r\n\r\n  onKeyUp(event) {\r\n    if (event.which !== 27) return;\r\n    event.preventDefault();\r\n    this.cancelNotify();\r\n  }\r\n\r\n  render() {\r\n    const data = this.model.toJSON();\r\n    const template = Handlebars.templates.notify;\r\n    // hide notify container\r\n    this.$el.css('visibility', 'hidden');\r\n    // attach popup + shadow\r\n    this.$el.html(template(data)).appendTo('body');\r\n    // hide popup\r\n    this.$('.notify__popup').css('visibility', 'hidden');\r\n    // show notify container\r\n    this.$el.css('visibility', 'visible');\r\n    this.showNotify();\r\n    return this;\r\n  }\r\n\r\n  onAlertButtonClicked(event) {\r\n    event.preventDefault();\r\n    // tab index preservation, notify must close before subsequent callback is triggered\r\n    this.closeNotify();\r\n    Adapt.trigger(this.model.get('_callbackEvent'), this);\r\n  }\r\n\r\n  onPromptButtonClicked(event) {\r\n    event.preventDefault();\r\n    // tab index preservation, notify must close before subsequent callback is triggered\r\n    this.closeNotify();\r\n    Adapt.trigger($(event.currentTarget).attr('data-event'), this);\r\n  }\r\n\r\n  onCloseButtonClicked(event) {\r\n    event.preventDefault();\r\n    // tab index preservation, notify must close before subsequent callback is triggered\r\n    this.cancelNotify();\r\n  }\r\n\r\n  onShadowClicked(event) {\r\n    event.preventDefault();\r\n    if (this.model.get('_closeOnShadowClick') === false) return;\r\n    this.cancelNotify();\r\n  }\r\n\r\n  cancelNotify() {\r\n    if (this.model.get('_isCancellable') === false) return;\r\n    // tab index preservation, notify must close before subsequent callback is triggered\r\n    this.closeNotify();\r\n    Adapt.trigger('notify:cancelled', this);\r\n  }\r\n\r\n  resetNotifySize() {\r\n    if (!this.hasOpened) return;\r\n    this.resizeNotify();\r\n  }\r\n\r\n  resizeNotify() {\r\n    const windowHeight = $(window).height();\r\n    const notifyHeight = this.$('.notify__popup-inner').outerHeight();\r\n    const isFullWindow = (notifyHeight >= windowHeight);\r\n    this.$('.notify__popup').css({\r\n      'height': isFullWindow ? '100%' : 'auto',\r\n      'top': isFullWindow ? 0 : '',\r\n      'margin-top': isFullWindow ? '' : -(notifyHeight / 2),\r\n      'overflow-y': isFullWindow ? 'scroll' : '',\r\n      '-webkit-overflow-scrolling': isFullWindow ? 'touch' : ''\r\n    });\r\n  }\r\n\r\n  async showNotify() {\r\n    this.isOpen = true;\r\n    await this.addSubView();\r\n    // Add to the list of open popups\r\n    Adapt.notify.stack.push(this);\r\n    // Keep focus from previous action\r\n    this.$previousActiveElement = $(document.activeElement);\r\n    Adapt.trigger('notify:opened', this);\r\n    this.$el.imageready(this.onLoaded.bind(this));\r\n  }\r\n\r\n  onLoaded() {\r\n    if (this.disableAnimation) {\r\n      this.$('.notify__shadow').css('display', 'block');\r\n    } else {\r\n      this.$('.notify__shadow').velocity({ opacity: 0 }, { duration: 0 }).velocity({ opacity: 1 }, { duration: 400,\r\n        begin: () => {\r\n          this.$('.notify__shadow').css('display', 'block');\r\n        }\r\n      });\r\n    }\r\n    this.resizeNotify();\r\n    if (this.disableAnimation) {\r\n      this.$('.notify__popup').css('visibility', 'visible');\r\n      this.onOpened();\r\n    } else {\r\n      this.$('.notify__popup').velocity({ opacity: 0 }, { duration: 0 }).velocity({ opacity: 1 }, { duration: 400,\r\n        begin: () => {\r\n          // Make sure to make the notify visible and then set\r\n          // focus, disabled scroll and manage tabs\r\n          this.$('.notify__popup').css('visibility', 'visible');\r\n          this.onOpened();\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  onOpened() {\r\n    $.inview();\r\n    this.hasOpened = true;\r\n    // Allows popup manager to control focus\r\n    Adapt.a11y.popupOpened(this.$('.notify__popup'));\r\n    Adapt.a11y.scrollDisable('body');\r\n    $('html').addClass('notify');\r\n    // Set focus to first accessible element\r\n    Adapt.a11y.focusFirst(this.$('.notify__popup'), { defer: false });\r\n  }\r\n\r\n  async addSubView() {\r\n    this.subView = this.model.get('_view');\r\n    if (this.model.get('_id')) {\r\n      // Automatically render the specified id\r\n      const model = Adapt.findById(this.model.get('_id'));\r\n      const View = Adapt.getViewClass(model);\r\n      this.subView = new View({ model });\r\n    }\r\n    if (!this.subView) return;\r\n    this.subView.$el.on('resize', this.resetNotifySize);\r\n    this.$('.notify__content-inner').prepend(this.subView.$el);\r\n    if (!(this.subView instanceof AdaptView) || this.subView.model.get('_isReady')) return;\r\n    // Wait for the AdaptView subview to be ready\r\n    return new Promise(resolve => {\r\n      const check = (model, value) => {\r\n        if (!value) return;\r\n        this.subView.model.off('change:_isReady', check);\r\n        resolve();\r\n      };\r\n      this.subView.model.on('change:_isReady', check);\r\n    });\r\n  }\r\n\r\n  closeNotify() {\r\n    // Make sure that only the top most notify is closed\r\n    const stackItem = Adapt.notify.stack[Adapt.notify.stack.length - 1];\r\n    if (this !== stackItem) return;\r\n    Adapt.notify.stack.pop();\r\n    // Prevent from being invoked multiple times - see https://github.com/adaptlearning/adapt_framework/issues/1659\r\n    if (!this.isOpen) return;\r\n    this.isOpen = false;\r\n    // If closeNotify is called before showNotify has finished then wait\r\n    // until it's open.\r\n    if (this.hasOpened) {\r\n      this.onCloseReady();\r\n      return;\r\n    }\r\n    this.listenToOnce(Adapt, 'popup:opened', () => {\r\n      // Wait for popup:opened to finish processing\r\n      _.defer(this.onCloseReady.bind(this));\r\n    });\r\n  }\r\n\r\n  onCloseReady() {\r\n    if (this.disableAnimation) {\r\n      this.$('.notify__popup').css('visibility', 'hidden');\r\n      this.$el.css('visibility', 'hidden');\r\n      this.remove();\r\n    } else {\r\n      this.$('.notify__popup').velocity({ opacity: 0 }, { duration: 400,\r\n        complete: () => {\r\n          this.$('.notify__popup').css('visibility', 'hidden');\r\n        }\r\n      });\r\n      this.$('.notify__shadow').velocity({ opacity: 0 }, { duration: 400,\r\n        complete: () => {\r\n          this.$el.css('visibility', 'hidden');\r\n          this.remove();\r\n        }\r\n      });\r\n    }\r\n    Adapt.a11y.scrollEnable('body');\r\n    $('html').removeClass('notify');\r\n    // Return focus to previous active element\r\n    Adapt.a11y.popupClosed(this.$previousActiveElement);\r\n    // Return reference to the notify view\r\n    Adapt.trigger('notify:closed', this);\r\n  }\r\n\r\n  remove(...args) {\r\n    this.removeSubView();\r\n    $(window).off('keyup', this.onKeyUp);\r\n    super.remove(...args);\r\n  }\r\n\r\n  removeSubView() {\r\n    if (!this.subView) return;\r\n    this.subView.$el.off('resize', this.resetNotifySize);\r\n    if (this.subView instanceof AdaptView) {\r\n      // Clear up nested views and models\r\n      const views = [...this.subView.findDescendantViews(), this.subView];\r\n      views.forEach(view => {\r\n        view.model.set('_isReady', false);\r\n        view.remove();\r\n      });\r\n    } else {\r\n      this.subView.remove();\r\n    }\r\n    this.subView = null;\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport NotifyPushCollection from 'core/js/collections/notifyPushCollection';\r\nimport NotifyView from 'core/js/views/notifyView';\r\nimport NotifyModel from 'core/js/models/notifyModel';\r\n\r\nclass Notify extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this._stack = [];\r\n    this.notifyPushes = new NotifyPushCollection();\r\n    this.listenTo(Adapt, {\r\n      'notify:popup': this._deprecated.bind(this, 'popup'),\r\n      'notify:alert': this._deprecated.bind(this, 'alert'),\r\n      'notify:prompt': this._deprecated.bind(this, 'prompt'),\r\n      'notify:push': this._deprecated.bind(this, 'push')\r\n    });\r\n  }\r\n\r\n  get stack() {\r\n    return this._stack;\r\n  }\r\n\r\n  _deprecated(type, notifyObject) {\r\n    Adapt.log.deprecated(`NOTIFY DEPRECATED: Adapt.trigger('notify:${type}', notifyObject); is no longer supported, please use Adapt.notify.${type}(notifyObject);`);\r\n    return this.create(notifyObject, { _type: type });\r\n  }\r\n\r\n  create(notifyObject, defaults) {\r\n    notifyObject = _.defaults({}, notifyObject, defaults, {\r\n      _type: 'popup',\r\n      _isCancellable: true,\r\n      _showCloseButton: true,\r\n      _closeOnShadowClick: true\r\n    });\r\n\r\n    if (notifyObject._type === 'push') {\r\n      this.notifyPushes.push(notifyObject);\r\n      return;\r\n    }\r\n\r\n    return new NotifyView({\r\n      model: new NotifyModel(notifyObject)\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Creates a 'popup' notify\r\n   * @param {Object} notifyObject An object containing all the settings for the popup\r\n   * @param {string} notifyObject.title Title of the popup\r\n   * @param {string} notifyObject.body Body of the popup\r\n   * @param {Boolean} [notifyObject._showCloseButton=true] If set to `false` the popup will not have a close button. The learner will still be able to dismiss the popup by clicking outside of it or by pressing the Esc key. This setting is typically used mainly for popups that have a subview (where the subview contains the close button)\r\n   * @param {Boolean} [notifyObject._isCancellable=true] If set to `false` the learner will not be able to close the popup - use with caution!\r\n   * @param {string} [notifyObject._classes] A class name or (space separated) list of class names you'd like to be applied to the popup's `<div>`\r\n   * @param {Backbone.View} [notifyObject._view] Subview to display in the popup instead of the standard view\r\n   */\r\n  popup(notifyObject) {\r\n    return this.create(notifyObject, { _type: 'popup' });\r\n  }\r\n\r\n  /**\r\n   * Creates an 'alert' notify popup\r\n   * @param {Object} notifyObject An object containing all the settings for the alert popup\r\n   * @param {string} notifyObject.title Title of the alert popup\r\n   * @param {string} notifyObject.body Body of the alert popup\r\n   * @param {string} notifyObject.confirmText Label for the popup confirm button\r\n   * @param {Boolean} [notifyObject._isCancellable=true] If set to `false` only the confirm button can be used to dismiss/close the popup\r\n   * @param {Boolean} [notifyObject._showIcon=false] If set to `true` an 'alert' icon will be displayed in the popup\r\n   * @param {string} [notifyObject._callbackEvent] Event to trigger when the confirm button is clicked\r\n   * @param {string} [notifyObject._classes] A class name or (space separated) list of class names you'd like to be applied to the popup's `<div>`\r\n   * @param {Backbone.View} [notifyObject._view] Subview to display in the popup instead of the standard view\r\n   */\r\n  alert(notifyObject) {\r\n    return this.create(notifyObject, { _type: 'alert' });\r\n  }\r\n\r\n  /**\r\n   * Creates a 'prompt dialog' notify popup\r\n   * @param {Object} notifyObject An object containing all the settings for the prompt dialog\r\n   * @param {string} notifyObject.title Title of the prompt\r\n   * @param {string} notifyObject.body Body of the prompt\r\n   * @param {Object[]} notifyObject._prompts Array of objects that each define a button (and associated callback event) that you want shown in the prompt\r\n   * @param {string} notifyObject._prompts[].promptText Label for this button\r\n   * @param {string} notifyObject._prompts[]._callbackEvent Event to be triggered when this button is clicked\r\n   * @param {Boolean} [notifyObject._isCancellable=true] If set to `false` only the confirm button can be used to dismiss/close the prompt\r\n   * @param {Boolean} [notifyObject._showIcon=true] If set to `true` a 'query' icon will be displayed in the popup\r\n   * @param {string} [notifyObject._callbackEvent] Event to trigger when the confirm button is clicked\r\n   * @param {string} [notifyObject._classes] A class name or (space separated) list of class names you'd like to be applied to the popup's `<div>`\r\n   * @param {Backbone.View} [notifyObject._view] Subview to display in the popup instead of the standard view\r\n   */\r\n  prompt(notifyObject) {\r\n    return this.create(notifyObject, { _type: 'prompt' });\r\n  }\r\n\r\n  /**\r\n   * Creates a 'push notification'\r\n   * @param {Object} notifyObject An object containing all the settings for the push notification\r\n   * @param {string} notifyObject.title Title of the push notification\r\n   * @param {string} notifyObject.body Body of the push notification\r\n   * @param {Number} [notifyObject._timeout=3000] Length of time (in milliseconds) the notification should left on-screen before automatically fading away\r\n   * @param {string} notifyObject._callbackEvent Event to be triggered if the learner clicks on the push notification (not triggered if they use the close button)\r\n   * @param {string} [notifyObject._classes] A class name or (space separated) list of class names you'd like to be applied to the popup's `<div>`\r\n   */\r\n  push(notifyObject) {\r\n    return this.create(notifyObject, { _type: 'push' });\r\n  }\r\n\r\n}\r\n\r\nexport default (Adapt.notify = new Notify());\r\n","import LockingModel from 'core/js/models/lockingModel';\r\n\r\nexport default class RouterModel extends LockingModel {\r\n\r\n  defaults() {\r\n    return {\r\n      _canNavigate: true,\r\n      _shouldNavigateFocus: true\r\n    };\r\n  }\r\n\r\n  lockedAttributes() {\r\n    return {\r\n      _canNavigate: false,\r\n      _shouldNavigateFocus: false\r\n    };\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport RouterModel from 'core/js/models/routerModel';\r\nimport CourseModel from 'core/js/models/courseModel';\r\nimport ContentObjectModel from 'core/js/models/contentObjectModel';\r\nimport MenuModel from 'core/js/models/menuModel';\r\nimport 'core/js/startController';\r\n\r\nclass Router extends Backbone.Router {\r\n\r\n  routes() {\r\n    return {\r\n      '': 'handleRoute',\r\n      'id/:id': 'handleRoute',\r\n      ':pluginName(/*location)(/*action)': 'handleRoute'\r\n    };\r\n  }\r\n\r\n  initialize({ model }) {\r\n    this._isBackward = false;\r\n    this.model = model;\r\n    this._navigationRoot = null;\r\n    // Flag to indicate if the router has tried to redirect to the current location.\r\n    this._isCircularNavigationInProgress = false;\r\n    this.showLoading();\r\n    // Store #wrapper element and html to cache for later use.\r\n    this.$wrapper = $('#wrapper');\r\n    this.$html = $('html');\r\n    this.listenToOnce(Adapt, 'app:dataReady', this.setDocumentTitle);\r\n    this.listenTo(Adapt, 'router:navigateTo', this.navigateToArguments);\r\n  }\r\n\r\n  get rootModel() {\r\n    return this._navigationRoot || Adapt.course;\r\n  }\r\n\r\n  set rootModel(model) {\r\n    this._navigationRoot = model;\r\n  }\r\n\r\n  showLoading() {\r\n    $('.js-loading').show();\r\n  }\r\n\r\n  hideLoading() {\r\n    $('.js-loading').hide();\r\n  }\r\n\r\n  setDocumentTitle() {\r\n    const currentModel = Adapt.location._currentModel;\r\n    const hasSubTitle = (currentModel && currentModel !== Adapt.router.rootModel && currentModel.get('title'));\r\n    const title = [\r\n      this.rootModel.get('title'),\r\n      hasSubTitle && currentModel.get('title')\r\n    ].filter(Boolean).join(' | ');\r\n    this.listenToOnce(Adapt, 'contentObjectView:preRender', () => {\r\n      const escapedTitle = $(`<div>${title}</div>`).text();\r\n      document.title = escapedTitle;\r\n    });\r\n  }\r\n\r\n  navigateToArguments(args) {\r\n    args = args.filter(v => v !== null);\r\n    const options = { trigger: false, replace: false };\r\n    if (args.length === 1 && Adapt.findById(args[0])) {\r\n      this.navigate('#/id/' + args[0], options);\r\n      return;\r\n    }\r\n    if (args.length <= 3) {\r\n      this.navigate('#/' + args.join('/'), options);\r\n      return;\r\n    }\r\n    Adapt.log.deprecated(`Use Backbone.history.navigate or window.location.href instead of Adapt.trigger('router:navigateTo')`);\r\n    this.handleRoute(...args);\r\n  }\r\n\r\n  handleRoute(...args) {\r\n    args = args.filter(v => v !== null);\r\n\r\n    if (this.model.get('_canNavigate')) {\r\n      // Reset _isCircularNavigationInProgress protection as code is allowed to navigate away.\r\n      this._isCircularNavigationInProgress = false;\r\n    }\r\n\r\n    // Check if the current page is in the process of navigating to itself.\r\n    // It will redirect to itself if the URL was changed and _canNavigate is false.\r\n    if (this._isCircularNavigationInProgress === false) {\r\n      // Trigger an event pre 'router:location' to allow extensions to stop routing.\r\n      Adapt.trigger('router:navigate', args);\r\n    }\r\n\r\n    // Re-check as _canNavigate can be set to false on 'router:navigate' event.\r\n    if (this.model.get('_canNavigate')) {\r\n      // Disable navigation whilst rendering.\r\n      this.model.set('_canNavigate', false, { pluginName: 'adapt' });\r\n      this._isBackward = false;\r\n      if (args.length <= 1) {\r\n        return this.handleId(...args);\r\n      }\r\n      return this.handlePluginRouter(...args);\r\n    }\r\n\r\n    if (this._isCircularNavigationInProgress) {\r\n      // Navigation correction finished.\r\n      // Router has successfully re-navigated to the current _id as the URL was changed\r\n      // while _canNavigate: false\r\n      this._isCircularNavigationInProgress = false;\r\n      return;\r\n    }\r\n\r\n    // Cancel navigation to stay at the current location.\r\n    this._isCircularNavigationInProgress = true;\r\n    Adapt.trigger('router:navigationCancelled', args);\r\n\r\n    // Reset URL to the current one.\r\n    // https://github.com/adaptlearning/adapt_framework/issues/3061\r\n    Backbone.history.history[this._isBackward ? 'forward' : 'back']();\r\n    this._isBackward = false;\r\n  }\r\n\r\n  async handlePluginRouter(pluginName, location, action) {\r\n    const pluginLocation = [\r\n      pluginName,\r\n      location && `-${location}`,\r\n      action && `-${action}`\r\n    ].filter(Boolean).join('');\r\n    await this.updateLocation(pluginLocation, null, null, null);\r\n\r\n    Adapt.trigger('router:plugin:' + pluginName, pluginName, location, action);\r\n    Adapt.trigger('router:plugin', pluginName, location, action);\r\n    this.model.set('_canNavigate', true, { pluginName: 'adapt' });\r\n  }\r\n\r\n  async handleId(id) {\r\n    const rootModel = Adapt.router.rootModel;\r\n    let model = (!id) ? rootModel : Adapt.findById(id);\r\n\r\n    if (!model) {\r\n      // Bad id\r\n      this.model.set('_canNavigate', true, { pluginName: 'adapt' });\r\n      return;\r\n    }\r\n\r\n    // Keep the routed id incase it needs to be scrolled to later\r\n    const isContentObject = (model instanceof ContentObjectModel);\r\n    const navigateToId = model.get('_id');\r\n\r\n    // Ensure that the router is rendering a contentobject\r\n    model = isContentObject ? model : model.findAncestor('contentobject');\r\n    id = model.get('_id');\r\n\r\n    const isRoot = (model === rootModel);\r\n    if (isRoot && Adapt.course.has('_start')) {\r\n      // Do not allow access to the menu when the start controller is enabled.\r\n      const startController = Adapt.course.get('_start');\r\n      if (startController._isEnabled === true && startController._isMenuDisabled === true) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    if (model.get('_isLocked') && Adapt.config.get('_forceRouteLocking')) {\r\n      // Locked id\r\n      Adapt.log.warn('Unable to navigate to locked id: ' + id);\r\n      this.model.set('_canNavigate', true, { pluginName: 'adapt' });\r\n      if (Adapt.location._previousId === undefined) {\r\n        return this.navigate('#/', { trigger: true, replace: true });\r\n      }\r\n      return this.navigateBack();\r\n    }\r\n\r\n    // Move to a content object\r\n    this.showLoading();\r\n    await Adapt.remove();\r\n\r\n    /**\r\n     * TODO:\r\n     * As the course object has separate location and type rules,\r\n     * it makes it more difficult to update the Adapt.location object\r\n     * should stop doing this.\r\n     */\r\n    const isCourse = (model instanceof CourseModel);\r\n    const type = isCourse ? 'menu' : model.get('_type');\r\n    const location = isCourse ? 'course' : `${type}-${id}`;\r\n\r\n    model.set('_isVisited', true);\r\n    await this.updateLocation(location, type, id, model);\r\n\r\n    Adapt.once('contentObjectView:ready', () => {\r\n      // Allow navigation.\r\n      this.model.set('_canNavigate', true, { pluginName: 'adapt' });\r\n      this.handleNavigationFocus();\r\n    });\r\n    Adapt.trigger(`router:${type} router:contentObject`, model);\r\n\r\n    const ViewClass = Adapt.getViewClass(model);\r\n    const isMenu = (model instanceof MenuModel);\r\n    if (!ViewClass && isMenu) {\r\n      Adapt.log.deprecated(`Using event based menu view instantiation for '${Adapt.getViewName(model)}'`);\r\n      return;\r\n    }\r\n\r\n    if (!isMenu) {\r\n      // checkIfResetOnRevisit where exists on descendant models before render\r\n      _.invoke(model.getAllDescendantModels(), 'checkIfResetOnRevisit');\r\n      // wait for completion to settle\r\n      await Adapt.deferUntilCompletionChecked();\r\n    }\r\n\r\n    this.$wrapper.append(new ViewClass({ model }).$el);\r\n\r\n    if (!isContentObject && !this.isScrolling) {\r\n      // Scroll to element if not a content object or not already trying to\r\n      await Adapt.navigateToElement('.' + navigateToId, { replace: true, duration: 400 });\r\n    }\r\n\r\n  }\r\n\r\n  async updateLocation(currentLocation, type, id, currentModel) {\r\n    // Handles updating the location.\r\n    Adapt.location._previousModel = Adapt.location._currentModel;\r\n    Adapt.location._previousId = Adapt.location._currentId;\r\n    Adapt.location._previousContentType = Adapt.location._contentType;\r\n\r\n    Adapt.location._currentModel = currentModel;\r\n    Adapt.location._currentId = id;\r\n    Adapt.location._contentType = type;\r\n    Adapt.location._currentLocation = currentLocation;\r\n\r\n    /**\r\n     * TODO:\r\n     * this if block should be removed,\r\n     * these properties are unused in the framework\r\n     */\r\n    if (type === 'menu') {\r\n      Adapt.location._lastVisitedType = 'menu';\r\n      Adapt.location._lastVisitedMenu = id;\r\n    } else if (type === 'page') {\r\n      Adapt.location._lastVisitedType = 'page';\r\n      Adapt.location._lastVisitedPage = id;\r\n    }\r\n\r\n    this.setDocumentTitle();\r\n    this.setGlobalClasses();\r\n\r\n    // Trigger event when location changes.\r\n    Adapt.trigger('router:location', Adapt.location);\r\n\r\n    await Adapt.wait.queue();\r\n  }\r\n\r\n  setGlobalClasses() {\r\n    const currentModel = Adapt.location._currentModel;\r\n\r\n    const htmlClasses = currentModel?.get('_htmlClasses') || '';\r\n    const classes = (Adapt.location._currentId) ?\r\n      `location-${Adapt.location._contentType} location-id-${Adapt.location._currentId}` :\r\n      `location-${Adapt.location._currentLocation}`;\r\n    const currentClasses = `${classes} ${htmlClasses}`;\r\n\r\n    this.$html\r\n      .removeClass(Adapt.location._previousClasses)\r\n      .addClass(currentClasses)\r\n      .attr('data-location', Adapt.location._currentLocation);\r\n\r\n    this.$wrapper\r\n      .removeClass()\r\n      .addClass(classes)\r\n      .attr('data-location', Adapt.location._currentLocation);\r\n\r\n    Adapt.location._previousClasses = currentClasses;\r\n  }\r\n\r\n  handleNavigationFocus() {\r\n    if (!this.model.get('_shouldNavigateFocus')) return;\r\n    // Body will be forced to accept focus to start the\r\n    // screen reader reading the page.\r\n    Adapt.a11y.focus('body');\r\n  }\r\n\r\n  navigateBack() {\r\n    this._isBackward = true;\r\n    Backbone.history.history.back();\r\n  }\r\n\r\n  navigateToCurrentRoute(force) {\r\n    if (!this.model.get('_canNavigate') && !force) {\r\n      return;\r\n    }\r\n    if (!Adapt.location._currentId) {\r\n      return;\r\n    }\r\n    const currentId = Adapt.location._currentModel.get('_id');\r\n    const isRoot = (Adapt.location._currentModel === this.rootModel);\r\n    const route = isRoot ? '#/' : '#/id/' + currentId;\r\n    this.navigate(route, { trigger: true, replace: true });\r\n  }\r\n\r\n  navigateToPreviousRoute(force) {\r\n    // Sometimes a plugin might want to stop the default navigation.\r\n    // Check whether default navigation has changed.\r\n    if (!this.model.get('_canNavigate') && !force) {\r\n      return;\r\n    }\r\n    const currentModel = Adapt.location._currentModel;\r\n    const previousModel = Adapt.location._previousModel;\r\n    if (!currentModel) {\r\n      return this.navigateBack();\r\n    }\r\n    if (Adapt.location._currentModel instanceof MenuModel) {\r\n      return this.navigateToParent();\r\n    }\r\n    if (previousModel) {\r\n      return this.navigateBack();\r\n    }\r\n    this.navigateToParent();\r\n  }\r\n\r\n  navigateToParent(force) {\r\n    if (!this.model.get('_canNavigate') && !force) {\r\n      return;\r\n    }\r\n    const parentId = Adapt.location._currentModel.get('_parentId');\r\n    const parentModel = Adapt.findById(parentId);\r\n    const isRoot = (parentModel === this.rootModel);\r\n    const route = isRoot ? '#/' : '#/id/' + parentId;\r\n    this.navigate(route, { trigger: true });\r\n  }\r\n\r\n  navigateToHomeRoute(force) {\r\n    if (!this.model.get('_canNavigate') && !force) {\r\n      return;\r\n    }\r\n    this.navigate('#/', { trigger: true });\r\n  }\r\n\r\n  /**\r\n   * Allows a selector or id to be passed in and Adapt will navigate to this element. Resolves\r\n   * asynchronously when the element has been navigated to.\r\n   * Backend for Adapt.navigateToElement\r\n   * @param {string} selector CSS selector or id of the Adapt element you want to navigate to e.g. `\".co-05\"` or `\"co-05\"`\r\n   * @param {Object} [settings] The settings for the `$.scrollTo` function (See https://github.com/flesler/jquery.scrollTo#settings).\r\n   * @param {Object} [settings.replace=false] Set to `true` if you want to update the URL without creating an entry in the browser's history.\r\n   */\r\n  async navigateToElement(selector, settings = {}) {\r\n    const currentModelId = selector.replace(/\\./g, '').split(' ')[0];\r\n    const currentModel = Adapt.findById(currentModelId);\r\n\r\n    if (currentModel && (!currentModel.get('_isRendered') || !currentModel.get('_isReady'))) {\r\n      const shouldReplace = settings.replace || false;\r\n      const contentObject = (currentModel instanceof ContentObjectModel) ? currentModel : currentModel.findAncestor('contentobject');\r\n      const contentObjectId = contentObject.get('_id');\r\n      const isNotInCurrentContentObject = (contentObjectId !== Adapt.location._currentId);\r\n      if (isNotInCurrentContentObject) {\r\n        this.isScrolling = true;\r\n        this.navigate(`#/id/${currentModelId}`, { trigger: true, replace: shouldReplace });\r\n        this.model.set('_shouldNavigateFocus', false, { pluginName: 'adapt' });\r\n        await new Promise(resolve => Adapt.once('contentObjectView:ready', _.debounce(() => {\r\n          this.model.set('_shouldNavigateFocus', true, { pluginName: 'adapt' });\r\n          resolve();\r\n        }, 1)));\r\n        this.isScrolling = false;\r\n      }\r\n      await Adapt.parentView.renderTo(currentModelId);\r\n    }\r\n\r\n    // Correct selector when passed a pure id\r\n    if (currentModel && selector === currentModel.get('_id')) {\r\n      selector = `.${selector}`;\r\n    }\r\n\r\n    // Get the current location - this is set in the router\r\n    const location = (Adapt.location._contentType) ?\r\n      Adapt.location._contentType : Adapt.location._currentLocation;\r\n    // Trigger initial scrollTo event\r\n    Adapt.trigger(`${location}:scrollTo`, selector);\r\n    // Setup duration variable\r\n    const disableScrollToAnimation = Adapt.config.has('_disableAnimation') ? Adapt.config.get('_disableAnimation') : false;\r\n    if (disableScrollToAnimation) {\r\n      settings.duration = 0;\r\n    } else if (!settings.duration) {\r\n      settings.duration = $.scrollTo.defaults.duration;\r\n    }\r\n\r\n    let offsetTop = 0;\r\n    if (Adapt.scrolling.isLegacyScrolling) {\r\n      offsetTop = -$('.nav').outerHeight();\r\n      // prevent scroll issue when component description aria-label coincident with top of component\r\n      if ($(selector).hasClass('component')) {\r\n        offsetTop -= $(selector).find('.aria-label').height() || 0;\r\n      }\r\n    }\r\n\r\n    if (!settings.offset) settings.offset = { top: offsetTop, left: 0 };\r\n    if (settings.offset.top === undefined) settings.offset.top = offsetTop;\r\n    if (settings.offset.left === undefined) settings.offset.left = 0;\r\n\r\n    if (settings.offset.left === 0) settings.axis = 'y';\r\n\r\n    if (Adapt.get('_canScroll') !== false) {\r\n      // Trigger scrollTo plugin\r\n      $.scrollTo(selector, settings);\r\n    }\r\n\r\n    // Trigger an event after animation\r\n    // 300 milliseconds added to make sure queue has finished\r\n    await new Promise(resolve => {\r\n      _.delay(() => {\r\n        Adapt.a11y.focusNext(selector);\r\n        Adapt.trigger(`${location}:scrolledTo`, selector);\r\n        resolve();\r\n      }, settings.duration + 300);\r\n    });\r\n  }\r\n\r\n  get(...args) {\r\n    Adapt.log.deprecated('Adapt.router.get, please use Adapt.router.model.get');\r\n    return this.model.get(...args);\r\n  }\r\n\r\n  set(...args) {\r\n    Adapt.log.deprecated('Adapt.router.set, please use Adapt.router.model.set');\r\n    return this.model.set(...args);\r\n  }\r\n\r\n}\r\n\r\nAdapt.router = new Router({\r\n  model: new RouterModel(null, { reset: true })\r\n});\r\n\r\nAdapt.navigateToElement = Adapt.router.navigateToElement.bind(Adapt.router);\r\n\r\nexport default Adapt.router;\r\n","import AdaptCollection from 'core/js/collections/adaptCollection';\r\n\r\nexport default class AdaptSubsetCollection extends AdaptCollection {\r\n\r\n  initialize(models, options) {\r\n    super.initialize(models, options);\r\n    this.parent = options.parent;\r\n    this.listenTo(this.parent, 'reset', this.loadSubset);\r\n  }\r\n\r\n  loadSubset() {\r\n    this.set(this.parent.filter(model => model instanceof this.model));\r\n    this._byAdaptID = this.groupBy('_id');\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport AdaptModel from 'core/js/models/adaptModel';\r\n\r\nclass ArticleModel extends AdaptModel {\r\n\r\n  get _parent() {\r\n    Adapt.log.deprecated('articleModel._parent, use articleModel.getParent() instead, parent models are defined by the JSON');\r\n    return 'contentObjects';\r\n  }\r\n\r\n  get _siblings() {\r\n    Adapt.log.deprecated('articleModel._siblings, use articleModel.getSiblings() instead, sibling models are defined by the JSON');\r\n    return 'articles';\r\n  }\r\n\r\n  get _children() {\r\n    Adapt.log.deprecated('articleModel._children, use articleModel.hasManagedChildren instead, child models are defined by the JSON');\r\n    return 'blocks';\r\n  }\r\n\r\n  /**\r\n   * Returns a string of the model type group.\r\n   * @returns {string}\r\n   */\r\n  getTypeGroup() {\r\n    return 'article';\r\n  }\r\n\r\n}\r\n\r\nAdapt.register('article', { model: ArticleModel });\r\n\r\nexport default ArticleModel;\r\n","import Adapt from 'core/js/adapt';\r\nimport AdaptModel from 'core/js/models/adaptModel';\r\n\r\nclass BlockModel extends AdaptModel {\r\n\r\n  get _parent() {\r\n    Adapt.log.deprecated('blockModel._parent, use blockModel.getParent() instead, parent models are defined by the JSON');\r\n    return 'articles';\r\n  }\r\n\r\n  get _siblings() {\r\n    Adapt.log.deprecated('blockModel._siblings, use blockModel.getSiblings() instead, sibling models are defined by the JSON');\r\n    return 'blocks';\r\n  }\r\n\r\n  get _children() {\r\n    Adapt.log.deprecated('blockModel._children, use blockModel.hasManagedChildren instead, child models are defined by the JSON');\r\n    return 'components';\r\n  }\r\n\r\n  /**\r\n   * Returns a string of the model type group.\r\n   * @returns {string}\r\n   */\r\n  getTypeGroup() {\r\n    return 'block';\r\n  }\r\n\r\n}\r\n\r\nAdapt.register('block', { model: BlockModel });\r\n\r\nexport default BlockModel;\r\n","import Adapt from 'core/js/adapt';\r\nimport AdaptModel from 'core/js/models/adaptModel';\r\n\r\nclass ComponentModel extends AdaptModel {\r\n\r\n  get _parent() {\r\n    Adapt.log.deprecated('componentModel._parent, use componentModel.getParent() instead, parent models are defined by the JSON');\r\n    return 'blocks';\r\n  }\r\n\r\n  get _siblings() {\r\n    Adapt.log.deprecated('componentModel._siblings, use componentModel.getSiblings() instead, sibling models are defined by the JSON');\r\n    return 'components';\r\n  }\r\n\r\n  /**\r\n   * Returns a string of the model type group.\r\n   * @returns {string}\r\n   */\r\n  getTypeGroup() {\r\n    return 'component';\r\n  }\r\n\r\n  defaults() {\r\n    return AdaptModel.resultExtend('defaults', {\r\n      _isA11yComponentDescriptionEnabled: true,\r\n      _userAnswer: null,\r\n      _attemptStates: null\r\n    });\r\n  }\r\n\r\n  trackable() {\r\n    return AdaptModel.resultExtend('trackable', [\r\n      '_userAnswer',\r\n      '_attemptStates'\r\n    ]);\r\n  }\r\n\r\n  trackableType() {\r\n    return AdaptModel.resultExtend('trackableType', [\r\n      Array,\r\n      Array\r\n    ]);\r\n  }\r\n\r\n  get hasManagedChildren() {\r\n    return false;\r\n  }\r\n\r\n  init() {\r\n    if (Adapt.get('_isStarted')) {\r\n      this.onAdaptInitialize();\r\n      return;\r\n    }\r\n    this.listenToOnce(Adapt, 'adapt:initialize', this.onAdaptInitialize);\r\n  }\r\n\r\n  onAdaptInitialize() {\r\n    this.restoreUserAnswers();\r\n  }\r\n\r\n  /**\r\n   * Restore the user's answer from the _userAnswer property.\r\n   * The _userAnswer value must be in the form of arrays containing\r\n   * numbers, booleans or arrays only.\r\n   */\r\n  restoreUserAnswers() {}\r\n\r\n  /**\r\n   * Store the user's answer in the _userAnswer property.\r\n   * The _userAnswer value must be in the form of arrays containing\r\n   * numbers, booleans or arrays only.\r\n   */\r\n  storeUserAnswer() {}\r\n\r\n  resetUserAnswer() {\r\n    this.set('_userAnswer', null);\r\n  }\r\n\r\n  reset(type, force) {\r\n    if (!this.get('_canReset') && !force) return;\r\n    this.resetUserAnswer();\r\n    super.reset(type, force);\r\n  }\r\n\r\n  /**\r\n   * Returns the current attempt state raw data or the raw data from the supplied attempt state object.\r\n   * @param {Object} [object] JSON object representing the component state. Defaults to current JSON.\r\n   * @returns {Array}\r\n   */\r\n  getAttemptState(object = this.toJSON()) {\r\n    const trackables = this.trackable();\r\n    const types = this.trackableType();\r\n    trackables.find((name, index) => {\r\n      // Exclude _attemptStates as it's trackable but isn't needed here\r\n      if (name !== '_attemptStates') return;\r\n      trackables.splice(index, 1);\r\n      types.splice(index, 1);\r\n      return true;\r\n    });\r\n    const values = trackables.map(n => object[n]);\r\n    const booleans = values.filter((v, i) => types[i] === Boolean).map(Boolean);\r\n    const numbers = values.filter((v, i) => types[i] === Number).map(v => Number(v) || 0);\r\n    const arrays = values.filter((v, i) => types[i] === Array);\r\n    return [\r\n      numbers,\r\n      booleans,\r\n      arrays\r\n    ];\r\n  }\r\n\r\n  /**\r\n   * Returns an attempt object representing the current state or a formatted version of the raw state object supplied.\r\n   * @param {Array} [state] JSON object representing the component state, defaults to current state returned from getAttemptState().\r\n   * @returns {Object}\r\n   */\r\n  getAttemptObject(state = this.getAttemptState()) {\r\n    const trackables = this.trackable();\r\n    const types = this.trackableType();\r\n    trackables.find((name, index) => {\r\n      // Exclude _attemptStates as it's trackable but isn't needed here\r\n      if (name !== '_attemptStates') return;\r\n      trackables.splice(index, 1);\r\n      types.splice(index, 1);\r\n      return true;\r\n    });\r\n    const numbers = (state[0] || []).slice(0);\r\n    const booleans = (state[1] || []).slice(0);\r\n    const arrays = (state[2] || []).slice(0);\r\n    const object = {};\r\n    trackables.forEach((n, i) => {\r\n      if (n === '_id') return;\r\n      switch (types[i]) {\r\n        case Number:\r\n          object[n] = numbers.shift();\r\n          break;\r\n        case Boolean:\r\n          object[n] = booleans.shift();\r\n          break;\r\n        case Array:\r\n          object[n] = arrays.shift();\r\n          break;\r\n      }\r\n    });\r\n    return object;\r\n  }\r\n\r\n  /**\r\n   * Sets the current attempt state from the supplied attempt state object.\r\n   * @param {Object} object JSON object representing the component state.\r\n   * @param {boolean} silent Stops change events from triggering\r\n   */\r\n  setAttemptObject(object, silent = true) {\r\n    this.set(object, { silent });\r\n  }\r\n\r\n  /**\r\n   * Adds the current attempt state object or the supplied state object to the attempts store.\r\n   * @param {Object} [object] JSON object representing the component state. Defaults to current JSON.\r\n   */\r\n  addAttemptObject(object = this.getAttemptObject()) {\r\n    const attemptStates = this.get('_attemptStates') || [];\r\n    const state = this.getAttemptState(object);\r\n    attemptStates.push(state);\r\n    this.set('_attemptStates', attemptStates);\r\n  }\r\n\r\n  /**\r\n   * Returns an array of the previous state objects. The most recent state is last in the list.\r\n   * @returns {Array}\r\n   */\r\n  getAttemptObjects() {\r\n    const states = this.get('_attemptStates') || [];\r\n    return states.map(state => this.getAttemptObject(state));\r\n  }\r\n\r\n}\r\n\r\n// This abstract model needs to registered to support deprecated view-only components\r\nAdapt.register('component', { model: ComponentModel });\r\n\r\nexport default ComponentModel;\r\n","import Adapt from 'core/js/adapt';\r\nimport ContentObjectModel from 'core/js/models/contentObjectModel';\r\n\r\nclass PageModel extends ContentObjectModel {\r\n\r\n  get _children() {\r\n    Adapt.log.deprecated('pageModel._children, use menuModel.hasManagedChildren instead, child models are defined by the JSON');\r\n    return 'articles';\r\n  }\r\n\r\n  /**\r\n   * Returns a string of the model type group.\r\n   * @returns {string}\r\n   */\r\n  getTypeGroup() {\r\n    return 'page';\r\n  }\r\n\r\n}\r\n\r\nAdapt.register('page', { model: PageModel });\r\n\r\nexport default PageModel;\r\n","import Adapt from 'core/js/adapt';\r\nimport AdaptView from 'core/js/views/adaptView';\r\n\r\nexport default class ContentObjectView extends AdaptView {\r\n\r\n  attributes() {\r\n    return AdaptView.resultExtend('attributes', {\r\n      'role': 'main',\r\n      'aria-labelledby': `${this.model.get('_id')}-heading`\r\n    }, this);\r\n  }\r\n\r\n  className() {\r\n    return [\r\n      this.constructor.type,\r\n      'contentobject',\r\n      this.constructor.className,\r\n      this.model.get('_id'),\r\n      this.model.get('_classes'),\r\n      this.setVisibility(),\r\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\r\n      (this.model.get('_isOptional') ? 'is-optional' : '')\r\n    ].filter(Boolean).join(' ');\r\n  }\r\n\r\n  preRender() {\r\n    $.inview.lock(this.constructor.type + 'View');\r\n    this.disableAnimation = Adapt.config.has('_disableAnimation') ? Adapt.config.get('_disableAnimation') : false;\r\n    this.$el.css('opacity', 0);\r\n    this.listenTo(this.model, 'change:_isReady', this.isReady);\r\n  }\r\n\r\n  render() {\r\n    const type = this.constructor.type;\r\n    Adapt.trigger(`${type}View:preRender contentObjectView:preRender view:preRender`, this);\r\n\r\n    if (this.isReact) {\r\n      this.changed();\r\n    } else {\r\n      const data = this.model.toJSON();\r\n      data.view = this;\r\n      const template = Handlebars.templates[this.constructor.template];\r\n      this.$el.html(template(data));\r\n    }\r\n\r\n    Adapt.trigger(`${type}View:render contentObjectView:render view:render`, this);\r\n\r\n    _.defer(() => {\r\n      // don't call postRender after remove\r\n      if (this._isRemoved) return;\r\n\r\n      this.postRender();\r\n      Adapt.trigger(`${type}View:postRender contentObjectView:postRender view:postRender`, this);\r\n    });\r\n\r\n    return this;\r\n  }\r\n\r\n  async isReady() {\r\n    if (!this.model.get('_isReady') || this._isTriggeredReady) return;\r\n    this._isTriggeredReady = true;\r\n\r\n    const type = this.constructor.type;\r\n    const performIsReady = async () => {\r\n      Adapt.trigger(`${type}View:preReady contentObjectView:preReady view:preReady`, this);\r\n      await Adapt.wait.queue();\r\n      $('.js-loading').hide();\r\n      if (Adapt.get('_shouldContentObjectScrollTop') !== false) {\r\n        $(window).scrollTop(0);\r\n      }\r\n      Adapt.trigger(`${type}View:ready contentObjectView:ready view:ready`, this);\r\n      $.inview.unlock(`${type}View`);\r\n      const styleOptions = { opacity: 1 };\r\n      if (this.disableAnimation) {\r\n        this.$el.css(styleOptions);\r\n        $.inview();\r\n        _.defer(() => {\r\n          Adapt.trigger(`${type}View:postReady contentObjectView:postReady view:postReady`, this);\r\n        });\r\n      } else {\r\n        this.$el.velocity(styleOptions, {\r\n          duration: 'fast',\r\n          complete: () => {\r\n            $.inview();\r\n            Adapt.trigger(`${type}View:postReady contentObjectView:postReady view:postReady`, this);\r\n          }\r\n        });\r\n      }\r\n      $(window).scroll();\r\n    };\r\n\r\n    _.defer(performIsReady);\r\n  }\r\n\r\n  /**\r\n   * Force render up to specified id. Resolves when views are ready.\r\n   * @param {string} id\r\n   */\r\n  async renderTo(id) {\r\n    const isRenderToSelf = (id === this.model.get('_id'));\r\n    if (isRenderToSelf) return;\r\n    let models = this.model.getAllDescendantModels(true).filter(model => model.get('_isAvailable'));\r\n    const index = models.findIndex(model => model.get('_id') === id);\r\n    if (index === -1) {\r\n      throw new Error(`Cannot renderTo \"${id}\" as it isn't a descendant.`);\r\n    }\r\n    // Return early if the model is already rendered and ready\r\n    const model = models[index];\r\n    if (model.get('_isRendered') && model.get('_isReady')) {\r\n      return;\r\n    }\r\n    // Force all models up until the id to render\r\n    models = models.slice(0, index + 1);\r\n    const ids = _.indexBy(models, (model) => model.get('_id'));\r\n    const forceUntilId = (event) => {\r\n      const addingId = event.model.get('_id');\r\n      if (!ids[addingId]) return;\r\n      event.force();\r\n      if (addingId !== id) return;\r\n      Adapt.off('view:addChild', forceUntilId);\r\n    };\r\n    Adapt.on('view:addChild', forceUntilId);\r\n    // Trigger addChildren cascade\r\n    await this.addChildren();\r\n    await this.whenReady();\r\n    // Error if model isn't rendered and ready\r\n    if (!model.get('_isRendered') || !model.get('_isReady')) {\r\n      throw new Error(`Cannot renderTo \"${id}\".`);\r\n    }\r\n  }\r\n\r\n  preRemove() {\r\n    const type = this.constructor.type;\r\n    Adapt.trigger(`${type}View:preRemove contentObjectView:preRemove view:preRemove`, this);\r\n  }\r\n\r\n  remove() {\r\n    const type = this.constructor.type;\r\n    this.preRemove();\r\n    Adapt.trigger(`${type}View:remove contentObjectView:remove view:remove`, this);\r\n    this._isRemoved = true;\r\n\r\n    Adapt.wait.for(end => {\r\n      if (this.isReact) {\r\n        ReactDOM.unmountComponentAtNode(this.el);\r\n      }\r\n      this.$el.off('onscreen.adaptView');\r\n      this.findDescendantViews().reverse().forEach(view => {\r\n        view.remove();\r\n      });\r\n      this.setChildViews(null);\r\n      super.remove();\r\n      _.defer(() => {\r\n        Adapt.trigger(`${type}View:postRemove contentObjectView:postRemove view:postRemove`, this);\r\n        this.trigger('postRemove');\r\n      });\r\n      end();\r\n    });\r\n\r\n    return this;\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n    if (Adapt.parentView === this) {\r\n      Adapt.parentView = null;\r\n    }\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport ContentObjectView from 'core/js/views/contentObjectView';\r\n\r\nclass PageView extends ContentObjectView {\r\n\r\n  remove() {\r\n    if (this.$pageLabel) {\r\n      this.$pageLabel.remove();\r\n    }\r\n    super.remove();\r\n  }\r\n\r\n}\r\n\r\nObject.assign(PageView, {\r\n  childContainer: '.article__container',\r\n  type: 'page',\r\n  template: 'page'\r\n});\r\n\r\nAdapt.register('page', { view: PageView });\r\n\r\nexport default PageView;\r\n","import Adapt from 'core/js/adapt';\r\nimport AdaptView from 'core/js/views/adaptView';\r\n\r\nclass ArticleView extends AdaptView {\r\n\r\n  className() {\r\n    return [\r\n      'article',\r\n      this.model.get('_id'),\r\n      this.model.get('_classes'),\r\n      this.setVisibility(),\r\n      this.setHidden(),\r\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\r\n      (this.model.get('_isOptional') ? 'is-optional' : '')\r\n    ].join(' ');\r\n  }\r\n\r\n}\r\n\r\nObject.assign(ArticleView, {\r\n  childContainer: '.block__container',\r\n  type: 'article',\r\n  template: 'article'\r\n});\r\n\r\nAdapt.register('article', { view: ArticleView });\r\n\r\nexport default ArticleView;\r\n","import Adapt from 'core/js/adapt';\r\nimport AdaptView from 'core/js/views/adaptView';\r\n\r\nclass BlockView extends AdaptView {\r\n\r\n  className() {\r\n    return [\r\n      'block',\r\n      this.model.get('_id'),\r\n      this.model.get('_classes'),\r\n      this.setVisibility(),\r\n      this.setHidden(),\r\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\r\n      (this.model.get('_isOptional') ? 'is-optional' : '')\r\n    ].join(' ');\r\n  }\r\n\r\n}\r\n\r\nObject.assign(BlockView, {\r\n  childContainer: '.component__container',\r\n  type: 'block',\r\n  template: 'block'\r\n});\r\n\r\nAdapt.register('block', { view: BlockView });\r\n\r\nexport default BlockView;\r\n","import Adapt from 'core/js/adapt';\r\nimport Data from 'core/js/data';\r\nimport AdaptSubsetCollection from 'core/js/collections/adaptSubsetCollection';\r\nimport ContentObjectModel from 'core/js/models/contentObjectModel';\r\nimport ArticleModel from 'core/js/models/articleModel';\r\nimport BlockModel from 'core/js/models/blockModel';\r\nimport ComponentModel from 'core/js/models/componentModel';\r\n\r\nimport 'core/js/models/courseModel';\r\nimport 'core/js/models/menuModel';\r\nimport 'core/js/models/pageModel';\r\nimport 'core/js/views/pageView';\r\nimport 'core/js/views/articleView';\r\nimport 'core/js/views/blockView';\r\n\r\nclass MPABC extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    // Example of how to cause the data loader to wait for another module to setup\r\n    this.listenTo(Data, {\r\n      loading: this.waitForDataLoaded,\r\n      loaded: this.onDataLoaded\r\n    });\r\n    this.setupSubsetCollections();\r\n  }\r\n\r\n  waitForDataLoaded() {\r\n    // Tell the data loader to wait\r\n    Adapt.wait.begin();\r\n  }\r\n\r\n  onDataLoaded() {\r\n    // Tell the data loader that we have finished\r\n    Adapt.wait.end();\r\n  }\r\n\r\n  setupSubsetCollections() {\r\n    Adapt.contentObjects = new AdaptSubsetCollection(null, { parent: Data, model: ContentObjectModel });\r\n    Adapt.articles = new AdaptSubsetCollection(null, { parent: Data, model: ArticleModel });\r\n    Adapt.blocks = new AdaptSubsetCollection(null, { parent: Data, model: BlockModel });\r\n    Adapt.components = new AdaptSubsetCollection(null, { parent: Data, model: ComponentModel });\r\n  }\r\n\r\n}\r\n\r\nexport default (Adapt.mpabc = new MPABC());\r\n","import Adapt from 'core/js/adapt';\r\n\r\nconst defaultAriaLevels = {\r\n  '_menu': 1,\r\n  '_menuGroup': 2,\r\n  '_menuItem': 2,\r\n  '_page': 1,\r\n  '_article': 2,\r\n  '_block': 3,\r\n  '_component': 4,\r\n  '_componentItem': 5,\r\n  '_notify': 1\r\n};\r\n\r\nconst helpers = {\r\n\r\n  lowercase(text) {\r\n    return text.toLowerCase();\r\n  },\r\n\r\n  capitalise(text) {\r\n    return text.charAt(0).toUpperCase() + text.slice(1);\r\n  },\r\n\r\n  inc(index) {\r\n    return index + 1;\r\n  },\r\n\r\n  dec(index) {\r\n    return index - 1;\r\n  },\r\n\r\n  odd (index) {\r\n    return (index + 1) % 2 === 0 ? 'even' : 'odd';\r\n  },\r\n\r\n  equals(value, text, block) {\r\n    return helpers.compare.call(this, value, '==', text, block);\r\n  },\r\n\r\n  compare(value, operator, text, block) {\r\n    // Comparison operators\r\n    switch (operator) {\r\n      case '===':\r\n        if (value === text) return block.fn(this);\r\n        break;\r\n      case '=': case '==':\r\n        // eslint-disable-next-line eqeqeq\r\n        if (value == text) return block.fn(this);\r\n        break;\r\n      case '>=':\r\n        if (value >= text) return block.fn(this);\r\n        break;\r\n      case '<=':\r\n        if (value <= text) return block.fn(this);\r\n        break;\r\n      case '>':\r\n        if (value > text) return block.fn(this);\r\n        break;\r\n      case '<':\r\n        if (value < text) return block.fn(this);\r\n        break;\r\n    }\r\n    return block.inverse(this);\r\n  },\r\n\r\n  math(lvalue, operator, rvalue, options) {\r\n    // Mathematical operators\r\n    lvalue = parseFloat(lvalue);\r\n    rvalue = parseFloat(rvalue);\r\n    switch (operator) {\r\n      case '+': return lvalue + rvalue;\r\n      case '-': return lvalue - rvalue;\r\n      case '*': return lvalue * rvalue;\r\n      case '/': return lvalue / rvalue;\r\n      case '%': return lvalue % rvalue;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Equivalent to:\r\n   *  if (conditionA || conditionB)\r\n   * @example\r\n   * {{#any displayTitle body instruction}}\r\n   * <div class='component__header {{_component}}__header'></div>\r\n   * {{/any}}\r\n   */\r\n  any(...args) {\r\n    const specified = args.slice(0, -1);\r\n    const block = args.slice(-1)[0];\r\n    return specified.some(Boolean) ? (block.fn ? block.fn(this) : true) : (block.inverse ? block.inverse(this) : false);\r\n  },\r\n\r\n  /**\r\n   * Equivalent to:\r\n   *  if (conditionA && conditionB)\r\n   * @example\r\n   * {{#all displayTitle body instruction}}\r\n   * <div class='component__header {{_component}}__header'></div>\r\n   * {{/all}}\r\n   */\r\n  all(...args) {\r\n    const specified = args.slice(0, -1);\r\n    const block = args.slice(-1)[0];\r\n    return specified.every(Boolean) ? (block.fn ? block.fn(this) : true) : (block.inverse ? block.inverse(this) : false);\r\n  },\r\n\r\n  /**\r\n   * Equivalent to:\r\n   *  if (!conditionA && !conditionB)\r\n   * @example\r\n   * {{#none displayTitle body instruction}}\r\n   * <div class='component__header {{_component}}__header'></div>\r\n   * {{/none}}\r\n   */\r\n  none(...args) {\r\n    const specified = args.slice(0, -1);\r\n    const block = args.slice(-1)[0];\r\n    return !specified.some(Boolean) ? (block.fn ? block.fn(this) : true) : (block.inverse ? block.inverse(this) : false);\r\n  },\r\n\r\n  /**\r\n   * Allow JSON to be a template i.e. you can use handlebars {{expressions}} within your JSON\r\n   */\r\n  compile(template, context) {\r\n    if (!template) {\r\n      return '';\r\n    }\r\n    if (template instanceof Object) template = template.toString();\r\n    let data = this;\r\n    if (context) {\r\n      // choose between a passed argument context or the default handlebars helper context\r\n      data = (context.data?.root ?? context);\r\n    }\r\n    return Handlebars.compile(template)(data);\r\n  },\r\n\r\n  /**\r\n   * Allow JSON to be a template and accessible text\r\n   */\r\n  compile_a11y_text(template, context) {\r\n    Adapt.a11y.log.deprecated('a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/');\r\n    return helpers.compile.call(this, template, context);\r\n  },\r\n\r\n  /**\r\n   * Allow JSON to be a template and normalized text\r\n   */\r\n  compile_a11y_normalize(template, context) {\r\n    if (!template) {\r\n      return '';\r\n    }\r\n    if (template instanceof Object) template = template.toString();\r\n    return Handlebars.helpers.a11y_normalize.call(this, helpers.compile.call(this, template, context));\r\n  },\r\n\r\n  /**\r\n   * Remove all html tags except styling tags\r\n   */\r\n  compile_a11y_remove_breaks(template, context) {\r\n    if (!template) {\r\n      return '';\r\n    }\r\n    return Handlebars.helpers.a11y_remove_breaks.call(this, helpers.compile.call(this, template, context));\r\n  },\r\n\r\n  /**\r\n   * makes the _globals object in course.json available to a template\r\n   */\r\n  import_globals(context) {\r\n    if (context.data.root._globals) {\r\n      return '';\r\n    }\r\n    context.data.root._globals = Adapt.course.get('_globals');\r\n    return '';\r\n  },\r\n\r\n  /**\r\n   * makes the Adapt module data available to a template\r\n   */\r\n  import_adapt(context) {\r\n\r\n    if (context.data.root.Adapt) {\r\n      return;\r\n    }\r\n    const adapt = context.data.root.Adapt = {};\r\n\r\n    let i, l, name;\r\n\r\n    const directImport = ['config', 'course'];\r\n    for (i = 0, l = directImport.length; i < l; i++) {\r\n      name = directImport[i];\r\n      // convert the model to a json object and add to the current context\r\n      adapt[name] = Adapt[name].toJSON();\r\n    }\r\n\r\n    const indexedImport = ['contentObjects', 'articles', 'blocks', 'components'];\r\n    for (i = 0, l = indexedImport.length; i < l; i++) {\r\n      name = indexedImport[i];\r\n      // convert the collection of models to an array of json objects\r\n      const importArray = Adapt[name].toJSON();\r\n      // convert the array of json models to an object indexed by id\r\n      const importIndex = {};\r\n      for (let i1 = 0, l1 = importArray.length; i1 < l1; i1++) {\r\n        const item = importArray[i1];\r\n        importIndex[item._id] = item;\r\n      }\r\n      // add the indexed object to the current context\r\n      adapt[name] = importIndex;\r\n    }\r\n\r\n    return '';\r\n\r\n  },\r\n\r\n  /**\r\n   * Allow components to fetch their component description.\r\n   *\r\n   * Creates an aria label using the `a11y_aria_label` helper containing\r\n   * the component description specified in the\r\n   * `_globals._component[componentName].ariaRegion`. This value is defined\r\n   * in the `properties.schema:globals.ariaRegion`.\r\n   *\r\n   * @param {string} [override]\r\n   * @returns {string}\r\n   */\r\n  component_description(override, context) {\r\n    if (!this._isA11yComponentDescriptionEnabled) {\r\n      return;\r\n    }\r\n    const isNotDefined = !this._globals._components?.['_' + this._component];\r\n    if (isNotDefined) {\r\n      return;\r\n    }\r\n    const hasOverride = (arguments.length > 1);\r\n    let description;\r\n    if (hasOverride) {\r\n      description = override;\r\n      description = helpers.compile(description, context);\r\n    } else {\r\n      description = this._globals._components['_' + this._component].ariaRegion;\r\n      description = helpers.compile(description, override);\r\n    }\r\n    if (!description) {\r\n      return;\r\n    }\r\n    return new Handlebars.SafeString('<div class=\"aria-label\">' + description + '</div>');\r\n  },\r\n\r\n  a11y_text(text) {\r\n    Adapt.a11y.log.deprecated('a11y_text is no longer required. https://tink.uk/understanding-screen-reader-interaction-modes/');\r\n    return text;\r\n  },\r\n\r\n  /**\r\n   * Handlebars helper for `Adapt.a11y.normalize(htmls)`.\r\n   *\r\n   * @param {string} htmls Any htmls.\r\n   * @returns {string}\r\n   */\r\n  a11y_normalize(htmls) {\r\n    return Adapt.a11y.normalize.apply(Adapt.a11y, arguments);\r\n  },\r\n\r\n  /**\r\n   * Handlebars helper for `Adapt.a11y.removeBreaks(htmls)`.\r\n   *\r\n   * @param {string} htmls Any htmls.\r\n   * @returns {string}\r\n   */\r\n  a11y_remove_breaks(htmls) {\r\n    return Adapt.a11y.removeBreaks.apply(Adapt.a11y, arguments);\r\n  },\r\n\r\n  /**\r\n   * Creates a div styled with tiny, transparent text.\r\n   * It it absolutely positioned.\r\n   * The text is not visibly readable but is read by screen readers.\r\n   *\r\n   * @param {string} htmls\r\n   * @returns {string}\r\n   */\r\n  a11y_aria_label(htmls) {\r\n    let values = Array.prototype.slice.call(arguments, 0, -1);\r\n    values = values.filter(Boolean);\r\n    return new Handlebars.SafeString('<div class=\"aria-label\">' + values.join(' ') + '</div>');\r\n  },\r\n\r\n  /**\r\n   * Creates a div styled with tiny, transparent text.\r\n   * It it relatively positioned.\r\n   * The text is not visibly readable but is read by screen readers.\r\n   *\r\n   * @param {string} htmls Aria label texts.\r\n   * @returns {string}\r\n   */\r\n  a11y_aria_label_relative(htmls) {\r\n    let values = Array.prototype.slice.call(arguments, 0, -1);\r\n    values = values.filter(Boolean);\r\n    return new Handlebars.SafeString('<div class=\"aria-label relative\">' + values.join(' ') + '</div>');\r\n  },\r\n\r\n  /**\r\n   * Creates a div styled with tiny, transparent text and `role\"=img\"`.\r\n   * It is used for representing an image to a screen reader user in an\r\n   * order which cannot be represented in the DOM in a way that achieves the\r\n   * styling objectives.\r\n   * It it absolutely positioned.\r\n   * The text is not visibly readable but is read by screen readers.\r\n   *\r\n   * @param {string} texts Aria label texts.\r\n   * @returns {string}\r\n   */\r\n  a11y_aria_image(texts) {\r\n    let values = Array.prototype.slice.call(arguments, 0, -1);\r\n    values = values.filter(Boolean);\r\n    return new Handlebars.SafeString('<div class=\"aria-label\" role=\"img\" aria-label=\"' + values.join(' ') + '\"></div>');\r\n  },\r\n\r\n  /**\r\n   * Returns an `a` tag which when receiving focus causes the focus to wrap\r\n   * to the top of the readable document.\r\n   *\r\n   * @returns {string}\r\n   */\r\n  a11y_wrap_focus() {\r\n    const cfg = Adapt.config.get('_accessibility');\r\n    if (cfg._isPopupWrapFocusEnabled === false) return '';\r\n    return new Handlebars.SafeString('<a class=\"a11y-focusguard a11y-ignore a11y-ignore-focus\" role=\"presentation\">&nbsp;</a>');\r\n  },\r\n\r\n  /**\r\n   * Creates the attributes for a subject heading text. `role=\"heading\"` and\r\n   * `aria-level=\"#\"`. It will use the `_ariaLevel` attribute from the current\r\n   * context if specified, a number if given as the `levelOrType` parameter,\r\n   * or a name from the configured aria levels hash.\r\n   *\r\n   * @param {number|string} levelOrType\r\n   * @returns {string}\r\n   */\r\n  a11y_attrs_heading(levelOrType) {\r\n    // get the global configuration from config.json\r\n    const cfg = Adapt.config.get('_accessibility');\r\n    // default level to use if nothing overrides it\r\n    let level = 1;\r\n\r\n    // first check to see if the Handlebars context has an override\r\n    if (this._ariaLevel) {\r\n      levelOrType = this._ariaLevel;\r\n    }\r\n\r\n    if (isNaN(levelOrType) === false) {\r\n      // if a number is passed just use this\r\n      level = levelOrType;\r\n    } else if (_.isString(levelOrType)) {\r\n      // if a string is passed check if it is defined in global configuration\r\n      cfg._ariaLevels = cfg._ariaLevels || defaultAriaLevels;\r\n      if (cfg._ariaLevels?.['_' + levelOrType] !== undefined) {\r\n        level = cfg._ariaLevels['_' + levelOrType];\r\n      }\r\n    }\r\n\r\n    return new Handlebars.SafeString(' role=\"heading\" aria-level=\"' + level + '\" ');\r\n  },\r\n\r\n  a11y_attrs_tabbable() {\r\n    Adapt.a11y.log.deprecated('a11y_attrs_tabbable should not be used. tabbable elements should be natively tabbable.');\r\n    return new Handlebars.SafeString(' role=\"region\" tabindex=\"0\" ');\r\n  },\r\n\r\n  /**\r\n   * Produce display text with alternative screen reader version.\r\n   * @param {string} visible Text that will be displayed on screen\r\n   * @param {string} alternatives Text that will be read by the screen reader (instead of what's displayed on screen)\r\n   * @example {{a11y_alt_text '$5bn' 'five billion dollars'}} or {{a11y_alt_text 'Here are some bits to read' 'There are' _items.length 'items to read'}}\r\n   */\r\n  a11y_alt_text(visible, alternatives) {\r\n    let values = Array.prototype.slice.call(arguments, 1, -1);\r\n    values = values.filter(Boolean);\r\n    return new Handlebars.SafeString('<span aria-hidden=\"true\">' + visible + '</span><span class=\"aria-label\">' + values.join(' ') + '</span>');\r\n  }\r\n\r\n};\r\n\r\n// Compatibility references\r\nObject.assign(helpers, {\r\n\r\n  if_value_equals() {\r\n    Adapt.a11y.log.deprecated('if_value_equals, use equals instead.');\r\n    return helpers.equals.apply(this, arguments);\r\n  },\r\n\r\n  numbers() {\r\n    Adapt.a11y.log.deprecated('numbers, use inc instead.');\r\n    return helpers.inc.apply(this, arguments);\r\n  },\r\n\r\n  lowerCase() {\r\n    Adapt.a11y.log.deprecated('lowerCase, use lowercase instead.');\r\n    return helpers.lowercase.apply(this, arguments);\r\n  }\r\n\r\n});\r\n\r\nfor (let name in helpers) {\r\n  if (!helpers.hasOwnProperty(name)) continue;\r\n  Handlebars.registerHelper(name, helpers[name]);\r\n}\r\n\r\nexport default helpers;\r\n","import Adapt from 'core/js/adapt';\r\n\r\nclass Scrolling extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this.$html = null;\r\n    this.$app = null;\r\n    this.isLegacyScrolling = true;\r\n    this._checkApp();\r\n    Adapt.once('configModel:dataLoaded', this._loadConfig.bind(this));\r\n  }\r\n\r\n  _checkApp() {\r\n    this.$html = $('html');\r\n    this.$app = $('#app');\r\n    if (this.$app.length) return;\r\n    this.$app = $('<div id=\"app\">');\r\n    $('body').append(this.$app);\r\n    this.$app.append($('#wrapper'));\r\n    Adapt.log.warn('UPDATE - Your html file needs to have #app adding. See https://github.com/adaptlearning/adapt_framework/issues/2168');\r\n  }\r\n\r\n  _loadConfig() {\r\n    const config = Adapt.config.get('_scrollingContainer');\r\n    if (!config?._isEnabled) return;\r\n    const limitTo = config._limitToSelector;\r\n    const isIncluded = !limitTo || (this.$html.is(limitTo) || this.$html.hasClass(limitTo));\r\n    if (!isIncluded) return;\r\n    this.isLegacyScrolling = false;\r\n    this._addStyling();\r\n    this._fixJQuery();\r\n    this._fixScrollTo();\r\n    this._fixBrowser();\r\n  }\r\n\r\n  _addStyling() {\r\n    this.$html.addClass('adapt-scrolling');\r\n  }\r\n\r\n  _fixJQuery() {\r\n    const selectorScrollTop = $.fn.scrollTop;\r\n    const $app = Adapt.scrolling.$app;\r\n    $.fn.scrollTop = function() {\r\n      if (this[0] === window || this[0] === document.body) {\r\n        return selectorScrollTop.apply($app, arguments);\r\n      }\r\n      return selectorScrollTop.apply(this, arguments);\r\n    };\r\n    const selectorOffset = $.fn.offset;\r\n    $.fn.offset = function(coordinates) {\r\n      if (coordinates) {\r\n        return selectorOffset.apply(this, arguments);\r\n      }\r\n      const $app = Adapt.scrolling.$app;\r\n      const $element = this;\r\n      const elementOffset = selectorOffset.call($element);\r\n      const isCorrectedContainer = $element.is('html, body, #app') ||\r\n        $element.parents().is('#app');\r\n      if (!isCorrectedContainer) {\r\n        // Do not adjust the offset measurement as not in $app container and isn't html or body\r\n        return elementOffset;\r\n      }\r\n      // Adjust measurement by scrolling and offset of $app container\r\n      const scrollTop = parseInt($app.scrollTop());\r\n      const scrollLeft = parseInt($app.scrollLeft());\r\n      const appOffset = selectorOffset.call($app);\r\n      elementOffset.top += (scrollTop - appOffset.top);\r\n      elementOffset.left += (scrollLeft - appOffset.left);\r\n      return elementOffset;\r\n    };\r\n  }\r\n\r\n  _fixScrollTo() {\r\n    const selectorScrollTo = $.fn.scrollTo;\r\n    const scrollTo = $.scrollTo;\r\n    const $app = Adapt.scrolling.$app;\r\n    $.fn.scrollTo = function(target, duration, settings) {\r\n      if (this[0] === window || this[0] === document.body) {\r\n        return selectorScrollTo.apply($app, arguments);\r\n      }\r\n      return selectorScrollTo.apply(this, arguments);\r\n    };\r\n    $.scrollTo = function(target, duration, settings) {\r\n      return selectorScrollTo.apply($app, arguments);\r\n    };\r\n    Object.assign($.scrollTo, scrollTo);\r\n  }\r\n\r\n  _fixBrowser() {\r\n    const app = Adapt.scrolling.$app[0];\r\n    window.scrollTo = function(x, y) {\r\n      app.scrollTop = y || 0;\r\n      app.scrollLeft = x || 0;\r\n    };\r\n    const $window = $(window);\r\n    this.$app.on('scroll', () => {\r\n      $window.scroll();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Allows a selector to be passed in and Adapt will scroll to this element. Resolves\r\n   * asynchronously when the element has been navigated/scrolled to.\r\n   * Backend for Adapt.scrollTo\r\n   * @param {string} selector CSS selector of the Adapt element you want to navigate to e.g. `\".co-05\"`\r\n   * @param {Object} [settings={}] The settings for the `$.scrollTo` function (See https://github.com/flesler/jquery.scrollTo#settings).\r\n   * @param {Object} [settings.replace=false] Set to `true` if you want to update the URL without creating an entry in the browser's history.\r\n   */\r\n  async scrollTo(selector, settings = {}) {\r\n    Adapt.log.deprecated('Adapt.scrollTo and Adapt.scrolling.scrollTo, use Adapt.navigateToElement instead.');\r\n    return Adapt.router.navigateToElement(selector, settings);\r\n  }\r\n\r\n}\r\n\r\nAdapt.scrolling = new Scrolling();\r\n\r\nAdapt.scrollTo = Adapt.scrolling.scrollTo.bind(Adapt.scrolling);\r\n\r\nexport default Adapt.scrolling;\r\n","import Adapt from 'core/js/adapt';\r\n\r\nclass HeadingView extends Backbone.View {\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt.parentView, 'postRemove', this.remove);\r\n    this.listenTo(this.model, 'change:_isComplete', this.render);\r\n    this.render();\r\n  }\r\n\r\n  render() {\r\n    const template = Handlebars.templates[this.constructor.template];\r\n    const data = this.model.toJSON();\r\n    const customHeadingType = this.$el.attr('data-a11y-heading-type');\r\n    if (customHeadingType) data._type = customHeadingType;\r\n    this.$el.html(template(data));\r\n    this.checkCompletion();\r\n  }\r\n\r\n  checkCompletion() {\r\n    const isComplete = this.model.get('_isComplete');\r\n    this.$el\r\n      .toggleClass('is-complete', isComplete)\r\n      .toggleClass('is-incomplete', !isComplete);\r\n  }\r\n\r\n}\r\n\r\nHeadingView.template = 'heading';\r\n\r\nexport default HeadingView;\r\n","import Adapt from './adapt';\r\nimport HeadingView from './views/headingView';\r\n\r\nclass Headings extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, 'view:render', this.onViewRender);\r\n  }\r\n\r\n  onViewRender(view) {\r\n    const $headingSeats = view.$('.js-heading');\r\n    $headingSeats.each((index, el) => new HeadingView({ el, model: view.model }));\r\n  }\r\n\r\n}\r\n\r\nexport default new Headings();\r\n","import Adapt from 'core/js/adapt';\r\n\r\nclass NavigationView extends Backbone.View {\r\n\r\n  className() {\r\n    return 'nav';\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      'click [data-event]': 'triggerEvent'\r\n    };\r\n  }\r\n\r\n  attributes() {\r\n    return {\r\n      'role': 'navigation'\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this.listenToOnce(Adapt, {\r\n      'courseModel:dataLoading': this.remove\r\n    });\r\n    this.listenTo(Adapt, 'router:menu router:page', this.hideNavigationButton);\r\n    this.preRender();\r\n  }\r\n\r\n  preRender() {\r\n    Adapt.trigger('navigationView:preRender', this);\r\n    this.render();\r\n  }\r\n\r\n  render() {\r\n    const template = Handlebars.templates[this.constructor.template];\r\n    this.$el.html(template({\r\n      _globals: Adapt.course.get('_globals'),\r\n      _accessibility: Adapt.config.get('_accessibility')\r\n    })).insertBefore('#app');\r\n\r\n    _.defer(() => {\r\n      Adapt.trigger('navigationView:postRender', this);\r\n    });\r\n\r\n    return this;\r\n  }\r\n\r\n  triggerEvent(event) {\r\n    event.preventDefault();\r\n    const currentEvent = $(event.currentTarget).attr('data-event');\r\n    Adapt.trigger('navigation:' + currentEvent);\r\n    switch (currentEvent) {\r\n      case 'backButton':\r\n        Adapt.router.navigateToPreviousRoute();\r\n        break;\r\n      case 'homeButton':\r\n        Adapt.router.navigateToHomeRoute();\r\n        break;\r\n      case 'parentButton':\r\n        Adapt.router.navigateToParent();\r\n        break;\r\n      case 'skipNavigation':\r\n        this.skipNavigation();\r\n        break;\r\n      case 'returnToStart':\r\n        Adapt.startController.returnToStartLocation();\r\n        break;\r\n    }\r\n  }\r\n\r\n  skipNavigation() {\r\n    Adapt.a11y.focusFirst('.' + Adapt.location._contentType);\r\n  }\r\n\r\n  hideNavigationButton(model) {\r\n    const shouldHide = (model.get('_type') === 'course');\r\n    this.$('.nav__back-btn, .nav__home-btn').toggleClass('u-display-none', shouldHide);\r\n  }\r\n\r\n  showNavigationButton() {\r\n    this.$('.nav__back-btn, .nav__home-btn').removeClass('u-display-none');\r\n  }\r\n\r\n}\r\n\r\nNavigationView.template = 'nav';\r\n\r\nexport default NavigationView;\r\n","import Adapt from 'core/js/adapt';\r\nimport NavigationView from 'core/js/views/navigationView';\r\n\r\nclass NavigationController extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this.listenTo(Adapt, 'adapt:preInitialize', this.addNavigationBar);\r\n  }\r\n\r\n  addNavigationBar() {\r\n    const adaptConfig = Adapt.course.get('_navigation');\r\n\r\n    if (adaptConfig?._isDefaultNavigationDisabled) {\r\n      Adapt.trigger('navigation:initialize');\r\n      return;\r\n    }\r\n\r\n    Adapt.navigation = new NavigationView();// This should be triggered after 'app:dataReady' as plugins might want to manipulate the navigation\r\n  }\r\n\r\n}\r\n\r\nexport default new NavigationController();\r\n","import LockingModel from 'core/js/models/lockingModel';\r\n\r\nexport default class ItemModel extends LockingModel {\r\n\r\n  defaults() {\r\n    return {\r\n      _isActive: false,\r\n      _isVisited: false\r\n    };\r\n  }\r\n\r\n  reset() {\r\n    this.set({ _isActive: false, _isVisited: false });\r\n  }\r\n\r\n  toggleActive(isActive = !this.get('_isActive')) {\r\n    this.set('_isActive', isActive);\r\n  }\r\n\r\n  toggleVisited(isVisited = !this.get('_isVisited')) {\r\n    this.set('_isVisited', isVisited);\r\n  }\r\n\r\n}\r\n","import ComponentModel from 'core/js/models/componentModel';\r\nimport ItemModel from 'core/js/models/itemModel';\r\n\r\nexport default class ItemsComponentModel extends ComponentModel {\r\n\r\n  toJSON() {\r\n    const json = super.toJSON();\r\n    // Make sure _items is updated from child collection\r\n    json._items = this.getChildren().toJSON();\r\n    return json;\r\n  }\r\n\r\n  init() {\r\n    this.setUpItems();\r\n    this.listenTo(this.getChildren(), {\r\n      'all': this.onAll,\r\n      'change:_isVisited': this.checkCompletionStatus\r\n    });\r\n    super.init();\r\n  }\r\n\r\n  restoreUserAnswers() {\r\n    const booleanArray = this.get('_userAnswer');\r\n    if (!booleanArray) return;\r\n    this.getChildren().forEach((child, index) => child.set('_isVisited', booleanArray[index]));\r\n  }\r\n\r\n  storeUserAnswer() {\r\n    const booleanArray = this.getChildren().map(child => child.get('_isVisited'));\r\n    this.set('_userAnswer', booleanArray);\r\n  }\r\n\r\n  setUpItems() {\r\n    // see https://github.com/adaptlearning/adapt_framework/issues/2480\r\n    const items = this.get('_items') || [];\r\n    items.forEach((item, index) => (item._index = index));\r\n    this.setChildren(new Backbone.Collection(items, { model: ItemModel }));\r\n  }\r\n\r\n  getItem(index) {\r\n    return this.getChildren().findWhere({ _index: index });\r\n  }\r\n\r\n  getVisitedItems() {\r\n    return this.getChildren().where({ _isVisited: true });\r\n  }\r\n\r\n  getActiveItems() {\r\n    return this.getChildren().where({ _isActive: true });\r\n  }\r\n\r\n  getActiveItem() {\r\n    return this.getChildren().findWhere({ _isActive: true });\r\n  }\r\n\r\n  areAllItemsCompleted() {\r\n    return this.getVisitedItems().length === this.getChildren().length;\r\n  }\r\n\r\n  checkCompletionStatus() {\r\n    this.storeUserAnswer();\r\n    if (!this.areAllItemsCompleted()) return;\r\n    this.setCompletionStatus();\r\n  }\r\n\r\n  reset(type, force) {\r\n    this.getChildren().each(item => item.reset());\r\n    super.reset(type, force);\r\n  }\r\n\r\n  resetActiveItems() {\r\n    this.getChildren().each(item => item.toggleActive(false));\r\n  }\r\n\r\n  setActiveItem(index) {\r\n    const item = this.getItem(index);\r\n    if (!item) return;\r\n\r\n    const activeItem = this.getActiveItem();\r\n    if (activeItem) activeItem.toggleActive(false);\r\n    item.toggleActive(true);\r\n  }\r\n\r\n}\r\n","define([\r\n  'core/js/models/itemsComponentModel'\r\n], function(ItemsComponentModel) {\r\n\r\n  class AccordionModel extends ItemsComponentModel {\r\n\r\n    defaults() {\r\n      return ItemsComponentModel.resultExtend('defaults', {\r\n        _shouldCollapseItems: true,\r\n        _toggleSpeed: 200\r\n      }, this);\r\n    }\r\n\r\n    toggleItemsState(index) {\r\n      const item = this.getItem(index);\r\n      const previousActiveItem = this.getActiveItem();\r\n\r\n      item.toggleActive();\r\n      item.toggleVisited(true);\r\n\r\n      if (previousActiveItem && this.get('_shouldCollapseItems')) {\r\n        previousActiveItem.toggleActive(false);\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  return AccordionModel;\r\n\r\n});\r\n","import Adapt from 'core/js/adapt';\r\nimport AdaptView from 'core/js/views/adaptView';\r\n\r\nclass ComponentView extends AdaptView {\r\n\r\n  attributes() {\r\n    if (!this.model.get('_isA11yRegionEnabled')) {\r\n      return AdaptView.resultExtend('attributes', {}, this);\r\n    }\r\n    return AdaptView.resultExtend('attributes', {\r\n      'aria-labelledby': this.model.get('_id') + '-heading',\r\n      'role': 'region'\r\n    }, this);\r\n  }\r\n\r\n  className() {\r\n    return [\r\n      'component',\r\n      this.model.get('_component').toLowerCase(),\r\n      this.model.get('_id'),\r\n      this.model.get('_classes'),\r\n      this.setVisibility(),\r\n      this.setHidden(),\r\n      'is-' + this.model.get('_layout'),\r\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\r\n      (this.model.get('_isOptional') ? 'is-optional' : '')\r\n    ].join(' ');\r\n  }\r\n\r\n  renderState() {\r\n    Adapt.log.removed('renderState is removed and moved to item title');\r\n  }\r\n\r\n  /**\r\n   * Allows components that want to use inview for completion to set that up\r\n   * @param {string} [inviewElementSelector] Allows to you to specify (via a selector) which DOM element to use for inview.\r\n   * Defaults to `'.component__inner'` if not supplied.\r\n   * @param {function} [callback] Allows you to specify what function is called when the component has been viewed, should\r\n   * you want to perform additional checks before setting the component to completed - see adapt-contrib-assessmentResults\r\n   * for an example. Defaults to `view.setCompletionStatus` if not specified.\r\n   */\r\n  setupInviewCompletion(inviewElementSelector = '.component__inner', callback = this.setCompletionStatus) {\r\n    this.$inviewElement = this.$(inviewElementSelector);\r\n    this.inviewCallback = callback;\r\n\r\n    this.$inviewElement.on('inview.componentView', this.onInview.bind(this));\r\n  }\r\n\r\n  removeInviewListener() {\r\n    if (!this.$inviewElement) return;\r\n    this.$inviewElement.off('inview.componentView');\r\n    this.$inviewElement = null;\r\n  }\r\n\r\n  onInview(event, visible, visiblePartX, visiblePartY) {\r\n    if (!visible) return;\r\n\r\n    switch (visiblePartY) {\r\n      case 'top':\r\n        this.hasSeenTop = true;\r\n        break;\r\n      case 'bottom':\r\n        this.hasSeenBottom = true;\r\n        break;\r\n      case 'both':\r\n        this.hasSeenTop = this.hasSeenBottom = true;\r\n    }\r\n\r\n    if (!this.hasSeenTop || !this.hasSeenBottom) return;\r\n\r\n    this.inviewCallback();\r\n\r\n    if (this.model.get('_isComplete')) {\r\n      this.removeInviewListener();\r\n    }\r\n  }\r\n\r\n  postRender() {}\r\n\r\n  remove() {\r\n    this.removeInviewListener();\r\n    super.remove();\r\n  }\r\n\r\n}\r\n\r\nComponentView.type = 'component';\r\n\r\nexport default ComponentView;\r\n","define([\r\n  'core/js/views/componentView'\r\n], function(ComponentView) {\r\n\r\n  class AccordionView extends ComponentView {\r\n\r\n    events() {\r\n      return {\r\n        'click .js-toggle-item': 'onClick'\r\n      };\r\n    }\r\n\r\n    preRender() {\r\n      this.checkIfResetOnRevisit();\r\n\r\n      this.model.resetActiveItems();\r\n\r\n      this.listenTo(this.model.get('_children'), {\r\n        'change:_isActive': this.onItemsActiveChange,\r\n        'change:_isVisited': this.onItemsVisitedChange\r\n      });\r\n    }\r\n\r\n    postRender() {\r\n      this.setReadyStatus();\r\n\r\n      if (this.model.get('_setCompletionOn') === 'inview') {\r\n        this.setupInviewCompletion();\r\n      }\r\n    }\r\n\r\n    checkIfResetOnRevisit() {\r\n      const isResetOnRevisit = this.model.get('_isResetOnRevisit');\r\n\r\n      // If reset is enabled set defaults\r\n      if (isResetOnRevisit) {\r\n        this.model.reset(isResetOnRevisit);\r\n      }\r\n    }\r\n\r\n    onClick(event) {\r\n      this.model.toggleItemsState($(event.currentTarget).parent().data('index'));\r\n    }\r\n\r\n    onItemsActiveChange(item, isActive) {\r\n      this.toggleItem(item, isActive);\r\n    }\r\n\r\n    onItemsVisitedChange(item, isVisited) {\r\n      if (!isVisited) return;\r\n\r\n      const $item = this.getItemElement(item);\r\n\r\n      $item.children('.accordion__item-btn').addClass('is-visited');\r\n    }\r\n\r\n    toggleItem(item, shouldExpand) {\r\n      const $item = this.getItemElement(item);\r\n      const $body = $item.children('.accordion__item-content').stop(true, true);\r\n\r\n      $item.children('.accordion__item-btn')\r\n        .toggleClass('is-selected is-open', shouldExpand)\r\n        .toggleClass('is-closed', !shouldExpand)\r\n        .attr('aria-expanded', shouldExpand);\r\n\r\n      if (!shouldExpand) {\r\n        $body.slideUp(this.model.get('_toggleSpeed'));\r\n        return;\r\n      }\r\n\r\n      $body.slideDown(this.model.get('_toggleSpeed'));\r\n    }\r\n\r\n    getItemElement(item) {\r\n      const index = item.get('_index');\r\n\r\n      return this.$('.accordion__item').filter(`[data-index=\"${index}\"]`);\r\n    }\r\n\r\n  }\r\n\r\n  AccordionView.template = 'accordion';\r\n\r\n  return AccordionView;\r\n\r\n});\r\n","define([\r\n  'core/js/adapt',\r\n  './accordionModel',\r\n  './accordionView'\r\n], function(Adapt, AccordionModel, AccordionView) {\r\n\r\n  return Adapt.register('accordion', {\r\n    model: AccordionModel,\r\n    view: AccordionView\r\n  });\r\n\r\n});\r\n","define([\n  'core/js/adapt',\n  'core/js/models/componentModel'\n], function(Adapt, ComponentModel) {\n\n  class AssessmentResultsModel extends ComponentModel {\n\n    init(...args) {\n      this.set('originalBody', this.get('body'));// save the original body text so we can restore it when the assessment is reset\n\n      this.listenTo(Adapt, {\n        'assessments:complete': this.onAssessmentComplete,\n        'assessments:reset': this.onAssessmentReset\n      });\n\n      super.init(...args);\n    }\n\n    /**\n     * Checks to see if the assessment was completed in a previous session or not\n     */\n    checkIfAssessmentComplete() {\n      if (!Adapt.assessment || this.get('_assessmentId') === undefined) {\n        return;\n      }\n\n      const assessmentModel = Adapt.assessment.get(this.get('_assessmentId'));\n      if (!assessmentModel || assessmentModel.length === 0) return;\n\n      const state = assessmentModel.getState();\n      const isResetOnRevisit = assessmentModel.get('_assessment')._isResetOnRevisit;\n      if (state.isComplete && (!state.allowResetIfPassed || !isResetOnRevisit)) {\n        this.onAssessmentComplete(state);\n        return;\n      }\n\n      this.setVisibility();\n    }\n\n    onAssessmentComplete(state) {\n      if (this.get('_assessmentId') === undefined ||\n          this.get('_assessmentId') != state.id) return;\n\n      /*\n      make shortcuts to some of the key properties in the state object so that\n      content developers can just use {{attemptsLeft}} in json instead of {{state.attemptsLeft}}\n      */\n      this.set( {\n        _state: state,\n        attempts: state.attempts,\n        attemptsSpent: state.attemptsSpent,\n        attemptsLeft: state.attemptsLeft,\n        score: state.score,\n        scoreAsPercent: state.scoreAsPercent,\n        maxScore: state.maxScore,\n        isPass: state.isPass\n      });\n\n      this.setFeedbackBand(state);\n\n      this.checkRetryEnabled(state);\n\n      this.setFeedbackText();\n\n      this.toggleVisibility(true);\n    }\n\n    setFeedbackBand(state) {\n      const scoreProp = state.isPercentageBased ? 'scoreAsPercent' : 'score';\n      const bands = _.sortBy(this.get('_bands'), '_score');\n\n      for (let i = (bands.length - 1); i >= 0; i--) {\n        const isScoreInBandRange =  (state[scoreProp] >= bands[i]._score);\n        if (!isScoreInBandRange) continue;\n\n        this.set('_feedbackBand', bands[i]);\n        break;\n      }\n    }\n\n    checkRetryEnabled(state) {\n      const assessmentModel = Adapt.assessment.get(state.id);\n      if (!assessmentModel.canResetInPage()) return false;\n\n      const feedbackBand = this.get('_feedbackBand');\n      const isRetryEnabled = (feedbackBand && feedbackBand._allowRetry) !== false;\n      const isAttemptsLeft = (state.attemptsLeft > 0 || state.attemptsLeft === 'infinite');\n      const showRetry = isRetryEnabled && isAttemptsLeft && (!state.isPass || state.allowResetIfPassed);\n\n      this.set({\n        _isRetryEnabled: showRetry,\n        retryFeedback: showRetry ? this.get('_retry').feedback : ''\n      });\n    }\n\n    setFeedbackText() {\n      const feedbackBand = this.get('_feedbackBand');\n\n      // ensure any handlebars expressions in the .feedback are handled...\n      const feedback = feedbackBand ? Handlebars.compile(feedbackBand.feedback)(this.toJSON()) : '';\n\n      this.set({\n        feedback,\n        body: this.get('_completionBody')\n      });\n    }\n\n    setVisibility() {\n      if (!Adapt.assessment) return;\n\n      const isVisibleBeforeCompletion = this.get('_isVisibleBeforeCompletion') || false;\n      const wasVisible = this.get('_isVisible');\n\n      const assessmentModel = Adapt.assessment.get(this.get('_assessmentId'));\n      if (!assessmentModel || assessmentModel.length === 0) return;\n\n      const state = assessmentModel.getState();\n      const isComplete = state.isComplete;\n      const isAttemptInProgress = state.attemptInProgress;\n      const attemptsSpent = state.attemptsSpent;\n      const hasHadAttempt = (!isAttemptInProgress && attemptsSpent > 0);\n\n      const isVisible = (isVisibleBeforeCompletion && !isComplete) || hasHadAttempt;\n\n      if (!wasVisible && isVisible) isVisible = false;\n\n      this.toggleVisibility(isVisible);\n    }\n\n    toggleVisibility (isVisible) {\n      if (isVisible === undefined) {\n        isVisible = !this.get('_isVisible');\n      }\n\n      this.set('_isVisible', isVisible, { pluginName: 'assessmentResults' });\n    }\n\n    checkCompletion() {\n      if (this.get('_setCompletionOn') === 'pass' && !this.get('isPass')) {\n        return;\n      }\n\n      this.setCompletionStatus();\n    }\n\n    /**\n     * Handles resetting the component whenever its corresponding assessment is reset\n     * The component can either inherit the assessment's reset type or define its own\n     */\n    onAssessmentReset(state) {\n      if (this.get('_assessmentId') === undefined ||\n          this.get('_assessmentId') != state.id) return;\n\n      let resetType = this.get('_resetType');\n      if (!resetType || resetType === 'inherit') {\n        resetType = state.resetType || 'hard';// backwards compatibility - state.resetType was only added in assessment v2.3.0\n      }\n      this.reset(resetType, true);\n    }\n\n    reset(...args) {\n      this.set({\n        body: this.get('originalBody'),\n        state: null,\n        feedback: '',\n        _feedbackBand: null,\n        retryFeedback: '',\n        _isRetryEnabled: false\n      });\n\n      super.reset(...args);\n    }\n  }\n\n  return AssessmentResultsModel;\n\n});\n","define([\n  'core/js/adapt',\n  'core/js/views/componentView'\n], function(Adapt, ComponentView) {\n\n  class AssessmentResultsView extends ComponentView {\n\n    events() {\n      return {\n        'click .js-assessment-retry-btn': 'onRetryClicked'\n      }\n    }\n\n    preRender() {\n      this.model.setLocking('_isVisible', false);\n\n      this.listenTo(Adapt.parentView, 'preRemove', function () {\n        this.model.unsetLocking('_isVisible');\n      });\n\n      this.listenTo(this.model, {\n        'change:_feedbackBand': this.addClassesToArticle,\n        'change:body': this.render\n      });\n    }\n\n    postRender() {\n      this.model.checkIfAssessmentComplete();\n      this.setReadyStatus();\n      this.setupInviewCompletion('.component__inner', this.model.checkCompletion.bind(this.model));\n    }\n\n    /**\n     * Resets the state of the assessment and optionally redirects the user\n     * back to the assessment for another attempt.\n     */\n    onRetryClicked() {\n      const state = this.model.get('_state');\n\n      Adapt.assessment.get(state.id).reset(null, wasReset => {\n        if (!wasReset) {\n          return;\n        }\n        if (this.model.get('_retry')._routeToAssessment === true) {\n          Adapt.navigateToElement('.' + state.articleId);\n        }\n      });\n    }\n\n    /**\n     * If there are classes specified for the feedback band, apply them to the containing article\n     * This allows for custom styling based on the band the user's score falls into\n     */\n    addClassesToArticle(model, value) {\n      if (!value || !value._classes) return;\n\n      this.$el.parents('.article').addClass(value._classes);\n    }\n\n  }\n\n  AssessmentResultsView.template = 'assessmentResults';\n\n  return AssessmentResultsView;\n\n});\n","define([\n  'core/js/adapt',\n  './assessmentResultsModel',\n  './assessmentResultsView'\n], function(Adapt, AssessmentResultsModel, AssessmentResultsView) {\n\n  return Adapt.register(\"assessmentResults\", {\n    model: AssessmentResultsModel,\n    view: AssessmentResultsView\n  });\n\n});\n","define([\n  'core/js/adapt',\n  'core/js/views/componentView',\n  'core/js/models/componentModel'\n], function(Adapt, ComponentView, ComponentModel) {\n\n  class BlankView extends ComponentView {\n\n    preRender() {\n      this.checkIfResetOnRevisit();\n    }\n\n    postRender() {\n      this.setReadyStatus();\n      this.setupInviewCompletion();\n    }\n\n    checkIfResetOnRevisit() {\n      const isResetOnRevisit = this.model.get('_isResetOnRevisit');\n\n      if (isResetOnRevisit) {\n        this.model.reset(isResetOnRevisit);\n      }\n    }\n  }\n\n  BlankView.template = 'blank';\n\n  return Adapt.register('blank', {\n    model: ComponentModel.extend({}),// create a new class in the inheritance chain so it can be extended per component type if necessary later\n    view: BlankView\n  });\n\n});\n","const BUTTON_STATE = ENUM([\r\n  'SUBMIT',\r\n  'CORRECT',\r\n  'INCORRECT',\r\n  'SHOW_CORRECT_ANSWER',\r\n  'HIDE_CORRECT_ANSWER',\r\n  'SHOW_FEEDBACK',\r\n  'RESET'\r\n]);\r\n\r\nexport default BUTTON_STATE;\r\n","import Adapt from 'core/js/adapt';\r\nimport BUTTON_STATE from 'core/js/enums/buttonStateEnum';\r\n\r\n// convert BUTTON_STATE to property name\r\nconst textPropertyName = {\r\n  'SUBMIT': 'submit',\r\n  'CORRECT': 'correct',\r\n  'INCORRECT': 'incorrect',\r\n  'SHOW_CORRECT_ANSWER': 'showCorrectAnswer',\r\n  'HIDE_CORRECT_ANSWER': 'hideCorrectAnswer',\r\n  'SHOW_FEEDBACK': 'showFeedback',\r\n  'RESET': 'reset'\r\n};\r\n\r\nexport default class ButtonsView extends Backbone.View {\r\n\r\n  initialize(options) {\r\n    this.parent = options.parent;\r\n    this.listenTo(Adapt.parentView, 'postRemove', this.remove);\r\n    this.listenTo(this.model, {\r\n      'change:_buttonState': this.onButtonStateChanged,\r\n      'change:feedbackMessage': this.onFeedbackMessageChanged,\r\n      'change:_attemptsLeft': this.onAttemptsChanged,\r\n      'change:_canSubmit': this.onCanSubmitChange\r\n    });\r\n    this.render();\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      'click .js-btn-action': 'onActionClicked',\r\n      'click .js-btn-feedback': 'onFeedbackClicked'\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const data = this.model.toJSON();\r\n    const template = Handlebars.templates.buttons;\r\n    _.defer(() => {\r\n      this.postRender();\r\n      Adapt.trigger('buttonsView:postRender', this);\r\n    });\r\n    this.$el.html(template(data));\r\n  }\r\n\r\n  postRender() {\r\n    this.refresh();\r\n  }\r\n\r\n  checkResetSubmittedState() {\r\n    const isSubmitted = this.model.get('_isSubmitted');\r\n    if (isSubmitted) {\r\n      this.$el.addClass('is-submitted');\r\n      return;\r\n    }\r\n\r\n    this.$('.js-btn-marking').removeClass('is-incorrect is-correct').addClass('u-display-none');\r\n    this.$el.removeClass('is-submitted');\r\n    this.model.set('feedbackMessage', undefined);\r\n    Adapt.a11y.toggleEnabled(this.$('.js-btn-feedback'), false);\r\n  }\r\n\r\n  onActionClicked() {\r\n    const buttonState = BUTTON_STATE(this.model.get('_buttonState'));\r\n    this.trigger('buttons:stateUpdate', buttonState);\r\n    this.checkResetSubmittedState();\r\n\r\n    if (buttonState === BUTTON_STATE.SHOW_CORRECT_ANSWER) {\r\n      const correctAnswer = this.model.getCorrectAnswerAsText?.();\r\n      this.updateAnswerLiveRegion(correctAnswer);\r\n    }\r\n\r\n    if (buttonState === BUTTON_STATE.HIDE_CORRECT_ANSWER) {\r\n      const userAnswer = this.model.getUserAnswerAsText?.();\r\n      this.updateAnswerLiveRegion(userAnswer);\r\n    }\r\n  }\r\n\r\n  onFeedbackClicked() {\r\n    this.trigger('buttons:stateUpdate', BUTTON_STATE.SHOW_FEEDBACK);\r\n  }\r\n\r\n  onFeedbackMessageChanged(model, changedAttribute) {\r\n    if (changedAttribute && this.model.get('_canShowFeedback')) {\r\n      // enable feedback button\r\n      Adapt.a11y.toggleEnabled(this.$('.js-btn-feedback'), true);\r\n      return;\r\n    }\r\n    // disable feedback button\r\n    Adapt.a11y.toggleEnabled(this.$('.js-btn-feedback'), false);\r\n  }\r\n\r\n  onCanSubmitChange() {\r\n    this.onButtonStateChanged(this.model, this.model.get('_buttonState'));\r\n  }\r\n\r\n  onButtonStateChanged(model, changedAttribute) {\r\n\r\n    this.updateAttemptsCount();\r\n\r\n    // Use 'correct' instead of 'complete' to signify button state\r\n    const $buttonsAction = this.$('.js-btn-action');\r\n    const buttonState = BUTTON_STATE(changedAttribute);\r\n    if (changedAttribute === BUTTON_STATE.CORRECT || changedAttribute === BUTTON_STATE.INCORRECT) {\r\n      // Both 'correct' and 'incorrect' states have no model answer, so disable the submit button\r\n      Adapt.a11y.toggleEnabled($buttonsAction, false);\r\n      return;\r\n    }\r\n\r\n    const propertyName = textPropertyName[buttonState.asString];\r\n    const ariaLabel = this.model.get('_buttons')['_' + propertyName].ariaLabel;\r\n    const buttonText = this.model.get('_buttons')['_' + propertyName].buttonText;\r\n\r\n    // Enable the button, make accessible and update aria labels and text\r\n    Adapt.a11y.toggleEnabled($buttonsAction, this.model.get('_canSubmit'));\r\n    $buttonsAction.html(buttonText).attr('aria-label', ariaLabel);\r\n  }\r\n\r\n  checkFeedbackState() {\r\n    const canShowFeedback = this.model.get('_canShowFeedback');\r\n\r\n    this.$('.js-btn-action').toggleClass('is-full-width', !canShowFeedback);\r\n    this.$('.js-btn-feedback').toggleClass('u-display-none', !canShowFeedback);\r\n    this.$('.js-btn-marking').toggleClass('is-full-width u-display-none', !canShowFeedback);\r\n  }\r\n\r\n  updateAttemptsCount() {\r\n    const isInteractionComplete = this.model.get('_isInteractionComplete');\r\n    const attemptsLeft = (this.model.get('_attemptsLeft')) ? this.model.get('_attemptsLeft') : this.model.get('_attempts');\r\n    const shouldDisplayAttempts = this.model.get('_shouldDisplayAttempts');\r\n    let attemptsString;\r\n\r\n    this.checkResetSubmittedState();\r\n\r\n    if (!isInteractionComplete && attemptsLeft !== 0) {\r\n      attemptsString = attemptsLeft + ' ';\r\n      attemptsString += attemptsLeft === 1 ?\r\n        this.model.get('_buttons').remainingAttemptText :\r\n        this.model.get('_buttons').remainingAttemptsText;\r\n    } else {\r\n      this.$('.js-display-attempts').addClass('u-visibility-hidden');\r\n      this.showMarking();\r\n    }\r\n\r\n    if (shouldDisplayAttempts) {\r\n      this.$('.js-insert-attempts-string').html(attemptsString);\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * Updates the ARIA 'live region' with the correct/user answer when that button\r\n   * is selected by the learner.\r\n   * @param {string} answer Textual representation of the correct/user answer\r\n   */\r\n  updateAnswerLiveRegion(answer) {\r\n    if (!answer) return;\r\n    this.$('.js-answer-live-region').html(answer);\r\n  }\r\n\r\n  showMarking() {\r\n    if (!this.model.shouldShowMarking) return;\r\n\r\n    const isCorrect = this.model.get('_isCorrect');\r\n    const ariaLabels = Adapt.course.get('_globals')._accessibility._ariaLabels;\r\n\r\n    this.$('.js-btn-marking')\r\n      .removeClass('u-display-none')\r\n      .addClass(isCorrect ? 'is-correct' : 'is-incorrect')\r\n      .attr('aria-label', isCorrect ? ariaLabels.answeredCorrectly : ariaLabels.answeredIncorrectly);\r\n  }\r\n\r\n  refresh() {\r\n    this.updateAttemptsCount();\r\n    this.checkResetSubmittedState();\r\n    this.checkFeedbackState();\r\n    this.onButtonStateChanged(null, this.model.get('_buttonState'));\r\n    this.onFeedbackMessageChanged(null, this.model.get('feedbackMessage'));\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport ComponentModel from 'core/js/models/componentModel';\r\nimport BUTTON_STATE from 'core/js/enums/buttonStateEnum';\r\n\r\nclass QuestionModel extends ComponentModel {\r\n\r\n  /// ///\r\n  // Setup question types\r\n  /// /\r\n\r\n  // Used to set model defaults\r\n  defaults() {\r\n    // Extend from the ComponentModel defaults\r\n    return ComponentModel.resultExtend('defaults', {\r\n      _isQuestionType: true,\r\n      _shouldDisplayAttempts: false,\r\n      _canShowModelAnswer: true,\r\n      _canShowFeedback: true,\r\n      _canShowMarking: true,\r\n      _canSubmit: true,\r\n      _isSubmitted: false,\r\n      _questionWeight: Adapt.config.get('_questionWeight'),\r\n      _items: []\r\n    });\r\n  }\r\n\r\n  // Extend from the ComponentModel trackable\r\n  trackable() {\r\n    return ComponentModel.resultExtend('trackable', [\r\n      '_isSubmitted',\r\n      '_score',\r\n      '_isCorrect',\r\n      '_attemptsLeft'\r\n    ]);\r\n  }\r\n\r\n  trackableType() {\r\n    return ComponentModel.resultExtend('trackableType', [\r\n      Boolean,\r\n      Number,\r\n      Boolean,\r\n      Number\r\n    ]);\r\n  }\r\n\r\n  /**\r\n   * Returns a string of the model type group.\r\n   * @returns {string}\r\n   */\r\n  getTypeGroup() {\r\n    return 'question';\r\n  }\r\n\r\n  init() {\r\n    this.setupDefaultSettings();\r\n    this.setLocking('_canSubmit', true);\r\n    super.init();\r\n  }\r\n\r\n  // Calls default methods to setup on questions\r\n  setupDefaultSettings() {\r\n    // Not sure this is needed anymore, keeping to maintain API\r\n    this.setupWeightSettings();\r\n    this.setupButtonSettings();\r\n  }\r\n\r\n  // Used to setup either global or local button text\r\n  setupButtonSettings() {\r\n    const globalButtons = Adapt.course.get('_buttons');\r\n\r\n    // Check if  '_buttons' attribute exists and if not use the globally defined buttons.\r\n    if (!this.has('_buttons')) {\r\n      this.set('_buttons', globalButtons);\r\n    } else {\r\n      // Check all the components buttons.\r\n      // If they are empty use the global defaults.\r\n      const componentButtons = this.get('_buttons');\r\n\r\n      for (let key in componentButtons) {\r\n        if (typeof componentButtons[key] === 'object') {\r\n          // Button text.\r\n          if (!componentButtons[key].buttonText && globalButtons[key].buttonText) {\r\n            componentButtons[key].buttonText = globalButtons[key].buttonText;\r\n          }\r\n\r\n          // ARIA labels.\r\n          if (!componentButtons[key].ariaLabel && globalButtons[key].ariaLabel) {\r\n            componentButtons[key].ariaLabel = globalButtons[key].ariaLabel;\r\n          }\r\n        }\r\n\r\n        if (!componentButtons[key] && globalButtons[key]) {\r\n          componentButtons[key] = globalButtons[key];\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // Used to setup either global or local question weight/score\r\n  setupWeightSettings() {\r\n    // Not needed as handled by model defaults, keeping to maintain API\r\n  }\r\n\r\n  /// ///\r\n  // Submit process\r\n  /// /\r\n\r\n  // Use to check if the user is allowed to submit the question\r\n  // Maybe the user has to select an item?\r\n  canSubmit() {}\r\n\r\n  checkCanSubmit() {\r\n    this.set('_canSubmit', this.canSubmit(), { pluginName: 'adapt' });\r\n  }\r\n\r\n  // Used to update the amount of attempts the user has left\r\n  updateAttempts() {\r\n    if (!this.get('_attemptsLeft')) {\r\n      this.set('_attemptsLeft', this.get('_attempts'));\r\n    }\r\n    this.set('_attemptsLeft', this.get('_attemptsLeft') - 1);\r\n  }\r\n\r\n  // Used to set _isEnabled and _isSubmitted on the model\r\n  setQuestionAsSubmitted() {\r\n    this.set({\r\n      _isEnabled: false,\r\n      _isSubmitted: true\r\n    });\r\n  }\r\n\r\n  // Sets _isCorrect:true/false based upon isCorrect method below\r\n  markQuestion() {\r\n\r\n    if (this.isCorrect()) {\r\n      this.set('_isCorrect', true);\r\n    } else {\r\n      this.set('_isCorrect', false);\r\n    }\r\n\r\n  }\r\n\r\n  // Should return a boolean based upon whether to question is correct or not\r\n  isCorrect() {}\r\n\r\n  // Used to set the score based upon the _questionWeight\r\n  setScore() {}\r\n\r\n  // Checks if the question should be set to complete\r\n  // Calls setCompletionStatus and adds complete classes\r\n  checkQuestionCompletion() {\r\n\r\n    const isComplete = (this.get('_isCorrect') || this.get('_attemptsLeft') === 0);\r\n\r\n    if (isComplete) {\r\n      this.setCompletionStatus();\r\n    }\r\n\r\n    return isComplete;\r\n\r\n  }\r\n\r\n  // Updates buttons based upon question state by setting\r\n  // _buttonState on the model which buttonsView listens to\r\n  updateButtons() {\r\n\r\n    const isInteractionComplete = this.get('_isInteractionComplete');\r\n    const isCorrect = this.get('_isCorrect');\r\n    const isEnabled = this.get('_isEnabled');\r\n    const buttonState = this.get('_buttonState');\r\n    const canShowModelAnswer = this.get('_canShowModelAnswer');\r\n\r\n    if (isInteractionComplete) {\r\n\r\n      if (isCorrect || !canShowModelAnswer) {\r\n        // Use correct instead of complete to signify button state\r\n        this.set('_buttonState', BUTTON_STATE.CORRECT);\r\n\r\n      } else {\r\n\r\n        switch (buttonState) {\r\n          case BUTTON_STATE.SUBMIT:\r\n          case BUTTON_STATE.HIDE_CORRECT_ANSWER:\r\n            this.set('_buttonState', BUTTON_STATE.SHOW_CORRECT_ANSWER);\r\n            break;\r\n          default:\r\n            this.set('_buttonState', BUTTON_STATE.HIDE_CORRECT_ANSWER);\r\n        }\r\n\r\n      }\r\n\r\n    } else {\r\n\r\n      if (isEnabled) {\r\n        this.set('_buttonState', BUTTON_STATE.SUBMIT);\r\n      } else {\r\n        this.set('_buttonState', BUTTON_STATE.RESET);\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  // Used to setup the correct, incorrect and partly correct feedback\r\n  setupFeedback() {\r\n    if (!this.has('_feedback')) return;\r\n\r\n    if (this.get('_isCorrect')) {\r\n      this.setupCorrectFeedback();\r\n    } else if (this.isPartlyCorrect()) {\r\n      this.setupPartlyCorrectFeedback();\r\n    } else {\r\n      this.setupIncorrectFeedback();\r\n    }\r\n  }\r\n\r\n  // Used by the question to determine if the question is incorrect or partly correct\r\n  // Should return a boolean\r\n  isPartlyCorrect() {}\r\n\r\n  setupCorrectFeedback() {\r\n    this.set({\r\n      feedbackTitle: this.getFeedbackTitle(),\r\n      feedbackMessage: this.get('_feedback').correct\r\n    });\r\n  }\r\n\r\n  setupPartlyCorrectFeedback() {\r\n    const feedback = this.get('_feedback')._partlyCorrect;\r\n\r\n    if (feedback?.final) {\r\n      this.setAttemptSpecificFeedback(feedback);\r\n    } else {\r\n      this.setupIncorrectFeedback();\r\n    }\r\n  }\r\n\r\n  setupIncorrectFeedback() {\r\n    this.setAttemptSpecificFeedback(this.get('_feedback')._incorrect);\r\n  }\r\n\r\n  setAttemptSpecificFeedback(feedback) {\r\n    const body = (this.get('_attemptsLeft') && feedback.notFinal) || feedback.final;\r\n\r\n    this.set({\r\n      feedbackTitle: this.getFeedbackTitle(),\r\n      feedbackMessage: body\r\n    });\r\n  }\r\n\r\n  getFeedbackTitle() {\r\n    return this.get('_feedback').title || this.get('displayTitle') || this.get('title') || '';\r\n  }\r\n\r\n  /**\r\n   * Used to determine whether the learner is allowed to interact with the question component or not.\r\n   * @return {Boolean}\r\n   */\r\n  isInteractive() {\r\n    return !this.get('_isComplete') || (this.get('_isEnabled') && !this.get('_isSubmitted'));\r\n  }\r\n\r\n  // Reset the model to let the user have another go (not the same as attempts)\r\n  reset(type, force) {\r\n    if (!this.get('_canReset') && !force) return;\r\n\r\n    type = type || true; // hard reset by default, can be \"soft\", \"hard\"/true\r\n\r\n    super.reset(type, force);\r\n\r\n    const attempts = this.get('_attempts');\r\n    this.set({\r\n      _attemptsLeft: attempts,\r\n      _isCorrect: undefined,\r\n      _isSubmitted: false,\r\n      _buttonState: BUTTON_STATE.SUBMIT\r\n    });\r\n  }\r\n\r\n  // Reset question for subsequent attempts\r\n  setQuestionAsReset() {\r\n    this.set({\r\n      _isEnabled: true,\r\n      _isSubmitted: false\r\n    });\r\n  }\r\n\r\n  refresh() {\r\n    this.trigger('question:refresh');\r\n  }\r\n\r\n  getButtonState() {\r\n    if (this.get('_isCorrect')) {\r\n      return BUTTON_STATE.CORRECT;\r\n    }\r\n\r\n    if (this.get('_attemptsLeft') === 0) {\r\n      return this.get('_canShowModelAnswer') ? BUTTON_STATE.SHOW_CORRECT_ANSWER : BUTTON_STATE.INCORRECT;\r\n    }\r\n\r\n    return this.get('_isSubmitted') ? BUTTON_STATE.RESET : BUTTON_STATE.SUBMIT;\r\n  }\r\n\r\n  // Returns an object specific to the question type, e.g. if the question\r\n  // is a 'choice' this should contain an object with:\r\n  // - correctResponsesPattern[]\r\n  // - choices[]\r\n  getInteractionObject() {\r\n    return {};\r\n  }\r\n\r\n  // Returns a string detailing how the user answered the question.\r\n  getResponse() {}\r\n\r\n  // Returns a string describing the type of interaction: \"choice\" and \"matching\" supported (see scorm wrapper)\r\n  getResponseType() {}\r\n\r\n  /**\r\n   * Called at the end of the onSubmitClicked view function.\r\n   */\r\n  onSubmitted() {\r\n    // Stores the current attempt state\r\n    this.addAttemptObject();\r\n  }\r\n\r\n  /** @type {boolean} */\r\n  get shouldShowMarking() {\r\n    if (!this.get('_canShowMarking')) {\r\n      return false;\r\n    }\r\n\r\n    return this.get('_isInteractionComplete');\r\n  }\r\n\r\n}\r\n\r\n// This abstract model needs to registered to support deprecated view-only questions\r\nAdapt.register('question', { model: QuestionModel });\r\n\r\nexport default QuestionModel;\r\n","import Adapt from 'core/js/adapt';\r\nimport ComponentView from 'core/js/views/componentView';\r\nimport ButtonsView from 'core/js/views/buttonsView';\r\nimport BUTTON_STATE from 'core/js/enums/buttonStateEnum';\r\n\r\nimport 'core/js/models/questionModel';\r\n\r\nclass QuestionView extends ComponentView {\r\n\r\n  className() {\r\n    return [\r\n      'component',\r\n      'is-question',\r\n      this.model.get('_component').toLowerCase(),\r\n      this.model.get('_id'),\r\n      this.model.get('_classes'),\r\n      this.setVisibility(),\r\n      'is-' + this.model.get('_layout'),\r\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\r\n      (this.model.get('_isOptional') ? 'is-optional' : ''),\r\n      (this.model.get('_canShowModelAnswer') ? 'can-show-model-answer' : ''),\r\n      (this.model.get('_canShowFeedback') ? 'can-show-feedback' : ''),\r\n      (this.model.get('_canShowMarking') ? 'can-show-marking' : '')\r\n    ].join(' ');\r\n  }\r\n\r\n  preRender() {\r\n    // Setup listener for _isEnabled\r\n    this.listenTo(this.model, 'change:_isEnabled', this.onEnabledChanged);\r\n\r\n    this.listenTo(this.model, 'question:refresh', this.refresh);\r\n\r\n    // Checks to see if the question should be reset on revisit\r\n    this.checkIfResetOnRevisit();\r\n    // This method helps setup default settings on the model\r\n    this._runModelCompatibleFunction('setupDefaultSettings');\r\n    // Blank method for setting up questions before rendering\r\n    this.setupQuestion();\r\n  }\r\n\r\n  // Used in the question view to disabled the question when _isEnabled has been set to false\r\n  onEnabledChanged(model, changedAttribute) {\r\n\r\n    // If isEnabled == false add disabled class\r\n    // else remove disabled class\r\n    if (!changedAttribute) {\r\n      this.$('.component__widget').addClass('is-disabled');\r\n      this.disableQuestion();\r\n    } else {\r\n      this.$('.component__widget').removeClass('is-disabled');\r\n      this.enableQuestion();\r\n    }\r\n\r\n  }\r\n\r\n  // Used by the question to disable the question during submit and complete stages\r\n  disableQuestion() {}\r\n\r\n  // Used by the question to enable the question during interactions\r\n  enableQuestion() {}\r\n\r\n  // Used to check if the question should reset on revisit\r\n  checkIfResetOnRevisit() {\r\n    const isResetOnRevisit = this.model.get('_isResetOnRevisit');\r\n    // If reset is enabled set defaults\r\n    // Call blank method for question to handle\r\n    if (isResetOnRevisit) {\r\n      this.model.reset(isResetOnRevisit, true);\r\n\r\n      // Defer is added to allow the component to render\r\n      _.defer(() => {\r\n        this.resetQuestionOnRevisit(isResetOnRevisit);\r\n      });\r\n\r\n      return;\r\n    }\r\n\r\n    // If complete - display learner's answer\r\n    // or reset the question if not complete\r\n    const isInteractionComplete = this.model.get('_isInteractionComplete');\r\n    if (isInteractionComplete) {\r\n      this.model.set('_buttonState', BUTTON_STATE.HIDE_CORRECT_ANSWER);\r\n      // Defer is added to allow the component to render\r\n      _.defer(() => {\r\n        this.onHideCorrectAnswerClicked();\r\n      });\r\n\r\n      return;\r\n    }\r\n\r\n    this.model.set('_buttonState', BUTTON_STATE.SUBMIT);\r\n    // Defer is added to allow the component to render\r\n    _.defer(() => {\r\n      this.onResetClicked();\r\n    });\r\n  }\r\n\r\n  // Used by the question to reset the question when revisiting the component\r\n  resetQuestionOnRevisit(type) {}\r\n\r\n  // Left blank for question setup - should be used instead of preRender\r\n  setupQuestion() {}\r\n\r\n  // Calls default methods to setup after the question is rendered\r\n  postRender() {\r\n    this.addButtonsView();\r\n    this.onQuestionRendered();\r\n  }\r\n\r\n  // Used to setup buttonsView and sets up the internal events for the question\r\n  addButtonsView() {\r\n    this.buttonsView = new ButtonsView({ model: this.model, el: this.$('.btn__container') });\r\n\r\n    this.listenTo(this.buttonsView, 'buttons:stateUpdate', this.onButtonStateUpdate);\r\n\r\n  }\r\n\r\n  onButtonStateUpdate(buttonState) {\r\n\r\n    switch (buttonState) {\r\n      case BUTTON_STATE.SUBMIT:\r\n        this.onSubmitClicked();\r\n        break;\r\n      case BUTTON_STATE.RESET:\r\n        this.onResetClicked();\r\n        break;\r\n      case BUTTON_STATE.SHOW_CORRECT_ANSWER:\r\n        this.onShowCorrectAnswerClicked();\r\n        break;\r\n      case BUTTON_STATE.HIDE_CORRECT_ANSWER:\r\n        this.onHideCorrectAnswerClicked();\r\n        break;\r\n      case BUTTON_STATE.SHOW_FEEDBACK:\r\n        this.showFeedback();\r\n        break;\r\n    }\r\n\r\n  }\r\n\r\n  // Blank method used just like postRender is for presentational components\r\n  onQuestionRendered() {}\r\n\r\n  // Triggered when the submit button is clicked\r\n  onSubmitClicked() {\r\n    // canSubmit is setup in questions and should return a boolean\r\n    // If the question stops the user form submitting - show instruction error\r\n    // and give a blank method, onCannotSubmit to the question\r\n    const canSubmit = this._runModelCompatibleFunction('canSubmit');\r\n\r\n    if (!canSubmit) {\r\n      this.showInstructionError();\r\n      this.onCannotSubmit();\r\n      return;\r\n    }\r\n\r\n    // Used to update the amount of attempts the question has\r\n    this._runModelCompatibleFunction('updateAttempts');\r\n\r\n    // Used to set attributes on the model after being submitted\r\n    // Also adds a class of submitted\r\n    this._runModelCompatibleFunction('setQuestionAsSubmitted');\r\n\r\n    // Used to remove instruction error that is set when\r\n    // the user has interacted in the wrong way\r\n    this.removeInstructionError();\r\n\r\n    // Used to store the users answer for later\r\n    // This is a blank method given to the question\r\n    this._runModelCompatibleFunction('storeUserAnswer');\r\n\r\n    // Used to set question as correct:true/false\r\n    // Calls isCorrect which is blank for the question\r\n    // to fill out and return a boolean\r\n    this._runModelCompatibleFunction('markQuestion', 'isCorrect');\r\n\r\n    // Used by the question to set the score on the model\r\n    this._runModelCompatibleFunction('setScore');\r\n\r\n    // Used to check if the question is complete\r\n    // Triggers setCompletionStatus and adds class to widget\r\n    this._runModelCompatibleFunction('checkQuestionCompletion');\r\n\r\n    // Used by the question to display markings on the component\r\n    if (this.model.shouldShowMarking) {\r\n      this.showMarking();\r\n    }\r\n\r\n    this.recordInteraction();\r\n\r\n    // Used to setup the feedback by checking against\r\n    // question isCorrect or isPartlyCorrect\r\n    this._runModelCompatibleFunction('setupFeedback');\r\n\r\n    // Used to trigger an event so plugins can display feedback\r\n    // Do this before updating the buttons so that the focus can be\r\n    // shifted immediately\r\n    this.showFeedback();\r\n\r\n    // Force height re-calculations before the submit button\r\n    // becomes disabled.\r\n    $(window).resize();\r\n\r\n    // Used to update buttonsView based upon question state\r\n    // Update buttons happens before showFeedback to preserve tabindexes and after setupFeedback to allow buttons to use feedback attribute\r\n    this._runModelCompatibleFunction('updateButtons');\r\n\r\n    this.model.onSubmitted();\r\n    this.onSubmitted();\r\n  }\r\n\r\n  showInstructionError() {\r\n    Adapt.trigger('questionView:showInstructionError', this);\r\n  }\r\n\r\n  // Blank method for question to fill out when the question cannot be submitted\r\n  onCannotSubmit() {}\r\n\r\n  // Blank method for question to fill out when the question was successfully submitted\r\n  onSubmitted() {}\r\n\r\n  // Used to set _isEnabled and _isSubmitted on the model\r\n  // Also adds a 'submitted' class to the widget\r\n  setQuestionAsSubmitted() {\r\n    this.model.setQuestionAsSubmitted();\r\n    this.$('.component__widget').addClass('is-submitted');\r\n  }\r\n\r\n  // Removes validation error class when the user canSubmit\r\n  removeInstructionError() {\r\n    this.$('.component__instruction-inner').removeClass('validation-error');\r\n  }\r\n\r\n  // This is important and should give the user feedback on how they answered the question\r\n  // Normally done through ticks and crosses by adding classes\r\n  showMarking() {}\r\n\r\n  // Checks if the question should be set to complete\r\n  // Calls setCompletionStatus and adds complete classes\r\n  checkQuestionCompletion() {\r\n\r\n    const isComplete = this.model.checkQuestionCompletion();\r\n\r\n    if (isComplete) {\r\n      this.$('.component__widget').addClass('is-complete show-user-answer');\r\n    }\r\n\r\n  }\r\n\r\n  recordInteraction() {\r\n    if (this.model.get('_recordInteraction') === true || !this.model.has('_recordInteraction')) {\r\n      Adapt.trigger('questionView:recordInteraction', this);\r\n    }\r\n  }\r\n\r\n  // Used to show feedback based upon whether _canShowFeedback is true\r\n  showFeedback() {\r\n\r\n    if (this.model.get('_canShowFeedback')) {\r\n      Adapt.trigger('questionView:showFeedback', this);\r\n    } else {\r\n      Adapt.trigger('questionView:disabledFeedback', this);\r\n    }\r\n\r\n  }\r\n\r\n  onResetClicked() {\r\n    this.setQuestionAsReset();\r\n\r\n    this._runModelCompatibleFunction('resetUserAnswer');\r\n\r\n    this.resetQuestion();\r\n\r\n    this.model.checkCanSubmit();\r\n\r\n    this._runModelCompatibleFunction('updateButtons');\r\n\r\n    // onResetClicked is called as part of the checkIfResetOnRevisit\r\n    // function and as a button click. if the view is already rendered,\r\n    // then the button was clicked, focus on the first tabbable element\r\n    if (!this.model.get('_isReady')) return;\r\n    // Attempt to get the current page location\r\n    const currentModel = Adapt.findById(Adapt.location._currentId);\r\n    // Make sure the page is ready\r\n    if (!currentModel?.get('_isReady')) return;\r\n    // Focus on the first readable item in this element\r\n    Adapt.a11y.focusNext(this.$el);\r\n\r\n  }\r\n\r\n  setQuestionAsReset() {\r\n    this.model.setQuestionAsReset();\r\n    this.$('.component__widget').removeClass('is-submitted');\r\n  }\r\n\r\n  // Used by the question view to reset the look and feel of the component.\r\n  // This could also include resetting item data\r\n  // This is triggered when the reset button is clicked so it shouldn't\r\n  // be a full reset\r\n  resetQuestion() {}\r\n\r\n  refresh() {\r\n    this.model.set('_buttonState', this.model.getButtonState());\r\n\r\n    if (this.model.shouldShowMarking && this.model.get('_isSubmitted')) {\r\n      this.showMarking();\r\n    }\r\n\r\n    if (this.buttonsView) {\r\n      _.defer(this.buttonsView.refresh.bind(this.buttonsView));\r\n    }\r\n  }\r\n\r\n  onShowCorrectAnswerClicked() {\r\n    this.setQuestionAsShowCorrect();\r\n\r\n    this._runModelCompatibleFunction('updateButtons');\r\n\r\n    this.showCorrectAnswer();\r\n  }\r\n\r\n  setQuestionAsShowCorrect() {\r\n    this.$('.component__widget')\r\n      .addClass('is-submitted show-correct-answer')\r\n      .removeClass('show-user-answer');\r\n  }\r\n\r\n  // Used by the question to display the correct answer to the user\r\n  showCorrectAnswer() {}\r\n\r\n  onHideCorrectAnswerClicked() {\r\n    this.setQuestionAsHideCorrect();\r\n\r\n    this._runModelCompatibleFunction('updateButtons');\r\n\r\n    this.hideCorrectAnswer();\r\n  }\r\n\r\n  setQuestionAsHideCorrect() {\r\n    this.$('.component__widget')\r\n      .addClass('is-submitted show-user-answer')\r\n      .removeClass('show-correct-answer');\r\n  }\r\n\r\n  // Used by the question to display the users answer and\r\n  // hide the correct answer\r\n  // Should use the values stored in storeUserAnswer\r\n  hideCorrectAnswer() {}\r\n\r\n  // Time elapsed between the time the interaction was made available to the learner for response and the time of the first response\r\n  getLatency() {\r\n    return null;\r\n  }\r\n\r\n  // This function is overridden if useQuestionModeOnly: false. see below.\r\n  _runModelCompatibleFunction(name, lookForViewOnlyFunction) {\r\n    return this.model[name](); // questionModel Only\r\n  }\r\n}\r\n\r\nQuestionView._isQuestionType = true;\r\n\r\n/* BACKWARDS COMPATIBILITY SECTION\r\n* This section below is only for compatibility between the separated questionView+questionModel and the old questionView\r\n* Remove this section in when all components use questionModel and there is no need to have model behaviour in the questionView\r\n*/\r\n\r\nclass ViewOnlyQuestionViewCompatibilityLayer extends QuestionView {\r\n\r\n  /* All of these functions have been moved to the questionModel.js file.\r\n    * On the rare occasion that they have not been overridden by the component and\r\n          that they call the view only questionView version,\r\n          these functions are included as redirects to the new Question Model.\r\n          It is very unlikely that these are needed but they are included to ensure compatibility.\r\n    * If you need to override these in your component you should now make and register a component model.\r\n    * Please remove them from your question component's view.\r\n  */\r\n\r\n  // Returns an object specific to the question type.\r\n  getInteractionObject() {\r\n    Adapt.log.deprecated('QuestionView.getInteractionObject, please use QuestionModel.getInteractionObject');\r\n    return this.model.getInteractionObject();\r\n  }\r\n\r\n  // Retturns a string detailing how the user answered the question.\r\n  getResponse() {\r\n    Adapt.log.deprecated('QuestionView.getInteractionObject, please use QuestionModel.getInteractionObject');\r\n    return this.model.getResponse();\r\n  }\r\n\r\n  // Returns a string describing the type of interaction: \"choice\" and \"matching\" supported (see scorm wrapper)\r\n  getResponseType() {\r\n    Adapt.log.deprecated('QuestionView.getResponseType, please use QuestionModel.getResponseType');\r\n    return this.model.getResponseType();\r\n  }\r\n\r\n  // Calls default methods to setup on questions\r\n  setupDefaultSettings() {\r\n    Adapt.log.deprecated('QuestionView.setupDefaultSettings, please use QuestionModel.setupDefaultSettings');\r\n    return this.model.setupDefaultSettings();\r\n  }\r\n\r\n  // Used to setup either global or local button text\r\n  setupButtonSettings() {\r\n    Adapt.log.deprecated('QuestionView.setupButtonSettings, please use QuestionModel.setupButtonSettings');\r\n    return this.model.setupButtonSettings();\r\n  }\r\n\r\n  // Used to setup either global or local question weight/score\r\n  setupWeightSettings() {\r\n    Adapt.log.deprecated('QuestionView.setupWeightSettings, please use QuestionModel.setupWeightSettings');\r\n    return this.model.setupWeightSettings();\r\n  }\r\n\r\n  // Use to check if the user is allowed to submit the question\r\n  // Maybe the user has to select an item?\r\n  canSubmit() {\r\n    Adapt.log.deprecated('QuestionView.canSubmit, please use QuestionModel.canSubmit');\r\n    return this.model.canSubmit();\r\n  }\r\n\r\n  // Used to update the amount of attempts the user has left\r\n  updateAttempts() {\r\n    Adapt.log.deprecated('QuestionView.updateAttempts, please use QuestionModel.updateAttempts');\r\n    return this.model.updateAttempts();\r\n  }\r\n\r\n  // This is important for returning or showing the users answer\r\n  // This should preserve the state of the users answers\r\n  storeUserAnswer() {\r\n    Adapt.log.deprecated('QuestionView.storeUserAnswer, please use QuestionModel.storeUserAnswer');\r\n    return this.model.storeUserAnswer();\r\n  }\r\n\r\n  // Used by the question view to reset the stored user answer\r\n  resetUserAnswer() {\r\n    Adapt.log.deprecated('QuestionView.resetUserAnswer, please use QuestionModel.resetUserAnswer');\r\n    return this.model.resetUserAnswer();\r\n  }\r\n\r\n  // Sets _isCorrect:true/false based upon isCorrect method below\r\n  markQuestion() {\r\n\r\n    if (this._isInViewOnlyCompatibleMode('isCorrect')) {\r\n\r\n      if (this.isCorrect()) {\r\n        this.model.set('_isCorrect', true);\r\n      } else {\r\n        this.model.set('_isCorrect', false);\r\n      }\r\n\r\n    } else {\r\n      return this.model.markQuestion();\r\n    }\r\n  }\r\n\r\n  // Should return a boolean based upon whether to question is correct or not\r\n  isCorrect() {\r\n    Adapt.log.deprecated('QuestionView.isCorrect, please use QuestionModel.isCorrect');\r\n    return this.model.isCorrect();\r\n  }\r\n\r\n  // Used to set the score based upon the _questionWeight\r\n  setScore() {\r\n    Adapt.log.deprecated('QuestionView.setScore, please use QuestionModel.setScore');\r\n    return this.model.setScore();\r\n  }\r\n\r\n  // Updates buttons based upon question state by setting\r\n  // _buttonState on the model which buttonsView listens to\r\n  updateButtons() {\r\n    Adapt.log.deprecated('QuestionView.updateButtons, please use QuestionModel.updateButtons');\r\n    return this.model.updateButtons();\r\n  }\r\n\r\n  // Used to setup the correct, incorrect and partly correct feedback\r\n  setupFeedback() {\r\n\r\n    if (this._isInViewOnlyCompatibleMode('isPartlyCorrect')) {\r\n\r\n      // Use view based feedback where necessary\r\n      if (this.model.get('_isCorrect')) {\r\n        this._runModelCompatibleFunction('setupCorrectFeedback');\r\n      } else if (this.isPartlyCorrect()) {\r\n        this._runModelCompatibleFunction('setupPartlyCorrectFeedback');\r\n      } else {\r\n        this._runModelCompatibleFunction('setupIncorrectFeedback');\r\n      }\r\n\r\n    } else {\r\n      // Use model based feedback\r\n      this.model.setupFeedback();\r\n    }\r\n\r\n  }\r\n\r\n  // Used by the question to determine if the question is incorrect or partly correct\r\n  // Should return a boolean\r\n  isPartlyCorrect() {\r\n    Adapt.log.deprecated('QuestionView.isPartlyCorrect, please use QuestionModel.isPartlyCorrect');\r\n    return this.model.isPartlyCorrect();\r\n  }\r\n\r\n  setupCorrectFeedback() {\r\n    Adapt.log.deprecated('QuestionView.setupCorrectFeedback, please use QuestionModel.setupCorrectFeedback');\r\n    return this.model.setupCorrectFeedback();\r\n  }\r\n\r\n  setupPartlyCorrectFeedback() {\r\n    Adapt.log.deprecated('QuestionView.setupPartlyCorrectFeedback, please use QuestionModel.setupPartlyCorrectFeedback');\r\n    return this.model.setupPartlyCorrectFeedback();\r\n  }\r\n\r\n  setupIncorrectFeedback() {\r\n    Adapt.log.deprecated('QuestionView.setupIncorrectFeedback, please use QuestionModel.setupIncorrectFeedback');\r\n    return this.model.setupIncorrectFeedback();\r\n  }\r\n\r\n  // Helper functions for compatibility layer\r\n  _runModelCompatibleFunction(name, lookForViewOnlyFunction) {\r\n    if (this._isInViewOnlyCompatibleMode(name, lookForViewOnlyFunction)) {\r\n      return this[name](); // questionView\r\n    } else {\r\n      return this.model[name](); // questionModel\r\n    }\r\n  }\r\n\r\n  _isInViewOnlyCompatibleMode(name, lookForViewOnlyFunction) {\r\n    // return false uses the model function questionModel\r\n    // return true uses the view only function questionView\r\n\r\n    const checkForFunction = (lookForViewOnlyFunction || name);\r\n\r\n    // if the function does NOT exist on the view at all, use the model only\r\n    if (!this.constructor.prototype[checkForFunction]) return false; // questionModel\r\n\r\n    // if the function DOES exist on the view and MATCHES the compatibility function above, use the model only\r\n    const hasCompatibleVersion = (ViewOnlyQuestionViewCompatibilityLayer.prototype.hasOwnProperty(checkForFunction));\r\n    const usingCompatibleVersion = (this.constructor.prototype[checkForFunction] === ViewOnlyQuestionViewCompatibilityLayer.prototype[checkForFunction]);\r\n    if (hasCompatibleVersion && usingCompatibleVersion) {\r\n      switch (checkForFunction) {\r\n        case 'setupFeedback':\r\n        case 'markQuestion':\r\n          return true; // questionView\r\n      }\r\n      return false; // questionModel\r\n    }\r\n\r\n    // if the function DOES exist on the view and does NOT match the compatibility function above, use the view function\r\n    return true; // questionView\r\n  }\r\n\r\n};\r\n\r\n// return question view class extended with the compatibility layer\r\nexport default ViewOnlyQuestionViewCompatibilityLayer;\r\n\r\n/* END OF BACKWARDS COMPATIBILITY SECTION */\r\n","define([\n  'core/js/adapt',\n  'core/js/views/questionView'\n], function(Adapt, QuestionView) {\n\n  var McqView = QuestionView.extend({\n\n    events: {\n      'focus .js-item-input': 'onItemFocus',\n      'blur .js-item-input': 'onItemBlur',\n      'change .js-item-input': 'onItemSelect',\n      'keyup .js-item-input': 'onKeyPress'\n    },\n\n    isCorrectAnswerShown: false,\n\n    initialize: function() {\n      QuestionView.prototype.initialize.apply(this, arguments);\n      this.update = _.debounce(this.update.bind(this), 1);\n      this.listenTo(this.model, {\n        'change:_isEnabled change:_isComplete change:_isSubmitted': this.update\n      });\n      this.listenTo(this.model.getChildren(), {\n        'change:_isActive': this.update\n      });\n    },\n\n    resetQuestionOnRevisit: function() {\n      this.resetQuestion();\n    },\n\n    setupQuestion: function() {\n      this.model.setupRandomisation();\n    },\n\n    onQuestionRendered: function() {\n      this.setReadyStatus();\n      this.update();\n    },\n\n    onKeyPress: function(event) {\n      if (event.which !== 13) return;\n      // <ENTER> keypress\n      this.onItemSelect(event);\n    },\n\n    onItemFocus: function(event) {\n      if (!this.model.isInteractive()) return;\n\n      this.$('.js-item-label[for=' + $(event.currentTarget).attr('id') + ']').addClass('is-highlighted');\n    },\n\n    onItemBlur: function(event) {\n      this.$('.js-item-label[for=' + $(event.currentTarget).attr('id') + ']').removeClass('is-highlighted');\n    },\n\n    onItemSelect: function(event) {\n      if (!this.model.isInteractive()) return;\n\n      var index = $(event.currentTarget).data('adapt-index');\n      var itemModel = this.model.getItem(index);\n      var shouldSelect = !itemModel.get('_isActive');\n\n      if (this.model.isSingleSelect()) {\n        // Assume a click is always a selection\n        shouldSelect = true;\n        this.model.resetActiveItems();\n      } else if (shouldSelect && this.model.isAtActiveLimit()) {\n        // At the selection limit, deselect the last item\n        this.model.getLastActiveItem().toggleActive(false);\n      }\n\n      // Select or deselect accordingly\n      itemModel.toggleActive(shouldSelect);\n    },\n\n    // Blank method to add functionality for when the user cannot submit\n    // Could be used for a popup or explanation dialog/hint\n    onCannotSubmit: function() {},\n\n    // This is important and should give the user feedback on how they answered the question\n    // Normally done through ticks and crosses by adding classes\n    showMarking: function() {\n      this.update();\n    },\n\n    // Used by the question view to reset the look and feel of the component.\n    resetQuestion: function() {\n      this.model.resetActiveItems();\n      this.model.resetItems();\n    },\n\n    showCorrectAnswer: function() {\n      this.isCorrectAnswerShown = true;\n      this.update();\n    },\n\n    hideCorrectAnswer: function() {\n      this.isCorrectAnswerShown = false;\n      this.update();\n    },\n\n    update: function() {\n      this.updateSelection();\n      this.updateMarking();\n    },\n\n    updateSelection: function() {\n\n      var isEnabled = this.model.get('_isEnabled');\n\n      this.model.getChildren().each(function(itemModel) {\n\n        var isSelected = this.isCorrectAnswerShown ?\n          itemModel.get('_shouldBeSelected') :\n          itemModel.get('_isActive');\n\n        var index = itemModel.get('_index');\n        this.$('.js-item-label').filter('[data-adapt-index=\"' + index + '\"]')\n          .toggleClass('is-selected', isSelected)\n          .toggleClass('is-disabled', !isEnabled);\n\n        this.$('.js-item-input').filter('[data-adapt-index=\"' + index + '\"]')\n          .prop('checked', isSelected)\n          .prop('disabled', !isEnabled);\n\n      }.bind(this));\n\n    },\n\n    updateMarking: function() {\n\n      var isInteractive = this.model.isInteractive();\n      var canShowMarking = this.model.get('_canShowMarking');\n      var ariaLabels = Adapt.course.get('_globals')._accessibility._ariaLabels;\n\n      this.model.getChildren().each(function(itemModel) {\n\n        var index = itemModel.get('_index');\n        var $itemInput = this.$('.js-item-input').filter('[data-adapt-index=\"' + index + '\"]');\n        var $item = $itemInput.parents('.js-mcq-item');\n\n        if (isInteractive || !canShowMarking) {\n          // Remove item marking\n          $item.removeClass('is-correct is-incorrect');\n          $itemInput.attr('aria-label', $.a11y_normalize(itemModel.get('text')));\n          return;\n        }\n\n        // Mark item\n        var shouldBeSelected = itemModel.get('_shouldBeSelected');\n        var isCorrect = Boolean(itemModel.get('_isCorrect'));\n        var isActive = Boolean(itemModel.get('_isActive'));\n\n        $item\n          .toggleClass('is-correct', isCorrect)\n          .toggleClass('is-incorrect', !isCorrect);\n\n        $itemInput.attr('aria-label', [\n          (shouldBeSelected ? ariaLabels.correct : ariaLabels.incorrect),\n          ', ',\n          (isActive ? ariaLabels.selectedAnswer : ariaLabels.unselectedAnswer),\n          '. ',\n          $.a11y_normalize(itemModel.get('text'))\n        ].join(''));\n\n      }.bind(this));\n\n    }\n\n  });\n\n  return McqView;\n\n});\n","import Adapt from 'core/js/adapt';\r\nimport QuestionModel from 'core/js/models/questionModel';\r\nimport ItemsComponentModel from 'core/js/models/itemsComponentModel';\r\n\r\nclass BlendedItemsComponentQuestionModel extends QuestionModel {\r\n\r\n  init() {\r\n    ItemsComponentModel.prototype.init.call(this);\r\n    super.init();\r\n  }\r\n\r\n  reset(type, force) {\r\n    ItemsComponentModel.prototype.reset.call(this, type, force);\r\n    super.reset(type, force);\r\n  }\r\n\r\n}\r\n// extend BlendedItemsComponentQuestionModel with ItemsComponentModel\r\nObject.getOwnPropertyNames(ItemsComponentModel.prototype).forEach(name => {\r\n  if (name === 'constructor' || name === 'init' || name === 'reset') return;\r\n  Object.defineProperty(BlendedItemsComponentQuestionModel.prototype, name, {\r\n    value: ItemsComponentModel.prototype[name]\r\n  });\r\n});\r\n\r\nexport default class ItemsQuestionModel extends BlendedItemsComponentQuestionModel {\r\n\r\n  init() {\r\n    super.init();\r\n    this.set('_isRadio', this.isSingleSelect());\r\n    this.listenTo(this.getChildren(), 'change:_isActive', this.checkCanSubmit);\r\n    this.checkCanSubmit();\r\n  }\r\n\r\n  restoreUserAnswers() {\r\n    if (!this.get('_isSubmitted')) return;\r\n\r\n    const itemModels = this.getChildren();\r\n    const userAnswer = this.get('_userAnswer');\r\n    itemModels.each(item => {\r\n      item.toggleActive(userAnswer[item.get('_index')]);\r\n    });\r\n\r\n    this.setQuestionAsSubmitted();\r\n    this.markQuestion();\r\n    this.setScore();\r\n    this.setupFeedback();\r\n  }\r\n\r\n  setupRandomisation() {\r\n    if (!this.get('_isRandom') || !this.get('_isEnabled')) return;\r\n    const children = this.getChildren();\r\n    children.set(children.shuffle());\r\n  }\r\n\r\n  // check if the user is allowed to submit the question\r\n  canSubmit() {\r\n    const activeItems = this.getActiveItems();\r\n    return activeItems.length > 0;\r\n  }\r\n\r\n  // This is important for returning or showing the users answer\r\n  // This should preserve the state of the users answers\r\n  storeUserAnswer() {\r\n    const items = this.getChildren().slice(0);\r\n    items.sort((a, b) => a.get('_index') - b.get('_index'));\r\n    const userAnswer = items.map(itemModel => itemModel.get('_isActive'));\r\n    this.set('_userAnswer', userAnswer);\r\n  }\r\n\r\n  isCorrect() {\r\n\r\n    const props = {\r\n      _numberOfRequiredAnswers: 0,\r\n      _numberOfIncorrectAnswers: 0,\r\n      _isAtLeastOneCorrectSelection: false,\r\n      _numberOfCorrectAnswers: 0\r\n    };\r\n\r\n    this.getChildren().each(itemModel => {\r\n      const itemShouldBeActive = itemModel.get('_shouldBeSelected');\r\n      if (itemShouldBeActive) {\r\n        props._numberOfRequiredAnswers++;\r\n      }\r\n\r\n      if (!itemModel.get('_isActive')) return;\r\n\r\n      if (!itemShouldBeActive) {\r\n        props._numberOfIncorrectAnswers++;\r\n        return;\r\n      }\r\n\r\n      props._isAtLeastOneCorrectSelection = true;\r\n      props._numberOfCorrectAnswers++;\r\n      itemModel.set('_isCorrect', true);\r\n    });\r\n\r\n    this.set(props);\r\n\r\n    const hasRightNumberOfCorrectAnswers = (props._numberOfCorrectAnswers === props._numberOfRequiredAnswers);\r\n    const hasNoIncorrectAnswers = !props._numberOfIncorrectAnswers;\r\n\r\n    return hasRightNumberOfCorrectAnswers && hasNoIncorrectAnswers;\r\n  }\r\n\r\n  // Sets the score based upon the questionWeight\r\n  // Can be overwritten if the question needs to set the score in a different way\r\n  setScore() {\r\n    const questionWeight = this.get('_questionWeight');\r\n    const answeredCorrectly = this.get('_isCorrect');\r\n    const score = answeredCorrectly ? questionWeight : 0;\r\n    this.set('_score', score);\r\n  }\r\n\r\n  setupFeedback() {\r\n    if (!this.has('_feedback')) return;\r\n\r\n    if (this.get('_isCorrect')) {\r\n      this.setupCorrectFeedback();\r\n      return;\r\n    }\r\n\r\n    if (this.isPartlyCorrect()) {\r\n      this.setupPartlyCorrectFeedback();\r\n      return;\r\n    }\r\n\r\n    // apply individual item feedback\r\n    const activeItem = this.getActiveItem();\r\n    if (this.isSingleSelect() && activeItem.get('feedback')) {\r\n      this.setupIndividualFeedback(activeItem);\r\n      return;\r\n    }\r\n\r\n    this.setupIncorrectFeedback();\r\n  }\r\n\r\n  setupIndividualFeedback(selectedItem) {\r\n    this.set({\r\n      feedbackTitle: this.getFeedbackTitle(this.get('_feedback')),\r\n      feedbackMessage: selectedItem.get('feedback')\r\n    });\r\n  }\r\n\r\n  isPartlyCorrect() {\r\n    return this.get('_isAtLeastOneCorrectSelection');\r\n  }\r\n\r\n  resetUserAnswer() {\r\n    this.set('_userAnswer', []);\r\n  }\r\n\r\n  isAtActiveLimit() {\r\n    const selectedItems = this.getActiveItems();\r\n    return (selectedItems.length === this.get('_selectable'));\r\n  }\r\n\r\n  isSingleSelect() {\r\n    return (this.get('_selectable') === 1);\r\n  }\r\n\r\n  getLastActiveItem() {\r\n    const selectedItems = this.getActiveItems();\r\n    return selectedItems[selectedItems.length - 1];\r\n  }\r\n\r\n  resetItems() {\r\n    this.resetActiveItems();\r\n    this.set('_isAtLeastOneCorrectSelection', false);\r\n  }\r\n\r\n  getInteractionObject() {\r\n    const interactions = {\r\n      correctResponsesPattern: [],\r\n      choices: []\r\n    };\r\n\r\n    interactions.choices = this.getChildren().map(itemModel => {\r\n      return {\r\n        id: (itemModel.get('_index') + 1).toString(),\r\n        description: itemModel.get('text')\r\n      };\r\n    });\r\n\r\n    const correctItems = this.getChildren().filter(itemModel => {\r\n      return itemModel.get('_shouldBeSelected');\r\n    });\r\n\r\n    interactions.correctResponsesPattern = [\r\n      correctItems.map(itemModel => {\r\n        // indexes are 0-based, we need them to be 1-based for cmi.interactions\r\n        return String(itemModel.get('_index') + 1);\r\n      }).join('[,]')\r\n    ];\r\n\r\n    return interactions;\r\n  }\r\n\r\n  /**\r\n  * used by adapt-contrib-spoor to get the user's answers in the format required by the cmi.interactions.n.student_response data field\r\n  * returns the user's answers as a string in the format '1,5,2'\r\n  */\r\n  getResponse() {\r\n    const activeItems = this.getActiveItems();\r\n    const activeIndexes = activeItems.map(itemModel => {\r\n      // indexes are 0-based, we need them to be 1-based for cmi.interactions\r\n      return itemModel.get('_index') + 1;\r\n    });\r\n    return activeIndexes.join(',');\r\n  }\r\n\r\n  /**\r\n  * used by adapt-contrib-spoor to get the type of this question in the format required by the cmi.interactions.n.type data field\r\n  */\r\n  getResponseType() {\r\n    return 'choice';\r\n  }\r\n\r\n  /**\r\n   * Creates a string explaining the answer(s) the learner should have chosen\r\n   * Used by ButtonsView to retrieve question-specific correct answer text for the ARIA\r\n   * 'live region' that gets updated when the learner selects the 'show correct answer' button\r\n   * @return {string}\r\n   */\r\n  getCorrectAnswerAsText() {\r\n    const globals = Adapt.course.get('_globals')._components['_' + this.get('_component')];\r\n    const isSingleSelect = this.isSingleSelect();\r\n    const ariaAnswer = isSingleSelect ? globals?.ariaCorrectAnswer : globals?.ariaCorrectAnswers;\r\n    if (!ariaAnswer) return;\r\n\r\n    const correctOptions = this.getChildren().where({ _shouldBeSelected: true });\r\n    const correctAnswer = isSingleSelect ?\r\n      correctOptions[0]?.get('text') :\r\n      correctOptions.map(correctOption => correctOption.get('text')).join('<br>');\r\n\r\n    return Handlebars.compile(ariaAnswer)({ correctAnswer });\r\n  }\r\n\r\n  /**\r\n   * Creates a string listing the answer(s) the learner chose\r\n   * Used by ButtonsView to retrieve question-specific user answer text for the ARIA\r\n   * 'live region' that gets updated when the learner selects the 'hide correct answer' button\r\n   * @return {string}\r\n   */\r\n  getUserAnswerAsText() {\r\n    const globals = Adapt.course.get('_globals')._components['_' + this.get('_component')];\r\n    const isSingleSelect = this.isSingleSelect();\r\n    const ariaAnswer = isSingleSelect ? globals?.ariaUserAnswer : globals?.ariaUserAnswers;\r\n    if (!ariaAnswer) return;\r\n\r\n    const selectedItems = this.getActiveItems();\r\n    const userAnswer = isSingleSelect ?\r\n      selectedItems[0].get('text') :\r\n      selectedItems.map(selectedItem => selectedItem.get('text')).join('<br>');\r\n\r\n    return Handlebars.compile(ariaAnswer)({ userAnswer });\r\n  }\r\n\r\n}\r\n","define([\n  'core/js/adapt',\n  './mcqView',\n  'core/js/models/itemsQuestionModel'\n], function(Adapt, McqView, ItemsQuestionModel) {\n\n  return Adapt.register('mcq', {\n    view: McqView,\n    // Extend ItemsQuestionModel to distinguish McqModel in\n    // the inheritance chain and allow targeted model extensions.\n    model: ItemsQuestionModel.extend({})\n  });\n\n});\n","define([\n  'core/js/adapt',\n  'components/adapt-contrib-mcq/js/adapt-contrib-mcq'\n], function(Adapt, Mcq) {\n\n  var Gmcq = Mcq.view.extend({\n\n    setupQuestion: function() {\n      Mcq.view.prototype.setupQuestion.call(this);\n\n      this.listenTo(Adapt, {\n        'device:changed': this.resizeImage,\n        'device:resize': this.onDeviceResize\n      });\n\n    },\n\n    onQuestionRendered: function() {\n\n      this.resizeImage(Adapt.device.screenSize);\n      this.setUpColumns();\n\n      this.$('.js-item-label').imageready(this.setReadyStatus.bind(this));\n\n    },\n\n    onDeviceResize: function() {\n      this.setUpColumns();\n    },\n\n    resizeImage: function(width) {\n      var imageWidth = width === 'medium' ? 'small' : width;\n\n      this.$('.js-item-label').each(function(index) {\n        var $img = $(this).find('img');\n        var newSrc = $img.attr('data-' + imageWidth);\n        if (!newSrc) return;\n        $img.attr('src', newSrc);\n      });\n\n    },\n\n    setUpColumns: function() {\n      var columns = this.model.get('_columns');\n\n      if (!columns) return;\n\n      var isLarge = Adapt.device.screenSize === 'large';\n\n      this.$el.toggleClass('has-column-layout', isLarge);\n      this.$('.js-mcq-item').css('width', isLarge ? (100 / columns) + '%' : '');\n    }\n\n  }, {\n    template: 'gmcq'\n  });\n\n  return Adapt.register('gmcq', {\n    view: Gmcq,\n    model: Mcq.model.extend({})\n  });\n\n});\n","define([\n  'core/js/adapt',\n  'core/js/views/componentView',\n  'core/js/models/componentModel'\n], function(Adapt, ComponentView, ComponentModel) {\n\n  class GraphicView extends ComponentView {\n\n    preRender() {\n      this.listenTo(Adapt, 'device:changed', this.resizeImage);\n\n      this.checkIfResetOnRevisit();\n    }\n\n    postRender() {\n      this.resizeImage(Adapt.device.screenSize, true);\n    }\n\n    checkIfResetOnRevisit() {\n      const isResetOnRevisit = this.model.get('_isResetOnRevisit');\n\n      if (isResetOnRevisit) {\n        this.model.reset(isResetOnRevisit);\n      }\n    }\n\n    resizeImage(width, setupInView) {\n      const imageWidth = width === 'medium' ? 'small' : width;\n      const imageSrc = (this.model.get('_graphic')) ? this.model.get('_graphic')[imageWidth] : '';\n      this.$('.js-graphic-set-image-src').attr('src', imageSrc);\n\n      this.$('.graphic__widget').imageready(() => {\n        this.setReadyStatus();\n\n        if (setupInView) {\n          this.setupInviewCompletion('.graphic__widget');\n        }\n      });\n    }\n  }\n\n  GraphicView.template = 'graphic';\n\n  return Adapt.register('graphic', {\n    model: ComponentModel.extend({}),// create a new class in the inheritance chain so it can be extended per component type if necessary later\n    view: GraphicView\n  });\n\n});\n","define([\r\n  'core/js/adapt'\r\n], function(Adapt) {\r\n\r\n  class HotgraphicPopupView extends Backbone.View {\r\n\r\n    className() {\r\n      return 'hotgraphic-popup';\r\n    }\r\n\r\n    events() {\r\n      return {\r\n        'click .js-hotgraphic-popup-close': 'closePopup',\r\n        'click .js-hotgraphic-controls-click': 'onControlClick'\r\n      };\r\n    }\r\n\r\n    initialize(...args) {\r\n      super.initialize(...args);\r\n      // Debounce required as a second (bad) click event is dispatched on iOS causing a jump of two items.\r\n      this.onControlClick = _.debounce(this.onControlClick.bind(this), 100);\r\n      this.listenToOnce(Adapt, 'notify:opened', this.onOpened);\r\n      this.listenTo(this.model.get('_children'), {\r\n        'change:_isActive': this.onItemsActiveChange,\r\n        'change:_isVisited': this.onItemsVisitedChange\r\n      });\r\n      this.render();\r\n    }\r\n\r\n    onOpened() {\r\n      this.applyNavigationClasses(this.model.getActiveItem().get('_index'));\r\n      this.updatePageCount();\r\n      this.handleTabs();\r\n    }\r\n\r\n    applyNavigationClasses (index) {\r\n      const itemCount = this.model.get('_items').length;\r\n      const canCycleThroughPagination = this.model.get('_canCycleThroughPagination');\r\n\r\n      const shouldEnableBack = index > 0 || canCycleThroughPagination;\r\n      const shouldEnableNext = index < itemCount - 1 || canCycleThroughPagination;\r\n      const $controls = this.$('.hotgraphic-popup__controls');\r\n\r\n      this.$('hotgraphic-popup__nav')\r\n          .toggleClass('first', !shouldEnableBack)\r\n          .toggleClass('last', !shouldEnableNext);\r\n\r\n      Adapt.a11y.toggleAccessibleEnabled($controls.filter('.back'), shouldEnableBack);\r\n      Adapt.a11y.toggleAccessibleEnabled($controls.filter('.next'), shouldEnableNext);\r\n    }\r\n\r\n    updatePageCount() {\r\n      const template = Adapt.course.get('_globals')._components._hotgraphic.popupPagination || '{{itemNumber}} / {{totalItems}}';\r\n      const labelText = Handlebars.compile(template)({\r\n        itemNumber: this.model.getActiveItem().get('_index') + 1,\r\n        totalItems: this.model.get('_items').length\r\n      });\r\n      this.$('.hotgraphic-popup__count').html(labelText);\r\n    }\r\n\r\n    handleTabs() {\r\n      Adapt.a11y.toggleHidden(this.$('.hotgraphic-popup__item:not(.is-active)'), true);\r\n      Adapt.a11y.toggleHidden(this.$('.hotgraphic-popup__item.is-active'), false);\r\n    }\r\n\r\n    onItemsActiveChange(item, _isActive) {\r\n      if (!_isActive) return;\r\n      const index = item.get('_index');\r\n      this.updatePageCount();\r\n      this.applyItemClasses(index);\r\n      this.handleTabs();\r\n      this.handleFocus(index);\r\n    }\r\n\r\n    applyItemClasses(index) {\r\n      this.$(`.hotgraphic-popup__item[data-index=\"${index}\"]`).addClass('is-active').removeAttr('aria-hidden');\r\n      this.$(`.hotgraphic-popup__item[data-index=\"${index}\"] .hotgraphic-popup__item-title`).attr('id', 'notify-heading');\r\n      this.$(`.hotgraphic-popup__item:not([data-index=\"${index}\"])`).removeClass('is-active').attr('aria-hidden', 'true');\r\n      this.$(`.hotgraphic-popup__item:not([data-index=\"${index}\"]) .hotgraphic-popup__item-title`).removeAttr('id');\r\n    }\r\n\r\n    handleFocus(index) {\r\n      Adapt.a11y.focusFirst(this.$('.hotgraphic-popup__inner .is-active'));\r\n      this.applyNavigationClasses(index);\r\n    }\r\n\r\n    onItemsVisitedChange(item, _isVisited) {\r\n      if (!_isVisited) return;\r\n\r\n      this.$('.hotgraphic-popup__item')\r\n          .filter(`[data-index=\"${item.get('_index')}\"]`)\r\n          .addClass('is-visited');\r\n    }\r\n\r\n    render() {\r\n      const data = this.model.toJSON();\r\n      data.view = this;\r\n      const template = Handlebars.templates[this.constructor.template];\r\n      this.$el.html(template(data));\r\n    }\r\n\r\n    closePopup() {\r\n      Adapt.trigger('notify:close');\r\n    }\r\n\r\n    onControlClick(event) {\r\n      const direction = $(event.currentTarget).data('direction');\r\n      const index = this.getNextIndex(direction);\r\n      if (index === -1) return;\r\n\r\n      this.setItemState(index);\r\n    }\r\n\r\n    getNextIndex(direction) {\r\n      let index = this.model.getActiveItem().get('_index');\r\n      const lastIndex = this.model.get('_items').length - 1;\r\n\r\n      switch (direction) {\r\n        case 'back':\r\n          if (index > 0) return --index;\r\n          if (this.model.get('_canCycleThroughPagination')) return lastIndex;\r\n          break;\r\n        case 'next':\r\n          if (index < lastIndex) return ++index;\r\n          if (this.model.get('_canCycleThroughPagination')) return 0;\r\n      }\r\n      return -1;\r\n    }\r\n\r\n    setItemState(index) {\r\n      this.model.getActiveItem().toggleActive();\r\n\r\n      const nextItem = this.model.getItem(index);\r\n      nextItem.toggleActive();\r\n      nextItem.toggleVisited(true);\r\n    }\r\n\r\n  };\r\n\r\n  HotgraphicPopupView.template = 'hotgraphicPopup';\r\n\r\n  return HotgraphicPopupView;\r\n\r\n});\r\n","define([\r\n  'core/js/adapt',\r\n  'core/js/views/componentView',\r\n  './hotgraphicPopupView'\r\n], function(Adapt, ComponentView, HotgraphicPopupView) {\r\n\r\n  class HotGraphicView extends ComponentView {\r\n\r\n    events () {\r\n      return {\r\n        'click .js-hotgraphic-item-click': 'onPinClicked'\r\n      };\r\n    }\r\n\r\n    initialize(...args) {\r\n      super.initialize(...args);\r\n\r\n      this.setUpViewData();\r\n      this.setUpModelData();\r\n      this.setUpEventListeners();\r\n      this.checkIfResetOnRevisit();\r\n    }\r\n\r\n    setUpViewData() {\r\n      this.popupView = null;\r\n      this._isPopupOpen = false;\r\n    }\r\n\r\n    setUpModelData() {\r\n      if (this.model.get('_canCycleThroughPagination') === undefined) {\r\n        this.model.set('_canCycleThroughPagination', false);\r\n      }\r\n    }\r\n\r\n    setUpEventListeners() {\r\n      this.listenTo(Adapt, 'device:changed', this.reRender);\r\n\r\n      this.listenTo(this.model.get('_children'), {\r\n        'change:_isActive': this.onItemsActiveChange,\r\n        'change:_isVisited': this.onItemsVisitedChange\r\n      });\r\n    }\r\n\r\n    reRender() {\r\n      if (Adapt.device.screenSize === 'large' || this.model.get('_isNarrativeOnMobile') === false) return;\r\n\r\n      this.replaceWithNarrative();\r\n    }\r\n\r\n    replaceWithNarrative() {\r\n      const NarrativeView = Adapt.getViewClass('narrative');\r\n      if (!NarrativeView) return;\r\n\r\n      const model = this.prepareNarrativeModel();\r\n      const newNarrative = new NarrativeView({ model });\r\n      // NOTE: if this component is doing its inital render in 'narrative mode',\r\n      // this.$el.parents() won't exist at this point - which is why the following is\r\n      // written the way it is, instead of (what would appear to be) the more efficient\r\n      // this.$el.parents('.component__container')\r\n      const $container = Adapt.findViewByModelId(model.get('_parentId')).$el.find('.component__container');\r\n      $container.append(newNarrative.$el);\r\n\r\n      this.remove();\r\n      _.defer(() => {\r\n        Adapt.trigger('device:resize');\r\n      });\r\n    }\r\n\r\n    prepareNarrativeModel() {\r\n      this.model.set({\r\n        _component: 'narrative',\r\n        _wasHotgraphic: true,\r\n        originalBody: this.model.get('body'),\r\n        originalInstruction: this.model.get('instruction')\r\n      });\r\n\r\n      // Check if active item exists, default to 0\r\n      const activeItem = this.model.getActiveItem();\r\n      if (!activeItem) {\r\n        this.model.getItem(0).toggleActive(true);\r\n      }\r\n\r\n      // Swap mobile body and instructions for desktop variants.\r\n      if (this.model.get('mobileBody')) {\r\n        this.model.set('body', this.model.get('mobileBody'));\r\n      }\r\n      if (this.model.get('mobileInstruction')) {\r\n        this.model.set('instruction', this.model.get('mobileInstruction'));\r\n      }\r\n\r\n      return this.model;\r\n    }\r\n\r\n    onItemsActiveChange(model, _isActive) {\r\n      this.getItemElement(model).toggleClass('is-active', _isActive);\r\n    }\r\n\r\n    getItemElement(model) {\r\n      const index = model.get('_index');\r\n      return this.$('.js-hotgraphic-item-click').filter(`[data-index=\"${index}\"]`);\r\n    }\r\n\r\n    onItemsVisitedChange(model, _isVisited) {\r\n      if (!_isVisited) return;\r\n\r\n      const $pin = this.getItemElement(model);\r\n      // Append the word 'visited.' to the pin's aria-label\r\n      const visitedLabel = ` ${this.model.get('_globals')._accessibility._ariaLabels.visited}.`;\r\n      $pin.find('.aria-label').each(function(index, el) {\r\n        el.innerHTML += visitedLabel;\r\n      });\r\n\r\n      $pin.addClass('is-visited');\r\n    }\r\n\r\n    checkIfResetOnRevisit() {\r\n      const isResetOnRevisit = this.model.get('_isResetOnRevisit');\r\n\r\n      // If reset is enabled set defaults\r\n      if (isResetOnRevisit) {\r\n        this.model.reset(isResetOnRevisit);\r\n      }\r\n    }\r\n\r\n    preRender() {\r\n      if (Adapt.device.screenSize === 'large') {\r\n        this.render();\r\n        return;\r\n      }\r\n\r\n      this.reRender();\r\n    }\r\n\r\n    postRender() {\r\n      this.$('.hotgraphic__widget').imageready(this.setReadyStatus.bind(this));\r\n      if (this.model.get('_setCompletionOn') === 'inview') {\r\n        this.setupInviewCompletion('.component__widget');\r\n      }\r\n    }\r\n\r\n    onPinClicked (event) {\r\n      const item = this.model.getItem($(event.currentTarget).data('index'));\r\n      item.toggleActive(true);\r\n      item.toggleVisited(true);\r\n\r\n      this.openPopup();\r\n    }\r\n\r\n    openPopup() {\r\n      if (this._isPopupOpen) return;\r\n\r\n      this._isPopupOpen = true;\r\n\r\n      this.popupView = new HotgraphicPopupView({\r\n        model: this.model\r\n      });\r\n\r\n      Adapt.notify.popup({\r\n        _view: this.popupView,\r\n        _isCancellable: true,\r\n        _showCloseButton: false,\r\n        _classes: 'hotgraphic ' + this.model.get('_classes')\r\n      });\r\n\r\n      this.listenToOnce(Adapt, {\r\n        'popup:closed': this.onPopupClosed\r\n      });\r\n    }\r\n\r\n    onPopupClosed() {\r\n      this.model.getActiveItem().toggleActive();\r\n      this._isPopupOpen = false;\r\n    }\r\n\r\n  }\r\n\r\n  HotGraphicView.template = 'hotgraphic';\r\n\r\n  return HotGraphicView;\r\n\r\n});\r\n","define([\r\n  'core/js/adapt',\r\n  './hotgraphicView',\r\n  'core/js/models/itemsComponentModel'\r\n], function(Adapt, HotgraphicView, ItemsComponentModel) {\r\n\r\n  return Adapt.register('hotgraphic', {\r\n    model: ItemsComponentModel.extend({}),\r\n    view: HotgraphicView\r\n  });\r\n\r\n});\r\n","define(function() {\n\n  var DropDownItem = Backbone.View.extend({\n\n    events: {\n      'click': 'onClick',\n      'click *': 'onClick'\n    },\n\n    initialize: function(settings) {\n      this.settings = settings;\n      this.$inner = this.$('.js-dropdown-list-item-inner');\n    },\n\n    isPlaceholder: function() {\n      return this.$el.is('[hidden]');\n    },\n\n    parent: function() {\n      return this.settings.parent;\n    },\n\n    onClick: function(event) {\n      var parent = this.parent();\n      event.preventDefault();\n      this.select().scrollTo();\n      parent.$button.focus();\n    },\n\n    getValue: function() {\n      return this.$el.attr('value').trim();\n    },\n\n    select: function() {\n      var parent = this.parent();\n      parent.deselectAll();\n      parent.setActiveDescendantId(this.el.id);\n      this.$el.attr({\n        selected: '',\n        'aria-selected': 'true'\n      });\n      parent.$inner.html(this.$el.attr('text'));\n      var value = this.isPlaceholder() ? '' : this.getValue();\n      parent.$input.val(value).trigger('change');\n      parent.trigger('change', parent);\n      return this;\n    },\n\n    deselect: function() {\n      if (!this.isSelected()) return this;\n      var parent = this.parent();\n      parent.removeActiveDescendantId();\n      this.$el.removeAttr('selected');\n      this.$el.attr('aria-selected', 'false');\n      parent.$inner.html('');\n      parent.$input.val('').trigger('change');\n      parent.trigger('change', parent);\n      return this;\n    },\n\n    reselect: function() {\n      var parent = this.parent();\n      parent.setActiveDescendantId(this.$el[0].id);\n      if (this.isSelected()) return this;\n      this.select();\n      return this;\n    },\n\n    isSelected: function() {\n      return Boolean(this.$el.attr('selected'));\n    },\n\n    getIndex: function() {\n      var parent = this.parent();\n      return _.findIndex(parent.options, function(option) {\n        return (option === this);\n      }.bind(this));\n    },\n\n    getNext: function() {\n      var parent = this.parent();\n      return parent.options[this.getIndex() + 1];\n    },\n\n    getPrevious: function() {\n      var parent = this.parent();\n      return parent.options[this.getIndex() - 1];\n    },\n\n    getFirst: function() {\n      var parent = this.parent();\n      return parent.options[0];\n    },\n\n    getLast: function() {\n      var parent = this.parent();\n      return parent.options[parent.options.length - 1];\n    },\n\n    scrollTo: function() {\n      var parent = this.parent();\n      parent.settings.scrollToItem.call(parent, this);\n    },\n\n    destroy: function() {\n      var parent = this.parent();\n      this.remove();\n      if (this.isPlaceholder()) {\n        parent.placeholder = null;\n      } else {\n        for (var i = 0, l = parent.options.length; i < l; i++) {\n          var item = parent.options[i];\n          if (item !== this) continue;\n          parent.options.splice(i, 1);\n          break;\n        }\n      }\n      delete this.settings;\n    }\n\n  });\n\n  return DropDownItem;\n\n});\n","define([\n  './dropdownOption'\n], function(DropDownOption) {\n\n  var DropDown = Backbone.View.extend({\n\n    initialize: function(settings) {\n      _.bindAll(this, 'onStartInteraction', 'onButtonClick', 'onListBlur', 'onKeyDown');\n      this.settings = _.defaults(settings, this.getDefaults());\n      this.placeholder = null;\n      this.options = [];\n      this.setUpElements();\n      this.setUpItems();\n      this.select(this.settings.value);\n      this.addEventListeners();\n      this.toggleOpen(false);\n      this.settings.load.call(this, this);\n      this.trigger('load', this);\n    },\n\n    getDefaults: function() {\n      return {\n        load: DropDown.defaults.load,\n        openList: DropDown.defaults.openList,\n        closeList: DropDown.defaults.closeList,\n        scrollToItem: DropDown.defaults.scrollToItem\n      };\n    },\n\n    setUpElements: function() {\n      this.$list = this.$('.js-dropdown-list');\n      this.$button = this.$('.js-dropdown-btn');\n      this.$inner = this.$button.find('.js-dropdown-inner');\n      this.$input = this.$('.js-data-output');\n    },\n\n    setUpItems: function() {\n      var $options = this.$('.js-dropdown-list-item');\n      $options.each(function(index, el) {\n        var option = new DropDownOption({\n          parent: this,\n          el: el\n        });\n        if (option.isPlaceholder()) {\n          this.placeholder = option;\n          return;\n        }\n        this.options.push(option);\n      }.bind(this));\n    },\n\n    addEventListeners: function() {\n      this.$button.on({\n        'mousedown touchstart': this.onStartInteraction,\n        click: this.onButtonClick\n      });\n      this.$list.on('blur', this.onListBlur);\n      $(document).on('keydown', this.onKeyDown);\n    },\n\n    onStartInteraction: function() {\n      this.wasOpen = this.isOpen();\n    },\n\n    deselectAll: function() {\n      this.placeholder.deselect();\n      this.options.forEach(function(option) {\n        option.deselect();\n      });\n    },\n\n    onButtonClick: function(event) {\n      if (this.wasOpen || this.isOpen()) {\n        // click toggle list:\n        // if the list is open and the button is clicked\n        // the blur event will fire first closing the list.\n        // this code is to prevent the list from reopening\n        // in that situation\n        this.wasOpen = false;\n        return;\n      }\n      this.toggleOpen();\n      var option = this.getFirstSelectedItem() || this.placeholder;\n      if (!option) return;\n      option.reselect();\n      option.scrollTo();\n      this.$list.focus();\n    },\n\n    isOpen: function() {\n      return !this.$list.hasClass('u-display-none');\n    },\n\n    toggleOpen: function(open) {\n      if (open === undefined) open = !this.isOpen();\n      if (open) clearTimeout(this.blurTimeout);\n      this.$button.attr('aria-expanded', open ? 'true' : 'false');\n      var name = open ? 'openList' : 'closeList';\n      this.settings[name].call(this, this);\n      this.trigger(name, this);\n    },\n\n    onListBlur: function(event) {\n      // IE11: Allow option click handler to execute before blur and close list\n      var handleBlur = function() {\n        this.toggleOpen(false);\n        this.removeActiveDescendantId();\n      }.bind(this);\n      this.blurTimeout = setTimeout(handleBlur, 100);\n    },\n\n    onKeyDown: function(event) {\n      if (!this.isOpen()) return;\n      var option = this.getFirstSelectedItem() || this.placeholder;\n      switch (event.keyCode) {\n        case 38: // UP\n          event.preventDefault();\n          option = option.getPrevious() || option.getLast();\n          break;\n        case 40: // DOWN\n          event.preventDefault();\n          option = option.getNext() || option.getFirst();\n          break;\n        case 13: // ENTER\n        case 32: // SPACE\n        case 27: // ESCAPE\n          event.preventDefault();\n          this.$button.focus();\n          return;\n        default:\n          return;\n      }\n      option.select().scrollTo();\n    },\n\n    getFirstSelectedItem: function() {\n      return _.find(this.options, function(option) {\n        return option.isSelected();\n      });\n    },\n\n    setActiveDescendantId: function(id) {\n      this.$list.attr('aria-activedescendant', id);\n    },\n\n    removeActiveDescendantId: function() {\n      this.$list.removeAttr('aria-activedescendant');\n    },\n\n    select: function(value) {\n      value = String(value);\n      var option = _.find(this.options, function(option) {\n        return option.getValue() === value;\n      });\n      if (option) {\n        option.select();\n        return;\n      }\n      this.placeholder.select();\n    },\n\n    toggleDisabled: function(value) {\n      if (value === undefined) {\n        value = !this.$input.attr('disabled');\n      }\n      if (value === false) {\n        this.$input.removeAttr('disabled');\n        this.$button\n            .removeAttr('disabled')\n            .removeClass('is-disabled');\n        this.$el.removeAttr('disabled');\n        return;\n      }\n      this.$input.attr('disabled', '');\n      this.$button\n          .attr('disabled', '')\n          .addClass('is-disabled');\n      this.$el.attr('disabled', '');\n    },\n\n    isEmpty: function() {\n      return !this.getFirstSelectedItem();\n    },\n\n    val: function() {\n      return this.$input.val();\n    },\n\n    destroy: function() {\n      this.removeEventListeners();\n      this.$el.remove();\n      delete this.options;\n      delete this.$input;\n      delete this.$inner;\n      delete this.$button;\n      delete this.$list;\n      delete this.$el;\n    },\n\n    removeEventListeners: function() {\n      this.$button.off({\n        'mousedown touchstart': this.onStartInteraction,\n        click: this.onButtonClick\n      });\n      this.$list.off('blur', this.onListBlur);\n      $(document).off('keydown', this.onKeyDown);\n    }\n\n  }, {\n\n    defaults: {\n\n      load: function() {},\n\n      openList: function() {\n        this.$list\n          .css({\n            top: '',\n            left: this.$button[0].offsetLeft,\n            width: this.$button.outerWidth()\n          })\n          .addClass('u-visibility-hidden')\n          .removeClass('u-display-none');\n\n        var offset = this.$list[0].getBoundingClientRect();\n        var height = this.$list.height();\n        var windowHeight = $(window).height();\n        var isOffscreen = (offset.top + height > windowHeight);\n\n        this.$list\n          .css('top', isOffscreen ? -height : '')\n          .removeClass('u-visibility-hidden')\n          .focus();\n\n      },\n\n      closeList: function() {\n        this.$list\n          .removeClass('u-visibility-hidden')\n          .addClass('u-display-none')\n          .css('top', '');\n      },\n\n      scrollToItem: function(option) {\n        var height = this.$list[0].clientHeight;\n        var pos = option.$el[0].offsetTop-(height/2);\n        this.$list[0].scrollTop = pos;\n      }\n\n    }\n\n  });\n\n  return DropDown;\n\n});\n","define([\n  'core/js/adapt',\n  'core/js/views/questionView',\n  './dropdown'\n], function(Adapt, QuestionView, DropDown) {\n\n  var MatchingView = QuestionView.extend({\n\n    dropdowns: null,\n\n    disableQuestion: function() {\n      this.dropdowns.forEach(function(dropdown) {\n        dropdown.toggleDisabled(true);\n      });\n    },\n\n    enableQuestion: function() {\n      this.dropdowns.forEach(function(dropdown) {\n        dropdown.toggleDisabled(false);\n      });\n    },\n\n    resetQuestionOnRevisit: function() {\n      this.resetQuestion();\n    },\n\n    setupQuestion: function() {\n      this.listenToOnce(Adapt.parentView, 'postRemove', this.onPostRemove);\n      this.model.setupRandomisation();\n    },\n\n    onPostRemove: function() {\n      this.dropdowns.forEach(function(dropdown) {\n        dropdown.off('change', this.onOptionSelected);\n        dropdown.destroy();\n      }, this);\n    },\n\n    onQuestionRendered: function() {\n      this.setReadyStatus();\n      this.setUpDropdowns();\n    },\n\n    setUpDropdowns: function() {\n      _.bindAll(this, 'onOptionSelected');\n      this.dropdowns = [];\n      var items = this.model.get('_items');\n      this.$('.matching__item').each(function(i, el) {\n        var item = items[i];\n        var selectedOption = _.find(item._options, function(option) {\n          return option._isSelected;\n        });\n        var value = selectedOption ? selectedOption._index : null;\n        var dropdown = new DropDown({\n          el: $(el).find('.dropdown')[0],\n          placeholder: this.model.get('placeholder'),\n          value: value\n        });\n        this.dropdowns.push(dropdown);\n        dropdown.on('change', this.onOptionSelected);\n      }.bind(this));\n      this.enableQuestion();\n      if (this.model.get('_isEnabled') !== true) {\n        this.disableQuestion();\n      }\n    },\n\n    onCannotSubmit: function() {\n      this.dropdowns.forEach(function(dropdown) {\n        if (!dropdown.isEmpty()) return;\n        dropdown.$el.parents('.matching__select-container').addClass('has-error');\n      });\n    },\n\n    onOptionSelected: function(dropdown) {\n      if (this.model.get('_isInteractionComplete')) return;\n      var $container = dropdown.$el.parents('.matching__select-container');\n      $container.removeClass('error');\n      var itemIndex = dropdown.$el.parents('.matching__item').index();\n      if (dropdown.isEmpty()) return;\n      var optionIndex = parseInt(dropdown.val());\n      this.model.setOptionSelected(itemIndex, optionIndex, true);\n    },\n\n    showMarking: function() {\n      if (!this.model.get('_canShowMarking')) return;\n\n      this.model.get('_items').forEach(function(item, i) {\n        var $item = this.$('.matching__item').eq(i);\n        $item.removeClass('is-correct is-incorrect').addClass(item._isCorrect ? 'is-correct' : 'is-incorrect');\n      }, this);\n    },\n\n    resetQuestion: function() {\n      this.$('.matching__item').removeClass('is-correct is-incorrect');\n      this.model.set('_isAtLeastOneCorrectSelection', false);\n      var resetAll = this.model.get('_shouldResetAllAnswers');\n\n      this.model.get('_items').forEach(function(item, index) {\n        if (item._isCorrect && resetAll === false) return;\n        this.selectValue(index, null);\n        item._options.forEach(function(option, index) {\n          option._isSelected = false;\n        });\n        item._selected = null;\n      }, this);\n    },\n\n    showCorrectAnswer: function() {\n      this.model.get('_items').forEach(function(item, index) {\n        var correctOption = _.findWhere(item._options, { _isCorrect: true });\n        this.selectValue(index, correctOption._index);\n      }, this);\n    },\n\n    hideCorrectAnswer: function() {\n      var answerArray = this.model.has('_tempUserAnswer') ?\n        this.model.get('_tempUserAnswer') :\n        this.model.get('_userAnswer');\n\n      this.model.get('_items').forEach(function (item, index) {\n        var key = answerArray[index];\n        var value = item._options[key]._index;\n        this.selectValue(index, value);\n      }, this);\n    },\n\n    /**\n     * Sets the selected item of a dropdown\n     * @param {number} index The index (0-based) of the dropdown\n     * @param {string} value The option _index\n     * @example\n     * // Sets the third dropdown to option _index 1\n     * this.selectValue(2, 1);\n     */\n    selectValue: function(index, optionIndex) {\n      if (!this.dropdowns) return;\n      var dropdown = this.dropdowns[index];\n      if (!dropdown) return;\n      dropdown.select(optionIndex);\n    }\n\n  });\n\n  return MatchingView;\n});\n","define([\n  'core/js/adapt',\n  'core/js/models/questionModel'\n], function(Adapt, QuestionModel) {\n\n  var MatchingModel = QuestionModel.extend({\n\n    init: function() {\n      QuestionModel.prototype.init.call(this);\n\n      this.setupQuestionItemIndexes();\n    },\n\n    setupQuestionItemIndexes: function() {\n\n      this.get('_items').forEach(function(item, index) {\n        if (item._index === undefined) {\n          item._index = index;\n          item._selected = false;\n        }\n        item._options.forEach(function(option, index) {\n          if (option._index === undefined) {\n            option._index = index;\n            option._isSelected = false;\n          }\n        });\n      });\n    },\n\n    setupRandomisation: function() {\n      if (!this.get('_isRandom') || !this.get('_isEnabled')) return;\n\n      this.get('_items').forEach(function(item) {\n        item._options = _.shuffle(item._options);\n      });\n    },\n\n    restoreUserAnswers: function() {\n      if (!this.get('_isSubmitted')) return;\n\n      var userAnswer = this.get('_userAnswer');\n\n      this.get('_items').forEach(function(item, index) {\n        item._options.forEach(function(option, index) {\n          if (option._index === userAnswer[item._index]) {\n            option._isSelected = true;\n            item._selected = option;\n          }\n        });\n      });\n\n      this.setQuestionAsSubmitted();\n      this.checkCanSubmit();\n      this.markQuestion();\n      this.setScore();\n      this.setupFeedback();\n    },\n\n    canSubmit: function() {\n      // can submit if every item has a selection\n      var canSubmit = _.every(this.get('_items'), function(item) {\n        return _.findWhere(item._options, { '_isSelected': true }) !== undefined;\n      });\n\n      return canSubmit;\n    },\n\n    setOptionSelected: function(itemIndex, optionIndex, isSelected) {\n      var item = this.get('_items')[itemIndex];\n      var option = _.findWhere(item._options, { '_index': optionIndex });\n      option._isSelected = isSelected;\n      item._selected = option;\n      this.checkCanSubmit();\n    },\n\n    storeUserAnswer: function() {\n\n      var userAnswer = new Array(this.get('_items').length);\n      var tempUserAnswer = new Array(this.get('_items').length);\n\n      this.get('_items').forEach(function(item, index) {\n        var optionIndex = _.findIndex(item._options, function(o) { return o._isSelected; });\n\n        tempUserAnswer[item._index] = optionIndex;\n        userAnswer[item._index] = item._options[optionIndex]._index;\n      }, this);\n\n      this.set({\n        _userAnswer: userAnswer,\n        _tempUserAnswer: tempUserAnswer\n      });\n    },\n\n    isCorrect: function() {\n      var numberOfCorrectAnswers = 0;\n\n      this.get('_items').forEach(function(item, index) {\n\n        var isCorrect = (item._selected && item._selected._isCorrect);\n\n        if (!isCorrect) {\n          item._isCorrect = false;\n          return;\n        }\n\n        numberOfCorrectAnswers++;\n        item._isCorrect = true;\n        this.set({\n          _numberOfCorrectAnswers: numberOfCorrectAnswers,\n          _isAtLeastOneCorrectSelection: true\n        });\n\n      }, this);\n\n      this.set('_numberOfCorrectAnswers', numberOfCorrectAnswers);\n\n      if (numberOfCorrectAnswers === this.get('_items').length) {\n        return true;\n      }\n\n      return false;\n    },\n\n    setScore: function() {\n      var questionWeight = this.get('_questionWeight');\n\n      if (this.get('_isCorrect')) {\n        this.set('_score', questionWeight);\n        return;\n      }\n\n      var numberOfCorrectAnswers = this.get('_numberOfCorrectAnswers');\n      var itemLength = this.get('_items').length;\n\n      var score = questionWeight * numberOfCorrectAnswers / itemLength;\n\n      this.set('_score', score);\n    },\n\n    isPartlyCorrect: function() {\n      return this.get('_isAtLeastOneCorrectSelection');\n    },\n\n    resetUserAnswer: function() {\n      this.set('_userAnswer', []);\n    },\n\n    /**\n    * Used by tracking extensions to return an object containing the component's specific interactions.\n    */\n    getInteractionObject: function() {\n      var interactions = {\n        correctResponsesPattern: null,\n        source: null,\n        target: null\n      };\n      var items = this.get('_items');\n      // This contains an array with a single string value, matching the source 'id' with the correct\n      // matching target 'id' value. An example is as follows:\n      // [ \"1[.]1_2[,]2[.]2_3\" ]\n      interactions.correctResponsesPattern = [\n        items.map(function(item, questionIndex) {\n          // Offset the item index and use it as a group identifier.\n          questionIndex = questionIndex + 1;\n          return [\n            questionIndex,\n            item._options.filter(function(item) {\n              // Get the correct item(s).\n              return item._isCorrect;\n            }).map(function(item) {\n              // Prefix the option's index and offset by 1.\n              return questionIndex + '_' + (item._index + 1).toString();\n            })\n          ].join('[.]');\n        }).join('[,]')\n      ];\n      // The 'source' property contains an array of all the stems/questions, e.g.\n      // [{id: \"1\", description: \"First question\"}, {id: \"2\", description: \"Second question\"}]\n      interactions.source = _.flatten(items.map(function(item) {\n        return {\n          // Offset by 1.\n          id: (item._index + 1).toString(),\n          description: item.text\n        };\n      }));\n      // The 'target' property contains an array of all the option responses, with the 'id'\n      // prefixed to indicate the grouping, e.g.\n      // [  {id: \"1_1\": description: \"First option, group 1\"},\n      //    {id: \"1_2\": description: \"Second option, group 1\"}\n      //    {id: \"2_1\": description: \"First option, group 2\"}  ]\n      interactions.target = _.flatten(items.map(function(item, index) {\n        // Offset by 1, as these values are not zero-indexed.\n        index = index + 1;\n        return item._options.map(function(option) {\n          return {\n            id: index + '_' + (option._index + 1),\n            description: option.text\n          };\n        });\n      }));\n      return interactions;\n    },\n\n    /**\n    * Used by adapt-contrib-spoor to get the user's answers in the format required by the cmi.interactions.n.student_response data field\n    * @return {string} the user's answers as a string in the format \"1.1#2.3#3.2\" assuming user selected option 1 in drop-down 1,\n    * option 3 in drop-down 2 and option 2 in drop-down 3. The '#' character will be changed to either ',' or '[,]' by adapt-contrib-spoor,\n    * depending on which SCORM version is being used.\n    */\n    getResponse: function() {\n      var responses = [];\n\n      this.get('_userAnswer').forEach(function(userAnswer, index) {\n        responses.push((index + 1) + '.' + (userAnswer + 1));// convert from 0-based to 1-based counting\n      });\n\n      return responses.join('#');\n    },\n\n    /**\n    * Used by adapt-contrib-spoor to get the type of this question in the format required by the cmi.interactions.n.type data field\n    * @return {string}\n    */\n    getResponseType: function() {\n      return 'matching';\n    },\n\n    /**\n     * Creates a string explaining the answers the learner should have chosen\n     * Used by ButtonsView to retrieve question-specific correct answer text for the ARIA\n     * 'live region' that gets updated when the learner selects the 'show correct answer' button\n     * @return {string}\n     */\n    getCorrectAnswerAsText: function() {\n      const correctAnswerTemplate = Adapt.course.get('_globals')._components._matching.ariaCorrectAnswer;\n      const ariaAnswer = this.get('_items').map(item => {\n        const correctOption = _.findWhere(item._options, { _isCorrect: true });\n        return Handlebars.compile(correctAnswerTemplate)({\n          itemText: item.text,\n          correctAnswer: correctOption.text\n        });\n      }).join('<br>');\n\n      return ariaAnswer;\n    },\n\n    /**\n     * Creates a string listing the answers the learner chose\n     * Used by ButtonsView to retrieve question-specific user answer text for the ARIA\n     * 'live region' that gets updated when the learner selects the 'hide correct answer' button\n     * @return {string}\n     */\n    getUserAnswerAsText: function() {\n      const userAnswerTemplate = Adapt.course.get('_globals')._components._matching.ariaUserAnswer;\n      const answerArray = this.has('_tempUserAnswer') ?\n        this.get('_tempUserAnswer') :\n        this.get('_userAnswer');\n\n      const ariaAnswer = this.get('_items').map((item, index) => {\n        const key = answerArray[index];\n        return Handlebars.compile(userAnswerTemplate)({\n          itemText: item.text,\n          userAnswer: item._options[key].text\n        });\n      }).join('<br>');\n\n      return ariaAnswer;\n    }\n\n  });\n\n  return MatchingModel;\n});\n","define([\n  'core/js/adapt',\n  './matchingView',\n  './matchingModel'\n], function(Adapt, MatchingView, MatchingModel) {\n\n  return Adapt.register('matching', {\n    view: MatchingView,\n    model: MatchingModel\n  });\n\n});\n","define([\n  'core/js/adapt',\n  'libraries/mediaelement-and-player'\n], function(Adapt) {\n  var mepPrototype = $.extend({}, mejs.MediaElementPlayer.prototype);\n\n  $.extend(mejs.MediaElementPlayer.prototype, {\n    /**\n    * fixes a bug (adaptlearning/adapt_framework#1478)\n    * where the media player going into/coming out of full-screen mode would trigger inview on\n    * components below it; we therefore need to switch off inview when entering full screen mode\n    * and switch it back on again after exiting full screen mode\n    */\n    detectFullscreenMode: function() {\n      var vendorPrefix = this.getVendorPrefix();\n      var fsEventName = 'on' + vendorPrefix + 'fullscreenchange';\n\n      if (document[fsEventName] === null) {\n        document[fsEventName] = function fullScreenEventHandler() {\n\n          var elementName = (vendorPrefix === '' ? 'fullscreenElement' : vendorPrefix + 'FullscreenElement');\n\n          if (document[elementName] !== null) {\n            $.inview.lock('mediaelement');\n            Adapt.trigger('media:fullscreen:enter');\n          } else {\n            $.inview.unlock('mediaelement');\n            Adapt.trigger('media:fullscreen:exit');\n          }\n        };\n      }\n      return mepPrototype.detectFullscreenMode.apply(this, arguments);\n    },\n\n    /**\n    * because the fullscreen events and properties are still vendor-prefixed in some browsers...\n    */\n    getVendorPrefix: function() {\n      var browser = Adapt.device.browser;\n\n      if (browser === 'internet explorer') {\n        return 'ms';\n      }\n\n      if (browser === 'microsoft edge' || browser === 'safari') {\n        return 'webkit';\n      }\n\n      return ''; // Chrome, Opera and Firefox no longer require a vendor prefix\n    }\n  });\n});\n","define([\n  'core/js/adapt',\n  'core/js/views/componentView',\n  'libraries/mediaelement-and-player',\n  'libraries/mediaelement-fullscreen-hook'\n], function(Adapt, ComponentView) {\n\n  let froogaloopAdded = false;\n\n  // The following function is used to to prevent a memory leak in Internet Explorer\n  // See: http://javascript.crockford.com/memory/leak.html\n  function purge(d) {\n    let a = d.attributes;\n    if (a) {\n      for (let i = a.length - 1; i >= 0; i -= 1) {\n        let n = a[i].name;\n        if (typeof d[n] === 'function') {\n          d[n] = null;\n        }\n      }\n    }\n    a = d.childNodes;\n    if (a) {\n      for (let i = 0, count = a.length; i < count; i += 1) {\n        purge(d.childNodes[i]);\n      }\n    }\n  }\n\n  /*\n   * Default shortcut keys trap a screen reader user inside the player once in focus. These keys are unnecessary\n   * as one may traverse the player in a linear fashion without needing to know or use shortcut keys. Below is\n   * the removal of the default shortcut keys.\n   *\n   * The default seek interval functions are passed two different data types from mejs which they handle incorrectly. One\n   * is a duration integer the other is the player object. The default functions error on slider key press and so break\n   * accessibility. Below is a correction.\n   */\n\n  Object.assign(window.mejs.MepDefaults, {\n    keyActions: [],\n    defaultSeekForwardInterval: duration => {\n      if (typeof duration === 'object') return duration.duration * 0.05;\n      return duration * 0.05;\n    },\n    defaultSeekBackwardInterval: duration => {\n      if (typeof duration === 'object') return duration.duration * 0.05;\n      return duration * 0.05;\n    }\n  });\n\n  class MediaView extends ComponentView {\n\n    events() {\n      return {\n        'click .js-media-inline-transcript-toggle': 'onToggleInlineTranscript',\n        'click .js-media-external-transcript-click': 'onExternalTranscriptClicked',\n        'click .js-skip-to-transcript': 'onSkipToTranscript'\n      };\n    }\n\n    className() {\n      let classes = super.className();\n      const playerOptions = this.model.get('_playerOptions');\n      if (playerOptions && playerOptions.toggleCaptionsButtonWhenOnlyOne) {\n        classes += ' toggle-captions';\n      }\n      return classes;\n    }\n\n    preRender() {\n      this.listenTo(Adapt, {\n        'device:resize': this.onScreenSizeChanged,\n        'device:changed': this.onDeviceChanged,\n        'media:stop': this.onMediaStop\n      });\n\n      _.bindAll(this, 'onMediaElementPlay', 'onMediaElementPause', 'onMediaElementEnded', 'onMediaElementTimeUpdate', 'onMediaElementSeeking', 'onOverlayClick', 'onMediaElementClick');\n\n      // set initial player state attributes\n      this.model.set({\n        _isMediaEnded: false,\n        _isMediaPlaying: false\n      });\n\n      if (this.model.get('_media').source) {\n        const media = this.model.get('_media');\n\n        // Avoid loading of Mixed Content (insecure content on a secure page)\n        if (window.location.protocol === 'https:' && media.source.indexOf('http:') === 0) {\n          media.source = media.source.replace(/^http:/, 'https:');\n        }\n\n        this.model.set('_media', media);\n      }\n\n      this.checkIfResetOnRevisit();\n    }\n\n    postRender() {\n      this.setupPlayer();\n      this.addMejsButtonClass();\n    }\n\n    addMejsButtonClass() {\n      this.$('.mejs-overlay-button').addClass('icon');\n    }\n\n    setupPlayer() {\n      if (!this.model.get('_playerOptions')) this.model.set('_playerOptions', {});\n\n      const modelOptions = this.model.get('_playerOptions');\n\n      if (modelOptions.pluginPath === undefined) {\n        // on the off-chance anyone still needs to use the Flash-based player...\n        _.extend(modelOptions, {\n          pluginPath: 'https://cdnjs.cloudflare.com/ajax/libs/mediaelement/2.21.2/',\n          flashName: 'flashmediaelement-cdn.swf',\n          flashScriptAccess: 'always'\n        });\n      }\n\n      if (modelOptions.features === undefined) {\n        modelOptions.features = ['playpause', 'progress', 'current', 'duration'];\n        if (this.model.get('_useClosedCaptions')) {\n          modelOptions.features.unshift('tracks');\n        }\n        if (this.model.get('_allowFullScreen')) {\n          modelOptions.features.push('fullscreen');\n        }\n        if (this.model.get('_showVolumeControl')) {\n          modelOptions.features.push('volume');\n        }\n      }\n\n      /*\n      Unless we are on Android/iOS and using native controls, when MediaElementJS initializes the player\n      it will invoke the success callback prior to performing one last call to setPlayerSize.\n      This call to setPlayerSize is deferred by 50ms so we add a delay of 100ms here to ensure that\n      we don't invoke setReadyStatus until the player is definitely finished rendering.\n      */\n      modelOptions.success = _.debounce(this.onPlayerReady.bind(this), 100);\n\n      if (this.model.get('_useClosedCaptions')) {\n        const startLanguage = this.model.get('_startLanguage') || 'en';\n        if (!Adapt.offlineStorage.get('captions')) {\n          Adapt.offlineStorage.set('captions', startLanguage);\n        }\n        modelOptions.startLanguage = this.checkForSupportedCCLanguage(Adapt.offlineStorage.get('captions'));\n      }\n\n      if (modelOptions.alwaysShowControls === undefined) {\n        modelOptions.alwaysShowControls = false;\n      }\n      if (modelOptions.hideVideoControlsOnLoad === undefined) {\n        modelOptions.hideVideoControlsOnLoad = true;\n      }\n\n      this.addMediaTypeClass();\n\n      this.addThirdPartyFixes(modelOptions, () => {\n        // create the player\n        this.$('audio, video').mediaelementplayer(modelOptions);\n        this.cleanUpPlayer();\n\n        const _media = this.model.get('_media');\n        // if no media is selected - set ready now, as success won't be called\n        if (!_media.mp3 && !_media.mp4 && !_media.ogv && !_media.webm && !_media.source) {\n          Adapt.log.warn('ERROR! No media is selected in components.json for component ' + this.model.get('_id'));\n          this.setReadyStatus();\n          return;\n        }\n        // Check if we're streaming\n        if (_media.source) {\n          this.$('.media__widget').addClass('external-source');\n        }\n      });\n    }\n\n    addMediaTypeClass() {\n      const media = this.model.get('_media');\n      if (media && media.type) {\n        const typeClass = media.type.replace(/\\//, '-');\n        this.$('.media__widget').addClass(typeClass);\n      }\n    }\n\n    addThirdPartyFixes(modelOptions, callback) {\n      const media = this.model.get('_media');\n      if (!media) return callback();\n\n      if (media.mp3 || media.ogg) {\n        // https://github.com/adaptlearning/adapt_framework/issues/3055\n        modelOptions.alwaysShowControls = true;\n      }\n\n      switch (media.type) {\n        case 'video/vimeo':\n          modelOptions.alwaysShowControls = false;\n          modelOptions.hideVideoControlsOnLoad = true;\n          modelOptions.features = [];\n          if (froogaloopAdded) return callback();\n          $.getScript('assets/froogaloop.js')\n            .done(() => {\n              froogaloopAdded = true;\n              callback();\n            })\n            .fail(() => {\n              froogaloopAdded = false;\n              Adapt.log.error('Could not load froogaloop.js');\n            });\n          break;\n        default:\n          callback();\n      }\n    }\n\n    cleanUpPlayer() {\n      this.$('.media__widget').children('.mejs-offscreen').remove();\n      this.$('[role=application]').removeAttr('role tabindex');\n      this.$('[aria-controls]').removeAttr('aria-controls');\n    }\n\n    setupEventListeners() {\n      this.completionEvent = (this.model.get('_setCompletionOn') || 'play');\n\n      if (this.completionEvent === 'inview') {\n        this.setupInviewCompletion('.component__widget');\n      }\n\n      // wrapper to check if preventForwardScrubbing is turned on.\n      if ((this.model.get('_preventForwardScrubbing')) && (!this.model.get('_isComplete'))) {\n        $(this.mediaElement).on({\n          'seeking': this.onMediaElementSeeking,\n          'timeupdate': this.onMediaElementTimeUpdate\n        });\n      }\n\n      // handle other completion events in the event Listeners\n      $(this.mediaElement).on({\n        'play': this.onMediaElementPlay,\n        'pause': this.onMediaElementPause,\n        'ended': this.onMediaElementEnded\n      });\n\n      // occasionally the mejs code triggers a click of the captions language\n      // selector during setup, this slight delay ensures we skip that\n      _.delay(this.listenForCaptionsChange.bind(this), 250);\n    }\n\n    /**\n     * Sets up the component to detect when the user has changed the captions so that it can store the user's\n     * choice in offlineStorage and notify other media components on the same page of the change\n     * Also sets the component up to listen for this event from other media components on the same page\n     */\n    listenForCaptionsChange() {\n      if (!this.model.get('_useClosedCaptions')) return;\n\n      const selector = this.model.get('_playerOptions').toggleCaptionsButtonWhenOnlyOne ?\n        '.mejs-captions-button button' :\n        '.mejs-captions-selector';\n\n      this.$(selector).on('click.mediaCaptionsChange', _.debounce(() => {\n        const srclang = this.mediaElement.player.selectedTrack ? this.mediaElement.player.selectedTrack.srclang : 'none';\n        Adapt.offlineStorage.set('captions', srclang);\n        Adapt.trigger('media:captionsChange', this, srclang);\n      }, 250)); // needs debouncing because the click event fires twice\n\n      this.listenTo(Adapt, 'media:captionsChange', this.onCaptionsChanged);\n    }\n\n    /**\n     * Handles updating the captions in this instance when learner changes captions in another\n     * media component on the same page\n     * @param {Backbone.View} view The view instance that triggered the event\n     * @param {string} lang The captions language the learner chose in the other media component\n     */\n    onCaptionsChanged(view, lang) {\n      if (view && view.cid === this.cid) return; // ignore the event if we triggered it\n\n      lang = this.checkForSupportedCCLanguage(lang);\n\n      this.mediaElement.player.setTrack(lang);\n\n      // because calling player.setTrack doesn't update the cc button's languages popup...\n      const $inputs = this.$('.mejs-captions-selector input');\n      $inputs.filter(':checked').prop('checked', false);\n      $inputs.filter(`[value=\"${lang}\"]`).prop('checked', true);\n    }\n\n    /**\n     * When the learner selects a captions language in another media component, that language may not be available\n     * in this instance, in which case default to the `_startLanguage` if that's set - or \"none\" if it's not\n     * @param {string} lang The language we're being asked to switch to e.g. \"de\"\n     * @return {string} The language we're actually going to switch to - or \"none\" if there's no good match\n     */\n    checkForSupportedCCLanguage(lang) {\n      if (!lang || lang === 'none') return 'none';\n\n      if (_.findWhere(this.model.get('_media').cc, { srclang: lang })) return lang;\n\n      return this.model.get('_startLanguage') || 'none';\n    }\n\n    onMediaElementPlay(event) {\n      this.queueGlobalEvent('play');\n\n      Adapt.trigger('media:stop', this);\n\n      if (this.model.get('_pauseWhenOffScreen')) $(this.mediaElement).on('inview', this.onMediaElementInview);\n\n      this.model.set({\n        '_isMediaPlaying': true,\n        '_isMediaEnded': false\n      });\n\n      if (this.completionEvent === 'play') {\n        this.setCompletionStatus();\n      }\n    }\n\n    onMediaElementPause(event) {\n      this.queueGlobalEvent('pause');\n\n      $(this.mediaElement).off('inview', this.onMediaElementInview);\n\n      this.model.set('_isMediaPlaying', false);\n    }\n\n    onMediaElementEnded(event) {\n      this.queueGlobalEvent('ended');\n\n      this.model.set('_isMediaEnded', true);\n\n      if (this.completionEvent === 'ended') {\n        this.setCompletionStatus();\n      }\n    }\n\n    onMediaElementInview(event, isInView) {\n      if (!isInView && !event.currentTarget.paused) event.currentTarget.pause();\n    }\n\n    onMediaElementSeeking(event) {\n      let maxViewed = this.model.get('_maxViewed');\n      if (!maxViewed) {\n        maxViewed = 0;\n      }\n      if (event.target.currentTime > maxViewed) {\n        event.target.currentTime = maxViewed;\n      }\n    }\n\n    onMediaElementTimeUpdate(event) {\n      let maxViewed = this.model.get('_maxViewed');\n      if (!maxViewed) {\n        maxViewed = 0;\n      }\n      if (event.target.currentTime > maxViewed) {\n        this.model.set('_maxViewed', event.target.currentTime);\n      }\n    }\n\n    // Overrides the default play/pause functionality to stop accidental playing on touch devices\n    setupPlayPauseToggle() {\n      // bit sneaky, but we don't have a this.mediaElement.player ref on iOS devices\n      const player = this.mediaElement.player;\n\n      if (!player) {\n        Adapt.log.warn('MediaView.setupPlayPauseToggle: OOPS! there is no player reference.');\n        return;\n      }\n\n      // stop the player dealing with this, we'll do it ourselves\n      player.options.clickToPlayPause = false;\n\n      // play on 'big button' click\n      this.$('.mejs-overlay-button').on('click', this.onOverlayClick);\n\n      // pause on player click\n      this.$('.mejs-mediaelement').on('click', this.onMediaElementClick);\n    }\n\n    onMediaStop(view) {\n\n      // Make sure this view isn't triggering media:stop\n      if (view && view.cid === this.cid) return;\n\n      if (!this.mediaElement || !this.mediaElement.player) return;\n\n      this.mediaElement.player.pause();\n\n    }\n\n    onOverlayClick() {\n      const player = this.mediaElement.player;\n      if (!player) return;\n\n      player.play();\n    }\n\n    onMediaElementClick(event) {\n      const player = this.mediaElement.player;\n      if (!player) return;\n\n      const isPaused = player.media.paused;\n      if (!isPaused) player.pause();\n    }\n\n    checkIfResetOnRevisit() {\n      const isResetOnRevisit = this.model.get('_isResetOnRevisit');\n\n      if (isResetOnRevisit) {\n        this.model.reset(isResetOnRevisit);\n      }\n    }\n\n    remove() {\n      this.$('.mejs-overlay-button').off('click', this.onOverlayClick);\n      this.$('.mejs-mediaelement').off('click', this.onMediaElementClick);\n\n      if (this.model.get('_useClosedCaptions')) {\n        const selector = this.model.get('_playerOptions').toggleCaptionsButtonWhenOnlyOne ?\n          '.mejs-captions-button button' :\n          '.mejs-captions-selector';\n        this.$(selector).off('click.mediaCaptionsChange');\n      }\n\n      const modelOptions = this.model.get('_playerOptions');\n      delete modelOptions.success;\n\n      const media = this.model.get('_media');\n      if (media) {\n        switch (media.type) {\n          case 'video/vimeo':\n            this.$('iframe')[0].isRemoved = true;\n        }\n      }\n\n      if (this.mediaElement && this.mediaElement.player) {\n        const playerId = this.mediaElement.player.id;\n\n        purge(this.$el[0]);\n        this.mediaElement.player.remove();\n\n        if (window.mejs.players[playerId]) {\n          delete window.mejs.players[playerId];\n        }\n      }\n\n      if (this.mediaElement) {\n        $(this.mediaElement).off({\n          'play': this.onMediaElementPlay,\n          'pause': this.onMediaElementPause,\n          'ended': this.onMediaElementEnded,\n          'seeking': this.onMediaElementSeeking,\n          'timeupdate': this.onMediaElementTimeUpdate,\n          'inview': this.onMediaElementInview\n        });\n\n        this.mediaElement.src = '';\n        $(this.mediaElement.pluginElement).remove();\n        delete this.mediaElement;\n      }\n\n      super.remove();\n    }\n\n    onDeviceChanged() {\n      if (this.model.get('_media').source) {\n        this.$('.mejs-container').width(this.$('.component__widget').width());\n      }\n    }\n\n    onPlayerReady(mediaElement, domObject) {\n      this.mediaElement = mediaElement;\n\n      let player = this.mediaElement.player;\n      if (!player) player = window.mejs.players[this.$('.mejs-container').attr('id')];\n\n      const hasTouch = window.mejs.MediaFeatures.hasTouch;\n      if (hasTouch) {\n        this.setupPlayPauseToggle();\n      }\n\n      this.addThirdPartyAfterFixes();\n      this.cleanUpPlayerAfter();\n\n      if (player && this.model.has('_startVolume')) {\n        // Setting the start volume only works with the Flash-based player if you do it here rather than in setupPlayer\n        player.setVolume(parseInt(this.model.get('_startVolume')) / 100);\n      }\n\n      this.setReadyStatus();\n      this.setupEventListeners();\n    }\n\n    addThirdPartyAfterFixes() {\n      const media = this.model.get('_media');\n      switch (media.type) {\n        case 'video/vimeo':\n          this.$('.mejs-container').attr('tabindex', 0);\n      }\n    }\n\n    cleanUpPlayerAfter() {\n      this.$(\"[aria-valuemax='NaN']\").attr('aria-valuemax', 0);\n    }\n\n    onScreenSizeChanged() {\n      this.$('audio, video').width(this.$('.component__widget').width());\n    }\n\n    onSkipToTranscript() {\n      // need slight delay before focussing button to make it work when JAWS is running\n      // see https://github.com/adaptlearning/adapt_framework/issues/2427\n      _.delay(() => {\n        Adapt.a11y.focus(this.$('.media__transcript-btn'));\n      }, 250);\n    }\n\n    onToggleInlineTranscript(event) {\n      if (event) event.preventDefault();\n      const $transcriptBodyContainer = this.$('.media__transcript-body-inline');\n      const $button = this.$('.media__transcript-btn-inline');\n      const $buttonText = this.$('.media__transcript-btn-inline .media__transcript-btn-text');\n\n      if ($transcriptBodyContainer.hasClass('inline-transcript-open')) {\n        $transcriptBodyContainer.stop(true, true).slideUp(() => {\n          $(window).resize();\n        }).removeClass('inline-transcript-open');\n        $button.attr('aria-expanded', false);\n        $buttonText.html(this.model.get('_transcript').inlineTranscriptButton);\n\n        return;\n      }\n\n      $transcriptBodyContainer.stop(true, true).slideDown(() => {\n        $(window).resize();\n      }).addClass('inline-transcript-open');\n\n      $button.attr('aria-expanded', true);\n      $buttonText.html(this.model.get('_transcript').inlineTranscriptCloseButton);\n\n      if (this.model.get('_transcript')._setCompletionOnView !== false) {\n        this.setCompletionStatus();\n      }\n    }\n\n    onExternalTranscriptClicked(event) {\n      if (this.model.get('_transcript')._setCompletionOnView !== false) {\n        this.setCompletionStatus();\n      }\n    }\n\n    /**\n     * Queue firing a media event to prevent simultaneous events firing, and provide a better indication of how the\n     * media  player is behaving\n     * @param {string} eventType\n     */\n    queueGlobalEvent(eventType) {\n      const time = Date.now();\n      const lastEvent = this.lastEvent || { time: 0 };\n      const timeSinceLastEvent = time - lastEvent.time;\n      const debounceTime = 500;\n\n      this.lastEvent = {\n        time,\n        type: eventType\n      };\n\n      // Clear any existing timeouts\n      clearTimeout(this.eventTimeout);\n\n      // Always trigger 'ended' events\n      if (eventType === 'ended') {\n        return this.triggerGlobalEvent(eventType);\n      }\n\n      // Fire the event after a delay, only if another event has not just been fired\n      if (timeSinceLastEvent > debounceTime) {\n        this.eventTimeout = setTimeout(this.triggerGlobalEvent.bind(this, eventType), debounceTime);\n      }\n    }\n\n    triggerGlobalEvent(eventType) {\n      const player = this.mediaElement.player;\n\n      const eventObj = {\n        type: eventType,\n        src: this.mediaElement.src,\n        platform: this.mediaElement.pluginType\n      };\n\n      if (player) eventObj.isVideo = player.isVideo;\n\n      Adapt.trigger('media', eventObj);\n    }\n  }\n\n  return MediaView;\n});\n","define([\n  'core/js/adapt',\n  './mediaView',\n  'core/js/models/componentModel'\n], function(Adapt, MediaView, ComponentModel) {\n\n  return Adapt.register('media', {\n    model: ComponentModel.extend({}), // create a new class in the inheritance chain so it can be extended per component type if necessary later\n    view: MediaView\n  });\n\n});\n","define(function() {\r\n\r\n  return new ENUM([\r\n    'SMALL',\r\n    'LARGE'\r\n  ]);\r\n\r\n});\r\n","define([\r\n  'core/js/adapt',\r\n  'core/js/views/componentView',\r\n  './modeEnum'\r\n], function(Adapt, ComponentView, MODE) {\r\n\r\n  class NarrativeView extends ComponentView {\r\n\r\n    events() {\r\n      return {\r\n        'click .js-narrative-strapline-open-popup': 'openPopup',\r\n        'click .js-narrative-controls-click': 'onNavigationClicked',\r\n        'click .js-narrative-progress-click': 'onProgressClicked'\r\n      };\r\n    }\r\n\r\n    initialize(...args) {\r\n      super.initialize(...args);\r\n\r\n      this._isInitial = true;\r\n    }\r\n\r\n    preRender() {\r\n      this.listenTo(Adapt, {\r\n        'device:changed device:resize': this.reRender,\r\n        'notify:closed': this.closeNotify\r\n      });\r\n      this.renderMode();\r\n\r\n      this.listenTo(this.model.getChildren(), {\r\n        'change:_isActive': this.onItemsActiveChange,\r\n        'change:_isVisited': this.onItemsVisitedChange\r\n      });\r\n\r\n      this.checkIfResetOnRevisit();\r\n      this.calculateWidths();\r\n    }\r\n\r\n    onItemsActiveChange(item, _isActive) {\r\n      if (!_isActive) return;\r\n      this.setStage(item);\r\n      this.setFocus(item.get('_index'));\r\n    }\r\n\r\n    setFocus(itemIndex) {\r\n      if (this._isInitial) return;\r\n      const $straplineHeaderElm = this.$('.narrative__strapline-header-inner');\r\n      const hasStraplineTransition = !this.isLargeMode() && ($straplineHeaderElm.css('transitionDuration') !== '0s');\r\n      if (hasStraplineTransition) {\r\n        $straplineHeaderElm.one('transitionend', () => {\r\n          this.focusOnNarrativeElement(itemIndex);\r\n        });\r\n        return;\r\n      }\r\n\r\n      this.focusOnNarrativeElement(itemIndex);\r\n    }\r\n\r\n    focusOnNarrativeElement(itemIndex) {\r\n      const dataIndexAttr = `[data-index='${itemIndex}']`;\r\n      const $elementToFocus = this.isLargeMode() ?\r\n        this.$(`.narrative__content-item${dataIndexAttr}`) :\r\n        this.$(`.narrative__strapline-btn${dataIndexAttr}`);\r\n      Adapt.a11y.focusFirst($elementToFocus);\r\n    }\r\n\r\n    onItemsVisitedChange(item, _isVisited) {\r\n      if (!_isVisited) return;\r\n      this.$(`[data-index=\"${item.get('_index')}\"]`).addClass('is-visited');\r\n    }\r\n\r\n    calculateMode() {\r\n      const mode = Adapt.device.screenSize === 'large' ? MODE.LARGE : MODE.SMALL;\r\n      this.model.set('_mode', mode);\r\n    }\r\n\r\n    renderMode() {\r\n      this.calculateMode();\r\n\r\n      const isLargeMode = this.isLargeMode();\r\n      this.$el.toggleClass('mode-large', isLargeMode).toggleClass('mode-small', !isLargeMode);\r\n    }\r\n\r\n    isLargeMode() {\r\n      return this.model.get('_mode') === MODE.LARGE;\r\n    }\r\n\r\n    postRender() {\r\n      this.renderMode();\r\n      this.setupNarrative();\r\n\r\n      this.$('.narrative__slider').imageready(this.setReadyStatus.bind(this));\r\n\r\n      if (Adapt.config.get('_disableAnimation')) {\r\n        this.$el.addClass('disable-animation');\r\n      }\r\n    }\r\n\r\n    checkIfResetOnRevisit() {\r\n      const isResetOnRevisit = this.model.get('_isResetOnRevisit');\r\n      // If reset is enabled set defaults\r\n      if (isResetOnRevisit) {\r\n        this.model.reset(isResetOnRevisit);\r\n      }\r\n    }\r\n\r\n    setupNarrative() {\r\n      this.renderMode();\r\n      const items = this.model.getChildren();\r\n      if (!items || !items.length) return;\r\n\r\n      let activeItem = this.model.getActiveItem();\r\n      if (!activeItem) {\r\n        activeItem = this.model.getItem(0);\r\n        activeItem.toggleActive(true);\r\n      } else {\r\n        // manually trigger change as it is not fired on reentry\r\n        items.trigger('change:_isActive', activeItem, true);\r\n      }\r\n\r\n      this.calculateWidths();\r\n\r\n      if (!this.isLargeMode() && !this.model.get('_wasHotgraphic')) {\r\n        this.replaceInstructions();\r\n      }\r\n      this.setupEventListeners();\r\n      this._isInitial = false;\r\n    }\r\n\r\n    calculateWidths() {\r\n      const itemCount = this.model.getChildren().length;\r\n      this.model.set({\r\n        _totalWidth: 100 * itemCount,\r\n        _itemWidth: 100 / itemCount\r\n      });\r\n    }\r\n\r\n    resizeControl() {\r\n      const previousMode = this.model.get('_mode');\r\n      this.renderMode();\r\n      if (previousMode !== this.model.get('_mode')) this.replaceInstructions();\r\n      this.evaluateNavigation();\r\n      const activeItem = this.model.getActiveItem();\r\n      if (activeItem) this.setStage(activeItem);\r\n    }\r\n\r\n    reRender() {\r\n      if (this.model.get('_wasHotgraphic') && this.isLargeMode()) {\r\n        this.replaceWithHotgraphic();\r\n        return;\r\n      }\r\n      this.resizeControl();\r\n    }\r\n\r\n    closeNotify() {\r\n      this.evaluateCompletion();\r\n    }\r\n\r\n    replaceInstructions() {\r\n      if (this.isLargeMode()) {\r\n        this.$('.narrative__instruction-inner').html(this.model.get('instruction'));\r\n        return;\r\n      }\r\n\r\n      if (this.model.get('mobileInstruction') && !this.model.get('_wasHotgraphic')) {\r\n        this.$('.narrative__instruction-inner').html(this.model.get('mobileInstruction'));\r\n      }\r\n    }\r\n\r\n    replaceWithHotgraphic() {\r\n      const HotgraphicView = Adapt.getViewClass('hotgraphic');\r\n      if (!HotgraphicView) return;\r\n\r\n      const model = this.prepareHotgraphicModel();\r\n      const newHotgraphic = new HotgraphicView({ model });\r\n\r\n      this.$el.parents('.component__container').append(newHotgraphic.$el);\r\n      this.remove();\r\n      _.defer(() => {\r\n        Adapt.trigger('device:resize');\r\n      });\r\n    }\r\n\r\n    prepareHotgraphicModel() {\r\n      const model = this.model;\r\n      model.resetActiveItems();\r\n      model.set({\r\n        _isPopupOpen: false,\r\n        _component: 'hotgraphic',\r\n        body: model.get('originalBody'),\r\n        instruction: model.get('originalInstruction')\r\n      });\r\n\r\n      return model;\r\n    }\r\n\r\n    moveSliderToIndex(itemIndex) {\r\n      let offset = this.model.get('_itemWidth') * itemIndex;\r\n      if (Adapt.config.get('_defaultDirection') === 'ltr') {\r\n        offset *= -1;\r\n      }\r\n      const cssValue = `translateX(${offset}%)`;\r\n      const $sliderElm = this.$('.narrative__slider');\r\n      const $straplineHeaderElm = this.$('.narrative__strapline-header-inner');\r\n\r\n      $sliderElm.css('transform', cssValue);\r\n      $straplineHeaderElm.css('transform', cssValue);\r\n    }\r\n\r\n    setStage(item) {\r\n      const index = item.get('_index');\r\n      const indexSelector = `[data-index=\"${index}\"]`;\r\n\r\n      if (this.isLargeMode()) {\r\n        // Set the visited attribute for large screen devices\r\n        item.toggleVisited(true);\r\n      }\r\n\r\n      this.$('.narrative__progress').removeClass('is-selected').filter(indexSelector).addClass('is-selected');\r\n\r\n      const $slideGraphics = this.$('.narrative__slider-image-container');\r\n      Adapt.a11y.toggleAccessibleEnabled($slideGraphics, false);\r\n      Adapt.a11y.toggleAccessibleEnabled($slideGraphics.filter(indexSelector), true);\r\n\r\n      const $narrativeItems = this.$('.narrative__content-item');\r\n      $narrativeItems.addClass('u-visibility-hidden u-display-none');\r\n      Adapt.a11y.toggleAccessible($narrativeItems, false);\r\n      Adapt.a11y.toggleAccessible($narrativeItems.filter(indexSelector).removeClass('u-visibility-hidden u-display-none'), true);\r\n\r\n      const $narrativeStraplineButtons = this.$('.narrative__strapline-btn');\r\n      Adapt.a11y.toggleAccessibleEnabled($narrativeStraplineButtons, false);\r\n      Adapt.a11y.toggleAccessibleEnabled($narrativeStraplineButtons.filter(indexSelector), true);\r\n\r\n      this.evaluateNavigation();\r\n      this.evaluateCompletion();\r\n      this.shouldShowInstructionError();\r\n      this.moveSliderToIndex(index);\r\n    }\r\n\r\n    evaluateNavigation() {\r\n      const active = this.model.getActiveItem();\r\n      if (!active) return;\r\n\r\n      const index = active.get('_index');\r\n      const itemCount = this.model.getChildren().length;\r\n\r\n      const isAtStart = index === 0;\r\n      const isAtEnd = index === itemCount - 1;\r\n\r\n      const $left = this.$('.narrative__controls-left');\r\n      const $right = this.$('.narrative__controls-right');\r\n\r\n      const globals = Adapt.course.get('_globals');\r\n\r\n      const ariaLabelsGlobals = globals._accessibility._ariaLabels;\r\n      const narrativeGlobals = globals._components._narrative;\r\n\r\n      const ariaLabelPrevious = narrativeGlobals.previous || ariaLabelsGlobals.previous;\r\n      const ariaLabelNext = narrativeGlobals.next || ariaLabelsGlobals.next;\r\n\r\n      const prevTitle = isAtStart ? '' : this.model.getItem(index - 1).get('title');\r\n      const nextTitle = isAtEnd ? '' : this.model.getItem(index + 1).get('title');\r\n\r\n      $left.toggleClass('u-visibility-hidden', isAtStart);\r\n      $right.toggleClass('u-visibility-hidden', isAtEnd);\r\n\r\n      $left.attr('aria-label', Handlebars.helpers.compile_a11y_normalize(ariaLabelPrevious, {\r\n        title: prevTitle,\r\n        _globals: globals,\r\n        itemNumber: isAtStart ? null : index,\r\n        totalItems: itemCount\r\n      }));\r\n      $right.attr('aria-label', Handlebars.helpers.compile_a11y_normalize(ariaLabelNext, {\r\n        title: nextTitle,\r\n        _globals: globals,\r\n        itemNumber: isAtEnd ? null : index + 2,\r\n        totalItems: itemCount\r\n      }));\r\n    }\r\n\r\n    evaluateCompletion() {\r\n      if (this.model.areAllItemsCompleted()) {\r\n        this.trigger('allItems');\r\n        this.$('.narrative__instruction-inner').removeClass('instruction-error');\r\n      }\r\n    }\r\n\r\n    openPopup() {\r\n      const currentItem = this.model.getActiveItem();\r\n      Adapt.notify.popup({\r\n        title: currentItem.get('title'),\r\n        body: currentItem.get('body')\r\n      });\r\n\r\n      Adapt.on('popup:opened', function() {\r\n        // Set the visited attribute for small and medium screen devices\r\n        currentItem.toggleVisited(true);\r\n      });\r\n    }\r\n\r\n    onNavigationClicked(event) {\r\n      const $btn = $(event.currentTarget);\r\n      let index = this.model.getActiveItem().get('_index');\r\n      $btn.data('direction') === 'right' ? index++ : index--;\r\n      this.model.setActiveItem(index);\r\n    }\r\n\r\n    onProgressClicked(event) {\r\n      const index = $(event.target).data('index');\r\n      this.model.setActiveItem(index);\r\n    }\r\n\r\n  /**\r\n   * In mobile view, highlight instruction if user navigates to another\r\n   * item before completing, in case the strapline is missed\r\n   */\r\n    shouldShowInstructionError() {\r\n      const prevItemIndex = this.model.getActiveItem().get('_index') - 1;\r\n      if (prevItemIndex < 0 || this.model.getItem(prevItemIndex).get('_isVisited')) return;\r\n      this.$('.narrative__instruction-inner').addClass('instruction-error');\r\n    }\r\n\r\n    setupEventListeners() {\r\n      if (this.model.get('_setCompletionOn') === 'inview') {\r\n        this.setupInviewCompletion('.component__widget');\r\n      }\r\n    }\r\n  }\r\n\r\n  NarrativeView.template = 'narrative';\r\n\r\n  return NarrativeView;\r\n\r\n});\r\n","define([\r\n  'core/js/adapt',\r\n  './narrativeView',\r\n  'core/js/models/itemsComponentModel'\r\n], function(Adapt, NarrativeView, ItemsComponentModel) {\r\n\r\n  return Adapt.register('narrative', {\r\n    model: ItemsComponentModel.extend({}),\r\n    view: NarrativeView\r\n  });\r\n\r\n});\r\n","define([\n  'core/js/adapt',\n  'core/js/views/questionView'\n], function(Adapt, QuestionView) {\n\n  class SliderView extends QuestionView {\n\n    events() {\n      return {\n        'click .js-slider-number-click': 'onNumberSelected',\n        'focus .js-slider-item-input': 'onHandleFocus',\n        'blur .js-slider-item-input': 'onHandleBlur'\n      };\n    }\n\n    // Used by the question to reset the question when revisiting the component\n    resetQuestionOnRevisit() {\n      this.setAllItemsEnabled();\n      this.model.deselectAllItems();\n      this.resetQuestion();\n    }\n\n    // Used by question to setup itself just before rendering\n    setupQuestion() {\n      if (this.model.get('_isSubmitted')) return;\n\n      this.selectItem(this.getIndexFromValue(this.model.get('_selectedItem').value));\n    }\n\n    setupRangeslider() {\n      this.$sliderScaleMarker = this.$('.js-slider-number-selection');\n      this.$slider = this.$('.js-slider-item-input');\n      if (this.model.has('_scaleStep')) {\n        this.$slider.attr({ 'step': this.model.get('_scaleStep') });\n      }\n\n      this.$slider.rangeslider({\n        polyfill: false,\n        onSlide: this.handleSlide.bind(this)\n      });\n      this.oldValue = 0;\n\n      if (this._deferEnable) {\n        this.setAllItemsEnabled();\n      }\n    }\n\n    handleSlide(position, value) {\n      if (this.oldValue === value) {\n        return;\n      }\n      const itemIndex = this.getIndexFromValue(value);\n      const pixels = this.mapIndexToPixels(itemIndex);\n      this.selectItem(itemIndex);\n      this.animateToPosition(pixels);\n      this.oldValue = value;\n    }\n\n    disableQuestion() {\n      this.setAllItemsEnabled();\n    }\n\n    enableQuestion() {\n      this.setAllItemsEnabled();\n    }\n\n    setAllItemsEnabled() {\n      const isEnabled = this.model.get('_isEnabled');\n\n      if (!this.$slider) {\n        this._deferEnable = true; // slider is not yet ready\n        return;\n      }\n\n      this.$('.slider__widget').toggleClass('is-disabled', !isEnabled);\n      this.$slider.prop('disabled', !isEnabled).rangeslider('update', true);\n    }\n\n    onQuestionRendered() {\n      this.setupRangeslider();\n      this.setScalePositions();\n      this.onScreenSizeChanged();\n      this.showScaleMarker(true);\n      this.listenTo(Adapt, 'device:resize', this.onScreenSizeChanged);\n      this.setReadyStatus();\n    }\n\n    // this should make the slider handle, slider marker and slider bar to animate to give position\n    animateToPosition(newPosition) {\n      if (!this.$sliderScaleMarker) return;\n\n      this.$sliderScaleMarker\n        .velocity('stop')\n        .velocity({\n          left: newPosition\n        }, {\n          duration: 200,\n          easing: 'linear',\n          mobileHA: false\n        });\n    }\n\n    // this shoud give the index of item using given slider value\n    getIndexFromValue(itemValue) {\n      const scaleStart = this.model.get('_scaleStart');\n      const scaleEnd = this.model.get('_scaleEnd');\n      return Math.round(this.mapValue(itemValue, scaleStart, scaleEnd, 0, this.model.get('_items').length - 1));\n    }\n\n    mapIndexToPixels(value, $widthObject) {\n      const numberOfItems = this.model.get('_items').length;\n      const width = $widthObject ? $widthObject.width() : this.$('.js-slider-scale').width();\n\n      return Math.round(this.mapValue(value, 0, numberOfItems - 1, 0, width));\n    }\n\n    mapPixelsToIndex(value) {\n      const numberOfItems = this.model.get('_items').length;\n      const width = this.$('.slider-sliderange').width();\n\n      return Math.round(this.mapValue(value, 0, width, 0, numberOfItems - 1));\n    }\n\n    normalise(value, low, high) {\n      const range = high - low;\n      return (value - low) / range;\n    }\n\n    mapValue(value, inputLow, inputHigh, outputLow, outputHigh) {\n      const normal = this.normalise(value, inputLow, inputHigh);\n      return normal * (outputHigh - outputLow) + outputLow;\n    }\n\n    onHandleFocus(event) {\n      event.preventDefault();\n      this.$slider.on('keydown', this.onKeyDown.bind(this));\n    }\n\n    onHandleBlur(event) {\n      event.preventDefault();\n      this.$slider.off('keydown');\n    }\n\n    onKeyDown(event) {\n      if (event.which === 9) return; // tab key\n      event.preventDefault();\n\n      let newItemIndex = this.getIndexFromValue(this.model.get('_selectedItem').value);\n\n      switch (event.which) {\n        case 40: //  down\n        case 37: //  left\n          newItemIndex = Math.max(newItemIndex - 1, 0);\n          break;\n        case 38: //  up\n        case 39: //  right\n          newItemIndex = Math.min(newItemIndex + 1, this.model.get('_items').length - 1);\n          break;\n      }\n\n      this.selectItem(newItemIndex);\n      if (typeof newItemIndex === 'number') this.showScaleMarker(true);\n      this.animateToPosition(this.mapIndexToPixels(newItemIndex));\n      this.setSliderValue(this.getValueFromIndex(newItemIndex));\n    }\n\n    onNumberSelected(event) {\n      event.preventDefault();\n\n      if (this.model.get('_isInteractionComplete')) {\n        return;\n      }\n\n      // when component is not reset, selecting a number should be prevented\n      if (this.$slider.prop('disabled')) {\n        return;\n      }\n\n      const itemValue = parseFloat($(event.currentTarget).attr('data-id'));\n      const index = this.getIndexFromValue(itemValue);\n      this.selectItem(index);\n      this.animateToPosition(this.mapIndexToPixels(index));\n      this.setSliderValue(itemValue);\n    }\n\n    getValueFromIndex(index) {\n      return this.model.get('_items')[index].value;\n    }\n\n    resetControlStyles() {\n      this.$('.slider-handle').empty();\n      this.showScaleMarker(false);\n      this.$('.slider-bar').animate({ width: '0' });\n      this.setSliderValue(this.model.get('_items')[0].value);\n    }\n\n    onCannotSubmit() { }\n\n    setSliderValue(value) {\n      if (!this.$slider) return;\n      this.$slider.val(value).change();\n    }\n\n    showMarking() {\n      if (!this.model.get('_canShowMarking')) return;\n\n      this.$('.slider__widget').removeClass('is-correct is-incorrect')\n        .addClass(this.model.get('_selectedItem').correct ? 'is-correct' : 'is-incorrect');\n    }\n\n    resetQuestion() {\n      this.selectItem(0);\n      this.animateToPosition(0);\n      this.resetControlStyles();\n      this.showScaleMarker(true);\n    }\n\n    setScalePositions() {\n      const numberOfItems = this.model.get('_items').length;\n      this.model.get('_items').forEach((item, index) => {\n        const normalisedPosition = this.normalise(index, 0, numberOfItems - 1);\n        this.$('.js-slider-number').eq(index).data('normalisedPosition', normalisedPosition);\n      });\n    }\n\n    showScale() {\n      const $markers = this.$('.js-slider-scale-notch-container').empty();\n\n      if (this.model.get('_showScale') === false) {\n        $markers.eq(0).addClass('u-display-none');\n        this.$('.js-slider-number').addClass(\n          this.model.get('_showScaleIndicator') ? 'u-visibility-hidden' : 'u-display-none'\n        );\n        return;\n      }\n\n      const $scaler = this.$('.js-slider-scale');\n      for (let i = 1, count = this.model.get('_items').length - 1; i < count; i++) {\n        $markers.append(`<div class=\"slider__scale-notch\" style=\"left: ${this.mapIndexToPixels(i, $scaler)}px\">`);\n      }\n      // Do we show scale numbers\n      this.showScaleNumbers();\n    }\n\n    showScaleNumbers() {\n      const $scaler = this.$('.js-slider-scale');\n      const $numbers = this.$('.js-slider-number');\n\n      if (this.model.get('_showScaleNumbers') === false) {\n        $numbers.addClass('u-display-none');\n        return;\n      }\n\n      const scaleWidth = $scaler.width();\n      this.model.get('_items').forEach((item, index) => {\n        const $number = $numbers.eq(index);\n        const newLeft = Math.round($number.data('normalisedPosition') * scaleWidth);\n        $number.css({ left: newLeft });\n      });\n    }\n\n    // Labels are enabled in slider.hbs. Here we manage their containing div.\n    showLabels() {\n      if (this.model.get('labelStart') || this.model.get('labelEnd')) return;\n      this.$('.js-slider-label-container').eq(0).addClass('u-display-none');\n    }\n\n    remapSliderBar() {\n      const $scaler = this.$('.js-slider-scale');\n      const currentIndex = this.getIndexFromValue(this.model.get('_selectedItem').value);\n      const left = this.mapIndexToPixels(currentIndex, $scaler);\n      this.$('.slider-handle').css({ left: `${left}px` });\n      this.$('.js-slider-number-selection').css({ left: `${left}px` });\n      this.$('.slider-bar').width(left);\n    }\n\n    onScreenSizeChanged() {\n      this.showScale();\n      this.showLabels();\n      this.remapSliderBar();\n      if (this.$('.slider__widget').hasClass('show-user-answer')) {\n        this.hideCorrectAnswer();\n      } else if (this.$('.slider__widget').hasClass('show-correct-answer')) {\n        this.showCorrectAnswer();\n      }\n    }\n\n    showCorrectAnswer() {\n      this.showScaleMarker(false);\n\n      const answers = this.model.getCorrectAnswers();\n      if (answers.length === 0) {\n        console.log('adapt-contrib-slider::WARNING: no correct answer or correct range set in JSON');\n        return;\n      }\n\n      const middleAnswer = answers[Math.floor(answers.length / 2)];\n      this.animateToPosition(this.mapIndexToPixels(this.getIndexFromValue(middleAnswer)));\n      this.showModelAnswers(answers);\n      this.setSliderValue(middleAnswer);\n    }\n\n    showModelAnswers(correctAnswerArray) {\n      const $parentDiv = this.$('.js-slider-model-range');\n      correctAnswerArray.forEach((correctAnswer, index) => {\n        $parentDiv.append($('<div class=\"slider__number-model-answer\">'));\n\n        const $element = this.$('.js-slider-model-range .slider__number-model-answer').eq(index);\n        const startingLeft = this.mapIndexToPixels(this.getIndexFromValue(this.model.get('_selectedItem').value));\n\n        if (this.model.get('_showNumber')) $element.html(correctAnswer);\n\n        $element.css({ left: startingLeft }).fadeIn(0, () => {\n          $element.animate({ left: this.mapIndexToPixels(this.getIndexFromValue(correctAnswer)) });\n        });\n      });\n    }\n\n    hideCorrectAnswer() {\n      const userAnswerIndex = this.getIndexFromValue(this.model.get('_userAnswer'));\n      this.$('.js-slider-model-range').empty();\n\n      this.showScaleMarker(true);\n      this.selectItem(userAnswerIndex);\n      this.animateToPosition(this.mapIndexToPixels(userAnswerIndex));\n      this.setSliderValue(this.model.get('_userAnswer'));\n    }\n\n    // according to given item index this should make the item as selected\n    selectItem(itemIndex) {\n      // deselect all items before selecting the chosen item\n      this.model.deselectAllItems();\n      const item = this.model.get('_items')[itemIndex];\n      if (!item) return;\n      item.selected = true;\n      this.model.set('_selectedItem', item);\n      this.$('.js-slider-item-input').attr({\n        'value': item.value,\n        'aria-valuenow': item.value\n      });\n      this.showNumber(true);\n    }\n\n    // this makes the marker visible or hidden\n    showScaleMarker(show) {\n      const $scaleMarker = this.$('.js-slider-number-selection');\n      if (this.model.get('_showScaleIndicator')) {\n        this.showNumber(show);\n        $scaleMarker.toggleClass('display-block', show);\n      }\n    }\n\n    // this should add the current slider value to the marker\n    showNumber(show) {\n      const $scaleMarker = this.$('.js-slider-number-selection');\n      if (this.model.get('_showNumber')) {\n        if (show) {\n          $scaleMarker.html(this.model.get('_selectedItem').value);\n        } else {\n          $scaleMarker.html = '';\n        }\n      }\n    }\n\n  }\n\n  return SliderView;\n\n});\n","define([\n  'core/js/adapt',\n  'core/js/models/questionModel'\n], function(Adapt, QuestionModel) {\n\n  class SliderModel extends QuestionModel {\n\n    init() {\n      QuestionModel.prototype.init.call(this);\n\n      this.setupModelItems();\n      this.selectDefaultItem();\n    }\n\n    selectDefaultItem() {\n      this.set('_selectedItem', this.get('_items')[0]);\n    }\n\n    /**\n     * Returns the number of decimal places in a specified number\n     */\n    getDecimalPlaces(num) {\n      return (num.toString().split('.')[1] || []).length;\n    }\n\n    setupModelItems() {\n      const items = [];\n      const answer = this.get('_correctAnswer');\n      const range = this.get('_correctRange');\n      const start = this.get('_scaleStart');\n      const end = this.get('_scaleEnd');\n      const step = this.get('_scaleStep') || 1;\n\n      const dp = this.getDecimalPlaces(step);\n\n      for (let i = start; i <= end; i += step) {\n        if (dp !== 0) {\n          // Ensure that steps with decimal places are handled correctly.\n          i = parseFloat(i.toFixed(dp));\n        }\n\n        items.push({\n          value: i,\n          selected: false,\n          // _correctAnswer/answer is a String - this allows AAT users to assign it no value when _correctRange needs to be used instead\n          // we therefore need to convert it to Number when checking the answer (see https://github.com/adaptlearning/adapt_framework/issues/2259)\n          correct: answer ? i === Number(answer) : (i >= range._bottom && i <= range._top)\n        });\n      }\n\n      this.set({\n        '_items': items,\n        '_marginDir': Adapt.config.get('_defaultDirection') === 'rtl' ? 'right' : 'left'\n      });\n    }\n\n    /**\n    * allow the user to submit immediately; the slider handle may already be in the position they want to choose\n    */\n    canSubmit() {\n      return true;\n    }\n\n    restoreUserAnswers() {\n      if (!this.get('_isSubmitted')) {\n        this.set({\n          _userAnswer: undefined\n        });\n        this.selectDefaultItem();\n        return;\n      }\n\n      const items = this.get('_items');\n      const userAnswer = this.get('_userAnswer');\n      const selectedItem = items.find(({ value }) => value === userAnswer);\n      if (selectedItem) {\n        selectedItem.selected = true;\n        this.set('_selectedItem', selectedItem);\n      }\n\n      this.setQuestionAsSubmitted();\n      this.markQuestion();\n      this.setScore();\n      this.setupFeedback();\n    }\n\n    // This preserves the state of the users answers for returning or showing the users answer\n    storeUserAnswer() {\n      this.set('_userAnswer', this.get('_selectedItem').value);\n    }\n\n    resetUserAnswer() {\n      this.set({\n        _isAtLeastOneCorrectSelection: false,\n        _userAnswer: undefined\n      });\n      this.selectDefaultItem();\n    }\n\n    deselectAllItems() {\n      this.get('_items').forEach(item => (item.selected = false));\n    }\n\n    isCorrect() {\n      const numberOfCorrectAnswers = this.get('_items').filter(({ selected, correct }) => selected && correct).length;\n\n      this.set('_isAtLeastOneCorrectSelection', numberOfCorrectAnswers > 0);\n      this.set('_numberOfCorrectAnswers', numberOfCorrectAnswers);\n\n      return this.get('_isAtLeastOneCorrectSelection');\n    }\n\n    isPartlyCorrect() {\n      return this.get('_isAtLeastOneCorrectSelection');\n    }\n\n    // Used to set the score based upon the _questionWeight\n    setScore() {\n      const numberOfCorrectAnswers = this.get('_numberOfCorrectAnswers');\n      const questionWeight = this.get('_questionWeight');\n      const score = questionWeight * numberOfCorrectAnswers;\n      this.set('_score', score);\n    }\n\n    /**\n    * Used by adapt-contrib-spoor to get the user's answers in the format required by the cmi.interactions.n.student_response data field\n    */\n    getResponse() {\n      return this.get('_userAnswer').toString();\n    }\n\n    /**\n    * Used by adapt-contrib-spoor to get the type of this question in the format required by the cmi.interactions.n.type data field\n    */\n    getResponseType() {\n      return 'numeric';\n    }\n\n    getCorrectAnswers() {\n\n      // are we dealing with a single correct answer or a range?\n      const answerSingle = this.get('_correctAnswer');\n      const answers = [];\n      if (answerSingle) {\n        return [ answerSingle ];\n      }\n      const answerMultiple = this.get('_correctRange');\n      if (!answerMultiple) {\n        return answers;\n      }\n      const bottom = answerMultiple._bottom;\n      const top = answerMultiple._top;\n      if (bottom === undefined || top === undefined) {\n        return answers;\n      }\n      let answer = bottom;\n      const step = this.get('_scaleStep') || 1;\n      while (answer <= top) {\n        answers.push(answer);\n        answer += step;\n      }\n      return answers;\n    }\n\n    /**\n     * Creates a string explaining the answer (or answer range) the learner should have chosen\n     * Used by ButtonsView to retrieve question-specific correct answer text for the ARIA\n     * 'live region' that gets updated when the learner selects the 'show correct answer' button\n     * @return {string}\n     */\n    getCorrectAnswerAsText() {\n      const globals = Adapt.course.get('_globals')._components._slider;\n      const answers = this.getCorrectAnswers();\n      if (answers.length > 1) {\n        return Handlebars.compile(globals.ariaCorrectAnswerRange)({\n          bottom: answers.shift(),\n          top: answers.pop()\n        });\n      }\n\n      return Handlebars.compile(globals.ariaCorrectAnswer)({ correctAnswer: answers[0] });\n    }\n\n    /**\n     * Creates a string listing the answer the learner chose\n     * Used by ButtonsView to retrieve question-specific user answer text for the ARIA\n     * 'live region' that gets updated when the learner selects the 'hide correct answer' button\n     * @return {string}\n     */\n    getUserAnswerAsText() {\n      const answerTemplate = Adapt.course.get('_globals')._components._slider.ariaUserAnswer;\n      return Handlebars.compile(answerTemplate)({ userAnswer: this.get('_userAnswer') });\n    }\n\n  }\n\n  return SliderModel;\n\n});\n","define([\n  'core/js/adapt',\n  './sliderView',\n  './sliderModel',\n  'libraries/rangeslider'\n], function(Adapt, SliderView, SliderModel) {\n\n  return Adapt.register('slider', {\n    view: SliderView,\n    model: SliderModel\n  });\n\n});\n","define([\n  'core/js/adapt',\n  'core/js/views/componentView',\n  'core/js/models/componentModel'\n], function(Adapt, ComponentView, ComponentModel) {\n\n  class TextView extends ComponentView {\n\n    preRender() {\n      this.checkIfResetOnRevisit();\n    }\n\n    postRender() {\n      this.setReadyStatus();\n\n      this.setupInview();\n    }\n\n    setupInview() {\n      const selector = this.getInviewElementSelector();\n      if (!selector) {\n        this.setCompletionStatus();\n        return;\n      }\n\n      this.setupInviewCompletion(selector);\n    }\n\n    /**\n     * determines which element should be used for inview logic - body, instruction or title - and returns the selector for that element\n     */\n    getInviewElementSelector() {\n      if (this.model.get('body')) return '.component__body';\n\n      if (this.model.get('instruction')) return '.component__instruction';\n\n      if (this.model.get('displayTitle')) return '.component__title';\n\n      return null;\n    }\n\n    checkIfResetOnRevisit() {\n      const isResetOnRevisit = this.model.get('_isResetOnRevisit');\n\n      // If reset is enabled set defaults\n      if (isResetOnRevisit) {\n        this.model.reset(isResetOnRevisit);\n      }\n    }\n  }\n\n  TextView.template = 'text';\n\n  return Adapt.register('text', {\n    model: ComponentModel.extend({}),// create a new class in the inheritance chain so it can be extended per component type if necessary later\n    view: TextView\n  });\n});\n","define([\n  'core/js/views/questionView'\n], function(QuestionView) {\n\n  var TextInputView = QuestionView.extend({\n\n    events: {\n      'focus .js-textinput-textbox': 'clearValidationError',\n      'change .js-textinput-textbox': 'onInputChanged',\n      'keyup .js-textinput-textbox': 'onInputChanged'\n    },\n\n    resetQuestionOnRevisit: function() {\n      this.setAllItemsEnabled(false);\n      this.resetQuestion();\n    },\n\n    setupQuestion: function() {\n      this.model.setupRandomisation();\n    },\n\n    disableQuestion: function() {\n      this.setAllItemsEnabled(false);\n    },\n\n    enableQuestion: function() {\n      this.setAllItemsEnabled(true);\n    },\n\n    setAllItemsEnabled: function(isEnabled) {\n      this.model.get('_items').forEach(function(item, index) {\n        var $itemInput = this.$('.js-textinput-textbox').eq(index);\n\n        $itemInput.prop('disabled', !isEnabled);\n      }, this);\n    },\n\n    onQuestionRendered: function() {\n      this.setReadyStatus();\n    },\n\n    clearValidationError: function() {\n      this.$('.js-textinput-textbox').removeClass('has-error');\n    },\n\n    // Blank method for question to fill out when the question cannot be submitted\n    onCannotSubmit: function() {\n      this.showValidationError();\n    },\n\n    showValidationError: function() {\n      this.$('.js-textinput-textbox').addClass('has-error');\n    },\n\n    // This is important and should give the user feedback on how they answered the question\n    // Normally done through ticks and crosses by adding classes\n    showMarking: function() {\n      if (!this.model.get('_canShowMarking')) return;\n\n      this.model.get('_items').forEach(function(item, i) {\n        var $item = this.$('.js-textinput-item').eq(i);\n        $item.removeClass('is-correct is-incorrect').addClass(item._isCorrect ? 'is-correct' : 'is-incorrect');\n      }, this);\n    },\n\n    // Used by the question view to reset the look and feel of the component.\n    resetQuestion: function() {\n      this.$('.js-textinput-textbox').prop('disabled', !this.model.get('_isEnabled')).val('');\n\n      this.model.set({\n        _isAtLeastOneCorrectSelection: false,\n        _isCorrect: undefined\n      });\n    },\n\n    showCorrectAnswer: function() {\n\n      if (this.model.get('_answers'))  {\n\n        var correctAnswers = this.model.get('_answers');\n        this.model.get('_items').forEach(function(item, index) {\n          this.$('.js-textinput-textbox').eq(index).val(correctAnswers[index][0]);\n        }, this);\n\n      } else {\n        this.model.get('_items').forEach(function(item, index) {\n          this.$('.js-textinput-textbox').eq(index).val(item._answers[0]);\n        }, this);\n      }\n\n    },\n\n    hideCorrectAnswer: function() {\n      this.model.get('_items').forEach(function(item, index) {\n        this.$('.js-textinput-textbox').eq(index).val(item.userAnswer);\n      }, this);\n    },\n\n    onInputChanged: function(e) {\n      var $input = $(e.target);\n      this.model.setItemUserAnswer($input.parents('.js-textinput-item').index(), $input.val());\n    }\n\n  });\n\n  return TextInputView;\n\n});\n","define([\n  'core/js/models/questionModel'\n], function(QuestionModel) {\n\n  var TextInputModel = QuestionModel.extend({\n\n    init: function() {\n      QuestionModel.prototype.init.call(this);\n\n      this.set( '_genericAnswerIndexOffset', TextInputModel.genericAnswerIndexOffset );\n\n      this.setupQuestionItemIndexes();\n      this.checkCanSubmit();\n    },\n\n    setupQuestionItemIndexes: function() {\n      this.get('_items').forEach(function(item, index) {\n\n        if (item._index === undefined) item._index = index;\n        if (item._answerIndex === undefined) item._answerIndex = -1;\n\n      });\n    },\n\n    restoreUserAnswers: function() {\n      if (!this.get('_isSubmitted')) return;\n\n      var userAnswer = this.get('_userAnswer');\n      var genericAnswers = this.get('_answers');\n      this.get('_items').forEach(function(item) {\n        var answerIndex = userAnswer[item._index];\n        if (answerIndex >= TextInputModel.genericAnswerIndexOffset) {\n          item.userAnswer = genericAnswers[answerIndex - TextInputModel.genericAnswerIndexOffset];\n          item._answerIndex = answerIndex;\n        } else if (answerIndex > -1) {\n          item.userAnswer = item._answers[answerIndex];\n          item._answerIndex = answerIndex;\n        } else {\n          if (item.userAnswer === undefined) item.userAnswer = '******';\n          item._answerIndex = -1;\n        }\n        if (item.userAnswer instanceof Array) item.userAnswer = item.userAnswer[0];\n      });\n\n      this.setQuestionAsSubmitted();\n      this.markQuestion();\n      this.setScore();\n      this.setupFeedback();\n    },\n\n    setupRandomisation: function() {\n      if (!this.get('_isRandom') || !this.get('_isEnabled')) return;\n\n      this.set('_items', _.shuffle(this.get('_items')));\n    },\n\n    // Use to check if the user is allowed to submit the question\n    canSubmit: function() {\n      // can submit if every item has user input\n      return this.get('_items').every(({ userAnswer }) => userAnswer);\n    },\n\n    setItemUserAnswer:function(itemIndex, userAnswer) {\n      var item = this.get('_items')[itemIndex];\n      item.userAnswer = userAnswer;\n      this.checkCanSubmit();\n    },\n\n    //This preserve the state of the users answers for returning or showing the users answer\n    storeUserAnswer: function() {\n      var items = this.get('_items');\n\n      this.isCorrect();\n\n      var userAnswer = new Array( items.length );\n      items.forEach(function(item, index) {\n        userAnswer[ item._index ] = item._answerIndex;\n      });\n      this.set('_userAnswer', userAnswer);\n    },\n\n    isCorrect: function() {\n      if (this.get('_answers')) {\n        this.markGenericAnswers();\n      } else {\n        this.markSpecificAnswers();\n      }\n      // do we have any _isCorrect == false?\n      return !_.contains(_.pluck(this.get('_items'), '_isCorrect'), false);\n    },\n\n    isPartlyCorrect: function() {\n      return this.get('_isAtLeastOneCorrectSelection');\n    },\n\n    // Allows the learner to give answers into any input, ignoring the order.\n    // (this excludes any inputs which have their own specific answers).\n    markGenericAnswers: function() {\n      var numberOfCorrectAnswers = 0;\n      var correctAnswers = this.get('_answers').slice();\n      var usedAnswerIndexes = [];\n\n      this.get('_items').forEach(function(item) {\n        correctAnswers.forEach(function(answerGroup, answerIndex) {\n          if (_.indexOf(usedAnswerIndexes, answerIndex) > -1) return;\n\n          if (this.checkAnswerIsCorrect(answerGroup, item.userAnswer) == false) return;\n\n          usedAnswerIndexes.push(answerIndex);\n          item._isCorrect = true;\n          item._answerIndex = answerIndex + TextInputModel.genericAnswerIndexOffset;\n\n          this.set({\n            _numberOfCorrectAnswers: ++numberOfCorrectAnswers,\n            _isAtLeastOneCorrectSelection: true\n          });\n\n        }, this);\n        if(!item._isCorrect) item._isCorrect = false;\n      }, this);\n    },\n\n    // Marks any items which have answers specific to it\n    // (i.e. item has a _answers array)\n    markSpecificAnswers: function() {\n      var numberOfCorrectAnswers = 0;\n      this.get('_items').forEach(function(item) {\n        if (!item._answers) return;\n        var userAnswer = item.userAnswer || '';\n        if (this.checkAnswerIsCorrect(item._answers, userAnswer)) {\n          item._isCorrect = true;\n          item._answerIndex = _.indexOf(item._answers, this.cleanupUserAnswer(userAnswer));\n          this.set({\n            _numberOfCorrectAnswers: ++numberOfCorrectAnswers,\n            _isAtLeastOneCorrectSelection: true\n          });\n        } else {\n          item._isCorrect = false;\n          item._answerIndex = -1;\n        }\n      }, this);\n    },\n\n    checkAnswerIsCorrect: function(possibleAnswers, userAnswer) {\n      var uAnswer = this.cleanupUserAnswer(userAnswer);\n      var matched = possibleAnswers.filter(function(cAnswer) {\n        return this.cleanupUserAnswer(cAnswer) == uAnswer;\n      }, this);\n\n      var answerIsCorrect = matched && matched.length > 0;\n      if (answerIsCorrect) this.set('_hasAtLeastOneCorrectSelection', true);\n      return answerIsCorrect;\n    },\n\n    cleanupUserAnswer: function(userAnswer) {\n      if (this.get('_allowsAnyCase')) {\n        userAnswer = userAnswer.toLowerCase();\n      }\n      if (this.get('_allowsPunctuation')) {\n        userAnswer = userAnswer.replace(/[\\.,-\\/#!$%\\^&\\*;:{}=\\-_`~()]/g, '');\n        //remove any orphan double spaces and replace with single space (B & Q)->(B  Q)->(B Q)\n        userAnswer = userAnswer.replace(/(  +)+/g, ' ');\n      }\n      // removes whitespace from beginning/end (leave any in the middle)\n      return $.trim(userAnswer);\n    },\n\n    // Used to set the score based upon the _questionWeight\n    setScore: function() {\n      var numberOfCorrectAnswers = this.get('_numberOfCorrectAnswers');\n      var questionWeight = this.get('_questionWeight');\n      var itemLength = this.get('_items').length;\n\n      var score = questionWeight * numberOfCorrectAnswers / itemLength;\n\n      this.set('_score', score);\n    },\n\n    resetUserAnswer: function() {\n      this.get('_items').forEach(function(item) {\n        item._isCorrect = false;\n        item.userAnswer = '';\n      });\n    },\n\n    /**\n    * used by adapt-contrib-spoor to get the user's answers in the format required by the cmi.interactions.n.student_response data field\n    * returns the user's answers as a string in the format 'answer1[,]answer2[,]answer3'\n    * the use of [,] as an answer delimiter is from the SCORM 2004 specification for the fill-in interaction type\n    */\n    getResponse: function() {\n      return _.pluck(this.get('_items'), 'userAnswer').join('[,]');\n    },\n\n    /**\n    * used by adapt-contrib-spoor to get the type of this question in the format required by the cmi.interactions.n.type data field\n    */\n    getResponseType: function() {\n      return 'fill-in';\n    }\n  }, {\n    genericAnswerIndexOffset: 65536\n  });\n\n  return TextInputModel;\n\n});\n","define([\n  'core/js/adapt',\n  './textInputView',\n  './textInputModel',\n], function(Adapt, TextInputView, TextInputModel) {\n\n  return Adapt.register('textinput', {\n    view: TextInputView,\n    model: TextInputModel\n  });\n\n});\n","define([\n  'core/js/adapt',\n  'core/js/views/articleView'\n], function(Adapt, AdaptArticleView) {\n\n  var AssessmentView = {\n\n    postRender: function() {\n      AdaptArticleView.prototype.postRender.call(this);\n      if (this.model.isAssessmentEnabled()) {\n        this._setupEventListeners();\n\n        var config = this.model.getConfig();\n        if (config && config._questions && config._questions._canShowMarking === false) {\n          this.$el.addClass('has-no-marking');\n        }\n      }\n      this.$el.addClass('is-assessment');\n    },\n\n    _setupEventListeners: function() {\n      this.listenTo(Adapt, {\n        'assessments:complete': this._onAssessmentComplete,\n        'assessments:reset': this._onAssessmentReset,\n        remove: this._onRemove\n      });\n    },\n\n    _removeEventListeners: function() {\n      this.stopListening(Adapt, {\n        'assessments:complete': this._onAssessmentComplete,\n        'assessments:reset': this._onAssessmentReset\n      });\n    },\n\n    _onAssessmentComplete: function(state, model) {\n      if (state.id !== this.model.get('_assessment')._id) return;\n\n      console.log('assessment complete', state, model);\n    },\n\n    _onAssessmentReset: function(state, model) {\n      if (state.id !== this.model.get('_assessment')._id) return;\n\n      console.log('assessment reset', state, model);\n\n    },\n\n    _onRemove: function() {\n      this._removeEventListeners();\n    }\n\n  };\n\n  return AssessmentView;\n\n});\n","define([], function() {\n\n  var QuestionBank = function(quizBankid, articleId, numQuestionBlocks, uniqueQuestions) {\n\n    this._id = quizBankid;\n    this._articleId = articleId;\n    this._numQuestionBlocks = numQuestionBlocks;\n    this._uniqueQuestions = uniqueQuestions;\n    this.questionBlocks = [];\n    this.unUsedQuestionBlocks = undefined;\n    this.usedQuestionBlocks = [];\n\n  };\n\n  QuestionBank.prototype = {\n\n    getID: function() {\n      return this._id;\n    },\n\n    addBlock: function(block) {\n      this.questionBlocks.push(block);\n    },\n\n    getRandomQuestionBlocks: function() {\n      this.checkResetUnunsedBlocks();\n\n      var questionBlocks = [];\n      var usedQuestionBlocks = this.usedQuestionBlocks.slice(0);\n\n      for (var i = 0; i < this._numQuestionBlocks; i++) {\n        var question = this.getRandomQuestion();\n        if (question !== undefined) {\n          questionBlocks.push(question);\n        } else {\n          if (usedQuestionBlocks.length === 0) break;\n          var index = Math.floor(Math.random() * (usedQuestionBlocks.length - 1));\n          question = usedQuestionBlocks.splice(index, 1)[0];\n          questionBlocks.push(question);\n        }\n      }\n\n      return questionBlocks;\n    },\n\n    checkResetUnunsedBlocks: function() {\n      if (this.unUsedQuestionBlocks !== undefined && this._uniqueQuestions) return;\n\n      this.unUsedQuestionBlocks = this.questionBlocks.slice(0);\n    },\n\n    getRandomQuestion: function() {\n      if (this.unUsedQuestionBlocks !== undefined && this.unUsedQuestionBlocks.length < 1) {\n        console.warn('assessment:' + this._articleId + ' No more unique questions for _assessment._quizBankID ' + this._id);\n        return undefined;\n      }\n\n      var index = Math.round(Math.random() * (this.unUsedQuestionBlocks.length - 1));\n      var questionBlock = this.unUsedQuestionBlocks[index];\n      this.usedQuestionBlocks.push(questionBlock);\n\n      this.unUsedQuestionBlocks.splice(index, 1);\n\n      return questionBlock;\n    }\n\n  };\n\n  return QuestionBank;\n\n});\n","define([\n  'core/js/adapt',\n  './adapt-assessmentQuestionBank'\n], function(Adapt, QuestionBank) {\n\n  var givenIdCount = 0;\n  var assessmentConfigDefaults = {\n    _isEnabled: true,\n    _questions: {\n      _resetType: 'soft',\n      _canShowFeedback: false,\n      _canShowMarking: false,\n      _canShowModelAnswer: false\n    },\n    _suppressMarking: false,\n    _isPercentageBased: true,\n    _scoreToPass: 100,\n    _includeInTotalScore: true,\n    _assessmentWeight: 1,\n    _isResetOnRevisit: true,\n    _reloadPageOnReset: true,\n    _attempts: 'infinite',\n    _allowResetIfPassed: false\n  };\n\n  var AssessmentModel = {\n\n    // Private functions\n    _postInitialize: function() {\n      if (!this.isAssessmentEnabled()) return;\n\n      var assessmentConfig = this.getConfig();\n\n      _.extend(this, {\n        _currentQuestionComponents: null,\n        _originalChildModels: null,\n        _questionBanks: null,\n        _forceResetOnRevisit: false\n      });\n\n      var attemptsLeft;\n      switch (assessmentConfig._attempts) {\n        case 'infinite': case 0: case undefined: case -1: case null:\n          attemptsLeft = 'infinite';\n          break;\n        default:\n          attemptsLeft = assessmentConfig._attempts;\n          break;\n      }\n\n      this.set({\n        _currentQuestionComponentIds: [],\n        _assessmentCompleteInSession: false,\n        _attemptInProgress: false,\n        _isAssessmentComplete: false,\n        _numberOfQuestionsAnswered: 0,\n        _lastAttemptScoreAsPercent: 0,\n        _attempts: attemptsLeft,\n        _attemptsLeft: attemptsLeft,\n        _attemptsSpent: 0\n      });\n\n      this.listenToOnce(Adapt, 'app:dataReady', this._onDataReady);\n      this.listenTo(Adapt, 'remove', this._onRemove);\n\n    },\n\n    init: function() {\n      // save original children\n      this._originalChildModels = this.getChildren().models;\n      // collect all question components\n      this._currentQuestionComponents = this.findDescendantModels('components', { where: { _isQuestionType: true } });\n      this.set('_currentQuestionComponentIds', this._currentQuestionComponents.map(function(comp) {\n        return comp.get('_id');\n      }));\n\n      this._setAssessmentOwnershipOnChildrenModels();\n\n      // ensure the _questions attribute is set up (see https://github.com/adaptlearning/adapt_framework/issues/2971)\n      this._updateQuestionsState();\n    },\n\n    _setAssessmentOwnershipOnChildrenModels: function() {\n      // mark all children components as belonging to an assessment\n      var assessmentConfig = this.get('_assessment');\n      var childConfig = {\n        _isPartOfAssessment: true,\n        _assessmentId: assessmentConfig._id\n      };\n      for (var i = 0, l = this._originalChildModels.length; i < l; i++) {\n        var blockModel = this._originalChildModels[i];\n        blockModel.set(childConfig);\n        // make sure components are set to _isPartOfAssessment for plp checking\n        blockModel.setOnChildren(childConfig);\n      }\n    },\n\n    _onDataReady: function() {\n      // register assessment\n      Adapt.assessment.register(this);\n    },\n\n    _setupAssessmentData: function(force, callback) {\n      var assessmentConfig = this.getConfig();\n      var state = this.getState();\n      var shouldResetAssessment = (!this.get('_attemptInProgress') && !state.isPass) || force === true;\n      var shouldResetQuestions = (assessmentConfig._isResetOnRevisit && (state.allowResetIfPassed || !state.isPass)) || force === true;\n\n      if (shouldResetAssessment || shouldResetQuestions) {\n        Adapt.trigger('assessments:preReset', this.getState(), this);\n      }\n\n      var quizModels;\n      if (shouldResetAssessment) {\n        this.set({\n          _numberOfQuestionsAnswered: 0,\n          _isAssessmentComplete: false,\n          _assessmentCompleteInSession: false,\n          _score: 0\n        });\n        this.getChildren().models = this._originalChildModels;\n        if (assessmentConfig._banks &&\n            assessmentConfig._banks._isEnabled &&\n            assessmentConfig._banks._split.length > 1) {\n\n          quizModels = this._setupBankedAssessment();\n        } else if (assessmentConfig._randomisation &&\n                  assessmentConfig._randomisation._isEnabled) {\n\n          quizModels = this._setupRandomisedAssessment();\n        }\n      }\n\n      if (!quizModels) {\n        // leave the order as before, completed or not\n        quizModels = this.getChildren().models;\n      } else if (quizModels.length === 0) {\n        quizModels = this.getChildren().models;\n        console.warn('assessment: Not enough unique questions to create a fresh assessment, using last selection');\n      }\n\n      this.getChildren().models = quizModels;\n\n      this._currentQuestionComponents = this.findDescendantModels('components', { where: { _isQuestionType: true } });\n      this.set('_currentQuestionComponentIds', this._currentQuestionComponents.map(function(comp) {\n        return comp.get('_id');\n      }));\n\n      if (shouldResetAssessment || shouldResetQuestions) {\n        this._resetQuestions(function() {\n          this.set('_attemptInProgress', true);\n          Adapt.trigger('assessments:reset', this.getState(), this);\n\n          finalise.apply(this);\n        }.bind(this));\n      } else {\n        finalise.apply(this);\n      }\n\n      function finalise() {\n        if (!state.isComplete) {\n          this.set('_attemptInProgress', true);\n        }\n\n        this._overrideQuestionComponentSettings();\n        this._setupQuestionListeners();\n        this._checkNumberOfQuestionsAnswered();\n        this._updateQuestionsState();\n\n        Adapt.assessment.saveState();\n\n        if (typeof callback === 'function') callback.apply(this);\n\n        if (shouldResetAssessment || shouldResetQuestions) {\n          Adapt.trigger('assessments:postReset', this.getState(), this);\n        }\n      }\n    },\n\n    _setupBankedAssessment: function() {\n      var assessmentConfig = this.getConfig();\n\n      this._setupBanks();\n\n      // get random questions from banks\n      var questionModels = [];\n      for (var bankId in this._questionBanks) {\n        if (this._questionBanks.hasOwnProperty(bankId)) { // skip over properties that were added to Array.prototype by the ES5-shim for IE8\n          var questionBank = this._questionBanks[bankId];\n          var questions = questionBank.getRandomQuestionBlocks();\n          questionModels = questionModels.concat(questions);\n        }\n      }\n\n      // if overall question order should be randomized\n      if (assessmentConfig._banks._randomisation) {\n        questionModels = _.shuffle(questionModels);\n      }\n\n      return questionModels;\n    },\n\n    _setupBanks: function() {\n      var assessmentConfig = this.getConfig();\n      var banks = assessmentConfig._banks._split.split(',');\n      var bankId;\n\n      this._questionBanks = [];\n\n      // build fresh banks\n      for (var i = 0, l = banks.length; i < l; i++) {\n        var bank = banks[i];\n        bankId = (i + 1);\n        var questionBank = new QuestionBank(bankId, this.get('_id'), bank, true);\n\n        this._questionBanks[bankId] = questionBank;\n      }\n\n      // add blocks to banks\n      var children = this.getChildren().models;\n      for (var j = 0, count = children.length; j < count; j++) {\n        var blockModel = children[j];\n        var blockAssessmentConfig = blockModel.get('_assessment');\n        if (!blockAssessmentConfig) continue;\n        bankId = blockAssessmentConfig._quizBankID;\n        this._questionBanks[bankId].addBlock(blockModel);\n      }\n\n    },\n\n    _setupRandomisedAssessment: function() {\n      var assessmentConfig = this.getConfig();\n\n      var randomisationModel = assessmentConfig._randomisation;\n      var blockModels = this.getChildren().models;\n\n      var questionModels = _.shuffle(blockModels);\n\n      if (randomisationModel._blockCount > 0) {\n        questionModels = questionModels.slice(0, randomisationModel._blockCount);\n      }\n\n      return questionModels;\n    },\n\n    _overrideQuestionComponentSettings: function() {\n      var newSettings = this._getMarkingSettings();\n\n      // Add any additional setting overrides here\n      var questionConfig = this.getConfig()._questions;\n      if (questionConfig.hasOwnProperty('_canShowFeedback')) {\n        newSettings._canShowFeedback = questionConfig._canShowFeedback;\n      }\n\n      if (!_.isEmpty(newSettings)) {\n        for (var i = 0, l = this._currentQuestionComponents.length; i < l; i++) {\n          this._currentQuestionComponents[i].set(newSettings, { pluginName: '_assessment' });\n        }\n      }\n    },\n\n    _setupQuestionListeners: function() {\n      var questionComponents = this._currentQuestionComponents;\n      for (var i = 0, l = questionComponents.length; i < l; i++) {\n        var question = questionComponents[i];\n        if (question.get('_isInteractionComplete')) continue;\n        this.listenTo(question, 'change:_isInteractionComplete', this._onQuestionCompleted);\n      }\n    },\n\n    _checkNumberOfQuestionsAnswered: function() {\n      var questionComponents = this._currentQuestionComponents;\n      var numberOfQuestionsAnswered = 0;\n      for (var i = 0, l = questionComponents.length; i < l; i++) {\n        var question = questionComponents[i];\n        if (question.get('_isInteractionComplete')) {\n          numberOfQuestionsAnswered++;\n        }\n      }\n      this.set('_numberOfQuestionsAnswered', numberOfQuestionsAnswered);\n    },\n\n    _removeQuestionListeners: function() {\n      var questionComponents = this._currentQuestionComponents;\n      if (!questionComponents) return;\n      for (var i = 0, l = questionComponents.length; i < l; i++) {\n        var question = questionComponents[i];\n        this.stopListening(question, 'change:_isInteractionComplete', this._onQuestionCompleted);\n      }\n    },\n\n    _onQuestionCompleted: function(questionModel, value) {\n      if (value === false) return;\n      if (!questionModel.get('_isInteractionComplete')) return;\n\n      var numberOfQuestionsAnswered = this.get('_numberOfQuestionsAnswered');\n      numberOfQuestionsAnswered++;\n      this.set('_numberOfQuestionsAnswered', numberOfQuestionsAnswered);\n\n      this._updateQuestionsState();\n      Adapt.assessment.saveState();\n\n      this._checkAssessmentComplete();\n    },\n\n    _checkAssessmentComplete: function() {\n      var numberOfQuestionsAnswered = this.get('_numberOfQuestionsAnswered');\n\n      var allQuestionsAnswered = numberOfQuestionsAnswered >= this._currentQuestionComponents.length;\n      if (!allQuestionsAnswered) return;\n\n      this._onAssessmentComplete();\n    },\n\n    _onAssessmentComplete: function() {\n      this.set('_attemptInProgress', false);\n      this._spendAttempt();\n\n      var scoreAsPercent = this._getScoreAsPercent();\n      var score = this._getScore();\n      var maxScore = this._getMaxScore();\n\n      this.set({\n        _scoreAsPercent: scoreAsPercent,\n        _score: score,\n        _maxScore: maxScore,\n        _lastAttemptScoreAsPercent: scoreAsPercent,\n        _assessmentCompleteInSession: true,\n        _isAssessmentComplete: true\n      });\n\n      this._updateQuestionsState();\n\n      this._checkIsPass();\n\n      this._removeQuestionListeners();\n\n      if (this._isMarkingSuppressionEnabled() && !this._isAttemptsLeft()) {\n        _.defer(function() {\n          this._overrideMarkingSettings();\n          this._refreshQuestions();\n        }.bind(this));\n      }\n\n      Adapt.trigger('assessments:complete', this.getState(), this);\n    },\n\n    _updateQuestionsState: function() {\n      var questions = [];\n\n      var questionComponents = this._currentQuestionComponents;\n      for (var i = 0, l = questionComponents.length; i < l; i++) {\n        var questionComponent = questionComponents[i];\n\n        var questionModel = {\n          _id: questionComponent.get('_id'),\n          _isCorrect: questionComponent.get('_isCorrect') === undefined ? null : questionComponent.get('_isCorrect')\n        };\n\n        // build array of questions\n        questions.push(questionModel);\n\n      }\n\n      this.set('_questions', questions);\n    },\n\n    _checkIsPass: function() {\n      var assessmentConfig = this.getConfig();\n\n      var isPercentageBased = assessmentConfig._isPercentageBased;\n      var scoreToPass = assessmentConfig._scoreToPass;\n\n      var scoreAsPercent = this.get('_scoreAsPercent');\n      var score = this.get('_score');\n\n      var isPass = isPercentageBased ? (scoreAsPercent >= scoreToPass) : (score >= scoreToPass);\n\n      this.set('_isPass', isPass);\n    },\n\n    _getMarkingSettings: function() {\n      var markingSettings = {};\n\n      if (this._shouldSuppressMarking()) {\n        markingSettings = {\n          _canShowMarking: false,\n          _canShowModelAnswer: false\n        };\n      } else {\n        var questionConfig = this.getConfig()._questions;\n\n        if (questionConfig.hasOwnProperty('_canShowModelAnswer')) {\n          markingSettings._canShowModelAnswer = questionConfig._canShowModelAnswer;\n        }\n\n        if (questionConfig.hasOwnProperty('_canShowMarking')) {\n          markingSettings._canShowMarking = questionConfig._canShowMarking;\n        }\n      }\n\n      return markingSettings;\n    },\n\n    _overrideMarkingSettings: function() {\n      var newMarkingSettings = this._getMarkingSettings();\n      for (var i = 0, l = this._currentQuestionComponents.length; i < l; i++) {\n        this._currentQuestionComponents[i].set(newMarkingSettings, {\n          pluginName: '_assessment'\n        });\n      }\n    },\n\n    _refreshQuestions: function() {\n      for (var a = 0, b = this._currentQuestionComponents.length; a < b; a++) {\n        var question = this._currentQuestionComponents[a];\n        question.refresh();\n      }\n    },\n\n    _shouldSuppressMarking: function() {\n      return this._isMarkingSuppressionEnabled() && this._isAttemptsLeft();\n    },\n\n    _isMarkingSuppressionEnabled: function() {\n      var assessmentConfig = this.getConfig();\n      return assessmentConfig._suppressMarking;\n    },\n\n    _isAttemptsLeft: function() {\n      if (this.get('_isAssessmentComplete') && this.get('_isPass')) return false;\n\n      if (this.get('_attemptsLeft') === 0) return false;\n\n      return true;\n    },\n\n    _spendAttempt: function() {\n      if (!this._isAttemptsLeft()) return false;\n\n      var attemptsSpent = this.get('_attemptsSpent');\n      this.set('_attemptsSpent', ++attemptsSpent);\n\n      if (this.get('_attempts') === 'infinite') return true;\n\n      var attemptsLeft = this.get('_attemptsLeft');\n      this.set('_attemptsLeft', --attemptsLeft);\n\n      return true;\n    },\n\n    _getScore: function() {\n      var score = 0;\n      var questionComponents = this._currentQuestionComponents;\n      for (var i = 0, l = questionComponents.length; i < l; i++) {\n        var question = questionComponents[i];\n        if (question.get('_isCorrect') &&\n          question.get('_questionWeight')) {\n          score += question.get('_questionWeight');\n        }\n      }\n      return score;\n    },\n\n    _getMaxScore: function() {\n      var maxScore = 0;\n      var questionComponents = this._currentQuestionComponents;\n      for (var i = 0, l = questionComponents.length; i < l; i++) {\n        var question = questionComponents[i];\n        if (question.get('_questionWeight')) {\n          maxScore += question.get('_questionWeight');\n        }\n      }\n      return maxScore;\n    },\n\n    _getScoreAsPercent: function() {\n      if (this._getMaxScore() === 0) return 0;\n      return Math.round((this._getScore() / this._getMaxScore()) * 100);\n    },\n\n    _getLastAttemptScoreAsPercent: function() {\n      return this.get('_lastAttemptScoreAsPercent');\n    },\n\n    _checkReloadPage: function() {\n      if (!this.canResetInPage()) return false;\n\n      var parentId = this.getParent().get('_id');\n      var currentLocation = Adapt.location._currentId;\n\n      // check if on assessment page and should rerender page\n      if (currentLocation !== parentId) return false;\n      if (!this.get('_isReady')) return false;\n\n      return true;\n    },\n\n    _reloadPage: function(callback) {\n      this._forceResetOnRevisit = true;\n\n      this.listenToOnce(Adapt, 'pageView:ready', callback);\n\n      _.delay(function() {\n        Backbone.history.navigate('#/id/' + Adapt.location._currentId, { replace: true, trigger: true });\n      }, 250);\n    },\n\n    _resetQuestions: function(callback) {\n      var assessmentConfig = this.getConfig();\n      var syncIterations = 1; // number of synchronous iterations to perform\n      var i = 0;\n      var qs = this._currentQuestionComponents;\n      var len = qs.length;\n\n      function step() {\n        for (var j = 0, count = Math.min(syncIterations, len - i); j < count; i++, j++) {\n          var question = qs[i];\n          question.reset(assessmentConfig._questions._resetType, true);\n        }\n\n        i === len ? callback() : setTimeout(step);\n      }\n\n      step();\n    },\n\n    _onRemove: function() {\n      this._removeQuestionListeners();\n    },\n\n    _setCompletionStatus: function() {\n      this.set({\n        _isComplete: true,\n        _isInteractionComplete: true\n      });\n    },\n\n    _checkIfQuestionsWereRestored: function() {\n      if (this.get('_assessmentCompleteInSession')) return;\n      if (!this.get('_isAssessmentComplete')) return;\n\n      // fix for courses that do not remember the user selections\n      // force assessment to reset if user revisits an assessment page in a new session which is completed\n      var wereQuestionsRestored = true;\n\n      var questions = this.get('_questions');\n      for (var i = 0, l = questions.length; i < l; i++) {\n        var question = questions[i];\n        var questionModel = Adapt.findById(question._id);\n        if (!questionModel.get('_isSubmitted')) {\n          wereQuestionsRestored = false;\n          break;\n        }\n      }\n\n      if (!wereQuestionsRestored) {\n        this.set('_assessmentCompleteInSession', true);\n        return true;\n      }\n\n      return false;\n    },\n\n    // Public Functions\n    isAssessmentEnabled: function() {\n      if (this.get('_assessment') &&\n        this.get('_assessment')._isEnabled) return true;\n      return false;\n    },\n\n    canResetInPage: function() {\n      var assessmentConfig = this.getConfig();\n      if (assessmentConfig._reloadPageOnReset === false) return false;\n      return true;\n    },\n\n    reset: function(force, callback) {\n\n      if (this._isResetInProgress) {\n        // prevent multiple resets from executing.\n        // keep callbacks in queue for when current reset is finished\n        this.once('reset', function() {\n          this._isResetInProgress = false;\n          if (typeof callback === 'function') {\n            callback(true);\n          }\n        });\n        return;\n      }\n\n      var assessmentConfig = this.getConfig();\n\n      // check if forcing reset via page revisit or force parameter\n      force = this._forceResetOnRevisit || force === true;\n      this._forceResetOnRevisit = false;\n\n      var isPageReload = this._checkReloadPage();\n\n      // stop resetting if not complete or not allowed\n      if (this.get('_assessmentCompleteInSession') &&\n          !assessmentConfig._isResetOnRevisit &&\n          !isPageReload &&\n          !force) {\n        if (typeof callback === 'function') {\n          callback(false);\n        }\n        return false;\n      }\n\n      // check if new session and questions not restored\n      var wereQuestionsRestored = this._checkIfQuestionsWereRestored();\n      force = force || wereQuestionsRestored;\n      // the assessment is going to be reset so we must reset attempts\n      // otherwise assessment may not be set up properly in next session\n      if (force && !this._isAttemptsLeft()) {\n        this.set({\n          _attemptsLeft: this.get('_attempts'),\n          _attemptsSpent: 0\n        });\n      }\n\n      var allowResetIfPassed = this.get('_assessment')._allowResetIfPassed;\n      // stop resetting if no attempts left and allowResetIfPassed is false\n      if (!this._isAttemptsLeft() && !force && !allowResetIfPassed) {\n        if (typeof callback === 'function') callback(false);\n        return false;\n      }\n\n      if (!isPageReload) {\n        // only perform this section when not attempting to reload the page\n        // wait for reset to trigger\n        this.once('reset', function() {\n          this._isResetInProgress = false;\n          if (typeof callback === 'function') {\n            callback(true);\n          }\n        });\n        this._isResetInProgress = true;\n        // perform asynchronous reset\n        this._setupAssessmentData(force, function() {\n          this.trigger('reset');\n        });\n      } else {\n        this._reloadPage(function() {\n          if (typeof callback === 'function') {\n            callback(true);\n          }\n        });\n      }\n\n      return true;\n    },\n\n    getSaveState: function() {\n      var state = this.getState();\n      let blocks;\n      var cfg = this.getConfig();\n      var banksActive = cfg._banks && cfg._banks._isEnabled && cfg._banks._split.length > 1;\n      var randomisationActive = cfg._randomisation && cfg._randomisation._isEnabled;\n\n      if (!banksActive && !randomisationActive) {\n        // include presentation blocks in save state so that blocks without questions aren't removed\n        blocks = this.findDescendantModels('block');\n      } else {\n        blocks = state.questions.map(question => Adapt.findById(question._id).getParent());\n      }\n      blocks = blocks.filter(block => {\n        const trackingId = block.get('_trackingId');\n        return Number.isInteger(trackingId) && trackingId >= 0;\n      });\n      const blockTrackingIds = blocks.map(block => block.get('_trackingId'));\n      const blockCompletion = blocks.map(block => {\n        let questions = block.findDescendantModels('question');\n        return questions.map(question => question.get('_isCorrect') || false);\n      });\n      const blockData = [blockTrackingIds, blockCompletion];\n\n      const saveState = [\n        state.isComplete ? 1 : 0,\n        state.attemptsSpent,\n        state.maxScore || 0,\n        state.score,\n        state.attemptInProgress ? 1 : 0\n      ];\n\n      const dataPackage = [saveState, blockData];\n\n      return dataPackage;\n    },\n\n    setRestoreState: function(dataPackage) {\n      const restoreState = dataPackage[0];\n      const blockData = dataPackage[1];\n      var isComplete = restoreState[0] === 1;\n      var attempts = this.get('_attempts');\n      var attemptsSpent = restoreState[1];\n      var maxScore = restoreState[2];\n      var score = restoreState[3];\n      var scoreAsPercent = score ? Math.round(score / maxScore * 100) : 0;\n      var attemptInProgress = restoreState[4] === 1;\n\n      let blocks = blockData[0].map(trackingId => Adapt.data.findWhere({ _trackingId: trackingId }));\n\n      if (blocks.length) {\n        this.getChildren().models = blocks;\n      }\n\n      this.set({\n        _isAssessmentComplete: isComplete,\n        _assessmentCompleteInSession: false,\n        _attemptsSpent: attemptsSpent,\n        _attemptInProgress: attemptInProgress,\n        _attemptsLeft: (attempts === 'infinite' ? attempts : attempts - attemptsSpent),\n        _maxScore: maxScore || this._getMaxScore(),\n        _score: score || 0,\n        _scoreAsPercent: scoreAsPercent,\n        _lastAttemptScoreAsPercent: scoreAsPercent\n      });\n\n      var questions = [];\n      blocks.forEach((block, blockIndex) => {\n        const blockQuestions = block.findDescendantModels('question');\n        blockQuestions.forEach((question, questionIndex) => {\n          questions.push({\n            _id: question.get('_id'),\n            _isCorrect: blockData[1][blockIndex][questionIndex]\n          });\n        });\n      });\n      this.set('_questions', questions);\n\n      if (isComplete) this._checkIsPass();\n\n      Adapt.trigger('assessments:restored', this.getState(), this);\n\n    },\n\n    getState: function() {\n      // return the current state of the assessment\n      // create snapshot of values so as not to create memory leaks\n      var assessmentConfig = this.getConfig();\n\n      var state = {\n        id: assessmentConfig._id,\n        type: 'article-assessment',\n        pageId: this.getParent().get('_id'),\n        articleId: this.get('_id'),\n        isEnabled: assessmentConfig._isEnabled,\n        isComplete: this.get('_isAssessmentComplete'),\n        isPercentageBased: assessmentConfig._isPercentageBased,\n        scoreToPass: assessmentConfig._scoreToPass,\n        score: this.get('_score'),\n        scoreAsPercent: this.get('_scoreAsPercent'),\n        maxScore: this.get('_maxScore'),\n        isPass: this.get('_isPass'),\n        includeInTotalScore: assessmentConfig._includeInTotalScore,\n        assessmentWeight: assessmentConfig._assessmentWeight,\n        attempts: this.get('_attempts'),\n        attemptsSpent: this.get('_attemptsSpent'),\n        attemptsLeft: this.get('_attemptsLeft'),\n        attemptInProgress: this.get('_attemptInProgress'),\n        lastAttemptScoreAsPercent: this.get('_lastAttemptScoreAsPercent'),\n        questions: this.get('_questions'),\n        resetType: assessmentConfig._questions._resetType,\n        allowResetIfPassed: assessmentConfig._allowResetIfPassed,\n        questionModels: new Backbone.Collection(this._currentQuestionComponents)\n      };\n\n      return state;\n    },\n\n    getConfig: function() {\n      var assessmentConfig = this.get('_assessment');\n\n      if (!assessmentConfig) {\n        assessmentConfig = $.extend(true, {}, assessmentConfigDefaults);\n      } else {\n        assessmentConfig = $.extend(true, {}, assessmentConfigDefaults, assessmentConfig);\n      }\n\n      if (assessmentConfig._id === undefined) {\n        assessmentConfig._id = 'givenId' + (givenIdCount++);\n      }\n\n      this.set('_assessment', assessmentConfig);\n\n      return assessmentConfig;\n    }\n\n  };\n\n  return AssessmentModel;\n\n});\n","define([\n  'core/js/adapt'\n], function(Adapt) {\n\n  /*\n   * Here we setup a registry for all assessments\n   */\n  var assessmentsConfigDefaults = {\n    _isPercentageBased: true,\n    _scoreToPass: 100,\n    _isDefaultsLoaded: true\n  };\n\n  Adapt.assessment = _.extend({\n\n    // Private functions\n    _assessments: _.extend([], {\n      _byPageId: {},\n      _byAssessmentId: {}\n    }),\n\n    initialize: function() {\n      this.listenTo(Adapt, {\n        'assessments:complete': this._onAssessmentsComplete,\n        'router:location': this._checkResetAssessmentsOnRevisit,\n        'router:plugin': this._handleRoute,\n        'app:dataReady': this._onDataReady\n      });\n    },\n\n    _onAssessmentsComplete: function(state) {\n      var assessmentId = state.id;\n\n      state.isComplete = true;\n\n      if (assessmentId === undefined) return;\n\n      if (!this._getStateByAssessmentId(assessmentId)) {\n        Adapt.log.warn('assessments: state was not registered when assessment was created');\n      }\n\n      this.saveState();\n\n      this._setPageProgress();\n\n      this._checkAssessmentsComplete();\n\n    },\n\n    _restoreModelState: function(assessmentModel) {\n\n      if (!this._saveStateModel) {\n        this._saveStateModel = Adapt.offlineStorage.get('a');\n      }\n      if (this._saveStateModel) {\n        var state = assessmentModel.getState();\n        if (this._saveStateModel[state.id]) {\n          assessmentModel.setRestoreState(Adapt.offlineStorage.deserialize(this._saveStateModel[state.id]));\n        }\n      }\n\n    },\n\n    /*\n     * Allow navigating to an assessment via the URL.\n     */\n    _handleRoute: function(plugin, id) {\n      if (plugin !== 'assessment' && plugin !== 'article-assessment' || id === undefined) {\n        return;\n      }\n\n      // Check the 'id' passed is that of an article.\n      if (!Adapt.findById(id)) {\n        // The 'id' passed may have been the assessment _id/name, not the article _id.\n        var assessment = Adapt.assessment._assessments._byAssessmentId[id];\n        if (assessment) {\n          // Set 'id' to the article _id.\n          id = assessment.get('_id');\n        } else {\n          Adapt.log.warn('Assessment not found with _id: ' + id);\n          return;\n        }\n      }\n\n      _.defer(function() {\n        // Defer this call so that the router's _canNavigate flag is true.\n        Backbone.history.navigate('#/id/' + id, { trigger: true, replace: true });\n      });\n    },\n\n    _checkResetAssessmentsOnRevisit: function(toObject) {\n      /*\n       * Here we hijack router:location to reorganise the assessment blocks\n       * this must happen before trickle listens to block completion\n       */\n      if (toObject._contentType !== 'page') return;\n\n      // initialize assessment on page visit before pageView:preRender (and trickle)\n      var pageAssessmentModels = this._getAssessmentByPageId(toObject._currentId);\n      if (pageAssessmentModels === undefined) return;\n\n      /*\n       * Here we further hijack the router to ensure the asynchronous assessment\n       * reset completes before routing completes\n       */\n      Adapt.wait.for(function resetAllAssessments(allAssessmentHaveReset) {\n\n        var numberOfAssessments = pageAssessmentModels.length;\n        var numberOfResetAssessments = 0;\n        var forceAssessmentReset = false;\n\n        pageAssessmentModels.forEach(function(model) {\n\n          model.reset(forceAssessmentReset, function() {\n\n            numberOfResetAssessments++;\n            var haveAllModelsReset = (numberOfResetAssessments === numberOfAssessments);\n            if (!haveAllModelsReset) {\n              return;\n            }\n\n            allAssessmentHaveReset();\n\n          });\n\n        });\n\n      });\n\n      this._setPageProgress();\n    },\n\n    _onDataReady: function() {\n      this._assessments = _.extend([], {\n        _byPageId: {},\n        _byAssessmentId: {}\n      });\n\n      this._restoredCount = 0;\n    },\n\n    _checkAssessmentsComplete: function() {\n      var allAssessmentsComplete = true;\n      var assessmentToPostBack = 0;\n      var states = this._getStatesByAssessmentId();\n\n      var assessmentStates = [];\n\n      for (var id in states) {\n        var state = states[id];\n        if (!state.includeInTotalScore) continue;\n        if (!state.isComplete) {\n          allAssessmentsComplete = false;\n          break;\n        }\n        assessmentToPostBack++;\n        assessmentStates.push(state);\n      }\n\n      if (!allAssessmentsComplete || assessmentToPostBack === 0) return false;\n\n      if (assessmentToPostBack === 1) {\n        this._setupSingleAssessmentConfiguration(assessmentStates[0]);\n      }\n\n      _.defer(function() {\n        Adapt.trigger('assessment:complete', this.getState());\n      }.bind(this));\n\n      return true;\n    },\n\n    _setupSingleAssessmentConfiguration: function(assessmentState) {\n      var assessmentsConfig = Adapt.course.get('_assessment');\n      $.extend(true, assessmentsConfig, {\n        _isPercentageBased: assessmentState.isPercentageBased,\n        _scoreToPass: assessmentState.scoreToPass\n      });\n      Adapt.course.set('_assessment', assessmentsConfig);\n    },\n\n    _getAssessmentByPageId: function(pageId) {\n      return this._assessments._byPageId[pageId];\n    },\n\n    _getStateByAssessmentId: function(assessmentId) {\n      if (assessmentId === undefined) {\n        return null;\n      }\n\n      return this._assessments._byAssessmentId[assessmentId].getState();\n    },\n\n    _getStatesByAssessmentId: function() {\n      var states = {};\n      for (var i = 0, l = this._assessments.length; i < l; i++) {\n        var assessmentModel = this._assessments[i];\n        if (!assessmentModel.get('_isAvailable')) continue;\n        var state = assessmentModel.getState();\n        states[state.id] = state;\n      }\n      return states;\n    },\n\n    _setPageProgress: function() {\n      // set _subProgressTotal and _subProgressComplete on pages that have assessment progress indicator requirements\n\n      for (var k in this._assessments._byPageId) {\n\n        var assessments = this._assessments._byPageId[k];\n\n        var assessmentsTotal = assessments.length;\n        var assessmentsPassed = 0;\n\n        for (var i = 0, l = assessments.length; i < l; i++) {\n          var assessmentState = assessments[i].getState();\n\n          if (assessmentState.includeInTotalScore && !assessmentState.isPass) continue;\n\n          if (assessmentState.isComplete) {\n            assessmentsPassed++;\n          }\n        }\n\n        try {\n          var pageModel = Adapt.findById(k);\n          pageModel.set({\n            _subProgressTotal: assessmentsTotal,\n            _subProgressComplete: assessmentsPassed\n          });\n        } catch (e) {\n\n        }\n\n      }\n    },\n\n    _addToAssessmentIdMap: function(id, model) {\n      if (id === undefined) {\n        Adapt.log.warn('An assessment has been registered with an undefined value for \"_id\"');\n        return;\n      }\n\n      if (id === '') {\n        Adapt.log.warn('An assessment has been registered with an empty value for \"_id\"');\n      }\n\n      if (!this._assessments._byAssessmentId[id]) {\n        this._assessments._byAssessmentId[id] = model;\n      } else {\n        Adapt.log.warn('An assessment with an _id of \"' + id + '\" already exists!');\n      }\n    },\n\n    _setupQuestionNumbering: function() {\n      var getRelatedQuestions = function(data) {\n        var currentAssessmentId = data._assessmentId;\n        var currentAssessment = Adapt.assessment.get(currentAssessmentId);\n        return currentAssessment.getState().questions;\n      };\n\n      Handlebars.registerHelper('questionNumber', function getQuestionNumber() {\n        var data = this.view ? this.view.model.toJSON() : this;\n        if (!data._isPartOfAssessment) return;\n\n        var related = _.pluck(getRelatedQuestions(data), '_id');\n\n        return related.indexOf(data._id) + 1;\n      });\n\n      Handlebars.registerHelper('questionCount', function getTotalQuestions() {\n        var data = this.view ? this.view.model.toJSON() : this;\n        if (!data._isPartOfAssessment) return;\n        return getRelatedQuestions(data).length;\n      });\n    },\n\n    // Public functions\n    register: function(assessmentModel) {\n      var state = assessmentModel.getState();\n      var assessmentId = state.id;\n      var pageId = state.pageId;\n\n      if (this._assessments._byPageId[pageId] === undefined) {\n        this._assessments._byPageId[pageId] = [];\n      }\n\n      this._assessments._byPageId[pageId].push(assessmentModel);\n\n      this._addToAssessmentIdMap(assessmentId, assessmentModel);\n\n      this._assessments.push(assessmentModel);\n\n      this._restoreModelState(assessmentModel);\n      this._restoredCount++;\n\n      Adapt.trigger('assessments:register', state, assessmentModel);\n\n      this._setPageProgress();\n\n      this._setupQuestionNumbering();\n\n      if (this._restoredCount === this._assessments.length) {\n        // Since all assessments have been stored, broadcast an\n        // event which has the collated state.\n        Adapt.trigger('assessment:restored', this.getState());\n      }\n    },\n\n    get: function(id) {\n      if (id === undefined) {\n        return this._assessments.slice(0);\n      } else {\n        return this._assessments._byAssessmentId[id];\n      }\n    },\n\n    saveState: function() {\n\n      this._saveStateModel = {};\n      for (var i = 0, assessmentModel; assessmentModel = this._assessments[i++];) {\n        var state = assessmentModel.getState();\n        this._saveStateModel[state.id] = Adapt.offlineStorage.serialize(assessmentModel.getSaveState());\n      }\n\n      Adapt.offlineStorage.set('a', this._saveStateModel);\n    },\n\n    getConfig: function () {\n      var assessmentsConfig = Adapt.course.get('_assessment');\n\n      if (assessmentsConfig && assessmentsConfig._isDefaultsLoaded) {\n        return assessmentsConfig;\n      }\n\n      if (assessmentsConfig === undefined) {\n        assessmentsConfig = $.extend(true, {}, assessmentsConfigDefaults);\n      } else {\n        assessmentsConfig = $.extend(true, {}, assessmentsConfigDefaults, assessmentsConfig);\n      }\n\n      Adapt.course.set('_assessment', assessmentsConfig);\n\n      return assessmentsConfig;\n    },\n\n    getState: function() {\n      var assessmentsConfig = this.getConfig();\n\n      var score = 0;\n      var maxScore = 0;\n      var isPass = false;\n      var totalAssessments = 0;\n\n      var states = this._getStatesByAssessmentId();\n\n      var assessmentsComplete = 0;\n\n      for (var id in states) {\n        var state = states[id];\n        if (!state.includeInTotalScore) continue;\n        if (state.isComplete) assessmentsComplete++;\n        totalAssessments++;\n        maxScore += state.maxScore / state.assessmentWeight;\n        score += state.score / state.assessmentWeight;\n      }\n\n      var isComplete = assessmentsComplete === totalAssessments;\n\n      var scoreAsPercent = Math.round((score / maxScore) * 100);\n\n      if ((assessmentsConfig._scoreToPass || 100) && isComplete) {\n        if (assessmentsConfig._isPercentageBased !== false) {\n          if (scoreAsPercent >= assessmentsConfig._scoreToPass) isPass = true;\n        } else {\n          if (score >= assessmentsConfig._scoreToPass) isPass = true;\n        }\n      }\n\n      return {\n        isComplete: isComplete,\n        isPercentageBased: assessmentsConfig._isPercentageBased,\n        isPass: isPass,\n        scoreAsPercent: scoreAsPercent,\n        maxScore: maxScore,\n        score: score,\n        scoreToPass: assessmentsConfig._scoreToPass,\n        assessmentsComplete: assessmentsComplete,\n        assessments: totalAssessments\n      };\n    }\n\n  }, Backbone.Events);\n\n  Adapt.assessment.initialize();\n\n});\n","define([\n  'core/js/views/articleView',\n  'core/js/models/articleModel',\n  './adapt-assessmentArticleView',\n  './adapt-assessmentArticleModel',\n  './assessment'\n], function(ArticleView, ArticleModel, AdaptAssessmentArticleView, AdaptAssessmentArticleModel) {\n\n  /*\n   * Here we are extending the articleView and articleModel in Adapt.\n   * This is to accomodate the assessment functionality on the article.\n   * The advantage of this method is that the assessment behaviour can utilize all of the predefined article behaviour in both the view and the model.\n   */\n\n  // Extends core/js/views/articleView.js\n  var ArticleViewInitialize = ArticleView.prototype.initialize;\n  ArticleView.prototype.initialize = function(options) {\n    if (this.model.get('_assessment') && this.model.get('_assessment')._isEnabled === true) {\n      // extend the articleView with new functionality\n      _.extend(this, AdaptAssessmentArticleView);\n    }\n    // initialize the article in the normal manner\n    return ArticleViewInitialize.apply(this, arguments);\n  };\n\n  // Extends core/js/models/articleModel.js\n  var ArticleModelInitialize = ArticleModel.prototype.initialize;\n  ArticleModel.prototype.initialize = function(options) {\n    if (this.get('_assessment') && this.get('_assessment')._isEnabled === true) {\n      // extend the articleModel with new functionality\n      _.extend(this, AdaptAssessmentArticleModel);\n\n      // initialize the article in the normal manner\n      var returnValue = ArticleModelInitialize.apply(this, arguments);\n\n      // initialize assessment article\n      this._postInitialize();\n\n      return returnValue;\n    }\n\n    // initialize the article in the normal manner if no assessment\n    return ArticleModelInitialize.apply(this, arguments);\n  };\n\n});\n","import Adapt from 'core/js/adapt';\n\nclass Bookmarking extends Backbone.Controller {\n\n  initialize() {\n    this.bookmarkLevel = null;\n    this.restoredLocationID = null;\n    this.currentLocationID = null;\n    this.listenToOnce(Adapt, 'router:location', this.onAdaptInitialize);\n  }\n\n  onAdaptInitialize() {\n    if (!this.checkIsEnabled()) return;\n    this.setupEventListeners();\n    this.checkRestoreLocation();\n  }\n\n  checkIsEnabled() {\n    const courseBookmarkModel = Adapt.course.get('_bookmarking');\n    if (!courseBookmarkModel || !courseBookmarkModel._isEnabled) return false;\n    return true;\n  }\n\n  setupEventListeners() {\n    this._onScroll = _.debounce(this.checkLocation.bind(this), 1000);\n    this.listenTo(Adapt, {\n      'menuView:ready': this.setupMenu,\n      'pageView:preRender': this.setupPage\n    });\n  }\n\n  checkRestoreLocation() {\n    this.restoredLocationID = Adapt.offlineStorage.get('location');\n\n    if (!this.restoredLocationID || this.restoredLocationID === 'undefined' || !Adapt.findById(this.restoredLocationID)) {\n      return;\n    }\n\n    this.listenToOnce(Adapt, 'pageView:ready menuView:ready', this.restoreLocation);\n  }\n\n  restoreLocation() {\n    this.stopListening(Adapt, 'pageView:ready menuView:ready', this.restoreLocation);\n\n    _.delay(() => {\n      if (this.isAlreadyOnScreen(this.restoredLocationID)) {\n        return;\n      }\n\n      if (Adapt.course.get('_bookmarking')._showPrompt === false) {\n        this.navigateToPrevious();\n        return;\n      }\n\n      this.showPrompt();\n\n    }, 500);// slight delay is necessary to allow any render & scrollTo to complete before calling isAlreadyOnScreen\n  }\n\n  /**\n   * If the learner is already at the bookmarked location, there's no need to show a prompt\n   * This method determines whether that is the case or not\n   * @param {string} id The `_id` of the item the learner needs to be returned to\n   * @return {boolean}\n   */\n  isAlreadyOnScreen(id) {\n    if (id === Adapt.location._currentId) return true;\n\n    const type = Adapt.findById(id).getTypeGroup();\n    if (type === 'menu' || type === 'page') {\n      return false;\n    }\n\n    const locationOnscreen = $('.' + id).onscreen();\n    const isLocationOnscreen = locationOnscreen && (locationOnscreen.percentInview > 0);\n    const isLocationFullyInview = locationOnscreen && (locationOnscreen.percentInview === 100);\n    if (isLocationOnscreen && isLocationFullyInview) {\n      return true;\n    }\n\n    return false;\n  }\n\n  showPrompt() {\n    const courseBookmarkModel = Adapt.course.get('_bookmarking');\n    const buttons = courseBookmarkModel._buttons || { yes: 'Yes', no: 'No' };\n\n    this.listenToOnce(Adapt, {\n      'bookmarking:continue': this.navigateToPrevious,\n      'bookmarking:cancel': this.navigateCancel\n    });\n\n    Adapt.notify.prompt({\n      _classes: 'is-bookmarking',\n      _showIcon: true,\n      title: courseBookmarkModel.title,\n      body: courseBookmarkModel.body,\n      _prompts: [\n        {\n          promptText: buttons.yes || 'Yes',\n          _callbackEvent: 'bookmarking:continue'\n        },\n        {\n          promptText: buttons.no || 'No',\n          _callbackEvent: 'bookmarking:cancel'\n        }\n      ]\n    });\n  }\n\n  navigateToPrevious() {\n    _.defer(async () => {\n      const isSinglePage = (Adapt.contentObjects.models.length === 1);\n      await Adapt.router.navigateToElement(this.restoredLocationID, { trigger: true, replace: isSinglePage, duration: 400 });\n    });\n\n    this.stopListening(Adapt, 'bookmarking:cancel');\n  }\n\n  navigateCancel() {\n    this.stopListening(Adapt, 'bookmarking:continue');\n  }\n\n  resetLocationID() {\n    this.setLocationID('');\n  }\n\n  /**\n   * if the learner navigates to the top-level menu, clear the stored bookmark\n   * if it's a sub-menu, store the menu's id as the bookmark\n   */\n  setupMenu(menuView) {\n    const menuModel = menuView.model;\n\n    if (!menuModel.get('_parentId')) {\n      this.resetLocationID();\n      return;\n    }\n\n    this.setLocationID(menuModel.get('_id'));\n  }\n\n  /**\n   * Calculates what the bookmarking 'level' will be for any given page.\n   * First sets a default using the course-level setting (or 'component' if that's not been set)\n   * then checks to see if that's being overridden at page level or not\n   * @param {Backbone.Model} pageModel The model for the current page view\n   * @return {String} Either 'page', 'block', or 'component' - with 'component' being the default\n   */\n  getBookmarkLevel(pageModel) {\n    const defaultLevel = Adapt.course.get('_bookmarking')._level || 'component';\n    const bookmarkModel = pageModel.get('_bookmarking');\n    const isInherit = !bookmarkModel || !bookmarkModel._level || bookmarkModel._level === 'inherit';\n    return isInherit ? defaultLevel : bookmarkModel._level;\n  }\n\n  /**\n   * Sets up bookmarking for the page the learner just navigated to\n   * If bookmarking is disabled for the current page, clear the stored bookmark and return.\n   * Otherwise, bookmark the page then - if necessary - set up to calculate which block or component\n   * should be bookmarked as the learner scrolls up/down the page\n   * @param {Backbone.View} pageView The current page view\n   */\n  setupPage(pageView) {\n    const pageBookmarkModel = pageView.model.get('_bookmarking');\n    if (pageBookmarkModel && pageBookmarkModel._isEnabled === false) {\n      this.resetLocationID();\n      return;\n    }\n\n    this.setLocationID(pageView.model.get('_id'));\n\n    this.bookmarkLevel = this.getBookmarkLevel(pageView.model);\n    if (this.bookmarkLevel === 'page') {\n      return;\n    }\n\n    this.listenToOnce(Adapt, 'remove', this.releaseViews);\n\n    $(window).on('scroll', this._onScroll);\n  }\n\n  setLocationID(id) {\n    if (this.currentLocationID === id) return;\n    Adapt.offlineStorage.set('location', id);\n    this.currentLocationID = id;\n  }\n\n  releaseViews() {\n    this.stopListening(Adapt, 'remove', this.releaseViews);\n    $(window).off('scroll', this._onScroll);\n  }\n\n  checkLocation() {\n    const currentModel = Adapt.location._currentModel;\n    if (!currentModel) return;\n    const possibleViewIds = currentModel.findDescendantModels(this.bookmarkLevel + 's').map(desc => desc.get('_id'));\n\n    let highestOnscreen = 0;\n    let highestOnscreenLocation = '';\n    possibleViewIds.forEach(id => {\n      const element = $(`[data-adapt-id=${id}]`);\n      if (!element.length) return;\n      const measurements = element.onscreen();\n      if (!measurements.onscreen) return;\n      if (measurements.percentInview <= highestOnscreen) return;\n      highestOnscreen = measurements.percentInview;\n      highestOnscreenLocation = id;\n    });\n\n    // set location as most inview component\n    if (highestOnscreenLocation) this.setLocationID(highestOnscreenLocation);\n  }\n}\n\nexport default new Bookmarking();\n","define([\n  'core/js/adapt'\n], function(Adapt) {\n\n  var NavigationView = Backbone.View.extend({\n\n    className: 'nav',\n\n    attributes: {\n      role: 'navigation'\n    },\n\n    initialize: function() {\n      this.template = 'languagePickerNavigation';\n      this.setupHelpers();\n      this.preRender();\n    },\n\n    preRender: function() {\n      Adapt.trigger('navigationView:preRender', this);\n      this.render();\n    },\n\n    render: function() {\n      var template = Handlebars.templates[this.template];\n      this.$el.html(template({\n        _config: this.model.get('_accessibility'),\n        _accessibility: Adapt.config.get('_accessibility')\n      })).insertBefore('#app');\n\n      _.defer(() => Adapt.trigger('navigationView:postRender', this));\n\n      return this;\n    },\n\n    setupHelpers: function() {\n      Handlebars.registerHelper('a11y_aria_label', function(text) {\n        return `<div class=\"aria-label\">${text}</div>`;\n      });\n    }\n\n  });\n\n  return NavigationView;\n\n});\n","define([\n  'core/js/adapt',\n  './languagePickerNavigationView'\n], function(Adapt, NavigationView) {\n\n  var LanguagePickerView = Backbone.View.extend({\n\n    events: {\n      'click .js-languagepicker-btn-click': 'onLanguageClick'\n    },\n\n    className: 'languagepicker',\n\n    initialize: function () {\n      this.initializeNavigation();\n      $('html').addClass('in-languagepicker');\n      this.listenTo(Adapt, 'remove', this.remove);\n      this.render();\n    },\n\n    render: function () {\n      var data = this.model.toJSON();\n      var template = Handlebars.templates[this.constructor.template];\n      this.$el.html(template(data));\n      this.$el.addClass(data._classes);\n\n      document.title = this.model.get('title') || '';\n\n      _.defer(this.postRender.bind(this));\n    },\n\n    postRender: function () {\n      $('.js-loading').hide();\n    },\n\n    onLanguageClick: function (event) {\n      this.destroyNavigation();\n      const lang = event.currentTarget.value;\n      this.model.setLanguage(lang);\n    },\n\n    initializeNavigation: function() {\n      this.navigationView = new NavigationView({ model: this.model });\n    },\n\n    destroyNavigation: function() {\n      this.navigationView.remove();\n    },\n\n    remove: function() {\n      $('html').removeClass('in-languagepicker');\n\n      Backbone.View.prototype.remove.apply(this, arguments);\n    }\n\n  }, {\n    template: 'languagePickerView'\n  });\n\n  return LanguagePickerView;\n\n});\n","define([\n  'core/js/adapt'\n], function(Adapt) {\n\n  var LanguagePickerDrawerView = Backbone.View.extend({\n\n    events: {\n      'click .js-languagepicker-item-btn': 'onButtonClick'\n    },\n\n    initialize: function () {\n      this.listenTo(Adapt, {\n        remove: this.remove,\n        'languagepicker:changelanguage:yes': this.onDoChangeLanguage,\n        'languagepicker:changelanguage:no': this.onDontChangeLanguage\n      });\n      this.render();\n    },\n\n    render: function () {\n      var data = this.model.toJSON();\n      var template = Handlebars.templates[this.constructor.template];\n      this.$el.html(template(data));\n    },\n\n    onButtonClick: function (event) {\n      var newLanguage = $(event.currentTarget).attr('data-language');\n      this.model.set('newLanguage', newLanguage);\n      var data = this.model.getLanguageDetails(newLanguage);\n\n      var promptObject = {\n        _attributes: { lang: newLanguage },\n        _classes: `is-lang-${newLanguage} ${data._direction === 'rtl' ? 'is-rtl' : 'is-ltr'}`,\n        title: data.warningTitle,\n        body: data.warningMessage,\n        _prompts: [\n          {\n            promptText: data._buttons.yes,\n            _callbackEvent: 'languagepicker:changelanguage:yes'\n          },\n          {\n            promptText: data._buttons.no,\n            _callbackEvent: 'languagepicker:changelanguage:no'\n          }\n        ],\n        _showIcon: true\n      };\n\n      // keep active element incase the user cancels - usually navigation bar icon\n      // move drawer close focus to #focuser\n      this.$finishFocus = Adapt.a11y._popup._focusStack.pop();\n      Adapt.a11y._popup._focusStack.push($('#a11y-focuser'));\n\n      Adapt.once('drawer:closed', () => {\n        // wait for drawer to fully close\n        _.delay(() => {\n          Adapt.once('popup:opened', () => {\n            // move popup close focus to #focuser\n            Adapt.a11y._popup._focusStack.pop();\n            Adapt.a11y._popup._focusStack.push($('#a11y-focuser'));\n          });\n          // show yes/no popup\n          Adapt.notify.prompt(promptObject);\n        }, 250);\n      });\n\n      Adapt.trigger('drawer:closeDrawer');\n    },\n\n    onDoChangeLanguage: function () {\n      var newLanguage = this.model.get('newLanguage');\n      this.model.setTrackedData();\n      this.model.setLanguage(newLanguage);\n      this.remove();\n    },\n\n    /**\n     * If the learner selects 'no' in the 'confirm language change' prompt,\n     * wait for notify to close completely then send focus to the\n     * navigation bar icon\n     */\n    onDontChangeLanguage: function () {\n      this.remove();\n\n      _.delay(() => Adapt.a11y.focusFirst(this.$finishFocus), 500);\n\n    }\n\n  }, {\n    template: 'languagePickerDrawerView'\n  });\n\n  return LanguagePickerDrawerView;\n\n});\n","define([\n  'core/js/adapt',\n  './languagePickerDrawerView'\n], function(Adapt, LanguagePickerDrawerView) {\n\n  var LanguagePickerNavView = Backbone.View.extend({\n\n    tagName: 'button',\n\n    className: function () {\n      var classNames = 'btn-icon nav__btn nav__languagepicker-btn js-languagepicker-nav-btn icon';\n      var customClass = this.model.get('_languagePickerIconClass') || 'icon-language-2';\n\n      return classNames + ' ' + customClass;\n    },\n\n    events: {\n      'click': 'onClick'\n    },\n\n    initialize: function () {\n      this.listenTo(Adapt, 'remove', this.remove);\n    },\n\n    onClick: function (event) {\n      Adapt.drawer.triggerCustomView(new LanguagePickerDrawerView({ model: this.model }).$el, false);\n    }\n\n  });\n\n  return LanguagePickerNavView;\n\n});\n","define([\n  'core/js/adapt'\n], function (Adapt) {\n\n  var LanguagePickerModel = Backbone.Model.extend({\n\n    defaults: {\n      _isEnabled: false,\n      displayTitle: '',\n      body: '',\n      _languages: []\n    },\n\n    trackedData: {\n      components: [],\n      blocks: []\n    },\n\n    locationId: null,\n\n    initialize: function () {\n      this.listenTo(Adapt.config, 'change:_activeLanguage', this.markLanguageAsSelected);\n      this.listenTo(Adapt, 'app:dataLoaded', this.onDataLoaded);\n    },\n\n    getLanguageDetails: function (language) {\n      var _languages = this.get('_languages');\n      return _.find(_languages, item => item._language === language);\n    },\n\n    setLanguage: function (language) {\n      Adapt.config.set({\n        _activeLanguage: language,\n        _defaultDirection: this.getLanguageDetails(language)._direction\n      });\n    },\n\n    markLanguageAsSelected: function(model, language) {\n      this.get('_languages').forEach(item => {\n        item._isSelected = (item._language === language);\n      });\n    },\n\n    onDataLoaded: function() {\n      if (!this.get('_restoreStateOnLanguageChange')) {\n        return;\n      }\n      _.defer(() => {\n        this.locationId = Adapt.offlineStorage.get('location') || null;\n        this.restoreState();\n      });\n\n    },\n\n    restoreLocation: function() {\n      if (!Adapt.findById(this.locationId)) return;\n\n      _.defer(() => Adapt.navigateToElement('.' + this.locationId));\n    },\n\n    /**\n     * Restore course progress on language change.\n     */\n    restoreState: function() {\n\n      if (this.isTrackedDataEmpty()) return;\n\n      if (this.trackedData.components) {\n        this.trackedData.components.forEach(this.setTrackableState);\n      }\n\n      if (this.trackedData.blocks) {\n        this.trackedData.blocks.forEach(this.setTrackableState);\n      }\n    },\n\n    isTrackedDataEmpty: function() {\n      return _.isEqual(this.trackedData, {\n        components: [],\n        blocks: []\n      });\n    },\n\n    getTrackableState: function() {\n      var components = this.getState(Adapt.components.models);\n      var blocks = this.getState(Adapt.blocks.models);\n      return {\n        components: _.compact(components),\n        blocks: _.compact(blocks)\n      };\n    },\n\n    getState: function(models) {\n      return models.map(model => {\n        if (model.get('_isComplete')) {\n          return model.getTrackableState();\n        }\n      });\n    },\n\n    setTrackedData: function() {\n      if (!this.get('_restoreStateOnLanguageChange')) {\n        return;\n      }\n      this.listenToOnce(Adapt, 'contentObjectView:ready', this.restoreLocation);\n      this.trackedData = this.getTrackableState();\n    },\n\n    setTrackableState: function(stateObject) {\n      var restoreModel = Adapt.findById(stateObject._id);\n      if (!restoreModel) {\n        Adapt.log.warn('LanguagePicker unable to restore state for: ' + stateObject._id);\n        return;\n      }\n\n      restoreModel.setTrackableState(stateObject);\n    }\n\n  });\n\n  return LanguagePickerModel;\n\n});\n","define([\n  'core/js/adapt',\n  './languagePickerView',\n  './languagePickerNavView',\n  './languagePickerModel'\n], function(Adapt, LanguagePickerView, LanguagePickerNavView, LanguagePickerModel) {\n\n  var languagePickerModel;\n\n  Adapt.once('configModel:dataLoaded', onConfigLoaded);\n\n  /**\n   * Once the Adapt config has loaded, check to see if the language picker is enabled. If it is:\n   * - stop the rest of the .json from loading\n   * - set up the language picker model\n   * - register for events to allow us to display the language picker icon in the navbar on pages and menus\n   * - wait for offline storage to be ready so that we can check to see if there's a stored language choice or not\n   */\n  function onConfigLoaded() {\n    if (!Adapt.config.has('_languagePicker')) return;\n    if (!Adapt.config.get('_languagePicker')._isEnabled) return;\n\n    Adapt.config.set('_canLoadData', false);\n\n    languagePickerModel = new LanguagePickerModel(Adapt.config.get('_languagePicker'));\n\n    Adapt.on('router:menu router:page', setupNavigationView);\n\n    if (Adapt.offlineStorage.ready) { // on the offchance that it may already be ready...\n      onOfflineStorageReady();\n      return;\n    }\n    Adapt.once('offlineStorage:ready', onOfflineStorageReady);\n  }\n\n  /**\n   * Once offline storage is ready, check to see if a language was previously selected by the user\n   * If it was, load it. If it wasn't, show the language picker\n   */\n  function onOfflineStorageReady() {\n    var storedLanguage = Adapt.offlineStorage.get('lang');\n\n    if (storedLanguage) {\n      languagePickerModel.setLanguage(storedLanguage);\n      return;\n    }\n\n    if (languagePickerModel.get('_showOnCourseLoad') === false) {\n      languagePickerModel.setLanguage(Adapt.config.get('_defaultLanguage'));\n      return;\n    }\n\n    showLanguagePickerView();\n  }\n\n  function showLanguagePickerView () {\n    var languagePickerView = new LanguagePickerView({\n      model: languagePickerModel\n    });\n\n    languagePickerView.$el.appendTo('#wrapper');\n  }\n\n  function setupNavigationView () {\n    /*\n     * On the framework this isn't an issue, but courses built in the authoring tool before the ARIA label\n     * was added will break unless the extension is removed then added again.\n     */\n    var courseGlobals = Adapt.course.get('_globals')._extensions;\n    var navigationBarLabel = '';\n    if (courseGlobals._languagePicker) {\n      navigationBarLabel = courseGlobals._languagePicker.navigationBarLabel;\n    }\n\n    var languagePickerNavView = new LanguagePickerNavView({\n      model: languagePickerModel,\n      attributes: {\n        'aria-label': navigationBarLabel\n      }\n    });\n\n    languagePickerNavView.$el.appendTo('.nav__inner');\n  }\n\n});\n","define([\n  'core/js/adapt'\n], function(Adapt) {\n\n  var Completion = Backbone.Controller.extend({\n\n    subProgressCompleted: 0,\n    subProgressTotal: 0,\n    nonAssessmentCompleted: 0,\n    nonAssessmentTotal: 0,\n    assessmentCompleted: 0,\n    assessmentTotal: 0\n\n  });\n\n  // Calculate completion of a contentObject\n  function calculateCompletion(contentObjectModel) {\n\n    var completion = new Completion();\n\n    var viewType = contentObjectModel.get('_type');\n    var isComplete = contentObjectModel.get('_isComplete') ? 1 : 0;\n    var children;\n\n    switch (viewType) {\n      case 'page':\n        // If it's a page\n        children = contentObjectModel.getAllDescendantModels().filter(function(model) {\n          return model.get('_isAvailable') && !model.get('_isOptional');\n        });\n\n        var availableChildren = filterAvailableChildren(children);\n        var components = getPageLevelProgressEnabledModels(availableChildren);\n\n        var nonAssessmentComponents = getNonAssessmentComponents(components);\n\n        completion.nonAssessmentTotal = nonAssessmentComponents.length;\n        completion.nonAssessmentCompleted = getComponentsCompleted(nonAssessmentComponents).length;\n\n        var assessmentComponents = getAssessmentComponents(components);\n\n        completion.assessmentTotal = assessmentComponents.length;\n        completion.assessmentCompleted = getComponentsInteractionCompleted(assessmentComponents).length;\n\n        if (contentObjectModel.get('_pageLevelProgress')._excludeAssessments !== true) {\n          completion.subProgressCompleted = contentObjectModel.get('_subProgressComplete') || 0;\n          completion.subProgressTotal = contentObjectModel.get('_subProgressTotal') || 0;\n        }\n\n        var showPageCompletionCourse = Adapt.course.get('_pageLevelProgress') && Adapt.course.get('_pageLevelProgress')._showPageCompletion !== false;\n        var showPageCompletionPage = contentObjectModel.get('_pageLevelProgress') && contentObjectModel.get('_pageLevelProgress')._showPageCompletion !== false;\n\n        if (showPageCompletionCourse && showPageCompletionPage) {\n          // optionally add one point extra for page completion to eliminate incomplete pages and full progress bars\n          // if _showPageCompletion is true then the progress bar should also consider it so add 1 to nonAssessmentTotal\n          completion.nonAssessmentCompleted += isComplete;\n          completion.nonAssessmentTotal += 1;\n        }\n\n        break;\n      case 'menu': case 'course':\n        // If it's a sub-menu\n        children = contentObjectModel.get('_children').models;\n        children.forEach(function(contentObject) {\n          var completionObject = calculateCompletion(contentObject);\n          completion.subProgressCompleted += completionObject.subProgressCompleted || 0;\n          completion.subProgressTotal += completionObject.subProgressTotal || 0;\n          completion.nonAssessmentTotal += completionObject.nonAssessmentTotal;\n          completion.nonAssessmentCompleted += completionObject.nonAssessmentCompleted;\n          completion.assessmentTotal += completionObject.assessmentTotal;\n          completion.assessmentCompleted += completionObject.assessmentCompleted;\n        });\n        break;\n\n    }\n\n    return completion;\n  }\n\n  function getNonAssessmentComponents(models) {\n    return models.filter(function(model) {\n      return !model.get('_isPartOfAssessment');\n    });\n  }\n\n  function getAssessmentComponents(models) {\n    return models.filter(function(model) {\n      return model.get('_isPartOfAssessment');\n    });\n  }\n\n  function getComponentsCompleted(models) {\n    return models.filter(function(item) {\n      return item.get('_isComplete');\n    });\n  }\n\n  function getComponentsInteractionCompleted(models) {\n    return models.filter(function(item) {\n      return item.get('_isComplete');\n    });\n  }\n\n  //Get only those models who were enabled for pageLevelProgress\n  function getPageLevelProgressEnabledModels(models) {\n    return models.filter(function(model) {\n      var config = model.get('_pageLevelProgress');\n      return config && config._isEnabled;\n    });\n  }\n\n  function unavailableInHierarchy(parents) {\n    if (!parents) return;\n    return parents.some(function(parent) {\n      return !parent.get('_isAvailable');\n    });\n  }\n\n  function filterAvailableChildren(children) {\n    var availableChildren = [];\n\n    for (var i = 0, count = children.length; i < count; i++) {\n      var parents = children[i].getAncestorModels();\n      if (unavailableInHierarchy(parents)) continue;\n      availableChildren.push(children[i]);\n    }\n\n    return availableChildren;\n  }\n\n  function calculatePercentageComplete(model) {\n    var completionObject = calculateCompletion(model);\n    // take all assessment, nonassessment and subprogress into percentage\n    // this allows the user to see if assessments have been passed, if assessment components can be retaken, and all other component's completion\n    var completed = completionObject.nonAssessmentCompleted + completionObject.assessmentCompleted + completionObject.subProgressCompleted;\n    var total  = completionObject.nonAssessmentTotal + completionObject.assessmentTotal + completionObject.subProgressTotal;\n    var percentageComplete = Math.floor((completed / total)*100);\n    return percentageComplete;\n  }\n\n  return {\n    calculateCompletion: calculateCompletion,\n    calculatePercentageComplete: calculatePercentageComplete,\n    getPageLevelProgressEnabledModels: getPageLevelProgressEnabledModels,\n    filterAvailableChildren: filterAvailableChildren\n  };\n\n});\n","define([\n  'core/js/adapt'\n], function(Adapt) {\n\n  var PageLevelProgressIndicatorView = Backbone.View.extend({\n\n    initialize: function(options) {\n      options = options || {};\n      this.parent = options.parent;\n      this.calculatePercentage = options.calculatePercentage || this.calculatePercentage;\n      this.ariaLabel = options.ariaLabel || '';\n      this.type = options.type || this.model.get('_type');\n      this.addClasses();\n      this.setUpEventListeners();\n      this.setPercentageComplete();\n      this.render();\n      this.refresh();\n    },\n\n    addClasses: function() {\n      this.$el.addClass([\n        'pagelevelprogress__indicator',\n        'is-' + this.type\n      ].join(' '));\n    },\n    \n    checkAria: function() {\n      if (!this.ariaLabel) {\n        this.$el.attr('aria-hidden', true);\n        return;\n      }\n      var data = this.getRenderData();\n      this.$('.js-indicator-aria-label').html(Handlebars.compile(this.ariaLabel)(data));\n    },\n\n    setUpEventListeners: function() {\n      if (this.parent) {\n        this.listenToOnce(this.parent, 'postRemove', this.remove);\n      } else {\n        this.listenTo(Adapt, 'remove', this.remove);\n      }\n      this.listenTo(this.model, 'change:_isComplete', this.refresh);\n      if (!this.collection) return;\n      this.listenTo(this.collection, 'change:_isComplete', this.refresh);\n    },\n    \n    setPercentageComplete: function() {\n      var percentage =  this.calculatePercentage();\n      this.model.set('percentageComplete', percentage);\n      return percentage;\n    },\n\n    calculatePercentage: function() {\n      return this.model.get('_isComplete') ? 100 : 0;\n    },\n\n    render: function() {\n      var data = this.getRenderData();\n      var template = Handlebars.templates[this.constructor.template];\n      this.$el.html(template(data));\n    },\n    \n    getRenderData: function() {\n      var data = this.model.toJSON();\n      data.ariaLabel = this.ariaLabel;\n      data.type = this.type;\n      return data;\n    },\n\n    refresh: function() {\n      this.checkCompletion();\n      this.checkAria();\n      this.$('.js-indicator-bar').css({\n        width: this.calculatePercentage() + '%'\n      });\n    },\n\n    checkCompletion: function() {\n      var percentage = this.setPercentageComplete();\n      this.$el\n          .toggleClass('is-complete', percentage === 100)\n          .toggleClass('is-incomplete', percentage !== 100);\n    }\n\n  }, {\n    template: 'pageLevelProgressIndicator'\n  });\n\n  return PageLevelProgressIndicatorView;\n\n});\n","define([\n  'core/js/adapt',\n  './PageLevelProgressIndicatorView'\n], function(Adapt, PageLevelProgressIndicatorView) {\n\n  var PageLevelProgressItemView = Backbone.View.extend({\n\n    className: function () {\n      return [\n        'pagelevelprogress__item drawer__item',\n        this.model.get('_type') + '__indicator'\n      ].join(' ');\n    },\n\n    attributes: {\n      'role': 'listitem'\n    },\n\n    initialize: function() {\n      this.listenTo(Adapt, 'remove', this.remove);\n      this.render();\n      this.addIndicator();\n    },\n\n    render: function() {\n      var data = this.model.toJSON();\n      var template = Handlebars.templates[this.constructor.template];\n      this.$el.html(template(data));\n    },\n\n    addIndicator: function() {\n      if (this.model.get('_isOptional')) return;\n      var item = new PageLevelProgressIndicatorView({\n        model: this.model\n      });\n      this.$('.js-indicator').append(item.$el);\n    }\n\n  }, {\n    template: 'pageLevelProgressItem'\n  });\n\n  return PageLevelProgressItemView;\n\n});\n","define([\n 'core/js/adapt',\n './PageLevelProgressItemView'\n], function(Adapt, PageLevelProgressItemView) {\n\n  var PageLevelProgressView = Backbone.View.extend({\n\n    className: 'pagelevelprogress',\n\n    events: {\n      'click .js-pagelevelprogress-item-click': 'scrollToPageElement'\n    },\n\n    initialize: function() {\n      this.listenTo(Adapt, 'remove', this.remove);\n      this.render();\n      this.addChildren();\n    },\n\n    scrollToPageElement: async function(event) {\n      if (event && event.preventDefault) event.preventDefault();\n\n      var $target = $(event.currentTarget);\n      if ($target.is('.is-disabled')) return;\n\n      var id = $target.attr('data-pagelevelprogress-id');\n      var model = Adapt.findById(id);\n\n      if (!model.get('_isRendered')) {\n        try {\n          await Adapt.parentView.renderTo(id);\n        } catch(err) {\n          return;\n        }\n      }\n\n      var currentComponentSelector = '.' + id;\n\n      Adapt.once('drawer:closed', function() {\n        Adapt.scrollTo(currentComponentSelector, { duration: 400 });\n      }).trigger('drawer:closeDrawer', $(currentComponentSelector));\n    },\n\n    render: function() {\n      var template = Handlebars.templates['pageLevelProgress'];\n      this.$el.html(template({}));\n    },\n\n    addChildren: function() {\n      var $children = this.$('.js-children');\n      this.collection.each(function(model) {\n        $children.append(new PageLevelProgressItemView({\n          model: model\n        }).$el);\n      }.bind(this));\n    }\n\n  });\n\n  return PageLevelProgressView;\n\n});\n","define([\n  'core/js/adapt',\n  './completionCalculations',\n  './PageLevelProgressView',\n  './PageLevelProgressIndicatorView'\n], function(Adapt, completionCalculations, PageLevelProgressView, PageLevelProgressIndicatorView) {\n\n  var PageLevelProgressNavigationView = Backbone.View.extend({\n\n    tagName: 'button',\n\n    className: 'btn-icon nav__btn nav__pagelevelprogress-btn pagelevelprogress__nav-btn',\n\n    events: {\n      'click': 'onProgressClicked'\n    },\n\n    initialize: function() {\n      _.bindAll(this, 'updateProgressBar');\n      this.setUpEventListeners();\n      this.render();\n      this.addIndicator();\n      this.deferredUpdate();\n    },\n\n    setUpEventListeners: function() {\n      this.listenTo(Adapt, {\n        'remove': this.remove,\n        'router:location': this.updateProgressBar,\n        'view:childAdded pageLevelProgress:update': this.refreshProgressBar\n      });\n    },\n\n    render: function() {\n      var template = Handlebars.templates['pageLevelProgressNavigation'];\n      this.$el.html(template({}));\n    },\n\n    addIndicator: function() {\n      this.indicatorView = new PageLevelProgressIndicatorView({\n        model: this.model,\n        collection: this.collection,\n        calculatePercentage: this._getPageCompletionPercentage,\n        ariaLabel: Adapt.course.get('_globals')._extensions._pageLevelProgress.pageLevelProgressIndicatorBar\n      });\n      this.$el.prepend(this.indicatorView.$el);\n    },\n\n    _getPageCompletionPercentage: function() {\n      return completionCalculations.calculatePercentageComplete(this.model);\n    },\n\n    deferredUpdate: function() {\n      _.defer(this.updateProgressBar);\n    },\n\n    updateProgressBar: function() {\n      this.indicatorView.refresh();\n    },\n\n    refreshProgressBar: function() {\n      this.collection.repopulate();\n      this.updateProgressBar();\n    },\n\n    onProgressClicked: function(event) {\n      if (event && event.preventDefault) event.preventDefault();\n      Adapt.drawer.triggerCustomView(new PageLevelProgressView({\n        collection: this.collection\n      }).$el, false);\n    },\n\n    remove: function() {\n      Backbone.View.prototype.remove.call(this);\n      this.collection.reset();\n    }\n\n  });\n\n  return PageLevelProgressNavigationView;\n\n});\n","define([\n  'core/js/adapt',\n  './completionCalculations'\n], function(Adapt, completionCalculations) {\n\n  var PageLevelProgressCollection = Backbone.Collection.extend({\n\n    initialize: function(models, options) {\n      this.listenTo(Adapt, 'remove', this.reset);\n      if (!options || !options.pageModel) return;\n      this._pageModel = options.pageModel;\n      this.repopulate();\n    },\n\n    repopulate: function() {\n      this.reset();\n      if (!this._pageModel) return;\n\n      var allDescendants = this._pageModel.getAllDescendantModels(true);\n      var currentPageItems = allDescendants.filter(function(item) {\n        return item.get('_isAvailable') === true;\n      });\n      var availableItems = completionCalculations.filterAvailableChildren(currentPageItems);\n      var enabledProgressItems = completionCalculations.getPageLevelProgressEnabledModels(availableItems);\n\n      this.add(enabledProgressItems);\n    }\n\n  });\n\n  return PageLevelProgressCollection;\n\n});\n","define([\n  'core/js/adapt',\n  './completionCalculations',\n  './PageLevelProgressNavigationView',\n  './PageLevelProgressIndicatorView',\n  './PageLevelProgressCollection'\n], function(Adapt, completionCalculations, PageLevelProgressNavigationView, PageLevelProgressIndicatorView, PageLevelProgressCollection) {\n\n  var PageLevelProgress = Backbone.Controller.extend({\n\n    initialize: function() {\n      Adapt.on({\n        'app:dataReady': this.onDataReady.bind(this),\n        'app:languageChanged': function() {\n          // Remove events created by setUpEventListeners\n          this.stopListening();\n        }.bind(this)\n      });\n    },\n\n    getCourseConfig: function() {\n      return Adapt.course.get('_pageLevelProgress');\n    },\n\n    onDataReady: function() {\n      // Do not proceed if pageLevelProgress is not enabled in course.json\n      var coursePLPConfig = this.getCourseConfig();\n      if (!coursePLPConfig || !coursePLPConfig._isEnabled) {\n        return;\n      }\n      this.setUpEventListeners();\n    },\n\n    setUpEventListeners: function() {\n      var headerIndicatorTypes = [\n        'menu',\n        'menuItem',\n        'page',\n        'article',\n        'block',\n        'component'\n      ];\n\n      var headerIndicatorEventNames = headerIndicatorTypes\n        .concat(['']).join('View:render ');\n\n      this.listenTo(Adapt, headerIndicatorEventNames, this.renderHeaderIndicatorView);\n\n      this.listenTo(Adapt, {\n        'menuItemView:postRender': this.renderMenuItemIndicatorView,\n        'router:page': this.renderNavigationView\n      });\n\n      this.listenTo(Adapt.course, 'bubble:change:_isComplete', this.onCompletionChange);\n    },\n\n    onCompletionChange: function(event) {\n      if (!Adapt.location._currentId) return;\n\n      var currentModel = Adapt.findById(Adapt.location._currentId);\n      var completionState = {\n        currentLocation: completionCalculations.calculatePercentageComplete(currentModel),\n        course: completionCalculations.calculatePercentageComplete(Adapt.course)\n      };\n      var hasChanged = !_.isMatch(this._previousCompletionState, completionState);\n      if (!hasChanged) return;\n\n      this._previousCompletionState = completionState;\n      Adapt.trigger('pageLevelProgress:percentageCompleteChange', completionState);\n    },\n\n    renderHeaderIndicatorView: function(view) {\n      var model = view.model;\n\n      var config = model.get('_pageLevelProgress');\n      if (!config || !config._isEnabled || !config._isCompletionIndicatorEnabled) {\n        return;\n      }\n\n      var pageModel = model.findAncestor('contentObjects');\n      var pageConfig = pageModel && pageModel.get('_pageLevelProgress');\n      if (pageConfig && !pageConfig._isEnabled) {\n        return;\n      }\n\n      var $headings = view.$('.js-heading');\n      $headings.each(function(index, el) {\n        var $el = $(el);\n        var indicatorView = new PageLevelProgressIndicatorView({\n          parent: view,\n          model: model\n        });\n        indicatorView.$el.insertAfter($el);\n      });\n    },\n\n    // This should add/update progress on menuView\n    renderMenuItemIndicatorView: function(view) {\n      // Do not render on menu, only render on menu items\n      if (view.model.get('_id') === Adapt.location._currentId) {\n        return;\n      }\n\n      // Progress bar should not render for course viewType\n      var viewType = view.model.get('_type');\n      if (viewType === 'course') {\n        return;\n      }\n\n      // Do not proceed if pageLevelProgress is not enabled for the content object\n      var pageLevelProgress = view.model.get('_pageLevelProgress');\n      if (!pageLevelProgress || !pageLevelProgress._isEnabled) {\n        return;\n      }\n\n      view.$el.find('.js-menu-item-progress').append(new PageLevelProgressIndicatorView({\n        parent: view,\n        model: view.model,\n        type: 'menu-item',\n        calculatePercentage: this._getMenuItemCompletionPercentage.bind(view),\n        ariaLabel: Adapt.course.get('_globals')._extensions._pageLevelProgress.pageLevelProgressMenuBar\n      }).$el);\n    },\n\n    _getMenuItemCompletionPercentage: function() {\n      return completionCalculations.calculatePercentageComplete(this.model);\n    },\n\n    // This should add/update progress on page navigation bar\n    renderNavigationView: function(pageModel) {\n      // Do not render if turned off at course level\n      var coursePLPConfig = this.getCourseConfig();\n      if (coursePLPConfig && coursePLPConfig._isShownInNavigationBar === false) {\n        return;\n      }\n\n      // Do not proceed if pageLevelProgress is not enabled for the content object\n      var pagePLPConfig = pageModel.get('_pageLevelProgress');\n      if (!pagePLPConfig || !pagePLPConfig._isEnabled) {\n        return;\n      }\n\n      var collection = new PageLevelProgressCollection(null, {\n        pageModel: pageModel\n      });\n\n      if (collection.length === 0) {\n        return;\n      }\n\n      $('.nav__drawer-btn').after(new PageLevelProgressNavigationView({\n        model: pageModel,\n        collection: collection\n      }).$el);\n    }\n\n  });\n\n  Adapt.pageLevelProgress = new PageLevelProgress();\n\n});\n","define([\r\n  'core/js/adapt'\r\n], function(Adapt) {\r\n\r\n  var ResourcesView = Backbone.View.extend({\r\n\r\n    className: 'resources',\r\n\r\n    initialize: function() {\r\n      this.listenTo(Adapt, 'remove', this.remove);\r\n      this.render();\r\n    },\r\n\r\n    events: {\r\n      'click .js-resources-filter-btn-click': 'onFilterClicked',\r\n    },\r\n\r\n    render: function() {\r\n      this.$el.html(Handlebars.templates.resources({\r\n        model: this.model.toJSON(),\r\n        resources: this.collection.toJSON()\r\n      }));\r\n      \r\n      _.defer(function() {\r\n        this.listenTo(Adapt, 'drawer:triggerCustomView', this.remove);\r\n      }.bind(this));\r\n\r\n      return this;\r\n    },\r\n\r\n    onFilterClicked: function(e) {\r\n      if (e && e.preventDefault) e.preventDefault();\r\n      \r\n      this.$('.js-resources-filter-btn-click').removeClass('is-selected');\r\n      \r\n      var items;\r\n      var filter = $(e.currentTarget).addClass('is-selected').attr('data-filter');\r\n      if (filter === 'all') {\r\n        items = this.$('.js-resources-item').removeClass('u-display-none');\r\n      } else {\r\n        this.$('.js-resources-item').removeClass('u-display-none').not('.is-' + filter).addClass('u-display-none');\r\n        items = this.$('.js-resources-item.is-' + filter);\r\n      }\r\n\r\n      if (items.length > 0) $(items[0]).a11y_focus();\r\n    }\r\n  });\r\n\r\n  return ResourcesView;\r\n});\r\n","define([\r\n  'handlebars',\r\n  'core/js/adapt'\r\n], (Handlebars, Adapt) => {\r\n\r\n  const helpers = {\r\n\r\n    resources_has_type(resources, type, block) {\r\n      const hasType = resources.some(_.matcher({ _type: type }));\r\n      return hasType ? block.fn(this) : block.inverse(this);\r\n    },\r\n\r\n    resources_has_multiple_types(resources, block) {\r\n      if (resources.length === 1) return block.inverse(this);\r\n\r\n      const allSameType = resources.every(_.matcher({ _type: resources[0]._type }));\r\n      return allSameType ? block.inverse(this) : block.fn(this);\r\n    },\r\n\r\n    resources_get_column_count(resources) {\r\n      return _.uniq(_.pluck(resources, '_type')).length + 1;// add 1 for the 'All' button column\r\n    },\r\n\r\n    /**\r\n     * IE doesn't support the 'download' attribute\r\n     * https://github.com/adaptlearning/adapt_framework/issues/1559\r\n     * and iOS just opens links with that attribute in the same window\r\n     * https://github.com/adaptlearning/adapt_framework/issues/1852\r\n     */\r\n    resources_force_download(resource, block) {\r\n      if (Adapt.device.browser === 'internet explorer' || Adapt.device.OS === 'ios') {\r\n        return block.inverse(this);\r\n      }\r\n\r\n      return (resource._forceDownload || resource.filename) ? block.fn(this) : block.inverse(this);\r\n    }\r\n\r\n  };\r\n\r\n  for (const name in helpers) {\r\n    Handlebars.registerHelper(name, helpers[name]);\r\n  }\r\n\r\n  return helpers;\r\n\r\n});\r\n","define([\r\n  'core/js/adapt',\r\n  './adapt-contrib-resourcesView',\r\n  './adapt-contrib-resourcesHelpers'\r\n], function(Adapt, ResourcesView, ResourcesHelpers) {\r\n\r\n  function setupResources(resourcesData) {\r\n\r\n    var resourcesModel = new Backbone.Model(resourcesData);\r\n    var resourcesCollection = new Backbone.Collection(resourcesModel.get('_resourcesItems'));\r\n\r\n    Adapt.on('resources:showResources', function() {\r\n      Adapt.drawer.triggerCustomView(new ResourcesView({\r\n        model: resourcesModel,\r\n        collection: resourcesCollection\r\n      }).$el);\r\n    });\r\n\r\n  }\r\n\r\n  function initResources() {\r\n\r\n    var courseResources = Adapt.course.get('_resources');\r\n\r\n    // do not proceed until resource set on course.json\r\n    if (!courseResources || courseResources._isEnabled === false) return;\r\n\r\n    var drawerObject = {\r\n      title: courseResources.title,\r\n      description: courseResources.description,\r\n      className: 'is-resources',\r\n      drawerOrder: courseResources._drawerOrder || 0\r\n    };\r\n\r\n    Adapt.drawer.addItem(drawerObject, 'resources:showResources');\r\n\r\n    setupResources(courseResources);\r\n\r\n  }\r\n\r\n  Adapt.on('adapt:start', initResources);\r\n\r\n});\r\n","define(function() {\n\n  class Logger {\n\n    constructor() {\n      this.logArr = [];\n      this.registeredViews = [];\n    }\n\n    static getInstance() {\n      if (Logger.instance === null) {\n        Logger.instance = new Logger();\n      }\n      return Logger.instance;\n    }\n\n    getEntries() {\n      return this.logArr;\n    }\n\n    getLastEntry() {\n      return this.logArr[this.logArr.length - 1];\n    }\n\n    info(str) {\n      this.logArr[this.logArr.length] = { str: str, type: Logger.LOG_TYPE_INFO, time: Date.now() };\n      this.updateViews();\n    }\n\n    warn(str) {\n      this.logArr[this.logArr.length] = { str: str, type: Logger.LOG_TYPE_WARN, time: Date.now() };\n      this.updateViews();\n    }\n\n    error(str) {\n      this.logArr[this.logArr.length] = { str: str, type: Logger.LOG_TYPE_ERROR, time: Date.now() };\n      this.updateViews();\n    }\n\n    debug(str) {\n      this.logArr[this.logArr.length] = { str: str, type: Logger.LOG_TYPE_DEBUG, time: Date.now() };\n      this.updateViews();\n    }\n\n    registerView(_view) {\n      this.registeredViews[this.registeredViews.length] = _view;\n    }\n\n    unregisterView(_view) {\n      for (let i = 0, l = this.registeredViews.length; i < l; i++) {\n        if (this.registeredViews[i] !== _view) continue;\n        this.registeredViews.splice(i, 1);\n        i--;\n      }\n    }\n\n    updateViews() {\n      for (let i = 0, l = this.registeredViews.length; i < l; i++) {\n        if (!this.registeredViews[i]) continue;\n        this.registeredViews[i].update(this);\n      }\n    }\n\n  }\n\n  Logger.instance = null;\n  Logger.LOG_TYPE_INFO = 0;\n  Logger.LOG_TYPE_WARN = 1;\n  Logger.LOG_TYPE_ERROR = 2;\n  Logger.LOG_TYPE_DEBUG = 3;\n\n  // Assign global reference for debug window\n  return (window.Logger = Logger);\n\n});\n","define(function() {\n\n  class ScormError {\n\n    constructor(name, data = {}) {\n      this.name = name;\n      this.data = data;\n    }\n\n  }\n\n  ScormError.CLIENT_COULD_NOT_CONNECT = 'CLIENT_COULD_NOT_CONNECT';\n  ScormError.SERVER_STATUS_UNSUPPORTED = 'SERVER_STATUS_UNSUPPORTED'; // status\n  ScormError.CLIENT_STATUS_UNSUPPORTED = 'CLIENT_STATUS_UNSUPPORTED'; // status\n  ScormError.CLIENT_COULD_NOT_COMMIT = 'CLIENT_COULD_NOT_COMMIT'; // errorCode, errorInfo, diagnosticInfo\n  ScormError.CLIENT_NOT_CONNECTED = 'CLIENT_NOT_CONNECTED';\n  ScormError.CLIENT_COULD_NOT_FINISH = 'CLIENT_COULD_NOT_FINISH'; // errorCode, errorInfo, diagnosticInfo\n  ScormError.CLIENT_COULD_NOT_GET_PROPERTY = 'CLIENT_COULD_NOT_GET_PROPERTY'; // property, errorCode, errorInfo, diagnosticInfo\n  ScormError.CLIENT_COULD_NOT_SET_PROPERTY = 'CLIENT_COULD_NOT_SET_PROPERTY'; // property, value, errorCode, errorInfo, diagnosticInfo\n  ScormError.CLIENT_INVALID_CHOICE_VALUE = 'CLIENT_INVALID_CHOICE_VALUE';\n\n  ScormError.defaultMessages = {\n    title: 'An error has occurred',\n    pressOk: `Press 'OK' to view detailed debug information to send to technical support.`,\n    CLIENT_COULD_NOT_CONNECT: 'The course could not connect to the Learning Management System',\n    SERVER_STATUS_UNSUPPORTED: `An invalid lesson status of '{{{status}}}' was received from Learning Management System`,\n    CLIENT_STATUS_UNSUPPORTED: `The status '{{{status}}}' is not supported.`,\n    CLIENT_COULD_NOT_COMMIT: 'There was a problem saving data to the Learning Management System\\n\\nError: {{errorCode}} - {{{errorInfo}}}\\nLMS Error Info: {{{diagnosticInfo}}}',\n    CLIENT_NOT_CONNECTED: 'The course is not connected to the Learning Management System',\n    CLIENT_COULD_NOT_FINISH: 'The course was unable to terminate the learning session\\n\\nError: {{errorCode}} - {{{errorInfo}}}\\nLMS Error Info: {{{diagnosticInfo}}}',\n    CLIENT_COULD_NOT_GET_PROPERTY: 'Unable to get the value of {{property}} from the Learning Management System\\n\\nError: {{errorCode}} - {{{errorInfo}}}\\nLMS Error Info: {{{diagnosticInfo}}}',\n    CLIENT_COULD_NOT_SET_PROPERTY: `Unable to set {{property}} to: '{{{value}}}'\\n\\nError: {{errorCode}} - {{{errorInfo}}}\\nLMS Error Info: {{{diagnosticInfo}}}`,\n    CLIENT_INVALID_CHOICE_VALUE: 'Numeric choice/matching response elements must use a value from 0 to 35 in SCORM 1.2'\n  };\n\n  return ScormError;\n\n});\n","define([\n  'core/js/adapt',\n  'libraries/SCORM_API_wrapper',\n  './logger',\n  './error'\n], function(Adapt, pipwerks, Logger, ScormError) {\n\n  const {\n    CLIENT_COULD_NOT_CONNECT,\n    SERVER_STATUS_UNSUPPORTED,\n    CLIENT_STATUS_UNSUPPORTED,\n    CLIENT_COULD_NOT_COMMIT,\n    CLIENT_NOT_CONNECTED,\n    CLIENT_COULD_NOT_FINISH,\n    CLIENT_COULD_NOT_GET_PROPERTY,\n    CLIENT_COULD_NOT_SET_PROPERTY,\n    CLIENT_INVALID_CHOICE_VALUE\n  } = ScormError;\n\n  /**\n   * IMPORTANT: This wrapper uses the Pipwerks SCORM wrapper and should therefore support both SCORM 1.2 and 2004. Ensure any changes support both versions.\n   */\n  class ScormWrapper {\n\n    constructor() {\n      /* configuration */\n      this.setCompletedWhenFailed = true;// this only applies to SCORM 2004\n      /**\n       * whether to commit each time there's a change to lesson_status or not\n       */\n      this.commitOnStatusChange = true;\n      /**\n       * whether to commit each time there's a change to any value\n       */\n      this.commitOnAnyChange = false;\n      /**\n       * how frequently (in minutes) to commit automatically. set to 0 to disable.\n       */\n      this.timedCommitFrequency = 10;\n      /**\n       * how many times to retry if a commit fails\n       */\n      this.maxCommitRetries = 5;\n      /**\n       * time (in milliseconds) to wait between retries\n       */\n      this.commitRetryDelay = 1000;\n\n      /**\n       * prevents commit from being called if there's already a 'commit retry' pending.\n       */\n      this.commitRetryPending = false;\n      /**\n       * how many times we've done a 'commit retry'\n       */\n      this.commitRetries = 0;\n      /**\n       * not currently used - but you could include in an error message to show when data was last saved\n       */\n      this.lastCommitSuccessTime = null;\n      /**\n       * The exit state to use when course isn't completed yet\n       */\n      this.exitStateIfIncomplete = 'auto';\n      /**\n       * The exit state to use when the course has been completed/passed\n       */\n      this.exitStateIfComplete = 'auto';\n\n      this.timedCommitIntervalID = null;\n      this.retryCommitTimeoutID = null;\n      this.logOutputWin = null;\n      this.startTime = null;\n      this.endTime = null;\n\n      this.lmsConnected = false;\n      this.finishCalled = false;\n\n      this.logger = Logger.getInstance();\n      this.scorm = pipwerks.SCORM;\n      /**\n       * Prevent the Pipwerks SCORM API wrapper's handling of the exit status\n       */\n      this.scorm.handleExitMode = false;\n\n      this.suppressErrors = false;\n      this.debouncedCommit = _.debounce(this.commit.bind(this), 100);\n      if (window.__debug) {\n        this.showDebugWindow();\n      }\n\n      if ((window.API && window.API.__offlineAPIWrapper) || (window.API_1484_11 && window.API_1484_11.__offlineAPIWrapper)) {\n        this.logger.error('Offline SCORM API is being used. No data will be reported to the LMS!');\n      }\n    }\n\n    // ******************************* public methods *******************************\n\n    static getInstance() {\n      if (ScormWrapper.instance === null) {\n        ScormWrapper.instance = new ScormWrapper();\n      }\n\n      return ScormWrapper.instance;\n    }\n\n    getVersion() {\n      return this.scorm.version;\n    }\n\n    setVersion(value) {\n      this.logger.debug(`ScormWrapper::setVersion: ${value}`);\n      this.scorm.version = value;\n    }\n\n    initialize() {\n      this.logger.debug('ScormWrapper::initialize');\n      this.lmsConnected = this.scorm.init();\n\n      if (!this.lmsConnected) {\n        this.handleError(new ScormError(CLIENT_COULD_NOT_CONNECT));\n        return this.lmsConnected;\n      }\n\n      this.startTime = new Date();\n      this.initTimedCommit();\n\n      return this.lmsConnected;\n    }\n\n    /**\n     * allows you to check if this is the user's first ever 'session' of a SCO, even after the lesson_status has been set to 'incomplete'\n     */\n    isFirstSession() {\n      return (this.getValue(this.isSCORM2004() ? 'cmi.entry' : 'cmi.core.entry') === 'ab-initio');\n    }\n\n    setIncomplete() {\n      this.setValue(this.isSCORM2004() ? 'cmi.completion_status' : 'cmi.core.lesson_status', 'incomplete');\n\n      if (this.commitOnStatusChange && !this.commitOnAnyChange) this.commit();\n    }\n\n    setCompleted() {\n      this.setValue(this.isSCORM2004() ? 'cmi.completion_status' : 'cmi.core.lesson_status', 'completed');\n\n      if (this.commitOnStatusChange && !this.commitOnAnyChange) this.commit();\n    }\n\n    setPassed() {\n      if (this.isSCORM2004()) {\n        this.setValue('cmi.completion_status', 'completed');\n        this.setValue('cmi.success_status', 'passed');\n      } else {\n        this.setValue('cmi.core.lesson_status', 'passed');\n      }\n\n      if (this.commitOnStatusChange && !this.commitOnAnyChange) this.commit();\n    }\n\n    setFailed() {\n      if (this.isSCORM2004()) {\n        this.setValue('cmi.success_status', 'failed');\n\n        if (this.setCompletedWhenFailed) {\n          this.setValue('cmi.completion_status', 'completed');\n        }\n      } else {\n        this.setValue('cmi.core.lesson_status', 'failed');\n      }\n\n      if (this.commitOnStatusChange && !this.commitOnAnyChange) this.commit();\n    }\n\n    getStatus() {\n      const status = this.getValue(this.isSCORM2004() ? 'cmi.completion_status' : 'cmi.core.lesson_status');\n\n      switch (status.toLowerCase()) { // workaround for some LMSes (e.g. Arena) not adhering to the all-lowercase rule\n        case 'passed':\n        case 'completed':\n        case 'incomplete':\n        case 'failed':\n        case 'browsed':\n        case 'not attempted':\n        case 'not_attempted': // mentioned in SCORM 2004 docs but not sure it ever gets used\n        case 'unknown': // the SCORM 2004 version of not attempted\n          return status;\n        default:\n          this.handleError(new ScormError(SERVER_STATUS_UNSUPPORTED, { status }));\n          return null;\n      }\n    }\n\n    setStatus(status) {\n      switch (status.toLowerCase()) {\n        case 'incomplete':\n          this.setIncomplete();\n          break;\n        case 'completed':\n          this.setCompleted();\n          break;\n        case 'passed':\n          this.setPassed();\n          break;\n        case 'failed':\n          this.setFailed();\n          break;\n        default:\n          this.handleError(new ScormError(CLIENT_STATUS_UNSUPPORTED, { status }));\n      }\n    }\n\n    getScore() {\n      return this.getValue(this.isSCORM2004() ? 'cmi.score.raw' : 'cmi.core.score.raw');\n    }\n\n    setScore(score, minScore = 0, maxScore = 100) {\n      if (this.isSCORM2004()) {\n        this.setValue('cmi.score.raw', score);\n        this.setValue('cmi.score.min', minScore);\n        this.setValue('cmi.score.max', maxScore);\n\n        const range = maxScore - minScore;\n        const scaledScore = ((score - minScore) / range).toFixed(7);\n        this.setValue('cmi.score.scaled', scaledScore);\n        return;\n      }\n      // SCORM 1.2\n      this.setValue('cmi.core.score.raw', score);\n      if (this.isSupported('cmi.core.score.min')) this.setValue('cmi.core.score.min', minScore);\n      if (this.isSupported('cmi.core.score.max')) this.setValue('cmi.core.score.max', maxScore);\n    }\n\n    getLessonLocation() {\n      return this.getValue(this.isSCORM2004() ? 'cmi.location' : 'cmi.core.lesson_location');\n    }\n\n    setLessonLocation(location) {\n      this.setValue(this.isSCORM2004() ? 'cmi.location' : 'cmi.core.lesson_location', location);\n    }\n\n    getSuspendData() {\n      return this.getValue('cmi.suspend_data');\n    }\n\n    setSuspendData(data) {\n      this.setValue('cmi.suspend_data', data);\n    }\n\n    getStudentName() {\n      return this.getValue(this.isSCORM2004() ? 'cmi.learner_name' : 'cmi.core.student_name');\n    }\n\n    getStudentId() {\n      return this.getValue(this.isSCORM2004() ? 'cmi.learner_id' : 'cmi.core.student_id');\n    }\n\n    setLanguage(lang) {\n      if (this.isSCORM2004()) {\n        this.setValue('cmi.learner_preference.language', lang);\n        return;\n      }\n      if (this.isSupported('cmi.student_preference.language')) {\n        this.setValue('cmi.student_preference.language', lang);\n      }\n    }\n\n    commit() {\n      this.logger.debug('ScormWrapper::commit');\n\n      if (!this.lmsConnected) {\n        this.handleError(new ScormError(ScormError.CLIENT_NOT_CONNECTED));\n        return;\n      }\n\n      if (this.commitRetryPending) {\n        this.logger.debug('ScormWrapper::commit: skipping this commit call as one is already pending.');\n        return;\n      }\n\n      if (this.scorm.save()) {\n        this.commitRetries = 0;\n        this.lastCommitSuccessTime = new Date();\n        Adapt.trigger('spoor:commit', this);\n        return;\n      }\n\n      if (this.commitRetries < this.maxCommitRetries && !this.finishCalled) {\n        this.commitRetries++;\n        this.initRetryCommit();\n        return;\n      }\n\n      const errorCode = this.scorm.debug.getCode();\n      this.handleError(new ScormError(CLIENT_COULD_NOT_COMMIT, {\n        errorCode,\n        errorInfo: this.scorm.debug.getInfo(errorCode),\n        diagnosticInfo: this.scorm.debug.getDiagnosticInfo(errorCode)\n      }));\n    }\n\n    finish() {\n      this.logger.debug('ScormWrapper::finish');\n\n      if (!this.lmsConnected || this.finishCalled) {\n        this.handleError(new ScormError(CLIENT_NOT_CONNECTED));\n        return;\n      }\n\n      this.finishCalled = true;\n\n      if (this.timedCommitIntervalID !== null) {\n        window.clearInterval(this.timedCommitIntervalID);\n      }\n\n      if (this.commitRetryPending) {\n        window.clearTimeout(this.retryCommitTimeoutID);\n        this.commitRetryPending = false;\n      }\n\n      if (this.logOutputWin && !this.logOutputWin.closed) {\n        this.logOutputWin.close();\n      }\n\n      this.endTime = new Date();\n\n      if (this.isSCORM2004()) {\n        this.scorm.set('cmi.session_time', this.convertToSCORM2004Time(this.endTime.getTime() - this.startTime.getTime()));\n        this.scorm.set('cmi.exit', this.getExitState());\n      } else {\n        this.scorm.set('cmi.core.session_time', this.convertToSCORM12Time(this.endTime.getTime() - this.startTime.getTime()));\n        this.scorm.set('cmi.core.exit', this.getExitState());\n      }\n\n      // api no longer available from this point\n      this.lmsConnected = false;\n\n      if (!this.scorm.quit()) {\n        const errorCode = this.scorm.debug.getCode();\n        this.handleError(new ScormError(CLIENT_COULD_NOT_FINISH, {\n          errorCode,\n          errorInfo: this.scorm.debug.getInfo(errorCode),\n          diagnosticInfo: this.scorm.debug.getDiagnosticInfo(errorCode)\n        }));\n      }\n    }\n\n    recordInteraction(id, response, correct, latency, type) {\n      if (!this.isSupported('cmi.interactions._count')) {\n        this.logger.info('ScormWrapper::recordInteraction: cmi.interactions are not supported by this LMS...');\n        return;\n      }\n\n      switch (type) {\n        case 'choice':\n          this.recordInteractionMultipleChoice.apply(this, arguments);\n          break;\n\n        case 'matching':\n          this.recordInteractionMatching.apply(this, arguments);\n          break;\n\n        case 'numeric':\n          this.isSCORM2004() ? this.recordInteractionScorm2004.apply(this, arguments) : this.recordInteractionScorm12.apply(this, arguments);\n          break;\n\n        case 'fill-in':\n          this.recordInteractionFillIn.apply(this, arguments);\n          break;\n\n        default:\n          console.error(`ScormWrapper.recordInteraction: unknown interaction type of '${type}' encountered...`);\n      }\n    }\n\n    // ****************************** private methods ******************************\n\n    getValue(property) {\n      this.logger.debug(`ScormWrapper::getValue: _property=${property}`);\n\n      if (this.finishCalled) {\n        this.logger.debug(`ScormWrapper::getValue: ignoring request as 'finish' has been called`);\n        return;\n      }\n\n      if (!this.lmsConnected) {\n        this.handleError(new ScormError(CLIENT_NOT_CONNECTED));\n        return;\n      }\n\n      const value = this.scorm.get(property);\n      const errorCode = this.scorm.debug.getCode();\n\n      switch (errorCode) {\n        case 0:\n          break;\n        case 403:\n          // 403 errors are common (and normal) when targetting SCORM 2004 - they are triggered on any\n          // attempt to get the value of a data model element that hasn't yet been assigned a value.\n          this.logger.warn('ScormWrapper::getValue: data model element not initialized');\n          break;\n        default:\n          this.handleError(new ScormError(CLIENT_COULD_NOT_GET_PROPERTY, {\n            property,\n            errorCode,\n            errorInfo: this.scorm.debug.getInfo(errorCode),\n            diagnosticInfo: this.scorm.debug.getDiagnosticInfo(errorCode)\n          }));\n      }\n      this.logger.debug(`ScormWrapper::getValue: returning ${value}`);\n      return value + '';\n    }\n\n    setValue(property, value) {\n      this.logger.debug(`ScormWrapper::setValue: _property=${property} _value=${value}`);\n\n      if (this.finishCalled) {\n        this.logger.debug(`ScormWrapper::setValue: ignoring request as 'finish' has been called`);\n        return;\n      }\n\n      if (!this.lmsConnected) {\n        this.handleError(new ScormError(CLIENT_NOT_CONNECTED));\n        return;\n      }\n\n      const success = this.scorm.set(property, value);\n      if (!success) {\n        // Some LMSes have an annoying tendency to return false from a set call even when it actually worked fine.\n        // So we should only throw an error if there was a valid error code...\n        const errorCode = this.scorm.debug.getCode();\n        if (errorCode !== 0) {\n          this.handleError(new ScormError(CLIENT_COULD_NOT_SET_PROPERTY, {\n            property,\n            value,\n            errorCode,\n            errorInfo: this.scorm.debug.getInfo(errorCode),\n            diagnosticInfo: this.scorm.debug.getDiagnosticInfo(errorCode)\n          }));\n          return success;\n        }\n        this.logger.warn(`ScormWrapper::setValue: LMS reported that the 'set' call failed but then said there was no error!`);\n      }\n\n      if (this.commitOnAnyChange) this.debouncedCommit();\n\n      return success;\n    }\n\n    /**\n     * used for checking any data field that is not 'LMS Mandatory' to see whether the LMS we're running on supports it or not.\n     * Note that the way this check is being performed means it wouldn't work for any element that is\n     * 'write only', but so far we've not had a requirement to check for any optional elements that are.\n     */\n    isSupported(property) {\n      this.logger.debug(`ScormWrapper::isSupported: _property=${property}`);\n\n      if (this.finishCalled) {\n        this.logger.debug(`ScormWrapper::isSupported: ignoring request as 'finish' has been called`);\n        return;\n      }\n\n      if (!this.lmsConnected) {\n        this.handleError(new ScormError(CLIENT_NOT_CONNECTED));\n        return false;\n      }\n\n      this.scorm.get(property);\n\n      return (this.scorm.debug.getCode() !== 401); // 401 is the 'not implemented' error code\n    }\n\n    initTimedCommit() {\n      this.logger.debug('ScormWrapper::initTimedCommit');\n\n      if (!this.commitOnAnyChange && this.timedCommitFrequency > 0) {\n        const delay = this.timedCommitFrequency * (60 * 1000);\n        this.timedCommitIntervalID = window.setInterval(this.commit.bind(this), delay);\n      }\n    }\n\n    initRetryCommit() {\n      this.logger.debug(`ScormWrapper::initRetryCommit ${this.commitRetries} out of ${this.maxCommitRetries}`);\n\n      this.commitRetryPending = true;// stop anything else from calling commit until this is done\n\n      this.retryCommitTimeoutID = window.setTimeout(this.doRetryCommit.bind(this), this.commitRetryDelay);\n    }\n\n    doRetryCommit() {\n      this.logger.debug('ScormWrapper::doRetryCommit');\n\n      this.commitRetryPending = false;\n\n      this.commit();\n    }\n\n    handleError(error) {\n\n      if (!Adapt.get('_isStarted')) {\n        Adapt.once('contentObjectView:ready', this.handleError.bind(this, error));\n        return;\n      }\n\n      if ('value' in error.data) {\n        // because some browsers (e.g. Firefox) don't like displaying very long strings in the window.confirm dialog\n        if (error.data.value.length && error.data.value.length > 80) error.data.value = error.data.value.slice(0, 80) + '...';\n        // if the value being set is an empty string, ensure it displays in the error as ''\n        if (error.data.value === '') error.data.value = `''`;\n      }\n\n      const config = Adapt.course.get('_spoor');\n      const messages = Object.assign({}, ScormError.defaultMessages, config && config._messages);\n      const message = Handlebars.compile(messages[error.name])(error.data);\n\n      switch (error.name) {\n        case CLIENT_COULD_NOT_CONNECT:\n          Adapt.notify.popup({\n            _isCancellable: false,\n            title: messages.title,\n            body: message\n          });\n          return;\n      }\n\n      this.logger.error(message);\n\n      if (!this.suppressErrors && (!this.logOutputWin || this.logOutputWin.closed) && confirm(`${messages.title}:\\n\\n${message}\\n\\n${messages.pressOk}`)) {\n        this.showDebugWindow();\n      }\n\n    }\n\n    getInteractionCount() {\n      const count = this.getValue('cmi.interactions._count');\n      return count === '' ? 0 : count;\n    }\n\n    recordInteractionScorm12(id, response, correct, latency, type) {\n\n      id = id.trim();\n\n      const cmiPrefix = `cmi.interactions.${this.getInteractionCount()}`;\n\n      this.setValue(`${cmiPrefix}.id`, id);\n      this.setValue(`${cmiPrefix}.type`, type);\n      this.setValue(`${cmiPrefix}.student_response`, response);\n      this.setValue(`${cmiPrefix}.result`, correct ? 'correct' : 'wrong');\n      if (latency !== null && latency !== undefined) this.setValue(`${cmiPrefix}.latency`, this.convertToSCORM12Time(latency));\n      this.setValue(`${cmiPrefix}.time`, this.getCMITime());\n    }\n\n    recordInteractionScorm2004(id, response, correct, latency, type) {\n\n      id = id.trim();\n\n      const cmiPrefix = `cmi.interactions.${this.getInteractionCount()}`;\n\n      this.setValue(`${cmiPrefix}.id`, id);\n      this.setValue(`${cmiPrefix}.type`, type);\n      this.setValue(`${cmiPrefix}.learner_response`, response);\n      this.setValue(`${cmiPrefix}.result`, correct ? 'correct' : 'incorrect');\n      if (latency !== null && latency !== undefined) this.setValue(`${cmiPrefix}.latency`, this.convertToSCORM2004Time(latency));\n      this.setValue(`${cmiPrefix}.timestamp`, this.getISO8601Timestamp());\n    }\n\n    recordInteractionMultipleChoice(id, response, correct, latency, type) {\n\n      if (this.isSCORM2004()) {\n        response = response.replace(/,|#/g, '[,]');\n      } else {\n        response = response.replace(/#/g, ',');\n        response = this.checkResponse(response, 'choice');\n      }\n\n      const scormRecordInteraction = this.isSCORM2004() ? this.recordInteractionScorm2004 : this.recordInteractionScorm12;\n\n      scormRecordInteraction.call(this, id, response, correct, latency, type);\n    }\n\n    recordInteractionMatching(id, response, correct, latency, type) {\n\n      response = response.replace(/#/g, ',');\n\n      if (this.isSCORM2004()) {\n        response = response.replace(/,/g, '[,]');\n        response = response.replace(/\\./g, '[.]');\n      } else {\n        response = this.checkResponse(response, 'matching');\n      }\n\n      const scormRecordInteraction = this.isSCORM2004() ? this.recordInteractionScorm2004 : this.recordInteractionScorm12;\n\n      scormRecordInteraction.call(this, id, response, correct, latency, type);\n    }\n\n    recordInteractionFillIn(id, response, correct, latency, type) {\n\n      const maxLength = this.isSCORM2004() ? 250 : 255;\n\n      if (response.length > maxLength) {\n        response = response.substr(0, maxLength);\n\n        this.logger.warn(`ScormWrapper::recordInteractionFillIn: response data for ${id} is longer than the maximum allowed length of ${maxLength} characters; data will be truncated to avoid an error.`);\n      }\n\n      const scormRecordInteraction = this.isSCORM2004() ? this.recordInteractionScorm2004 : this.recordInteractionScorm12;\n\n      scormRecordInteraction.call(this, id, response, correct, latency, type);\n    }\n\n    showDebugWindow() {\n\n      if (this.logOutputWin && !this.logOutputWin.closed) {\n        this.logOutputWin.close();\n      }\n\n      this.logOutputWin = window.open('log_output.html', 'Log', 'width=600,height=300,status=no,scrollbars=yes,resizable=yes,menubar=yes,toolbar=yes,location=yes,top=0,left=0');\n\n      if (this.logOutputWin) {\n        this.logOutputWin.focus();\n      }\n\n    }\n\n    convertToSCORM12Time(msConvert) {\n\n      const msPerSec = 1000;\n      const msPerMin = msPerSec * 60;\n      const msPerHour = msPerMin * 60;\n\n      const ms = msConvert % msPerSec;\n      msConvert = msConvert - ms;\n\n      let secs = msConvert % msPerMin;\n      msConvert = msConvert - secs;\n      secs = secs / msPerSec;\n\n      let mins = msConvert % msPerHour;\n      msConvert = msConvert - mins;\n      mins = mins / msPerMin;\n\n      const hrs = msConvert / msPerHour;\n\n      if (hrs > 9999) {\n        return '9999:99:99.99';\n      }\n\n      const str = [ this.padWithZeroes(hrs, 4), this.padWithZeroes(mins, 2), this.padWithZeroes(secs, 2) ].join(':');\n      return (`${str}.${Math.floor(ms / 10)}`);\n    }\n\n    /**\n     * Converts milliseconds into the SCORM 2004 data type 'timeinterval (second, 10,2)'\n     * this will output something like 'P1DT3H5M0S' which indicates a period of time of 1 day, 3 hours and 5 minutes\n     * or 'PT2M10.1S' which indicates a period of time of 2 minutes and 10.1 seconds\n     */\n    convertToSCORM2004Time(msConvert) {\n      let csConvert = Math.floor(msConvert / 10);\n      const csPerSec = 100;\n      const csPerMin = csPerSec * 60;\n      const csPerHour = csPerMin * 60;\n      const csPerDay = csPerHour * 24;\n\n      let days = Math.floor(csConvert / csPerDay);\n      csConvert -= days * csPerDay;\n      days = days ? days + 'D' : '';\n\n      let hours = Math.floor(csConvert / csPerHour);\n      csConvert -= hours * csPerHour;\n      hours = hours ? hours + 'H' : '';\n\n      let mins = Math.floor(csConvert / csPerMin);\n      csConvert -= mins * csPerMin;\n      mins = mins ? mins + 'M' : '';\n\n      let secs = Math.floor(csConvert / csPerSec);\n      csConvert -= secs * csPerSec;\n      secs = secs || '0';\n\n      let cs = csConvert;\n      cs = cs ? '.' + cs : '';\n\n      const seconds = secs + cs + 'S';\n\n      const hms = [ hours, mins, seconds ].join('');\n\n      return 'P' + days + 'T' + hms;\n    }\n\n    getCMITime() {\n\n      const date = new Date();\n\n      const hours = this.padWithZeroes(date.getHours(), 2);\n      const min = this.padWithZeroes(date.getMinutes(), 2);\n      const sec = this.padWithZeroes(date.getSeconds(), 2);\n\n      return [ hours, min, sec ].join(':');\n    }\n\n    /**\n     * returns the current date & time in the format YYYY-MM-DDTHH:mm:ss\n     */\n    getISO8601Timestamp() {\n      const date = new Date().toISOString();\n      return date.replace(/.\\d\\d\\dZ/, ''); // Date.toISOString returns the date in the format YYYY-MM-DDTHH:mm:ss.sssZ so we need to drop the last bit to make it SCORM 2004 conformant\n    }\n\n    padWithZeroes(numToPad, padBy) {\n\n      let len = padBy;\n\n      while (--len) {\n        numToPad = '0' + numToPad;\n      }\n\n      return numToPad.slice(-padBy);\n    }\n\n    isSCORM2004() {\n      return this.scorm.version === '2004';\n    }\n\n    /**\n     * SCORM 1.2 requires that the identifiers in cmi.interactions.n.student_response for choice and matching activities be a character from [0-9a-z].\n     * When numeric identifiers are used this function attempts to map identifiers 10 to 35 to [a-z]. Resolves issues/1376.\n     */\n    checkResponse(response, responseType) {\n      if (!response) return response;\n      if (responseType !== 'choice' && responseType !== 'matching') return response;\n\n      response = response.split(/,|#/);\n\n      const self = this;\n\n      if (responseType === 'choice') {\n        response = response.map(checkIdentifier);\n      } else {\n        response = response.map(r => {\n          const identifiers = r.split('.');\n          return checkIdentifier(identifiers[0]) + '.' + checkIdentifier(identifiers[1]);\n        });\n      }\n\n      function checkIdentifier(r) {\n        let i;\n\n        // if [0-9] then ok\n        if (r.length === 1 && r >= '0' && r <= '9') return r;\n\n        // if [a-z] then ok\n        if (r.length === 1 && r >= 'a' && r <= 'z') return r;\n\n        // try to map integers 10-35 to [a-z]\n        i = parseInt(r);\n\n        if (isNaN(i) || i < 10 || i > 35) {\n          self.handleError(new ScormError(CLIENT_INVALID_CHOICE_VALUE));\n        }\n\n        return Number(i).toString(36); // 10 maps to 'a', 11 maps to 'b', ..., 35 maps to 'z'\n      }\n\n      return response.join(',');\n    }\n\n    getExitState() {\n      const completionStatus = this.scorm.data.completionStatus;\n      const isIncomplete = completionStatus === 'incomplete' || completionStatus === 'not attempted';\n      const exitState = isIncomplete ? this.exitStateIfIncomplete : this.exitStateIfComplete;\n\n      if (exitState !== 'auto') return exitState;\n\n      if (this.isSCORM2004()) return (isIncomplete ? 'suspend' : 'normal');\n\n      return '';\n    }\n\n  }\n\n  // static\n  ScormWrapper.instance = null;\n\n  return ScormWrapper;\n\n});\n","define([\n  'underscore'\n], function(_) {\n  /**\n   * 2020/05/06 SCORMSuspendData\n   *\n   * Serialize and deserialize arrays, booleans and numbers into a base64 string\n   * for transport over SCORM 1.2 based systems where storage space is restricted\n   * to only 4096 characters or 4KB.\n   *\n   * The algorithm is weighted heavily in efficiency towards storing data by\n   * its occurrence frequency when it is used to save Adapt question responses,\n   * booleans, arrays of <16 length and numbers of <4 value.\n   *\n   * Numbers can be 2 precision decimals, positive and negative numbers between\n   * -4294967295.99 and 4294967295.99. Arrays can have 0 to 65535 entries. Arrays\n   * can be nested. All arrays must have the same ES type (boolean, number or array).\n   *\n   * The appropriate binary type is chosen for each array according to the following table,\n   * an array must have one type which best fits its values:\n   *\n   *           VALUES                                VALUETYPE     PER ENTRY\n   * VALUETYPE MIN           MAX            DECIMAL  BITS          MIN BITS  MAX BITS  STORES\n   * ARRAY     0             65535 (items)  NO       2             6         23        Array length and valuetype\n   * BOOLEAN   0             1              NO       1             1         1         Entry value\n   * UINT3     0             7              NO       4             3         3         Entry value\n   * VINT8+    0             255            NO       3             3         9         Entry value\n   * VINT8-   -255           0              NO       6             3         9         Entry value\n   * SDEC15   -255.99        255.99         NO       6             8         22        Entry value\n   * SINT32   -4294967295    4294967295     NO       6             5         35        Entry value\n   * SDEC39   -4294967295.99 4294967295.99  YES      6             10        48        Entry value\n   *\n   * Output construction map:\n   *\n   *  OUTPUT = VALUETYPE + DATA\n   *  DATA = ( ARRAY | BOOLEAN | UINT3 | VINT8+ | VINT8- | SDEC15 | SINT32 | SDEC39 )\n   *  ARRAY = IS_SMALL_BIT( BOOLEAN ) + LENGTH( UINT4 | UINT16 ) + VALUETYPE + DATA[0-65535]\n   *\n   *  VALUETYPE = 0 to 111111\n   *   Signifies the type of value for the output or array data.\n   *\n   *   BINARY  NAME        USAGE RANKING\n   *   10      ARRAY       2\n   *   0       BOOLEAN     1\n   *   1110    UINT3       4\n   *   110     VINT8+      3\n   *   111100  VINT8-      7\n   *   111101  SDEC15      5\n   *   111110  SINT32      6\n   *   111111  SDEC39      8\n   *\n   *  ARRAY\n   *   Stores the number and type of items.\n   *\n   *          BINARY\n   *   BITS | SMALL LENGTH (UINT4/16) VALUETYPE = VALUE\n   *   6    | 1     0000              0         = zero length boolean array\n   *   6    | 1     1111              0         = 15 length boolean array\n   *   23   | 0     1000000000000000  111111    = 8 length sdec39 array\n   *   23   | 0     1111111111111111  111111    = 65535 length sdec39 array\n   *\n   *  BOOLEAN\n   *   A value of true or false.\n   *\n   *          BINARY\n   *   BITS | BOOL  = VALUE\n   *   1    | 0     = false\n   *   1    | 1     = true\n   *\n   *  UINT3\n   *   A value from 0 to 7 with a 3 bit fixed length output.\n   *\n   *          BINARY\n   *   BITS | INT (UINT3) = VALUE\n   *   3    | 000         = 0\n   *   3    | 111         = 7\n   *\n   *  UINT4\n   *   An array length from 0 to 15 with a 4 bit fixed length output.\n   *\n   *          BINARY\n   *   BITS | INT (UINT4) = VALUE\n   *   4    | 0000        = 0\n   *   4    | 1111        = 15\n   *\n   *  VINT8+\n   *   A value from 0 to 255 with variable length output.\n   *   Output is a UINT2/8 bit integer with a 1 bit header.\n   *\n   *          BINARY\n   *   BITS | SMALL INT (UINT2/8) = VALUE\n   *   3    | 1     00           =  0\n   *   3    | 1     11           =  3\n   *   9    | 0     00000100     =  4\n   *   9    | 0     11111111     =  255\n   *\n   *  VINT8-\n   *   A value from -255 to 0 with variable length output.\n   *   Output is a UINT2/8 bit integer with a 1 bit header.\n   *\n   *   BITS | SMALL INT (UINT2/8) = VALUE\n   *   3    | 1     00            =  0\n   *   3    | 1     11            = -3\n   *   9    | 0     00000100      = -4\n   *   9    | 0     11111111      = -255\n   *\n   *  SDEC15\n   *   A value from -255.99 to 255.99 preserving 2 decimals places\n   *   places and with variable length output.\n   *\n   *   BITS | SIGN INTSIZE INT (UINT2/8) DECSIZE DEC (UINT0/7)   = VALUE\n   *   5    | 0    0       00            0                       =  0\n   *   12   | 0    0       00            0       0000001         =  0.01\n   *   12   | 1    0       00            0       0000001         = -0.01\n   *   12   | 1    0       00            1       1100011         = -0.99\n   *   18   | 0    1       00001000      1       0000001         =  8.01\n   *   18   | 1    1       00001000      1       1100011         = -8.99\n   *   18   | 0    1       11111111      1       1100011         =  255.99\n   *   18   | 1    1       11111111      1       1100011         = -255.99\n   *\n   *  UINT16\n   *   An array length from 0 to 65535 with a 16 bit fixed length output.\n   *\n   *          BINARY\n   *   BITS | INT (UINT16)       = VALUE\n   *   16   | 0000000000000000  = 0\n   *   16   | 1111111111111111  = 65535\n   *\n   *  SINT32\n   *   A value from -4294967295 to 4294967295 with variable length output.\n   *   Output is a UINT2/4/16/32 bit integer with a 3 bit header.\n   *\n   *   BITS | SIGN SIZE  INT (UINT2/4/16/32)              = VALUE\n   *   5    | 0    00    00                               =  0\n   *   5    | 1    00    11                               = -3\n   *   7    | 0    01    1000                             =  8\n   *   7    | 1    01    1111                             = -15\n   *   19   | 0    10    0000000100000000                 =  256\n   *   19   | 1    10    1111111111111111                 = -65535\n   *   35   | 1    11    11111111111111111111111111111111 = -4294967295\n   *   35   | 0    11    11111111111111111111111111111111 =  4294967295\n   *\n   *  SDEC39\n   *   A value from -4294967295.99 to 4294967295.99 preserving 2 decimals places\n   *   places and with variable length output.\n   *\n   *   BITS | SIGN INTSIZE INT (UINT2/4/16/32)              DECSIZE DEC (UINT0/7)   = VALUE\n   *   6    | 0    00      00                               0                       =  0\n   *   13   | 0    00      11                               0       0000001         =  3.01\n   *   13   | 1    01      1000                             0       0000001         = -8.01\n   *   13   | 1    01      1111                             1       1100011         = -15.99\n   *   27   | 0    10      0000000100000000                 1       0000001         =  256.01\n   *   27   | 1    10      1111111111111111                 1       1100011         = -65535.99\n   *   37   | 0    11      11111111111111111111111111111111 0                       =  4294967295\n   *   37   | 1    11      11111111111111111111111111111111 0                       = -4294967295\n   *   43   | 0    11      11111111111111111111111111111111 1       1100011         =  4294967295.99\n   *   43   | 1    11      11111111111111111111111111111111 1       1100011         = -4294967295.99\n   *\n   * Output byte count formula:\n   *\n   *  byte_count = (bit_count * 1.5base64_expansion) / 8bits_per_byte\n   *\n   *  The output is in base64 so bit counts are always inflated by 1.5 from byte to base64.\n   *\n   * Example:\n   *\n   * [\n   *   [\n   *     0,\n   *     7,\n   *     1,\n   *     0\n   *   ],\n   *   [\n   *     true,\n   *     true,\n   *     true,\n   *     true,\n   *     true\n   *   ],\n   *   [\n   *     true,\n   *     false,\n   *     false,\n   *     false\n   *   ]\n   * ]\n   *\n   * In this example the parent array represents a completed question state for a\n   * single question. The first child number-array stores the block location,\n   * tracking id, score and attemptsLeft. The second child boolean-array stores\n   * the completion, correctness, submission state and user answer states. The\n   * third child boolean-array stores the user selections for a multiple choice question.\n   *\n   * When serialized with SCORMSuspendData.serialize() it becomes the following\n   * 10 characters:\n   *\n   *   hxOHIK-RAA\n   *\n   * These characters can be deserialized back into the nested arrays above using\n   * SCORMSuspendData.deserialize(\"hxOHIK-RAA\");\n   *\n   * In JSON this array would usually be 63 characters minified, at 10 characters this is\n   * a reduction of about 84%. At the worse case, storing an array containing just\n   * the largest possible number ([-4294967295.99]) the output will only be reduced\n   * by about 37% (g///////4w) when compared to the equivalent JSON. It is possible\n   * to store 500 of the above mcq state arrays in just 4088 characters. About 250\n   * question states will occupy about half of the available space in SCORM's 4096\n   * character suspend data.\n   */\n\n  // Cache for zero strings of various lengths\n  const ZeroString = {};\n  /**\n   * Make and cache a zero string up to the supplied length\n   * @param {number} length\n   * @returns {string}\n   */\n  function makeZeroString(length) {\n    ZeroString[length] = ZeroString[length] || (new Array(length + 1)).join('0');\n    return ZeroString[length];\n  }\n  // Initialize zero string cache up to 64 characters in length\n  for (let i = 1, l = 64; i <= l; i++) {\n    makeZeroString(i);\n  }\n\n  /**\n   * Zero pads to the right, making up to the supplied length\n   * @param {string} string\n   * @param {number} length\n   * @returns {string}\n   */\n  function zeroPadRightToLength(string, length) {\n    const padLength = (length - string.length);\n    if (padLength > 0) {\n      string += makeZeroString(padLength);\n    }\n    return string;\n  }\n\n  /**\n   * Zero pads to the left, making up to the supplied length\n   * @param {string} string\n   * @param {number} length\n   * @returns {string}\n   */\n  function zeroPadLeftToLength(string, length) {\n    const padLength = (length - string.length);\n    if (padLength > 0) {\n      string = makeZeroString(padLength) + string;\n    }\n    return string;\n  }\n\n  /**\n   * Zero pads to the right at even multiples\n   * @param {string} string\n   * @param {number} multiple\n   * @returns {string}\n   */\n  function zeroPadRightToMultiple(string, multiple) {\n    const padLength = multiple - (string.length % multiple);\n    if (padLength !== multiple) {\n      string += makeZeroString(padLength);\n    }\n    return string;\n  }\n\n  /**\n   * Returns a positive integer from the supplied binary string and binaryLength\n   * @param {string} binary\n   * @param {number} binaryLength\n   * @returns {number}\n   */\n  function binaryToUnsignedInteger(binary, binaryLength) {\n    if (binaryLength === 0) {\n      return 0;\n    }\n    binary = zeroPadLeftToLength(binary, binaryLength);\n    const integer = parseInt(binary.slice(0, binaryLength), 2);\n    return integer;\n  }\n\n  /**\n   * Shifts a positive integer from the supplied binary string and binaryLength,\n   * returning the shifted integer and the next part of the binary string\n   * @param {string} binary\n   * @param {number} binaryLength\n   * @returns {[number, string]}\n   */\n  function shiftUnsignedIntegerFromBinary(binary, binaryLength) {\n    if (binaryLength === 0) {\n      return [0, binary];\n    }\n    binary = zeroPadLeftToLength(binary, binaryLength);\n    const integer = parseInt(binary.slice(0, binaryLength), 2);\n    binary = binary.slice(binaryLength);\n    return [integer, binary];\n  }\n\n  /**\n   * Shifts binaryLength characters from the supplied binary string, returning the\n   * shifted binary string and the next part of the binary string\n   * @param {string} binary\n   * @param {number} binaryLength\n   * @returns {[string, string]}\n   */\n  function shiftBinary(binary, binaryLength) {\n    if (binaryLength === 0) {\n      return ['', binary];\n    }\n    binary = zeroPadLeftToLength(binary, binaryLength);\n    const shifted = binary.slice(0, binaryLength);\n    binary = binary.slice(binaryLength);\n    return [shifted, binary];\n  }\n\n  /**\n   * Converts a positive integer to a binary string\n   * @param {number} integer\n   * @param {number} [binaryLength] Length of the output string\n   */\n  function unsignedIntegerToBinary(integer, binaryLength) {\n    if (binaryLength === 0) {\n      return '';\n    }\n    let binary = Math.abs(integer).toString(2);\n    if (typeof binaryLength === 'undefined') {\n      return binary;\n    }\n    const length = binary.length;\n    if (length > binaryLength) {\n      throw new Error(`Integer too big for specified binary length. integer: ${integer} binarylen: ${binaryLength}`);\n    }\n    binary = zeroPadLeftToLength(binary, binaryLength);\n    return binary;\n  }\n\n  /**\n   * Converts a byte array to a string\n   * @param {[number]} array\n   * @returns {string}\n   */\n  function byteArrayToString(array) {\n    const arrayLength = array.length;\n    let string = new Array(arrayLength);\n    for (let i = 0, l = arrayLength; i < l; i++) {\n      string[i] = String.fromCharCode(array[i]);\n    }\n    string = string.join('');\n    return string;\n  }\n\n  /**\n   * Converts a string to a byte array\n   * @param {string} string\n   * @returns {[number]}\n   */\n  function stringToByteArray(string) {\n    const stringLength = string.length;\n    const array = new Array(stringLength);\n    for (let i = 0, l = stringLength; i < l; i++) {\n      array[i] = string.charCodeAt(i);\n    }\n    return array;\n  }\n\n  /** @type {number} Number of bits per byte */\n  const BYTE_BIT_LENGTH = 8;\n\n  /**\n   * Converts a binary string or nested arrays of binary strings to a base64 string\n   * @param {string|[string]} binary\n   * @returns {string}\n   */\n  function binaryToBase64(binary) {\n    binary = _.flatten(binary).join('');\n    binary = zeroPadRightToMultiple(binary, BYTE_BIT_LENGTH);\n    const bytesCount = binary.length / BYTE_BIT_LENGTH;\n    const charCodes = new Array(bytesCount);\n    for (let i = 0, l = bytesCount; i < l; i++) {\n      [ charCodes[i], binary ] = shiftUnsignedIntegerFromBinary(binary, BYTE_BIT_LENGTH);\n    }\n    let base64 = btoa(byteArrayToString(charCodes));\n    // Remove padding = or == as not necessary here\n    base64 = base64.replace(/=/g, '');\n    // Can't handle base64 with the + sign so swap with a -\n    base64 = base64.replace(/\\+/g, '-');\n    return base64;\n  }\n\n  /**\n   * Converts a base64 string to a binary string\n   * @param {string} base64\n   * @returns {string}\n   */\n  function base64ToBinary(base64) {\n    // base64 should have a + instead of a -\n    base64 = base64.replace(/-/g, '+');\n    const charCodes = stringToByteArray(atob(base64));\n    const bytesCount = charCodes.length;\n    let binary = new Array(bytesCount);\n    for (let i = 0, l = bytesCount; i < l; i++) {\n      binary[i] = unsignedIntegerToBinary(charCodes[i], BYTE_BIT_LENGTH);\n    }\n    binary = binary.join('');\n    return binary;\n  }\n\n  // Console output store\n  const logs = {\n    usedTypes: {},\n    typeLengths: {},\n    binarySamples: {}\n  };\n\n  /**\n   * An abstract base class for a ValueType value to and from binary string converter\n   */\n  class AbstractValueType {\n\n    /**\n     * @param {Object} options\n     * @param {string} options.name Name identifying the type\n     * @param {string} options.binaryType Binary string identifying the type\n     */\n    constructor(options) {\n      Object.assign(this, options);\n      this.binaryTypeLength = this.binaryType.length;\n    }\n\n    /**\n     * Adds a record of the binary string production to the logging store\n     * @param {[Array|string]} binary\n     */\n    log(binary) {\n      const name = this.name;\n      logs.usedTypes[name] = logs.usedTypes[name] || 0;\n      logs.usedTypes[name]++;\n      logs.binarySamples[name] = logs.binarySamples[name] || [];\n      logs.binarySamples[name].push(binary);\n    }\n\n  };\n\n  /**\n   * Converts a fixed length positive integer to and from a binary string.\n   */\n  class FixedIntegerType extends AbstractValueType {\n\n    /**\n     * @param {Object} options\n     * @param {string} options.name Name identifying the type\n     * @param {string} options.binaryType Binary string identifying the type\n     * @param {number} options.valueBinaryLength Bit length of the integer\n     */\n    constructor(options) {\n      super(options);\n      this.esType = 'number';\n      if (!this.valueBinaryLength) {\n        return;\n      }\n      this.minValue = options.minValue || 0;\n      this.maxValue = options.maxValue || Math.pow(2, this.valueBinaryLength) - 1;\n    }\n\n    /**\n     * Converts a fixed length positive integer to an array of binary strings\n     * @param {number} integer\n     * @param {boolean} [logStats] Log the type usage for output to the console\n     * @returns {[string]}\n     */\n    valueToBinary(integer, logStats = null) {\n      let binary = unsignedIntegerToBinary(integer, this.valueBinaryLength);\n      if (logStats) {\n        this.log(binary);\n      }\n      binary = [binary];\n      return binary;\n    }\n\n    /**\n     * Shifts a fixed length positive integer from the binary string, returning\n     * the integer and the next part of the binary string.\n     * @param {string} binary\n     * @returns {[number, string]}\n     */\n    shiftValueFromBinary(binary) {\n      let integer;\n      [integer, binary] = shiftUnsignedIntegerFromBinary(binary, this.valueBinaryLength);\n      return [integer, binary];\n    }\n\n  }\n\n  /**\n   * Converts a boolean to and from a binary string\n   */\n  class FixedBooleanType extends FixedIntegerType {\n\n    /**\n     * @param {Object} options\n     * @param {string} options.name Name identifying the type\n     * @param {string} options.binaryType Binary string identifying the type\n     */\n    constructor(options) {\n      options.valueBinaryLength = 1;\n      super(options);\n      this.esType = 'boolean';\n    }\n\n    /**\n     * Shifts a boolean from the binary string, returning\n     * the boolean and the next part of the binary string\n     * @param {string} binary\n     * @returns {[boolean, string]}\n     */\n    shiftValueFromBinary(binary) {\n      const bool = (binary[0] === '1');\n      binary = binary.slice(1);\n      return [bool, binary];\n    }\n\n  }\n\n  /**\n   * A helper for converting variable length positive integers to and from a binary string\n   */\n  class LengthAndValueBinary {\n\n    /**\n     * @param {string} parent The parent AbstractValueType\n     * @param {string} name The sub parent value part name \"integer\" or \"decimal\"\n     * @param {[number]} bitSizes An ordered array of expressible bit lengths\n     */\n    constructor(parent, name, bitSizes) {\n      this.parent = parent;\n      this.name = name;\n      this.bitSizes = bitSizes;\n      this.maxValues = _.flatten(this.bitSizes).map(value => (Math.pow(2, value) - 1));\n      this.maxValue = this.maxValues[this.maxValues.length - 1];\n      this.sizeBinaryLength = unsignedIntegerToBinary(this.bitSizes.length - 1).length;\n    }\n\n    /**\n     * Converts a positive integer to a binary string array\n     * @param {number} integer\n     * @param {boolean} [logStats] Log the type usage for output to the console\n     * @returns {[string]}\n     */\n    valueToBinary(integer, logStats = null) {\n      const parentName = this.parent.name;\n      const sizeIndex = this.maxValues.findIndex(maxValue => (integer <= maxValue));\n      if (sizeIndex === -1) {\n        throw new Error(`Value is too large for type: ${parentName} value: ${integer} max: ${this.maxValue}`);\n      }\n      const sizeBinary = unsignedIntegerToBinary(sizeIndex, this.sizeBinaryLength);\n      const valueLength = this.bitSizes[sizeIndex];\n      const name = this.name;\n      if (logStats) {\n        logs.typeLengths[parentName] = logs.typeLengths[parentName] || {};\n        logs.typeLengths[parentName][name] = logs.typeLengths[parentName][name] || {};\n        logs.typeLengths[parentName][name][valueLength] = logs.typeLengths[parentName][name][valueLength] || 0;\n        logs.typeLengths[parentName][name][valueLength]++;\n      }\n      const integerBinary = unsignedIntegerToBinary(integer, valueLength);\n      const binary = [sizeBinary, integerBinary];\n      return binary;\n    }\n\n    /**\n     * Shifts a positive integer from the binary string, returning\n     * the integer and the next part of the binary string\n     * @param {string} binary\n     * @returns {[number, string]}\n     */\n    shiftValueFromBinary(binary) {\n      let sizeBinary;\n      [sizeBinary, binary] = shiftBinary(binary, this.sizeBinaryLength);\n      const sizeIndex = binaryToUnsignedInteger(sizeBinary);\n      const valueLength = this.bitSizes[sizeIndex];\n      let integer;\n      [integer, binary] = shiftUnsignedIntegerFromBinary(binary, valueLength);\n      return [integer, binary];\n    }\n\n  }\n\n  /**\n   * Converts a variable length positive or negative integer to and from a\n   * binary string\n   */\n  class VariableIntegerType extends FixedIntegerType {\n\n    /**\n     * @param {Object} options\n     * @param {string} options.name Name identifying the type\n     * @param {string} options.binaryType Binary string identifying the type\n     * @param {number} options.minValue Minimum value for the integer\n     * @param {number} options.maxValue Maximum value for the integer\n     * @param {[number]} options.integerBitSizes Expressible storage bit sizes\n     */\n    constructor(options) {\n      super(options);\n      this.isNegative = (this.minValue < 0 && this.maxValue === 0);\n      this.integer = new LengthAndValueBinary(this, 'integer', options.integerBitSizes);\n    }\n\n    /**\n     * Converts a positive or negative integer to a array of binary strings\n     * @param {number} integer\n     * @param {boolean} [logStats] Log the type usage for output to the console\n     * @returns {[string]}\n     */\n    valueToBinary(integer, logStats = null) {\n      integer = integer.toFixed(0);\n      let binary = this.integer.valueToBinary(Math.abs(integer), logStats);\n      if (logStats) {\n        this.log(binary);\n      }\n      return binary;\n    }\n\n    /**\n     * Shifts a positive or negative integer from the binary string, returning\n     * the integer and the next part of the binary string\n     * @param {string} binary\n     * @returns {[number, string]}\n     */\n    shiftValueFromBinary(binary) {\n      let integer;\n      [integer, binary] = this.integer.shiftValueFromBinary(binary);\n      if (this.isNegative) {\n        integer = -integer;\n      }\n      return [integer, binary];\n    }\n\n  }\n\n  /**\n   * Converts a variable length array to and from a binary string\n   */\n  class VariableArrayType extends VariableIntegerType {\n\n    /**\n     * @param {Object} options\n     * @param {string} options.name Name identifying the type\n     * @param {string} options.binaryType Binary string identifying the type\n     * @param {[number]} options.integerBitSizes Expressible storage bit sizes\n     */\n    constructor(options) {\n      super(options);\n      this.esType = 'array';\n    }\n\n    /**\n     * Converts an array to an array of binary strings\n     * @param {Array} array\n     * @param {boolean} [logStats] Log the type usage for output to the console\n     * @returns {[Array|string]}\n     */\n    valueToBinary(array, logStats = null) {\n      const arrayLength = array.length;\n      const binary = super.valueToBinary(arrayLength);\n      if (arrayLength) {\n        const valueType = findValueTypeFromValues(array);\n        binary.push(valueType.binaryType);\n        binary.type = valueType.name;\n        binary.push(array.map(value => valueType.valueToBinary(value, logStats)));\n      }\n      if (logStats) {\n        this.log(binary);\n      }\n      return binary;\n    }\n\n    /**\n     * Shifts an array from the binary string, returning\n     * the array and the next part of the binary string\n     * @param {string} binary\n     * @returns {[Array, string]}\n     */\n    shiftValueFromBinary(binary) {\n      let arrayLength;\n      [arrayLength, binary] = super.shiftValueFromBinary(binary);\n      const value = new Array(arrayLength);\n      if (arrayLength) {\n        let valueType;\n        [valueType, binary] = shiftValueTypeFromBinary(binary);\n        for (let i = 0, l = arrayLength; i < l; i++) {\n          [value[i], binary] = valueType.shiftValueFromBinary(binary);\n        }\n      }\n      return [value, binary];\n    }\n\n  }\n\n  /**\n   * Converts a variable length signed integer to and from a binary string\n   */\n  class VariableSignedIntegerType extends VariableIntegerType {\n\n    /**\n     * Converts a signed positive or negative integer to a binary string array\n     * @param {number} integer\n     * @param {boolean} [logStats] Log the type usage for output to the console\n     * @returns {[string]}\n     */\n    valueToBinary(integer, logStats = null) {\n      integer = integer.toFixed(0);\n      const isNegative = (integer < 0);\n      const signBinary = isNegative ? '1' : '0';\n      const integerBinary = this.integer.valueToBinary(Math.abs(integer), logStats);\n      const binary = [signBinary, integerBinary];\n      if (logStats) {\n        this.log(binary);\n      }\n      return binary;\n    }\n\n    /**\n     * Shifts the first signed integer value from the binary string, returning\n     * the integer value and the next part of the binary string\n     * @param {string} binary\n     * @returns {[number, string]}\n     */\n    shiftValueFromBinary(binary) {\n      let isNegative;\n      [isNegative, binary] = shiftUnsignedIntegerFromBinary(binary, 1);\n      let integer;\n      [integer, binary] = this.integer.shiftValueFromBinary(binary);\n      if (isNegative) {\n        integer = -integer;\n      }\n      return [integer, binary];\n    }\n\n  }\n\n  /**\n   * Converts a variable length 2 precision decimal to and from a binary string\n   */\n  class VariableDecimalType extends VariableIntegerType {\n\n    /**\n     * @param {Object} options\n     * @param {string} options.name Name identifying the type\n     * @param {string} options.binaryType Binary string identifying the type\n     * @param {number} options.minValue Minimum value for the integer\n     * @param {number} options.maxValue Maximum value for the integer\n     * @param {[number]} options.integerBitSizes Expressible integer storage bit sizes\n     * @param {[number]} options.decimalBitSizes Expressible decimal storage bit sizes\n     */\n    constructor(options) {\n      super(options);\n      this.isFloat = true;\n      this.decimal = new LengthAndValueBinary(this, 'decimal', options.decimalBitSizes);\n    }\n\n    /**\n     * Converts a signed 2 precision decimal to an array of binary strings\n     * @param {number} float\n     * @param {boolean} [logStats] Log the type usage for output to the console\n     * @returns {[string]}\n     */\n    valueToBinary(float, logStats = null) {\n      float = float.toFixed(2);\n      const isNegative = (float < 0);\n      float = Math.abs(float);\n      const parts = String(float).split('.');\n      const higherInteger = parseInt(parts[0]);\n      const lowerInteger = parseInt(zeroPadRightToLength(parts[1] || 0, 2));\n      const signBinary = isNegative ? '1' : '0';\n      const integerValueBinary = this.integer.valueToBinary(higherInteger, logStats);\n      const decimalValueBinary = this.decimal.valueToBinary(lowerInteger, logStats);\n      const binary = [signBinary, integerValueBinary, decimalValueBinary];\n      if (logStats) {\n        this.log(binary);\n      }\n      return binary;\n    }\n\n    /**\n     * Shifts the first signed 2 precision decimal value from the binary string,\n     * returning the decimal value and the next part of the binary string\n     * @param {string} binary\n     * @returns {[number, string]}\n     */\n    shiftValueFromBinary(binary) {\n      let isNegative;\n      [isNegative, binary] = shiftUnsignedIntegerFromBinary(binary, 1);\n      let higherInteger;\n      [higherInteger, binary] = this.integer.shiftValueFromBinary(binary);\n      let lowerInteger;\n      [lowerInteger, binary] = this.decimal.shiftValueFromBinary(binary);\n      lowerInteger = zeroPadLeftToLength(String(lowerInteger), 2);\n      let float = parseFloat(higherInteger + '.' + lowerInteger);\n      if (isNegative) {\n        float = -float;\n      }\n      return [float, binary];\n    }\n\n  }\n\n  const arrayType = new VariableArrayType({\n    name: 'array',\n    binaryType: '10',\n    integerBitSizes: [4, 16]\n  });\n\n  const booleanType = new FixedBooleanType({\n    name: 'boolean',\n    binaryType: '0'\n  });\n\n  /**\n   * @type {[FixedIntegerType|VariableIntegerType]}\n   */\n  const integerTypes = [\n    new FixedIntegerType({\n      name: 'uint3',\n      binaryType: '1110',\n      valueBinaryLength: 3\n    }),\n    new VariableIntegerType({\n      name: 'vint8+',\n      binaryType: '110',\n      minValue: 0,\n      maxValue: 255,\n      integerBitSizes: [2, 8]\n    }),\n    new VariableIntegerType({\n      name: 'vint8-',\n      binaryType: '111100',\n      minValue: -255,\n      maxValue: 0,\n      integerBitSizes: [2, 8]\n    }),\n    new VariableSignedIntegerType({\n      name: 'sint32',\n      binaryType: '111110',\n      minValue: -4294967295,\n      maxValue: 4294967295,\n      integerBitSizes: [2, 4, 16, 32]\n    })\n  ];\n\n  /**\n   * @type {[VariableDecimalType]}\n   */\n  const decimalTypes = [\n    new VariableDecimalType({\n      name: 'sdec15',\n      binaryType: '111101',\n      minValue: -255.99,\n      maxValue: 255.99,\n      integerBitSizes: [2, 8],\n      decimalBitSizes: [0, 7]\n    }),\n    new VariableDecimalType({\n      name: 'sdec39',\n      binaryType: '111111',\n      minValue: -4294967295.99,\n      maxValue: 4294967295.99,\n      integerBitSizes: [2, 4, 16, 32],\n      decimalBitSizes: [0, 7]\n    })\n  ];\n\n  // Store and index all of the value types for searching by binaryType and name\n  const ValueTypes = [booleanType, arrayType].concat(integerTypes).concat(decimalTypes);\n  ValueTypes.nameIndex = {};\n  ValueTypes.forEach(valueType => (ValueTypes.nameIndex[valueType.name] = valueType));\n\n  /**\n   * Extends the native typeof keyword with array and null\n   * @param {*} value\n   * @returns {string} \"undefined\"|\"null\"|\"boolean\"|\"number\"|\"array\"|\"object\"\n   */\n  function esTypeOf(value) {\n    if (Array.isArray(value)) {\n      return 'array';\n    }\n    if (value === null) {\n      return 'null';\n    }\n    return typeof value;\n  }\n\n  /**\n   * Returns matching ValueType for the given name\n   * @param {string} name\n   * @returns {AbstractValueType}\n   */\n  function findValueTypeFromName(name) {\n    return ValueTypes.nameIndex[name.toLowerCase()];\n  }\n\n  /**\n   * Returns matching ValueType for the given value\n   * @param {number|boolean|Array} value\n   * @returns {AbstractValueType}\n   */\n  function findValueTypeFromValue(value) {\n    const esType = esTypeOf(value);\n    switch (esType) {\n      case 'array':\n        return arrayType;\n      case 'boolean':\n        return booleanType;\n    }\n    value = value.toFixed(2);\n    const isFloat = !Number.isInteger(value);\n    const isValueInValueTypeRange = valueType => (value >= valueType.minValue && value <= valueType.maxValue);\n    const valueType = isFloat ?\n      decimalTypes.find(isValueInValueTypeRange) :\n      integerTypes.find(isValueInValueTypeRange);\n    if (!valueType) {\n      throw new Error(`Cannot find type from value: ${value}`);\n    }\n    return valueType;\n  }\n\n  /**\n   * Returns a common ValueType for an array of values\n   * @param {Array} values\n   * @returns {AbstractValueType}\n   */\n  function findValueTypeFromValues(values) {\n    if (!values.length) {\n      return;\n    }\n    let minValue = 0;\n    let maxValue = 0;\n    let isFloat = false;\n    const esTypes = values.map(value => {\n      const valueType = findValueTypeFromValue(value, isFloat);\n      if (valueType.esType === 'number') {\n        minValue = _.min([value, minValue]);\n        maxValue = _.max([value, maxValue]);\n        isFloat = isFloat || !Number.isInteger(value);\n      }\n      return valueType.esType;\n    });\n    const uniqESTypes = _.uniq(esTypes);\n    if (uniqESTypes.length > 1) {\n      throw new Error(`Cannot resolve array to one type: ${uniqESTypes.join()}`);\n    }\n    const esType = uniqESTypes[0];\n    switch (esType) {\n      case 'array':\n        return arrayType;\n      case 'boolean':\n        return booleanType;\n    }\n    const isRangeInValueTypeRange = valueType => (minValue >= valueType.minValue && maxValue <= valueType.maxValue);\n    const valueType = isFloat ?\n      decimalTypes.find(isRangeInValueTypeRange) :\n      integerTypes.find(isRangeInValueTypeRange);\n    if (!valueType) {\n      throw new Error(`Cannot find type from value. min: ${minValue} max: ${maxValue} isfloat: ${isFloat}`);\n    }\n    return valueType;\n  }\n\n  /**\n   * Shifts the first value type representation from the binary string, returning\n   * the the ValueType found and next part of the binary string\n   * @param {string} binary\n   * @returns {[AbstractValueType, string]}\n   */\n  function shiftValueTypeFromBinary(binary) {\n    const valueType = ValueTypes.find(valueType => {\n      const binaryType = binary.slice(0, valueType.binaryTypeLength);\n      return (binaryType === valueType.binaryType);\n    });\n    if (!valueType) {\n      throw new Error(`Cannot find type from binary: ${binary.slice(0, 6)}...`);\n    }\n    binary = binary.slice(valueType.binaryTypeLength);\n    return [valueType, binary];\n  }\n\n  /**\n   * Sanitize the input throwing errors on any incorrect variable types whilst\n   * cloning the input arrays\n   * @param {number|boolean|Array} value\n   * @returns {number|boolean|Array}\n   */\n  function convertValuesToNumbers(value) {\n    const esType = esTypeOf(value);\n    switch (esType) {\n      case 'array':\n        return value.map(convertValuesToNumbers);\n      case 'undefined':\n      case 'null':\n        return (value ? 1 : 0);\n      case 'boolean':\n      case 'number':\n        return value;\n    }\n    throw new Error(`Cannot convert ${esType} to number`);\n  }\n\n  /**\n   * Main API\n   */\n  class Converter {\n\n    /**\n     * Checks the given value for conversion errors and returns the error\n     * @param {string|number|Array} value\n     * @returns {undefined|Error}\n     */\n    getInvalidTypeError(value) {\n      try {\n        value = convertValuesToNumbers(value);\n        (esTypeOf(value) === 'array') ?\n          findValueTypeFromValues(value) :\n          findValueTypeFromValue(value);\n        return;\n      } catch (err) {\n        return err;\n      }\n    }\n\n    /**\n     * Convert an array, boolean or number into a string binary representation\n     * @param {number|boolean|Array} value\n     * @param {string} [typeName] To force an internal data type for testing\n     * @param {boolean} [logStats] Console logs statistics on type use\n     * @returns {string}\n     */\n    valueToBinary(value, typeName = null, logStats = null) {\n      this.clearLog();\n      const hasInitialType = (typeof typeName === 'string');\n      value = convertValuesToNumbers(value);\n      const valueType = hasInitialType ?\n        findValueTypeFromName(typeName) :\n        findValueTypeFromValue(value);\n      if (!valueType) {\n        throw new Error(`Could not find value type from ${hasInitialType ? `name ${typeName}` : `value ${value}`} accepts: ${Object.keys(ValueTypes.nameIndex)}. Leave typeName empty for auto-detect.`);\n      }\n      const binary = valueType.valueToBinary(value, logStats);\n      if (!hasInitialType) {\n        binary.unshift(valueType.binaryType);\n      }\n      if (logStats) {\n        this.printLog();\n      }\n      return binary;\n    }\n\n    /**\n     * Convert the string binary representation back into an array, boolean or number\n     * @param {string} binary A string binary representation of data from valueToBinary\n     * @param {string} [typeName] To force an internal data type for testing\n     * @returns {number|boolean|Array}\n     */\n    valueFromBinary(binary, typeName = null) {\n      binary = _.flatten(binary).join('');\n      const hasInitialType = typeof typeName === 'string';\n      let valueType;\n      if (hasInitialType) {\n        valueType = findValueTypeFromName(typeName);\n      } else {\n        [valueType, binary] = shiftValueTypeFromBinary(binary);\n      }\n      if (!valueType || !(valueType instanceof AbstractValueType)) {\n        throw new Error(`Could not find value type from ${hasInitialType ? `name \"${typeName}\"` : `binary \"${binary.slice(0, 8)}\"...`} accepts: ${Object.keys(ValueTypes.nameIndex)}. Leave typeName empty for auto-detect.`);\n      }\n      const [value] = valueType.shiftValueFromBinary(binary);\n      return value;\n    }\n\n    /**\n     * Clears any previous logs\n     */\n    clearLog() {\n      logs.usedTypes = {};\n      logs.typeLengths = {};\n      logs.binarySamples = {};\n    }\n\n    /**\n     * Prints logs from last run\n     */\n    printLog() {\n      console.log('Types used count:', logs.usedTypes);\n      console.log('Type lengths used count:', logs.typeLengths);\n      console.log('Type binary samples:', logs.binarySamples);\n    }\n\n    /**\n     * Convert an array, boolean or number into a base64 string\n     * @param {number|boolean|Array} value\n     * @param {string} [typeName] To force an internal data type for testing\n     * @param {boolean} [logStats] Console logs statistics on type use\n     * @returns {string}\n     */\n    serialize(value, typeName = null, logStats = null) {\n      const binary = this.valueToBinary(value, typeName, logStats);\n      const base64 = binaryToBase64(binary);\n      return base64;\n    }\n\n    /**\n     * Convert the base64 string back into an array, boolean or number\n     * @param {string} base64 A string representation of data from serialize\n     * @param {string} [typeName] To force an internal data type for testing\n     * @returns {number|boolean|Array}\n     */\n    deserialize(base64, typeName = null) {\n      const binary = base64ToBinary(base64);\n      const value = this.valueFromBinary(binary, typeName);\n      return value;\n    }\n\n  }\n\n  return (window.SCORMSuspendData = new Converter());\n});\n","define([\n  'core/js/adapt',\n  './SCORMSuspendData'\n], function (Adapt, SCORMSuspendData) {\n\n  class ComponentSerializer extends Backbone.Controller {\n\n    initialize(trackingIdType) {\n      this.trackingIdType = trackingIdType;\n    }\n\n    serialize(shouldStoreResponses, shouldStoreAttempts) {\n      if (shouldStoreAttempts && !shouldStoreResponses) {\n        Adapt.log.warnOnce(`SPOOR configuration error, cannot use '_shouldStoreAttempts' without '_shouldStoreResponses'`);\n      }\n      const states = [];\n      Adapt.data.each(model => {\n        if (model.get('_type') !== this.trackingIdType) {\n          return;\n        }\n        const trackingId = model.get('_trackingId');\n        if (typeof trackingId === 'undefined') {\n          return;\n        }\n        const isContainer = model.hasManagedChildren;\n        const components = isContainer ?\n          model.findDescendantModels('component') :\n          [model];\n        components.forEach((component, index) => {\n          if (!shouldStoreResponses) {\n            // Store only component completion\n            const state = [\n              [ trackingId, index ],\n              [ component.get('_isComplete') ]\n            ];\n            states.push(state);\n            return;\n          }\n          let modelState = null;\n          if (!component.getAttemptState) {\n            // Legacy components without getAttemptState API\n            modelState = component.get('_isQuestionType') ?\n              [\n                [\n                  component.get('_score') || 0,\n                  component.get('_attemptsLeft') || 0\n                ],\n                [\n                  component.get('_isComplete') || false,\n                  component.get('_isInteractionComplete') || false,\n                  component.get('_isSubmitted') || false,\n                  component.get('_isCorrect') || false\n                ],\n                [\n                  component.get('_userAnswer')\n                ]\n              ] :\n              [\n                [],\n                [\n                  component.get('_isComplete') || false,\n                  component.get('_isInteractionComplete') || false\n                ],\n                [\n                  component.get('_userAnswer')\n                ]\n              ];\n          } else {\n            modelState = component.getAttemptState();\n          }\n          // Correct the _userAnswer array as it is sometimes not an array\n          // incomplete components are undefined and slider is a number\n          const userAnswer = modelState[2][0];\n          const hasUserAnswer = typeof userAnswer !== 'undefined' && userAnswer !== null;\n          const isUserAnswerArray = Array.isArray(userAnswer);\n          if (!hasUserAnswer) {\n            modelState[2][0] = [];\n          } else if (!isUserAnswerArray) {\n            modelState[2][0] = [modelState[2][0]];\n          }\n          // _attemptStates is empty if not a question or not attempted\n          const attemptStates = component.get('_attemptStates');\n          const hasAttemptStates = shouldStoreAttempts && Array.isArray(attemptStates);\n          if (hasAttemptStates) {\n            modelState[2][1] = attemptStates;\n          }\n          // Create the restoration state object\n          const state = [\n            [ trackingId, index ],\n            [ hasUserAnswer, isUserAnswerArray, hasAttemptStates ],\n            modelState\n          ];\n          states.push(state);\n        });\n      });\n      return SCORMSuspendData.serialize(states);\n    }\n\n    deserialize(binary) {\n      // Build a table of models and their tracking ids\n      const trackingIdMap = Adapt.data.toArray().reduce((trackingIdMap, model) => {\n        const trackingId = model.get('_trackingId');\n        if (typeof trackingId === 'undefined') return trackingIdMap;\n        trackingIdMap[trackingId] = model;\n        return trackingIdMap;\n      }, {});\n      const states = SCORMSuspendData.deserialize(binary);\n      // Derive the storage settings of the data from the states array, this will allow changes\n      // in the spoor configuration for _shouldStoreResponses and _shouldStoreAttempts\n      // to be non-breaking\n      const shouldStoreResponses = (states[0].length > 2);\n      states.forEach(state => {\n        const [ trackingId, index ] = state[0];\n        const model = trackingIdMap[trackingId];\n        if (!model) {\n          // Ignore any recently missing tracking ids if a course has been updated\n          return;\n        }\n        const isContainer = model.hasManagedChildren;\n        const components = isContainer ?\n          model.findDescendantModels('component') :\n          [model];\n        const component = components[index];\n        if (!shouldStoreResponses) {\n          // Restore only component completion\n          const isComplete = state[1][0];\n          component.set('_isComplete', isComplete);\n          return;\n        }\n        const [ hasUserAnswer, isUserAnswerArray, hasAttemptStates ] = state[1];\n        const modelState = state[2];\n        // Correct the _userAnswer value if it wasn't an array originally\n        if (!hasUserAnswer) {\n          modelState[2][0] = null;\n        } else if (!isUserAnswerArray) {\n          modelState[2][0] = modelState[2][0][0];\n        }\n        // Allow empty _attemptStates\n        if (!hasAttemptStates) {\n          modelState[2][1] = null;\n        }\n        if (component.setAttemptObject) {\n          // Restore component state with setAttemptObject API\n          component.set('_attemptStates', modelState[2][1]);\n          const attemptObject = component.getAttemptObject(modelState);\n          component.setAttemptObject(attemptObject, false);\n          return;\n        }\n        // Legacy components without getAttemptState\n        component.get('_isQuestionType') ?\n          component.set({\n            _score: modelState[0][0],\n            _attemptsLeft: modelState[0][1],\n            _isComplete: modelState[1][0],\n            _isInteractionComplete: modelState[1][1],\n            _isSubmitted: modelState[1][2],\n            _isCorrect: modelState[1][3],\n            _userAnswer: modelState[2][0],\n            _attemptStates: modelState[2][1]\n          }) :\n          component.set({\n            _isComplete: modelState[1][0],\n            _isInteractionComplete: modelState[1][1],\n            _userAnswer: modelState[2][0],\n            _attemptStates: modelState[2][1]\n          });\n      });\n    }\n\n  }\n\n  return ComponentSerializer;\n\n});\n","define([\n  'core/js/adapt',\n  './scorm/wrapper',\n  'core/js/enums/completionStateEnum',\n  './serializers/ComponentSerializer',\n  './serializers/SCORMSuspendData'\n], function(Adapt, ScormWrapper, COMPLETION_STATE, ComponentSerializer, SCORMSuspendData) {\n\n  class StatefulSession extends Backbone.Controller {\n\n    initialize() {\n      _.bindAll(this, 'beginSession', 'onVisibilityChange', 'endSession');\n      this.scorm = ScormWrapper.getInstance();\n      this._trackingIdType = 'block';\n      this._componentSerializer = null;\n      this._shouldStoreResponses = true;\n      this._shouldStoreAttempts = false;\n      this._shouldRecordInteractions = true;\n      this.beginSession();\n    }\n\n    beginSession() {\n      this.listenTo(Adapt, 'app:dataReady', this.restoreSession);\n      this._trackingIdType = Adapt.build.get('trackingIdType') || 'block';\n      this._componentSerializer = new ComponentSerializer(this._trackingIdType);\n      // suppress SCORM errors if 'nolmserrors' is found in the querystring\n      if (window.location.search.indexOf('nolmserrors') !== -1) {\n        this.scorm.suppressErrors = true;\n      }\n      const config = Adapt.spoor.config;\n      if (!config) return;\n      const tracking = config._tracking;\n      this._shouldStoreResponses = (tracking && tracking._shouldStoreResponses) || false;\n      this._shouldStoreAttempts = (tracking && tracking._shouldStoreAttempts) || false;\n      // Default should be to record interactions, so only avoid doing that if\n      // _shouldRecordInteractions is set to false\n      if (tracking && tracking._shouldRecordInteractions === false) {\n        this._shouldRecordInteractions = false;\n      }\n      const settings = config._advancedSettings;\n      if (!settings) {\n        // force use of SCORM 1.2 by default - some LMSes (SABA/Kallidus for instance)\n        // present both APIs to the SCO and, if given the choice, the pipwerks\n        // code will automatically select the SCORM 2004 API - which can lead to\n        // unexpected behaviour.\n        this.scorm.setVersion('1.2');\n        this.scorm.initialize();\n        return;\n      }\n      if (settings._showDebugWindow) {\n        this.scorm.showDebugWindow();\n      }\n      this.scorm.setVersion(settings._scormVersion || '1.2');\n      if (_.isBoolean(settings._suppressErrors)) {\n        this.scorm.suppressErrors = settings._suppressErrors;\n      }\n      if (_.isBoolean(settings._commitOnStatusChange)) {\n        this.scorm.commitOnStatusChange = settings._commitOnStatusChange;\n      }\n      if (_.isBoolean(settings._commitOnAnyChange)) {\n        this.scorm.commitOnAnyChange = settings._commitOnAnyChange;\n      }\n      if (_.isFinite(settings._timedCommitFrequency)) {\n        this.scorm.timedCommitFrequency = settings._timedCommitFrequency;\n      }\n      if (_.isFinite(settings._maxCommitRetries)) {\n        this.scorm.maxCommitRetries = settings._maxCommitRetries;\n      }\n      if (_.isFinite(settings._commitRetryDelay)) {\n        this.scorm.commitRetryDelay = settings._commitRetryDelay;\n      }\n      if ('_exitStateIfIncomplete' in settings) {\n        this.scorm.exitStateIfIncomplete = settings._exitStateIfIncomplete;\n      }\n      if ('_exitStateIfComplete' in settings) {\n        this.scorm.exitStateIfComplete = settings._exitStateIfComplete;\n      }\n      this.scorm.initialize();\n    }\n\n    restoreSession() {\n      this.setupLearnerInfo();\n      this.restoreSessionState();\n      // defer call because AdaptModel.check*Status functions are asynchronous\n      _.defer(this.setupEventListeners.bind(this));\n    }\n\n    setupLearnerInfo() {\n      // Replace the hard-coded _learnerInfo data in _globals with the actual data\n      // from the LMS\n      // If the course has been published from the AT, the _learnerInfo object\n      // won't exist so we'll need to create it\n      const globals = Adapt.course.get('_globals');\n      if (!globals._learnerInfo) {\n        globals._learnerInfo = {};\n      }\n      Object.assign(globals._learnerInfo, Adapt.offlineStorage.get('learnerinfo'));\n    }\n\n    restoreSessionState() {\n      const sessionPairs = Adapt.offlineStorage.get();\n      const hasNoPairs = !Object.keys(sessionPairs).length;\n      if (hasNoPairs) return;\n      if (sessionPairs.c) {\n        const [ _isComplete, _isAssessmentPassed ] = SCORMSuspendData.deserialize(sessionPairs.c);\n        Adapt.course.set({\n          _isComplete,\n          _isAssessmentPassed\n        });\n      }\n      if (sessionPairs.q) {\n        this._componentSerializer.deserialize(sessionPairs.q);\n      }\n    }\n\n    setupEventListeners() {\n      const debouncedSaveSession = _.debounce(this.saveSessionState.bind(this), 1);\n      this.listenTo(Adapt.data, 'change:_isComplete', debouncedSaveSession);\n      if (this._shouldStoreResponses) {\n        this.listenTo(Adapt.data, 'change:_isSubmitted change:_userAnswer', debouncedSaveSession);\n      }\n      this.listenTo(Adapt, {\n        'app:languageChanged': this.onLanguageChanged,\n        'questionView:recordInteraction': this.onQuestionRecordInteraction,\n        'assessment:complete': this.onAssessmentComplete,\n        'tracking:complete': this.onTrackingComplete\n      });\n      const config = Adapt.spoor.config;\n      const advancedSettings = config._advancedSettings;\n      const shouldCommitOnVisibilityChange = (!advancedSettings ||\n          advancedSettings._commitOnVisibilityChangeHidden !== false);\n      if (shouldCommitOnVisibilityChange) {\n        document.addEventListener('visibilitychange', this.onVisibilityChange);\n      }\n      $(window).on('beforeunload unload', this.endSession);\n    }\n\n    saveSessionState() {\n      const courseState = SCORMSuspendData.serialize([\n        Boolean(Adapt.course.get('_isComplete')),\n        Boolean(Adapt.course.get('_isAssessmentPassed'))\n      ]);\n      const componentStates = this._componentSerializer.serialize(this._shouldStoreResponses, this._shouldStoreAttempts);\n      const sessionPairs = {\n        'c': courseState,\n        'q': componentStates\n      };\n      Adapt.offlineStorage.set(sessionPairs);\n      this.printCompletionInformation(sessionPairs);\n    }\n\n    printCompletionInformation(suspendData) {\n      if (typeof suspendData === 'string') {\n        // In-case LMS data is passed as a string\n        suspendData = JSON.parse(suspendData);\n      }\n      const courseState = SCORMSuspendData.deserialize(suspendData.c);\n      const courseComplete = courseState[0];\n      const assessmentPassed = courseState[1];\n      const trackingIdModels = Adapt.data.filter(model => model.get('_type') === this._trackingIdType && model.has('_trackingId'));\n      const trackingIds = trackingIdModels.map(model => model.get('_trackingId'));\n      if (!trackingIds.length) {\n        Adapt.log.info(`course._isComplete: ${courseComplete}, course._isAssessmentPassed: ${assessmentPassed}, ${this._trackingIdType} completion: no tracking ids found`);\n        return;\n      }\n      const data = SCORMSuspendData.deserialize(suspendData.q);\n      const max = Math.max(...data.map(item => item[0][0]));\n      const completionString = data.reduce((markers, item) => {\n        const trackingId = item[0][0];\n        const mark = item[2][1][0] ? '1' : '0';\n        markers[trackingId] = (markers[trackingId] === '-' || markers[trackingId] === '1') ?\n          mark :\n          '0';\n        return markers;\n      }, (new Array(max + 1).join('-').split(''))).join('');\n      Adapt.log.info(`course._isComplete: ${courseComplete}, course._isAssessmentPassed: ${assessmentPassed}, ${this._trackingIdType} completion: ${completionString}`);\n    }\n\n    onLanguageChanged() {\n      // when the user switches language, we need to:\n      // - reattach the event listeners as the language change triggers a reload of\n      //   the json, which will create brand new collections\n      // - get and save a fresh copy of the session state. as the json has been reloaded,\n      //   the blocks completion data will be reset (the user is warned that this will\n      //   happen by the language picker extension)\n      // - check to see if the config requires that the lesson_status be reset to\n      //   'incomplete'\n      const config = Adapt.spoor.config;\n      this.removeEventListeners();\n      this.setupEventListeners();\n      this.saveSessionState();\n      if (config && config._reporting && config._reporting._resetStatusOnLanguageChange === true) {\n        Adapt.offlineStorage.set('status', 'incomplete');\n      }\n    }\n\n    onVisibilityChange() {\n      if (document.visibilityState === 'hidden') this.scorm.commit();\n    }\n\n    onQuestionRecordInteraction(questionView) {\n      if (!this._shouldRecordInteractions) return;\n      const responseType = questionView.getResponseType();\n      // If responseType doesn't contain any data, assume that the question\n      // component hasn't been set up for cmi.interaction tracking\n      if (_.isEmpty(responseType)) return;\n      const id = questionView.model.get('_id');\n      const response = questionView.getResponse();\n      const result = questionView.isCorrect();\n      const latency = questionView.getLatency();\n      Adapt.offlineStorage.set('interaction', id, response, result, latency, responseType);\n    }\n\n    onAssessmentComplete(stateModel) {\n      const config = Adapt.spoor.config;\n      Adapt.course.set('_isAssessmentPassed', stateModel.isPass);\n      this.saveSessionState();\n      const shouldSubmitScore = (config && config._tracking && config._tracking._shouldSubmitScore);\n      if (!shouldSubmitScore) return;\n      const scoreArgs = stateModel.isPercentageBased ?\n        [ stateModel.scoreAsPercent, 0, 100 ] :\n        [ stateModel.score, 0, stateModel.maxScore ];\n      Adapt.offlineStorage.set('score', ...scoreArgs);\n    }\n\n    onTrackingComplete(completionData) {\n      const config = Adapt.spoor.config;\n      this.saveSessionState();\n      let completionStatus = completionData.status.asLowerCase;\n      // The config allows the user to override the completion state.\n      switch (completionData.status) {\n        case COMPLETION_STATE.COMPLETED:\n        case COMPLETION_STATE.PASSED: {\n          if (!config || !config._reporting || !config._reporting._onTrackingCriteriaMet) {\n            Adapt.log.warn(`No value defined for '_onTrackingCriteriaMet', so defaulting to '${completionStatus}'`);\n          } else {\n            completionStatus = config._reporting._onTrackingCriteriaMet;\n          }\n\n          break;\n        }\n        case COMPLETION_STATE.FAILED: {\n          if (!config || !config._reporting || !config._reporting._onAssessmentFailure) {\n            Adapt.log.warn(`No value defined for '_onAssessmentFailure', so defaulting to '${completionStatus}'`);\n          } else {\n            completionStatus = config._reporting._onAssessmentFailure;\n          }\n        }\n      }\n      Adapt.offlineStorage.set('status', completionStatus);\n    }\n\n    endSession() {\n      if (!this.scorm.finishCalled) {\n        this.scorm.finish();\n      }\n      this.removeEventListeners();\n    }\n\n    removeEventListeners() {\n      $(window).off('beforeunload unload', this.endSession);\n      document.removeEventListener('visibilitychange', this.onVisibilityChange);\n      this.stopListening();\n    }\n\n  }\n\n  return StatefulSession;\n\n});\n","define([\n  'core/js/adapt',\n  './scorm/wrapper',\n  './serializers/SCORMSuspendData',\n  'core/js/offlineStorage'\n], function(Adapt, ScormWrapper, SCORMSuspendData) {\n\n  /**\n   * SCORM handler for Adapt.offlineStorage interface.\n   */\n  class OfflineStorage extends Backbone.Controller {\n\n    initialize(statefulSession) {\n      this.scorm = ScormWrapper.getInstance();\n      this.statefulSession = statefulSession;\n      this.temporaryStore = {};\n      this.suspendDataStore = {};\n      this.suspendDataRestored = false;\n      Adapt.offlineStorage.initialize(this);\n    }\n\n    save() {\n      this.statefulSession.saveSessionState();\n      this.scorm.commit();\n    }\n\n    serialize(...args) {\n      return SCORMSuspendData.serialize(...args);\n    }\n\n    deserialize(...args) {\n      return SCORMSuspendData.deserialize(...args);\n    }\n\n    get(name) {\n      if (name === undefined) {\n        // If not connected return just temporary store.\n        if (this.useTemporaryStore()) return this.temporaryStore;\n\n        // Get all values as a combined object\n        this.suspendDataStore = this.getCustomStates();\n\n        const data = Object.assign(_.clone(this.suspendDataStore), {\n          location: this.scorm.getLessonLocation(),\n          score: this.scorm.getScore(),\n          status: this.scorm.getStatus(),\n          student: this.scorm.getStudentName(),\n          learnerInfo: this.getLearnerInfo()\n        });\n\n        this.suspendDataRestored = true;\n\n        return data;\n      }\n\n      // If not connected return just temporary store value.\n      if (this.useTemporaryStore()) return this.temporaryStore[name];\n\n      // Get by name\n      let courseState;\n      switch (name.toLowerCase()) {\n        case 'location':\n          return this.scorm.getLessonLocation();\n        case 'score':\n          return this.scorm.getScore();\n        case 'status':\n          return this.scorm.getStatus();\n        case 'student':\n          // for backwards-compatibility. learnerInfo is preferred now and will\n          // give you more information\n          return this.scorm.getStudentName();\n        case 'learnerinfo':\n          return this.getLearnerInfo();\n        case 'coursestate':\n          courseState = this.getCustomState('c');\n          const stateArray = (courseState && SCORMSuspendData.deserialize(courseState)) || [];\n          return {\n            _isCourseComplete: Boolean(stateArray.slice(0, 1).map(Number)[0]),\n            _isAssessmentPassed: Boolean(stateArray.slice(1, 2).map(Number)[0]),\n            completion: stateArray.slice(2).map(Number).map(String).join('') || ''\n          };\n        case 'completion':\n          courseState = this.getCustomState('c');\n          return (courseState && SCORMSuspendData\n            .deserialize(courseState)\n            .slice(2)\n            .map(Number)\n            .map(String)\n            .join('')) || '';\n        case '_iscoursecomplete':\n          courseState = this.getCustomState('c');\n          return Boolean(courseState && SCORMSuspendData\n            .deserialize(courseState)\n            .slice(0, 1)\n            .map(Number)[0]);\n        case '_isassessmentpassed':\n          courseState = this.getCustomState('c');\n          return Boolean(courseState && SCORMSuspendData\n            .deserialize(courseState)\n            .slice(1, 2)\n            .map(Number)[0]);\n        case 'questions':\n          const questionsState = this.getCustomState('q');\n          return questionsState || '';\n        default:\n          return this.getCustomState(name);\n      }\n    }\n\n    set(name, value) {\n      // Convert arguments to array and drop the 'name' parameter\n      const args = [...arguments].slice(1);\n      const isObject = typeof name === 'object';\n\n      if (isObject) {\n        value = name;\n        name = 'suspendData';\n      }\n\n      if (this.useTemporaryStore()) {\n        if (isObject) {\n          Object.assign(this.temporaryStore, value);\n        } else {\n          this.temporaryStore[name] = value;\n        }\n\n        return true;\n      }\n\n      switch (name.toLowerCase()) {\n        case 'interaction':\n          return this.scorm.recordInteraction(...args);\n        case 'location':\n          return this.scorm.setLessonLocation(...args);\n        case 'score':\n          return this.scorm.setScore(...args);\n        case 'status':\n          return this.scorm.setStatus(...args);\n        case 'student':\n        case 'learnerinfo':\n          return false;// these properties are read-only\n        case 'lang':\n          this.scorm.setLanguage(value);\n          // fall-through so that lang gets stored in suspend_data as well:\n          // because in SCORM 1.2 cmi.student_preference.language is an optional\n          // data element so we can't rely on the LMS having support for it.\n          // If it does support it we may as well save the user's choice there\n          // purely for reporting purposes\n          break;\n        case 'suspenddata':\n          break;\n      }\n\n      if (isObject) {\n        Object.assign(this.suspendDataStore, value);\n      } else {\n        this.suspendDataStore[name] = value;\n      }\n\n      const dataAsString = JSON.stringify(this.suspendDataStore);\n      return (this.suspendDataRestored) ? this.scorm.setSuspendData(dataAsString) : false;\n    }\n\n    getCustomStates() {\n      const isSuspendDataStoreEmpty = _.isEmpty(this.suspendDataStore);\n      if (!isSuspendDataStoreEmpty && this.suspendDataRestored) {\n        return _.clone(this.suspendDataStore);\n      }\n\n      const dataAsString = this.scorm.getSuspendData();\n      if (dataAsString === '' || dataAsString === ' ' || dataAsString === undefined) {\n        return {};\n      }\n\n      let dataAsJSON = JSON.parse(dataAsString);\n      if (!isSuspendDataStoreEmpty && !this.suspendDataRestored) {\n        Object.assign(dataAsJSON, this.suspendDataStore);\n      }\n      return dataAsJSON;\n    }\n\n    getCustomState(name) {\n      const dataAsJSON = this.getCustomStates();\n      return dataAsJSON[name];\n    }\n\n    useTemporaryStore() {\n      const cfg = Adapt.config.get('_spoor');\n\n      if (!this.scorm.lmsConnected || (cfg && cfg._isEnabled === false)) return true;\n      return false;\n    }\n\n    /**\n     * Returns an object with the properties:\n     * - id (cmi.core.student_id)\n     * - name (cmi.core.student_name - which is usually in the format\n     *    'Lastname, Firstname' or 'Firstname Lastname' - but it sometimes doesn't\n     *    have the space after the comma\n     *   )\n     * - firstname\n     * - lastname\n     */\n    getLearnerInfo() {\n      const id = this.scorm.getStudentId();\n\n      let name = this.scorm.getStudentName();\n      let firstname = '';\n      let lastname = '';\n\n      let hasName = (name && name !== 'undefined');\n      const isNameCommaSeparated = hasName && name.includes(',');\n      const isNameSpaceSeparated = hasName && name.includes(' ');\n\n      // Name must have either a comma or a space\n      hasName = hasName && (isNameCommaSeparated || isNameSpaceSeparated);\n\n      if (!hasName) {\n        console.log(`SPOOR: LMS learner_name not in 'lastname, firstname' or 'firstname lastname' format`);\n        return { id, name, firstname, lastname };\n      }\n\n      const separator = isNameCommaSeparated ? ',' : ' ';\n      const nameParts = name.split(separator);\n      if (isNameCommaSeparated) {\n        // Assume lastname appears before the comma\n        nameParts.reverse();\n      }\n      [ firstname, lastname ] = nameParts.map(part => part.trim());\n      name = `${firstname} ${lastname}`;\n      return { id, name, firstname, lastname };\n    }\n\n  }\n\n  return OfflineStorage;\n\n});\n","define([\n  'core/js/adapt',\n  './scorm/wrapper',\n  './adapt-stateful-session',\n  './adapt-offlineStorage-scorm'\n], function(Adapt, ScormWrapper, StatefulSession, OfflineStorage) {\n\n  class Spoor extends Backbone.Controller {\n\n    initialize() {\n      this.config = null;\n      this.scorm = ScormWrapper.getInstance();\n      this.listenToOnce(Adapt, 'offlineStorage:prepare', this._prepare);\n    }\n\n    _prepare() {\n      this.config = Adapt.config.get('_spoor');\n      if (!this.isEnabled) {\n        Adapt.offlineStorage.setReadyStatus();\n        return;\n      }\n      this.statefulSession = new StatefulSession();\n      this.offlineStorage = new OfflineStorage(this.statefulSession);\n      // force offlineStorage-scorm to initialise suspendDataStore - this allows\n      // us to do things like store the user's chosen language before the rest\n      // of the course data loads\n      Adapt.offlineStorage.get();\n      Adapt.offlineStorage.setReadyStatus();\n      // setup debug window keyboard shortcut\n      require(['libraries/jquery.keycombo'], function() {\n        // listen for user holding 'd', 'e', 'v' keys together\n        $.onKeyCombo([68, 69, 86], function() {\n          Adapt.spoor.scorm.showDebugWindow();\n        });\n      });\n    }\n\n    get isEnabled() {\n      return (this.config && this.config._isEnabled);\n    }\n\n  }\n\n  Adapt.spoor = new Spoor();\n\n  return Spoor;\n\n});\n","define([\n  'core/js/adapt'\n], function(Adapt) {\n\n  var TrickleView = Backbone.View.extend({\n\n    isSteplocked: false,\n\n    completionAttribute : null,\n\n    initialize: function(options) {\n      this.setupEventListeners();\n    },\n\n    setupEventListeners: function() {\n      var AdaptEvents = {\n        \"trickle:kill\": this.onKill,\n        \"remove\": this.onRemove\n      };\n\n      this.onPreRender(this);\n\n      AdaptEvents[this.model.get(\"_type\") + \"View:postRender\"] = this.onPostRender;\n      this.listenTo(Adapt, AdaptEvents);\n\n      this.on(\"steplock\", this.onStepLock);\n      this.on(\"stepunlock\", this.onStepUnlock);\n    },\n\n    onPreRender: function(view) {\n      this.completionAttribute = Adapt.trickle.getCompletionAttribute();\n      if (!this.isElementEnabled()) return;\n\n      Adapt.trigger(\"trickle:preRender\", this);\n    },\n\n    onPostRender: function(view) {\n      if (view.model.get(\"_id\") !== this.model.get(\"_id\")) return;\n      if (!this.isElementEnabled()) return;\n\n      Adapt.trigger(\"trickle:postRender\", this);\n    },\n\n    isElementEnabled: function() {\n      var trickle = Adapt.trickle.getModelConfig(this.model);\n      if (!trickle) return false;\n\n      if (this.model.get(this.completionAttribute)) return false;\n\n      var isArticleWithOnChildren = (this.model.get(\"_type\") === \"article\" && trickle._onChildren);\n      if (isArticleWithOnChildren) {\n        return false;\n      }\n\n      if (trickle._isEnabled === true) return true;\n      return false;\n    },\n\n    onStepLock: function() {\n      if (!this.isElementEnabled()) {\n        this.continueToNext();\n        return;\n      }\n\n      var trickle = Adapt.trickle.getModelConfig(this.model);\n      var isSteplocking = (trickle._stepLocking && trickle._stepLocking._isEnabled);\n      if (!isSteplocking) {\n        this.continueToNext();\n        return;\n      }\n\n      Adapt.trigger(\"trickle:steplock\", this);\n      this.isSteplocked = true;\n    },\n\n    continueToNext: function() {\n      Adapt.trigger(\"trickle:continue\", this);\n    },\n\n\n    onStepUnlock: function() {\n      if (!this.isSteplocked) return;\n      this.isSteplocked = false;\n      Adapt.trigger(\"trickle:stepunlock\", this);\n    },\n\n    onKill: function() {\n      this.detachFromElement();\n    },\n\n    onRemove: function() {\n      this.detachFromElement();\n    },\n\n    detachFromElement: function() {\n      this.undelegateEvents();\n      this.stopListening();\n      this.model = null;\n      this.articleModel = null;\n      this.$el = null;\n      this.el = null;\n    }\n\n  });\n\n  return TrickleView;\n\n});\n","define([\n  'core/js/adapt',\n  './trickleView'\n], function(Adapt, TrickleView) {\n\n  var PageView = Backbone.View.extend({\n\n    currentDescendantIndex: 0,\n    currentLocksOnDescendant: 0,\n    currentDescendant: null,\n\n    initialize: function(options) {\n      if (!this.isPageEnabled()) {\n        return this.detachFromPage();\n      }\n      this.setupDescendants();\n      if (!this.haveDescendantsGotTrickle()) {\n        return this.detachFromPage();\n      }\n      this.addClassToHtml();\n      this.setupEventListeners();\n    },\n\n    isPageEnabled: function() {\n      var trickleConfig = Adapt.trickle.getModelConfig(this.model);\n      if (trickleConfig && trickleConfig._isEnabled === false) return false;\n      return true;\n    },\n\n    setupDescendants: function() {\n      this.currentDescendant = null;\n      this.descendantViews = {};\n      this.getDescendants();\n      Adapt.trigger(\"trickle:descendants\", this);\n    },\n\n    descendantsChildFirst: null,\n    descendantsParentFirst: null,\n    descendantViews: null,\n\n    getDescendants: function() {\n      this.descendantsChildFirst = this.model.getAllDescendantModels();\n      this.descendantsParentFirst = this.model.getAllDescendantModels(true);\n\n      // if some descendants flip between _isAvailable true/false they\n      // must have their defaults set before the filter is applied\n      this.setDescendantsTrickleDefaults();\n\n      this.descendantsChildFirst = this.filterComponents(this.descendantsChildFirst);\n      this.descendantsParentFirst = this.filterComponents(this.descendantsParentFirst);\n\n    },\n\n    filterComponents: function(descendants) {\n      return descendants.filter(function(descendant) {\n        if (descendant.get(\"_type\") === \"component\") return false;\n        if (!descendant.get(\"_isAvailable\")) return false;\n        return true;\n      });\n    },\n\n    setDescendantsTrickleDefaults: function() {\n      // use parent first as likely to get to article\n      this.descendantsParentFirst.forEach(function(descendant) {\n        var trickle = Adapt.trickle.getModelConfig(descendant);\n        if (!trickle) {\n          return;\n        }\n\n        // check if trickle is configures on descendant\n        // NOTE: Removed for banked assessments\n        // var isTrickleConfigured = descendant.get(\"_isTrickleConfigured\");\n        // if (isTrickleConfigured) return;\n\n        // setup steplocking defaults\n        trickle._stepLocking = _.extend({\n          \"_isEnabled\": true, //(default=true)\n          \"_isCompletionRequired\": true, //(default=true)\n          \"_isLockedOnRevisit\": false //(default=false)\n        }, trickle._stepLocking);\n\n        // setup main trickle defaults\n        trickle = _.extend({\n          \"_isEnabled\": true, //(default=true)\n          \"_autoScroll\": true, //(default=true)\n          \"_scrollDuration\": 500, //(default=500)\n          \"_onChildren\": true, //(default=true)\n          \"_scrollTo\": \"@block +1\" //(default=\"@block +1\")\n        }, trickle);\n\n        Adapt.trickle.setModelConfig(descendant, trickle);\n\n        //check article \"onChildren\" rule\n        if (trickle._onChildren &&\n          descendant.get(\"_type\") === \"article\") {\n          this.setupArticleOnChildren(descendant, trickle);\n        }\n\n        // set descendant trickle as configured\n        descendant.set(\"_isTrickleConfigured\", true);\n\n      }.bind(this));\n    },\n\n    setupArticleOnChildren: function(articleModel, articleTrickleConfig) {\n      // set trickle on all blocks, using article config with block overrides\n      var articleBlocks = articleModel.getChildren();\n\n      articleBlocks.each(function(blockModel, index) {\n        var blockTrickleConfig = Adapt.trickle.getModelConfig(blockModel);\n\n        // overlay block trickle on article trickle\n        // this allows values to carry through from the article to the block\n        // retains any value overriden in the block\n        for (var k in blockTrickleConfig) {\n          //handle nested objects to one level\n          if (typeof blockTrickleConfig[k] === \"object\") {\n            blockTrickleConfig[k] = _.extend({}, articleTrickleConfig[k], blockTrickleConfig[k]);\n          }\n        }\n\n        blockTrickleConfig = _.extend({}, articleTrickleConfig, blockTrickleConfig);\n\n\n        // setup start/final config\n        if (articleBlocks.length === index+1) {\n          blockTrickleConfig._isFinal = true;\n        }\n        if (index === 0) {\n          blockTrickleConfig._isStart = true;\n        }\n\n        Adapt.trickle.setModelConfig(blockModel, blockTrickleConfig);\n      });\n\n    },\n\n    haveDescendantsGotTrickle: function() {\n      return this.descendantsChildFirst.some(function(descendant) {\n        var trickle = Adapt.trickle.getModelConfig(descendant);\n        return trickle && trickle._isEnabled === true;\n      });\n    },\n\n    addClassToHtml: function() {\n      $(\"html\").addClass(\"trickle\");\n    },\n\n    setupEventListeners: function() {\n      this.listenTo(Adapt, {\n        \"remove\": this.onRemove,\n\n        \"articleView:preRender\": this.onDescendantPreRender,\n        \"blockView:preRender\": this.onDescendantPreRender,\n\n        \"trickle:unwait\": this.onUnwait,\n        \"trickle:wait\": this.onWait,\n        \"trickle:continue\": this.onContinue,\n        \"trickle:skip\": this.onSkip,\n\n        \"trickle:kill\": this.onKill\n      });\n      this.listenToOnce(this.model, \"change:_isReady\", this.onPageReady);\n    },\n\n    onDescendantPreRender: function(view) {\n      // ignore components\n      if (view.model.get(\"_type\") === \"component\") return;\n\n      var descendantView = new TrickleView({\n        model: view.model,\n        el: view.el\n      });\n      this.descendantViews[view.model.get(\"_id\")] = descendantView;\n    },\n\n    // trickle lifecycle\n\n    onPageReady: function(model, value) {\n      if (!value) return;\n\n      this.currentDescendant = null;\n\n      Adapt.trigger(\"trickle:started\");\n      this.gotoNextDescendant();\n    },\n\n    gotoNextDescendant: function() {\n      this.getDescendants();\n\n      if (this.currentDescendant) {\n        this.currentDescendant.trigger(\"stepunlock\");\n        this.currentDescendant = null;\n      }\n\n      for (var index = this.currentDescendantIndex || 0, l = this.descendantsChildFirst.length; index < l; index++) {\n        var descendant = this.descendantsChildFirst[index];\n        switch ( descendant.get(\"_type\") ) {\n          case \"block\":\n          case \"article\":\n            this.currentLocksOnDescendant = 0;\n            this.currentDescendantIndex = index;\n            var currentId = descendant.get(\"_id\");\n            this.currentDescendant = this.descendantViews[currentId];\n            this.currentDescendant.trigger(\"steplock\");\n            return;\n        }\n      }\n      this.finished();\n    },\n\n    onContinue: function(view) {\n      if (!this.currentDescendant) return;\n      if (view.model.get(\"_id\") !== this.currentDescendant.model.get(\"_id\")) return;\n\n      this.onSkip();\n    },\n\n    onWait: function() {\n      this.currentLocksOnDescendant++;\n    },\n\n    onUnwait: function() {\n      this.currentLocksOnDescendant--;\n      if (this.currentLocksOnDescendant > 0) return;\n\n      var lastDescendant = this.currentDescendant.model;\n\n      this.currentDescendantIndex++;\n      this.gotoNextDescendant();\n\n      Adapt.trickle.scroll(lastDescendant);\n\n    },\n\n    onSkip: function() {\n      // wait for all handlers to accept skip\n      this.currentDescendantIndex++;\n      this.gotoNextDescendant();\n    },\n\n    onKill: function() {\n      this.finished();\n      this.detachFromPage();\n    },\n\n    finished: function() {\n      Adapt.trigger(\"trickle:finished\");\n      this.detachFromPage();\n    },\n\n    // end of trickle lifecycle\n\n    onRemove: function() {\n      this.finished();\n    },\n\n    detachFromPage: function() {\n      $(\"html\").removeClass(\"trickle\");\n      this.undelegateEvents();\n      this.stopListening();\n      this.model = null;\n      this.$el = null;\n      this.el = null;\n      this.currentDescendant = null;\n      this.descendantViews = null;\n      this.descendantsChildFirst = null;\n      this.descendantsParentFirst = null;\n      Adapt.trickle.pageView = null;\n    }\n\n  });\n\n  return PageView;\n\n});\n","define([\n  'core/js/adapt',\n  'core/js/views/componentView'\n], function(Adapt, ComponentView) {\n\n  var completionAttribute = \"_isComplete\";\n\n  var TrickleButtonView = Backbone.View.extend({\n\n    isStepLocking: false,\n    hasStepLocked: false,\n    isStepLocked: false,\n    isStepLockFinished: false,\n    hasStepPreCompleted: false,\n    isWaitingForClick: false,\n    allowVisible: false,\n    allowEnabled: true,\n    overlayShownCount: 0,\n\n    el: function() {\n\n      this.setupPreRender();\n\n      return Handlebars.templates['trickle-button'](this.model.toJSON());\n    },\n\n    setupPreRender: function() {\n\n      this.setupButtonVisible();\n      this.setupButtonEnabled();\n    },\n\n    setupButtonVisible: function() {\n      var trickle = Adapt.trickle.getModelConfig(this.model);\n      this.allowVisible = false;\n      trickle._button._isVisible = false;\n\n      if (trickle._button._styleBeforeCompletion === \"visible\") {\n        this.allowVisible = true;\n        if (trickle._button._autoHide && trickle._button._isFullWidth) {\n          trickle._button._isVisible = false;\n        } else {\n          trickle._button._isVisible = true;\n        }\n      }\n    },\n\n    setupButtonEnabled: function() {\n      var trickle = Adapt.trickle.getModelConfig(this.model);\n\n      if (trickle._stepLocking._isCompletionRequired === false) {\n        this.allowEnabled = true;\n        trickle._button._isDisabled = false;\n      } else if (trickle._button._styleBeforeCompletion === \"visible\") {\n        this.allowEnabled = false;\n        trickle._button._isDisabled = true;\n      } else {\n        trickle._button._isDisabled = false;\n        this.allowEnabled = true;\n      }\n\n    },\n\n    events: {\n      \"click .js-trickle-btn\": \"onButtonClick\"\n    },\n\n    initialize: function(options) {\n      this.getCompletionAttribute();\n      this.debounceCheckAutoHide();\n      this.setupStepLocking();\n      this.setupEventListeners();\n    },\n\n    getCompletionAttribute: function() {\n      var trickle = Adapt.trickle.getModelConfig(Adapt.config);\n      if (!trickle) return;\n      if (!trickle._completionAttribute) return;\n      completionAttribute = trickle._completionAttribute;\n    },\n\n    setupStepLocking: function() {\n      var trickle = Adapt.trickle.getModelConfig(this.model);\n      this.isStepLocked = Boolean(trickle._stepLocking._isEnabled);\n    },\n\n    setupEventListeners: function() {\n      this.listenTo(Adapt, {\n        \"trickle:overlay\": this.onOverlay,\n        \"trickle:unoverlay\": this.onUnoverlay,\n        \"trickle:steplock\": this.onStepLock,\n        \"trickle:stepunlock\": this.onStepUnlock,\n        \"trickle:skip\": this.onSkip,\n        \"trickle:kill\": this.onKill,\n        \"trickle:update\": this.onUpdate,\n        \"remove\": this.onRemove\n      });\n\n      this.listenTo(this.model, \"change:\"+completionAttribute, this.onCompletion);\n    },\n\n    debounceCheckAutoHide: function() {\n      this.checkButtonAutoHideSync = this.checkButtonAutoHide.bind(this);\n      this.checkButtonAutoHide = _.debounce(this.checkButtonAutoHideSync, 100);\n    },\n\n    checkButtonAutoHide: function() {\n      if (!this.allowVisible) {\n        this.setButtonVisible(false);\n        return;\n      }\n\n      var trickle = Adapt.trickle.getModelConfig(this.model);\n      if (!trickle._button._autoHide) {\n        this.setButtonVisible(true);\n        return;\n      } else if (this.overlayShownCount > 0) {\n        this.setButtonVisible(false);\n        return;\n      }\n\n      var measurements = this.$el.onscreen();\n\n      // This is to fix common miscalculation issues\n      var isJustOffscreen = (measurements.bottom > -100);\n\n      // add show/hide animation here if needed\n      if (measurements.onscreen || isJustOffscreen) {\n        this.setButtonVisible(true);\n      } else {\n        this.setButtonVisible(false);\n      }\n    },\n\n    setButtonVisible: function(isVisible) {\n      var trickle = Adapt.trickle.getModelConfig(this.model);\n      trickle._button._isVisible = Boolean(isVisible);\n      this.$(\".js-trickle-btn-container\").toggleClass(\"u-display-none\", !trickle._button._isVisible);\n    },\n\n    checkButtonEnabled: function() {\n      this.setButtonEnabled(this.allowEnabled);\n    },\n\n    setButtonEnabled: function(isEnabled) {\n      var trickle = Adapt.trickle.getModelConfig(this.model);\n      var $button = this.$(\".js-trickle-btn\");\n      if (isEnabled) {\n        $button.removeClass(\"is-disabled\").removeAttr(\"disabled\");\n        trickle._button._isDisabled = true;\n        // move focus forward if it's on the aria-label\n        if (document.activeElement instanceof HTMLElement && document.activeElement.isSameNode(this.$('.aria-label')[0])) {\n          this.$('.aria-label').focusNext();\n        }\n        // make label unfocusable as it is no longer needed\n        this.$('.aria-label').a11y_cntrl(false);\n      } else {\n        $button.addClass(\"is-disabled\").attr(\"disabled\", \"disabled\");\n        trickle._button._isDisabled = false;\n      }\n    },\n\n    onStepLock: function(view) {\n      if (!this.isViewMatch(view)) return;\n\n      this.hasStepLocked = true;\n      this.isStepLocking = true;\n      this.overlayShownCount = 0;\n\n      var trickle = Adapt.trickle.getModelConfig(this.model);\n\n      if (!this.isButtonEnabled()) return;\n      var isCompleteAndShouldRelock = (trickle._stepLocking._isLockedOnRevisit &&\n          this.model.get(completionAttribute));\n\n      if (isCompleteAndShouldRelock) {\n        this.isStepLocked = true;\n        this.model.set(\"_isTrickleAutoScrollComplete\", false);\n        Adapt.trigger(\"trickle:wait\");\n        this.allowVisible = true;\n        this.checkButtonAutoHide();\n      } else if (this.hasStepPreCompleted) {\n        // force the button to show if section completed before it was steplocked\n        this.isStepLocked = true;\n        this.model.set(\"_isTrickleAutoScrollComplete\", false);\n        this.allowVisible = true;\n        this.stepCompleted();\n      }\n      this.setupOnScreenListener();\n    },\n\n    onOverlay: function() {\n      this.overlayShownCount++;\n    },\n\n    onUnoverlay: function() {\n      this.overlayShownCount--;\n      this.checkButtonAutoHide();\n    },\n\n    setupOnScreenListener: function() {\n      var trickle = Adapt.trickle.getModelConfig(this.model);\n\n      if (!trickle._button._autoHide) return;\n      this.$el.on(\"onscreen\", this.checkButtonAutoHideSync);\n\n    },\n\n    isViewMatch: function(view) {\n      return view.model.get(\"_id\") === this.model.get(\"_id\");\n    },\n\n    isButtonEnabled: function() {\n      var trickle = Adapt.trickle.getModelConfig(this.model);\n\n      if (!trickle._isEnabled || !trickle._button._isEnabled) return false;\n      return true;\n    },\n\n    onCompletion: function(model, value) {\n      if (value === false) return;\n\n      this.hasStepPreCompleted = true;\n\n      if (!this.hasStepLocked) return;\n\n      this.stepCompleted();\n    },\n\n    stepCompleted: function() {\n\n      if (this.isStepLockFinished) return;\n\n      this.isStepLocked = false;\n      this.allowVisible = false;\n      this.allowEnabled = false;\n\n      if (this.isButtonEnabled()) {\n        if (this.isStepLocking) {\n\n          this.isStepLocked = true;\n          this.isWaitingForClick = true;\n          Adapt.trigger(\"trickle:wait\");\n\n        } else {\n\n          this.isStepLockFinished = true;\n        }\n\n        this.allowVisible = true;\n        this.allowEnabled = true;\n      }\n\n      this.model.set(\"_isTrickleAutoScrollComplete\", false);\n      this.checkButtonAutoHideSync();\n      this.checkButtonEnabled();\n\n    },\n\n    onButtonClick: function() {\n      var trickle = this.model.get(\"_trickle\");\n      switch (trickle._button._styleAfterClick) {\n      case \"hidden\":\n        this.allowVisible = false;\n        this.checkButtonAutoHideSync();\n        break;\n      case \"disabled\":\n        this.allowEnabled = false;\n        this.checkButtonAutoHideSync();\n      }\n\n      if (this.isStepLocked) {\n        Adapt.trigger(\"trickle:unwait\");\n        this.isStepLocked = false;\n        this.isStepLockFinished = true;\n      } else {\n        this.model.set(\"_isTrickleAutoScrollComplete\", false);\n        Adapt.trickle.scroll(this.model);\n      }\n    },\n\n    onUpdate: function() {\n      var trickle = Adapt.trickle.getModelConfig(this.model);\n\n      if (trickle._button._autoHide && this.isStepLocking) {\n        this.$el.off(\"onscreen\", this.checkButtonAutoHideSync);\n      }\n\n      var $original = this.$el;\n      var $newEl = $(Handlebars.templates['trickle-button'](this.model.toJSON()));\n      $original.replaceWith($newEl);\n\n      this.setElement($newEl);\n\n      if (trickle._button._autoHide && this.isStepLocking) {\n        this.$el.on(\"onscreen\", this.checkButtonAutoHideSync);\n      }\n    },\n\n    onStepUnlock: function(view) {\n      if (!this.isViewMatch(view)) return;\n      this.$el.off(\"onscreen\", this.checkButtonAutoHideSync);\n      this.isStepLocking = false;\n      this.overlayShownCount = 0;\n      // move focus forward if it's on the aria-label\n      if (document.activeElement instanceof HTMLElement && document.activeElement.isSameNode(this.$('.aria-label')[0])) {\n        this.$('.aria-label').focusNext();\n      }\n      // make label unfocusable as it is no longer needed\n      this.$('.aria-label').a11y_cntrl(false);\n    },\n\n    onSkip: function() {\n      if (!this.isStepLocking) return;\n\n      this.onKill();\n    },\n\n    onKill: function() {\n      this.$el.off(\"onscreen\", this.checkButtonAutoHideSync);\n      if (this.isWaitingForClick) {\n        this.model.set(\"_isTrickleAutoScrollComplete\", true);\n      }\n      this.isWaitingForClick = false;\n      this.isStepLocked = false;\n      this.isStepLocking = false;\n      this.allowVisible = false;\n      this.allowEnabled = false;\n      this.isStepLockFinished = true;\n      this.model.set(\"_isTrickleAutoScrollComplete\", false);\n      this.checkButtonAutoHide();\n      this.checkButtonEnabled();\n    },\n\n    onRemove: function() {\n      if (this.isWaitingForClick) {\n        this.model.set(\"_isTrickleAutoScrollComplete\", true);\n      }\n      this.isWaitingForClick = false;\n      this.$el.off(\"onscreen\", this.checkButtonAutoHideSync);\n      this.isStepLocking = true;\n      this.remove();\n    }\n\n  });\n\n  return TrickleButtonView;\n\n});\n","define([\n  'core/js/adapt',\n  './buttonView'\n], function(Adapt, ButtonView) {\n\n  var TrickleButtonHandler = Backbone.Controller.extend({\n\n    buttonViews: null,\n\n    initialize: function() {\n      this.listenToOnce(Adapt, {\n        'app:dataReady': this.onAppDataReady,\n        remove: this.onRemove\n      });\n    },\n\n    onAppDataReady: function() {\n      this.buttonViews = {};\n      this.setupEventListeners();\n    },\n\n    setupEventListeners: function() {\n      this.listenTo(Adapt, {\n        'trickle:preRender': this.onPreRender,\n        'trickle:postRender': this.onPostRender\n      });\n    },\n\n    onPreRender: function(view) {\n      // setup button on prerender to allow it to control the steplocking process\n      if (!this.isTrickleEnabled(view.model)) return;\n\n      this.setupConfigDefaults(view.model);\n\n      this.buttonViews[view.model.get('_id')] = new ButtonView({\n        model: view.model\n      });\n    },\n\n    onPostRender: function(view) {\n      // inject the button at post render\n      if (!this.isTrickleEnabled(view.model)) return;\n\n      view.$el.append(this.buttonViews[view.model.get('_id')].$el);\n    },\n\n    isTrickleEnabled: function(model) {\n      var trickle = Adapt.trickle.getModelConfig(model);\n      if (!trickle || !trickle._isEnabled) return false;\n\n      if (trickle._onChildren && model.get('_type') === 'article') return false;\n\n      return true;\n    },\n\n    setupConfigDefaults: function(model) {\n      if (model.get('_isTrickleButtonConfigured')) return;\n\n      var defaults = {\n        _isEnabled: true,\n        _styleBeforeCompletion: 'hidden',\n        _styleAfterClick: 'hidden',\n        _isFullWidth: true,\n        _autoHide: false,\n        _className: '',\n        _hasIcon: false,\n        text: 'Continue',\n        startText: 'Begin',\n        finalText: 'Finish',\n        _component: 'trickle-button',\n        _isLocking: true,\n        _isVisible: false,\n        _isDisabled: false\n      };\n\n      var trickle = Adapt.trickle.getModelConfig(model);\n      trickle._button = _.extend(defaults, trickle._button);\n\n      if (trickle._button._isFullWidth) {\n        trickle._stepLocking._isEnabled = true;\n        trickle._button._styleAfterClick = 'hidden';\n      } else {\n        trickle._button._autoHide = false;\n      }\n\n      Adapt.trickle.setModelConfig(model, trickle);\n      model.set('_isTrickleButtonConfigured', true);\n\n    },\n\n    onRemove: function() {\n      this.buttonViews = {};\n    }\n\n  });\n\n  return new TrickleButtonHandler();\n\n});\n","define([\n  'core/js/adapt'\n], function(Adapt) {\n\n  var completionAttribute = \"_isComplete\";\n\n  var TrickleCompletionHandler = Backbone.Controller.extend({\n\n    isStepLocking: false,\n    isCompleted: false,\n\n    stepModel: null,\n\n    initialize: function() {\n      this.listenToOnce(Adapt, \"app:dataReady\", this.onAppDataReady);\n    },\n\n    onAppDataReady: function() {\n      this.getCompletionAttribute();\n      this.setupEventListeners();\n    },\n\n    getCompletionAttribute: function() {\n      var trickle = Adapt.trickle.getModelConfig(Adapt.config);\n      if (!trickle) return;\n      if (!trickle._completionAttribute) return;\n      completionAttribute = trickle._completionAttribute;\n    },\n\n    setupEventListeners: function() {\n      this.listenTo(Adapt, {\n        \"trickle:descendants\": this.onDescendants,\n        \"trickle:steplock\": this.onStepLock,\n        \"trickle:stepunlock\": this.onStepUnlock,\n        \"trickle:kill\": this.onKill,\n        \"remove\": this.onRemove\n      });\n    },\n\n    onDescendants: function(view) {\n      // save the original completion state of the component before steplocking\n      view.descendantsParentFirst.forEach(function(descendant) {\n        var trickle = Adapt.trickle.getModelConfig(descendant);\n        if (!trickle) return;\n        trickle._wasCompletedPreRender = descendant.get(completionAttribute);\n      });\n    },\n\n    onStepLock: function(view) {\n      var isModelComplete = view.model.get(completionAttribute);\n\n      var trickle = Adapt.trickle.getModelConfig(view.model);\n      if (!trickle._stepLocking._isCompletionRequired &&\n          !trickle._stepLocking._isLockedOnRevisit) {\n        if (!isModelComplete) return;\n        // skip any components that do not require completion but that are already complete\n        // this is needed for a second visit to a page with 'inview'\n        // components that aren't reset and don't require completion and are not relocked on revisit\n        Adapt.trigger(\"trickle:continue\", view);\n        return;\n      }\n\n      if (trickle._stepLocking._isCompletionRequired\n        && isModelComplete\n        && trickle._wasCompletedPreRender) {\n        // skip any components that are complete, have require completion\n        // and we completed before the page rendered\n        Adapt.trigger(\"trickle:continue\", view);\n        return;\n      }\n\n      Adapt.trigger(\"trickle:wait\");\n\n      if (isModelComplete) {\n        Adapt.trigger(\"trickle:unwait\");\n        return;\n      }\n\n      view.model.set(\"_isTrickleAutoScrollComplete\", false);\n      this.isCompleted = false;\n      this.isStepLocking = true;\n      this.stepModel = view.model;\n\n      this.listenTo(this.stepModel, \"change:\"+completionAttribute, this.onCompletion);\n    },\n\n    onCompletion: function(model, value) {\n      if (value === false) return;\n      this.stepCompleted();\n    },\n\n    stepCompleted: function() {\n\n      if (!this.isStepLocking) return;\n\n      if (this.isCompleted) return;\n      this.isCompleted = true;\n\n      this.stopListening(this.stepModel, \"change:\"+completionAttribute, this.onCompletion);\n\n      Adapt.trigger(\"trickle:unwait\");\n    },\n\n    onKill: function() {\n      this.onStepUnlock();\n    },\n\n    onRemove: function() {\n      this.onStepUnlock();\n    },\n\n    onStepUnlock: function() {\n      this.stopListening(this.stepModel, \"change:\"+completionAttribute, this.onCompletion);\n      this.isStepLocking = false;\n      this.stepModel = null;\n      this.isCompleted = false;\n    }\n\n  });\n\n  return new TrickleCompletionHandler();\n\n});\n","define([\n  'core/js/adapt'\n], function(Adapt) {\n\n  var TrickleNotifyHandler = Backbone.Controller.extend({\n\n    isStepLocking: false,\n    isNotifyOpen: false,\n\n    initialize: function() {\n      this.listenToOnce(Adapt, \"app:dataReady\", this.onAppDataReady);\n    },\n\n    onAppDataReady: function() {\n      this.setupEventListeners();\n    },\n\n    setupEventListeners: function() {\n      this.listenTo(Adapt, {\n        \"trickle:steplock\": this.onStepLock,\n        \"notify:opened\": this.onNotifyOpened,\n        \"notify:closed\": this.onNotifyClosed,\n        \"trickle:stepunlock\": this.onStepUnlock,\n        \"remove\": this.onRemove\n      });\n    },\n\n    onStepLock: function(view) {\n      this.isStepLocking = true;\n    },\n\n    onNotifyOpened: function() {\n      if (!this.isStepLocking) return;\n\n      this.isNotifyOpen = true;\n      Adapt.trigger(\"trickle:overlay\");\n      Adapt.trigger(\"trickle:wait\");\n    },\n\n    onNotifyClosed: function() {\n      if (!this.isStepLocking) return;\n      if (!this.isNotifyOpen) return;\n\n      this.isNotifyOpen = false;\n      Adapt.trigger(\"trickle:unoverlay\");\n      Adapt.trigger(\"trickle:unwait\");\n    },\n\n    onStepUnlock: function() {\n      this.isStepLocking = false;\n    },\n\n    onRemove: function() {\n      this.onStepUnlock();\n    }\n\n  });\n\n  return new TrickleNotifyHandler();\n\n});\n","define([\n  'core/js/adapt'\n], function(Adapt) {\n\n  var TrickleBodyResizeHandler = Backbone.Controller.extend({\n\n    isStepLocking: false,\n\n    stepView: null,\n\n    initialize: function() {\n      this.listenToOnce(Adapt, {\n        \"app:dataReady\": this.onAppDataReady,\n        \"adapt:initialize\": this.onAdaptInitialized\n      });\n    },\n\n    onAppDataReady: function() {\n      this.onResize = this.onResize.bind(this);\n      this.preventWrapperScroll = this.preventWrapperScroll.bind(this);\n      this.setupEventListeners();\n    },\n\n    setupEventListeners: function() {\n      this.listenTo(Adapt, {\n        \"trickle:steplock\": this.onStepLock,\n        \"trickle:resize\": this.onTrickleResize,\n        \"trickle:stepunlock\": this.onStepUnlock,\n        \"trickle:kill\": this.onKill,\n        \"trickle:finished\": this.onFinished,\n        \"remove\": this.onRemove\n      });\n    },\n\n    onAdaptInitialized: function() {\n      this.wrapper = document.getElementById('wrapper');\n      this.wrapper.addEventListener(\"scroll\", this.preventWrapperScroll);\n    },\n\n    onStepLock: function(view) {\n      this.isStepLocking = true;\n      this.stepView = view;\n      $(window).on(\"resize\", this.onResize);\n      $(\".page\").on(\"resize\", this.onResize);\n\n      // wait for height / visibility to adjust\n      Adapt.trigger(\"trickle:resize\");\n    },\n\n    preventWrapperScroll: function(event) {\n      if (!this.isStepLocking) return;\n      // Screen reader can scroll the #wrapper instead of the window.\n      // This code overcomes that behaviour.\n      var top = this.wrapper.scrollTop;\n      if (top === 0) return;\n      this.wrapper.scrollTop = 0;\n      window.scrollTo(0, window.pageYOffset + top);\n    },\n\n    onResize: function() {\n      if (!this.isStepLocking) return;\n      Adapt.trigger(\"trickle:resize\");\n    },\n\n    onTrickleResize: function() {\n      if (!this.isStepLocking) return;\n      var offset = this.stepView.$el.offset();\n      var height = this.stepView.$el.height();\n\n      var $wrapper = $(this.wrapper);\n\n      var bottom = offset['top'] + height;\n\n      $wrapper.css(\"height\", bottom );\n    },\n\n    onStepUnlock: function(view) {\n      this.isStepLocking = false;\n      this.stepView = null;\n      $(window).off(\"resize\", this.onResize);\n      $(\".page\").off(\"resize\", this.onResize);\n    },\n\n    onKill: function() {\n      this.onFinished();\n      this.onStepUnlock();\n    },\n\n    onFinished: function() {\n      this.wrapper.removeEventListener(\"scroll\", this.preventWrapperScroll);\n      $(this.wrapper).css(\"height\", \"\");\n    },\n\n    onRemove: function() {\n      this.onStepUnlock();\n      this.stepView = null;\n    }\n\n  });\n\n  return new TrickleBodyResizeHandler();\n\n});\n","define([\n  'core/js/adapt'\n], function(Adapt) {\n\n  var TrickleTutorHandler = Backbone.Controller.extend({\n\n    stepLockedId: null,\n    isStepLocking: false,\n    isTutorOpen: false,\n\n    initialize: function() {\n      this.listenToOnce(Adapt, \"app:dataReady\", this.onAppDataReady);\n    },\n\n    onAppDataReady: function() {\n      this.setupEventListeners();\n    },\n\n    setupEventListeners: function() {\n      this.listenTo(Adapt, {\n        \"trickle:steplock\": this.onStepLock,\n        \"tutor:opened\": this.onTutorOpened,\n        \"tutor:closed\": this.onTutorClosed,\n        \"trickle:stepunlock\": this.onStepUnlock,\n        \"remove\": this.onRemove\n      });\n    },\n\n    onStepLock: function(view) {\n      if (view) {\n        this.stepLockedId = view.model.get(\"_id\");\n      }\n      this.isStepLocking = true;\n    },\n\n    onTutorOpened: function(view, alertObject) {\n      if (!this.isStepLocking) return;\n      if (!this.isOriginStepLocked(view)) return;\n\n      this.isTutorOpen = true;\n      Adapt.trigger(\"trickle:overlay\");\n      Adapt.trigger(\"trickle:wait\");\n    },\n\n    isOriginStepLocked: function(view) {\n      if (!view || !this.stepLockedId) return true;\n\n      var parents = view.model.getAncestorModels();\n      var hasStepLockedParent = _.find(parents, function(ancestor) {\n        return ancestor.get('_id') === this.stepLockedId;\n      }, this);\n      if (!hasStepLockedParent) return false;\n      return true;\n    },\n\n    onTutorClosed: function(view, alertObject) {\n      if (!this.isStepLocking) return;\n      if (!this.isTutorOpen) return;\n      if (!this.isOriginStepLocked(view)) return;\n\n      this.isTutorOpen = false;\n      Adapt.trigger(\"trickle:unoverlay\");\n      Adapt.trigger(\"trickle:unwait\");\n    },\n\n    onStepUnlock: function() {\n      this.isStepLocking = false;\n      this.stepLockedId = null;\n    },\n\n    onRemove: function() {\n      this.onStepUnlock();\n    }\n\n  });\n\n  return new TrickleTutorHandler();\n\n});\n","define([\n  'core/js/adapt'\n], function(Adapt) {\n\n  var TrickleVisibilityHandler = Backbone.Controller.extend({\n\n    isStepLocking: false,\n\n    trickleModel: null,\n\n    initialize: function() {\n      this.listenToOnce(Adapt, \"app:dataReady\", this.onAppDataReady);\n    },\n\n    onAppDataReady: function() {\n      this.setupEventListeners();\n    },\n\n    setupEventListeners: function() {\n      this.listenTo(Adapt, {\n        \"trickle:steplock\": this.onStepLock,\n        \"trickle:visibility\": this.onVisibility,\n        \"trickle:stepunlock\": this.onStepUnlock,\n        \"trickle:kill\": this.onKill,\n        \"trickle:finished\": this.onFinished,\n        \"remove\": this.onRemove\n      });\n\n    },\n\n    onStepLock: function(view) {\n      this.isStepLocking = true;\n      this.trickleModel = view.model;\n      Adapt.trigger(\"trickle:visibility\");\n    },\n\n    onVisibility: function() {\n      if (!this.isStepLocking) return;\n\n      if (!Adapt.trickle.pageView) return;\n\n      var descendantsParentFirst = Adapt.trickle.pageView.descendantsParentFirst;\n\n      var trickleModelId = this.trickleModel.get(\"_id\");\n      var trickleType = this.trickleModel.get(\"_type\");\n\n      var atIndex = _.findIndex(descendantsParentFirst, function(descendant) {\n        if (descendant.get(\"_id\") === trickleModelId) return true;\n      });\n\n      descendantsParentFirst.forEach(function(descendant, index) {\n        var components = descendant.findDescendantModels(\"components\");\n        if (index <= atIndex) {\n          descendant.set(\"_isVisible\", true, {pluginName:\"trickle\"});\n          components.forEach(function(componentModel) {\n            componentModel.set(\"_isVisible\", true, {pluginName:\"trickle\"});\n          });\n          return;\n        }\n\n        if (trickleType === \"article\" && descendant.get(\"_type\") === \"block\") {\n          // make sure article blocks are shown\n          if (descendant.get(\"_parentId\") === trickleModelId) {\n            descendant.set(\"_isVisible\", true, {pluginName:\"trickle\"});\n            components.forEach(function(componentModel) {\n              componentModel.set(\"_isVisible\", true, {pluginName:\"trickle\"});\n            });\n            return;\n          }\n        }\n\n        descendant.set(\"_isVisible\", false, {pluginName:\"trickle\"});\n        components.forEach(function(componentModel) {\n          componentModel.set(\"_isVisible\", false, {pluginName:\"trickle\"});\n        });\n\n      });\n\n    },\n\n    onStepUnlock: function(view) {\n      this.isStepLocking = false;\n      this.trickleModel = null;\n    },\n\n    onKill: function() {\n      this.onFinished();\n      this.onStepUnlock();\n    },\n\n    onFinished: function() {\n\n      var descendantsParentFirst = Adapt.trickle.pageView.descendantsParentFirst;\n      descendantsParentFirst.forEach(function(descendant) {\n        descendant.set(\"_isVisible\", true, {pluginName:\"trickle\"});\n        var components = descendant.findDescendantModels(\"components\");\n        components.forEach(function(componentModel) {\n          componentModel.set(\"_isVisible\", true, {pluginName:\"trickle\"});\n        });\n      });\n\n    },\n\n    onRemove: function() {\n      this.onStepUnlock();\n    }\n\n  });\n\n  return new TrickleVisibilityHandler();\n\n});\n","define([\n  'core/js/adapt'\n], function(Adapt) {\n\n  var TrickleDone = Backbone.Controller.extend({\n\n    initialize: function() {\n      this.listenToOnce(Adapt, \"app:dataReady\", this.onAppDataReady);\n    },\n\n    onAppDataReady: function() {\n      this.setupEventListeners();\n    },\n\n    setupEventListeners: function() {\n      this.onDone = _.debounce(this.onDone.bind(this), 50);\n      this.listenTo(Adapt, {\n        \"trickle:steplock\": this.onDone,\n        \"trickle:stepunlock\": this.onDone,\n        \"trickle:continue\": this.onDone,\n        \"trickle:finished\": this.onDone\n      });\n    },\n\n    onDone: function() {\n      Adapt.trigger(\"trickle:done\");\n    }\n\n  });\n\n  return new TrickleDone();\n\n});\n","define([\n  'core/js/adapt',\n  './pageView',\n  './handlers/button',\n  './handlers/completion',\n  './handlers/notify',\n  './handlers/resize',\n  './handlers/tutor',\n  './handlers/visibility',\n  './handlers/done'\n], function(Adapt, PageView) {\n\n  var Trickle = Backbone.Controller.extend({\n\n    model: null,\n    pageView: null,\n\n    initialize: function() {\n      this.listenToOnce(Adapt, {\n        'app:dataReady': this.onAppDataReady\n      });\n    },\n\n    onAppDataReady: function() {\n      this.getCourseModel();\n      if (!this.isCourseEnabled()) return;\n      this.setupListeners();\n    },\n\n    getCourseModel: function() {\n      this.model = Adapt.course;\n    },\n\n    isCourseEnabled: function() {\n      var trickleConfig = this.getModelConfig(this.model);\n      if (trickleConfig && trickleConfig._isEnabled === false) return false;\n      return true;\n    },\n\n    getModelConfig: function(model) {\n      return model.get('_trickle');\n    },\n\n    getCompletionAttribute: function() {\n      var trickle = this.getModelConfig(Adapt.config);\n      if (!trickle) return '_isComplete';\n      return trickle._completionAttribute || '_isComplete';\n    },\n\n    setModelConfig: function(model, config) {\n      return model.set('_trickle', config);\n    },\n\n    setupListeners: function() {\n      this.listenTo(Adapt, 'pageView:preRender', this.onPagePreRender);\n    },\n\n    onPagePreRender: function(view) {\n      this.pageView = new PageView({\n        model: view.model,\n        el: view.el\n      });\n    },\n\n    scroll: function(fromModel) {\n      // Wait for model visibility to handle\n\n      if (!this.shouldScrollPage(fromModel)) return;\n\n      fromModel.set('_isTrickleAutoScrollComplete', true);\n\n      var trickle = Adapt.trickle.getModelConfig(fromModel);\n      var isAutoScrollOff = !trickle._autoScroll;\n      var hasTrickleButton = trickle._button._isEnabled;\n      if (isAutoScrollOff && !hasTrickleButton) {\n        return;\n      }\n\n      var scrollTo = trickle._scrollTo;\n      if (scrollTo === undefined) scrollTo = '@block +1';\n\n      var scrollToId = '';\n      switch (scrollTo.substr(0,1)) {\n        case '@':\n          // NAVIGATE BY RELATIVE TYPE\n\n          // Allows trickle to scroll to a sibling / cousin component\n          // relative to the current trickle item\n          var relativeModel = fromModel.findRelativeModel(scrollTo, {\n            filter: function(model) {\n              return model.get('_isAvailable');\n            }\n          });\n\n          if (relativeModel === undefined) return;\n          scrollToId = relativeModel.get('_id');\n          break;\n        case '.':\n          // NAVIGATE BY CLASS\n          scrollToId = scrollTo.substr(1, scrollTo.length-1);\n          break;\n        default:\n          scrollToId = scrollTo;\n      }\n\n      if (scrollToId === '') return;\n\n      if (hasTrickleButton) { // only set focus if there's a trickle button - see https://github.com/adaptlearning/adapt_framework/issues/2813\n        Adapt.a11y.focusFirst($('.' + scrollToId), { preventScroll: true });\n      }\n\n      if (isAutoScrollOff) return;\n\n      var duration = fromModel.get('_trickle')._scrollDuration || 500;\n      Adapt.scrollTo('.' + scrollToId, { duration: duration });\n    },\n\n    shouldScrollPage: function(fromModel) {\n      var trickle = Adapt.trickle.getModelConfig(fromModel);\n      if (!trickle || !trickle._isEnabled) return false;\n\n      var hasScrolled = fromModel.get('_isTrickleAutoScrollComplete');\n      if (hasScrolled) return false;\n\n      var isArticleWithOnChildren = (fromModel.get('_type') === 'article' && trickle._onChildren);\n      if (isArticleWithOnChildren) return false;\n\n      return true;\n    }\n\n  });\n\n  return (Adapt.trickle = new Trickle());\n\n});\n","define([\n  'core/js/adapt'\n],function(Adapt) {\n\n  Adapt.on('questionView:showFeedback', function(view) {\n\n    var alertObject = {\n      title: view.model.get('feedbackTitle'),\n      body: view.model.get('feedbackMessage')\n    };\n\n    var attributes = {};\n    var classes = [];\n\n    if (view.model.has('_isCorrect')) {\n      // Attach specific classes so that feedback can be styled.\n      if (view.model.get('_isCorrect')) {\n        classes.push('is-correct');\n      } else {\n        if (view.model.has('_isAtLeastOneCorrectSelection')) {\n          // Partially correct feedback is an option.\n          if (view.model.get('_isAtLeastOneCorrectSelection')) {\n            classes.push('is-partially-correct');\n          } else {\n            classes.push('is-incorrect');\n          }\n        } else {\n          classes.push('is-incorrect');\n        }\n      }\n    }\n\n    // Add the extension/component type which triggered this.\n    if (view.model.has('_component')) {\n      classes.push('is-component is-' + view.model.get('_component').toLowerCase());\n    } else if (view.model.has('_extension')) {\n      classes.push('is-extension is-' + view.model.get('_extension').toLowerCase());\n    }\n\n    // Add the _id property as attribute.\n    attributes['data-adapt-id'] = view.model.get('_id');\n\n    alertObject._classes = classes.join(' ');\n    alertObject._attributes = attributes;\n\n    Adapt.once('notify:closed', function() {\n      Adapt.trigger('tutor:closed', view, alertObject);\n    });\n\n    Adapt.trigger('notify:popup', alertObject);\n\n    Adapt.trigger('tutor:opened', view, alertObject);\n\n  });\n\n});\n","import Adapt from 'core/js/adapt';\r\n\r\n/**\r\n * Allows the modification of Adapt templates after render\r\n */\r\nexport class AdaptTemplateRenderModifier {\r\n\r\n  constructor({\r\n    htmlTest = () => {},\r\n    htmlModify = () => {}\r\n  } = {}) {\r\n    htmlTest = htmlTest.bind(this);\r\n    htmlModify = htmlModify.bind(this);\r\n    Adapt.on('template:postRender partial:postRender', (obj) => {\r\n      if (!htmlTest(obj.value)) return;\r\n      const value = htmlModify(obj.value);\r\n      if (!value) return;\r\n      obj.value = value;\r\n    });\r\n  }\r\n\r\n}\r\n\r\n/**\r\n * Allows the modification of filtered dom nodes on addition and removal\r\n */\r\nexport class DOMModifier {\r\n\r\n  constructor({\r\n    elementFilter = () => {},\r\n    onElementAdd = () => {},\r\n    onElementRemove = () => {}\r\n  }) {\r\n    elementFilter = elementFilter.bind(this);\r\n    onElementAdd = onElementAdd.bind(this);\r\n    onElementRemove = onElementRemove.bind(this);\r\n    function filter(list, prop) {\r\n      const nodes = list.reduce((nodes, item) => {\r\n        const arr = _.toArray(item[prop]);\r\n        return nodes.concat(arr);\r\n      }, []);\r\n      const elementNodes = nodes.filter(el => el.nodeType === 1);\r\n      const foundNodes = elementNodes.reduce((nodes, el) => nodes.concat([el, ...$(el).find('*').toArray()].filter(elementFilter)), []);\r\n      return foundNodes;\r\n    }\r\n    const observer = new MutationObserver((list, observer) => {\r\n      const added = filter(list, 'addedNodes');\r\n      const removed = filter(list, 'removedNodes');\r\n      if (added.length) {\r\n        added.forEach(onElementAdd);\r\n      }\r\n      if (removed.length) {\r\n        removed.forEach(onElementRemove);\r\n      }\r\n    });\r\n    observer.observe(document.body, { childList: true, subtree: true });\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport _ from 'underscore';\r\n\r\nexport default class AudioView extends Backbone.View {\r\n\r\n  get namedConfig() {\r\n    return this.config?._items?.find?.(item => item._name === this.$el.attr('name'));\r\n  }\r\n\r\n  get src() {\r\n    return this.namedConfig?._src || '';\r\n  }\r\n\r\n  get controls() {\r\n    return this.$el.attr('controls');\r\n  }\r\n\r\n  get $player() {\r\n    return this.$('.globalaudio__player');\r\n  }\r\n\r\n  events() {\r\n    return {\r\n      'click .globalaudio__playpause': 'onPlayPauseClick'\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    _.bindAll(this, 'render', 'onScreenChange', 'update', 'onDataReady', 'onTimeUpdate');\r\n    this.config = Adapt.course.get('_globalAudio');\r\n    this.hasUserPaused = false;\r\n    this.isDataReady = false;\r\n    this.setUpListeners();\r\n    this.render();\r\n    this.update();\r\n  }\r\n\r\n  setUpListeners() {\r\n    this.$el.on('onscreen', this.onScreenChange);\r\n    this.listenTo(Adapt, 'media:stop popup:opened', this.onMediaStop);\r\n  }\r\n\r\n  onScreenChange(event, { onscreen, percentInview } = {}) {\r\n    const isOffScreen = (!onscreen || percentInview < (this.config._onScreenPercentInviewVertical ?? 1));\r\n    if (isOffScreen) return this.onOffScreen();\r\n    this.onOnScreen();\r\n  }\r\n\r\n  onOffScreen() {\r\n    if (this.isPaused || this.hasUserPaused) return;\r\n    if (!this.config._offScreenPause) return;\r\n    this.pause(true);\r\n    if (!this.config._offScreenRewind) return;\r\n    this.rewind();\r\n  }\r\n\r\n  onOnScreen() {\r\n    if (!this.isPaused) return;\r\n    if (!this.config._autoPlay) return;\r\n    if (this.hasUserPaused) return;\r\n    this.play(true);\r\n  }\r\n\r\n  onMediaStop(view) {\r\n    if (view === this) return;\r\n    this.pause();\r\n    this.rewind();\r\n  }\r\n\r\n  play() {\r\n    const isFinished = (this.audioTag.currentSeconds === this.audioTag.duration - 1);\r\n    if (isFinished) {\r\n      if (!this.isPaused) this.audioTag.pause();\r\n    }\r\n    if (Adapt.globalAudio.audioContext?.state !== 'suspended') {\r\n      this.audioTag.play();\r\n    }\r\n    this.update();\r\n  }\r\n\r\n  pause() {\r\n    if (!this.isPaused) this.audioTag.pause();\r\n    this.update();\r\n  }\r\n\r\n  rewind() {\r\n    const isPaused = this.isPaused;\r\n    if (!isPaused) this.audioTag.pause();\r\n    this.audioTag.currentTime = 0;\r\n    if (!isPaused && Adapt.globalAudio.audioContext?.state !== 'suspended') {\r\n      this.audioTag.play();\r\n    }\r\n    this.update();\r\n  }\r\n\r\n  get isPaused() {\r\n    return this.audioTag.paused;\r\n  }\r\n\r\n  togglePlayPause() {\r\n    if (this.isPaused) {\r\n      return this.play();\r\n    }\r\n    this.pause();\r\n  }\r\n\r\n  render() {\r\n    this.$el.html(Handlebars.templates.globalAudio({\r\n      ...this.config,\r\n      _src: this.src\r\n    }));\r\n    this.audioTag = new Audio();\r\n    this.audioTag.addEventListener('loadeddata', this.onDataReady);\r\n    this.audioTag.addEventListener('timeupdate', this.onTimeUpdate);\r\n    if (Adapt.globalAudio.audioContext) {\r\n      this.sourceNode = Adapt.globalAudio.audioContext.createMediaElementSource(this.audioTag);\r\n      this.sourceNode.connect(Adapt.globalAudio.audioContext.destination);\r\n    }\r\n    this.audioTag.src = this.src;\r\n  }\r\n\r\n  onDataReady() {\r\n    this.isDataReady = true;\r\n    this.pause();\r\n    this.rewind();\r\n  }\r\n\r\n  onTimeUpdate() {\r\n    this.update();\r\n  }\r\n\r\n  update() {\r\n    this.$player.toggleClass('is-globalaudio-playing', !this.isPaused);\r\n    this.$player.toggleClass('is-globalaudio-paused', this.isPaused);\r\n    const globals = Adapt.course.get('_globals');\r\n    const ariaLabel = (globals?._extensions?._globalAudio?.ariaRegion || 'Audio Player') + ', ' + (this.isPaused\r\n      ? (globals?._extensions?._globalAudio?.play || 'play')\r\n      : (globals?._extensions?._globalAudio?.pause || 'pause'));\r\n    this.$player.find('.globalaudio__playpause').attr('aria-label', ariaLabel);\r\n  }\r\n\r\n  onPlayPauseClick(event) {\r\n    if (this.$el.closest('button, a, [role=link], [role=button]').length) {\r\n      // do not activate any parent buttons\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n    }\r\n    console.log('ppclick attempting resume');\r\n    Adapt.globalAudio.resume(event.originalEvent).then(() => {\r\n      console.log('ppclick attempting resumed');\r\n      Adapt.trigger('media:stop', this);\r\n      console.log('ppclick attempting play');\r\n      this.togglePlayPause();\r\n      console.log('ppclick attempting played');\r\n      this.hasUserPaused = this.audioTag.isPaused;\r\n      if (this.hasUserPaused && this.config._onPauseRewind) {\r\n        this.rewind();\r\n      }\r\n    });\r\n  }\r\n\r\n  destroyPlayer() {\r\n    if (!this.sourceNode) return;\r\n    this.pause();\r\n    this.sourceNode.disconnect(Adapt.globalAudio.audioContext.destination);\r\n    this.audioTag.removeEventListener('loadeddata', this.onDataReady);\r\n    this.audioTag.removeEventListener('timeupdate', this.onTimeUpdate);\r\n  }\r\n\r\n  remove() {\r\n    this.destroyPlayer();\r\n    super.remove();\r\n  }\r\n\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport { DOMModifier } from './injector';\r\nimport AudioView from './AudioView';\r\n\r\nclass GlobalAudio extends Backbone.Controller {\r\n\r\n  initialize() {\r\n    this.resume = this.resume.bind(this);\r\n    this.listenTo(Adapt, 'app:dataReady', this.onDataReady);\r\n  }\r\n\r\n  async whenResumed() {\r\n    return new Promise(resolve => {\r\n      if (this.isResumed) return resolve();\r\n      this.once('resumed', resolve);\r\n    });\r\n  }\r\n\r\n  onDataReady() {\r\n    const config = Adapt.course.get('_globalAudio');\r\n    if (!config?._isEnabled) return;\r\n    this.setUpAudioContext();\r\n    this.setUpEventListeners();\r\n    this.setUp();\r\n  }\r\n\r\n  setUpAudioContext() {\r\n    if (!window.AudioContext) return;\r\n    const AudioContext = window.AudioContext || window.webkitAudioContext;\r\n    this.audioContext = new AudioContext({});\r\n    window.addEventListener('touchstart', this.resume);\r\n    document.addEventListener('touchend', this.resume);\r\n    document.addEventListener('touchstart', this.resume);\r\n    document.addEventListener('click', this.resume);\r\n  }\r\n\r\n  resume(event) {\r\n    // Ignore synthetic events\r\n    const AudioContext = window.AudioContext || window.webkitAudioContext;\r\n    if (this.isResumed || !event.isTrusted || !AudioContext) return Promise.resolve();\r\n    return this.audioContext.resume().then(() => {\r\n      document.removeEventListener('click', this.resume);\r\n      document.removeEventListener('touchend', this.resume);\r\n      document.removeEventListener('touchstart', this.resume);\r\n      window.removeEventListener('touchstart', this.resume);\r\n      this.isResumed = true;\r\n      this.trigger('resumed');\r\n      Adapt.log.info('GlobalAudio: Context started');\r\n    }, () => {\r\n      Adapt.log.warn('GlobalAudio: Context failed');\r\n    });\r\n  }\r\n\r\n  setUpEventListeners() {\r\n    document.body.addEventListener('transitionend', this.checkOnScreen.bind(this));\r\n    this.listenTo(Adapt, 'notify:opened', this.checkOnScreen);\r\n  }\r\n\r\n  checkOnScreen() {\r\n    $.inview();\r\n  }\r\n\r\n  setUp() {\r\n    Handlebars.registerHelper('ga', function (context, ...flags) {\r\n      // passes named attributes from handlebars context to parent div attributes\r\n      // this can be used for specifying behaviour in the json but currently isn't used\r\n      return new Handlebars.SafeString(`<div data-globalaudio=\"true\" ${Object.entries(context.hash).map(([name, value]) => `${name}=\"${value}\"`).join(' ')}></div>`);\r\n    });\r\n    new DOMModifier({\r\n      elementFilter(element) {\r\n        return element.getAttribute('data-globalaudio');\r\n      },\r\n      onElementAdd(div) {\r\n        if (div.AudioView) return;\r\n        const $div = $(div);\r\n        if ($div.closest('.aria-label').length) return $div.remove();\r\n        div.AudioView = new AudioView({ el: div });\r\n      },\r\n      onElementRemove(div) {\r\n        if (!div.AudioView) return;\r\n        div.AudioView.remove();\r\n        div.AudioView = null;\r\n      }\r\n    });\r\n\r\n  }\r\n\r\n}\r\n\r\nexport default (Adapt.globalAudio = new GlobalAudio());\r\n","import AdaptView from 'core/js/views/adaptView';\r\n\r\nclass MenuItemView extends AdaptView {\r\n\r\n  attributes() {\r\n    return AdaptView.resultExtend('attributes', {\r\n      'role': 'listitem',\r\n      'aria-labelledby': this.model.get('_id') + '-heading'\r\n    }, this);\r\n  }\r\n\r\n  className() {\r\n    return [\r\n      'menu-item',\r\n      this.constructor.className,\r\n      this.model.get('_id'),\r\n      this.model.get('_classes'),\r\n      this.setVisibility(),\r\n      this.setHidden(),\r\n      (this.model.get('_isVisited') ? 'is-visited' : ''),\r\n      (this.model.get('_isComplete') ? 'is-complete' : ''),\r\n      (this.model.get('_isLocked') ? 'is-locked' : ''),\r\n      (this.model.get('_isOptional') ? 'is-optional' : '')\r\n    ].join(' ');\r\n  }\r\n\r\n  preRender() {\r\n    this.model.checkCompletionStatus();\r\n    this.model.checkInteractionCompletionStatus();\r\n  }\r\n\r\n  postRender() {\r\n    this.$el.imageready(this.setReadyStatus.bind(this));\r\n  }\r\n\r\n}\r\n\r\nMenuItemView.type = 'menuItem';\r\n\r\nexport default MenuItemView;\r\n","import ContentObjectView from 'core/js/views/contentObjectView';\r\nimport MenuItemView from 'core/js/views/menuItemView';\r\n\r\nclass MenuView extends ContentObjectView {}\r\n\r\nObject.assign(MenuView, {\r\n  /**\r\n   * TODO:\r\n   * child view here should not be fixed to the MenuItemView\r\n   * menus may currently rely on this\r\n   */\r\n  childContainer: '.js-children',\r\n  childView: MenuItemView,\r\n  type: 'menu',\r\n  template: 'menu'\r\n});\r\n\r\nexport default MenuView;\r\n","define([\n  'core/js/views/menuItemView'\n], function(MenuItemView) {\n\n  var BoxMenuItemView = MenuItemView.extend({\n\n    events: {\n      'click .js-btn-click' : 'onClickMenuItemButton'\n    },\n\n    onClickMenuItemButton: function(event) {\n      if (event && event.preventDefault) event.preventDefault();\n      if (this.model.get('_isLocked')) return;\n      Backbone.history.navigate('#/id/' + this.model.get('_id'), {trigger: true});\n    }\n\n  }, {\n    className: 'boxmenu-item',\n    template: 'boxMenuItem'\n  });\n\n  return BoxMenuItemView;\n\n});\n","define([\n  'core/js/views/menuItemView',\n  './adapt-contrib-boxMenuItemView'\n], function(MenuItemView, BoxMenuItemView) {\n\n  var BoxMenuGroupView = MenuItemView.extend({\n\n    postRender: function() {\n      _.defer(this.addChildren.bind(this));\n      this.$el.imageready(this.setReadyStatus.bind(this));\n      this.$el.parents('.boxmenu__item-container').addClass('has-groups');\n    }\n\n  }, {\n    childContainer: '.js-group-children',\n    childView: BoxMenuItemView,\n    className: 'boxmenu-group',\n    template: 'boxMenuGroup'\n  });\n\n  return BoxMenuGroupView;\n\n});\n","define([\n  'core/js/adapt',\n  'core/js/models/menuModel',\n  'core/js/views/menuView',\n  './adapt-contrib-boxMenuItemView',\n  './adapt-contrib-boxMenuGroupView'\n], function(Adapt, MenuModel, MenuView, BoxMenuItemView, BoxMenuGroupView) {\n\n  var BoxMenuView = MenuView.extend({\n\n    initialize: function() {\n      MenuView.prototype.initialize.apply(this);\n      this.setStyles();\n\n      this.listenTo(Adapt, {\n        'device:changed': this.onDeviceResize\n      });\n    },\n\n    onDeviceResize: function() {\n      this.setStyles();\n    },\n\n    addChildren: function() {\n      var nthChild = 0;\n      var models = this.model.getChildren().models;\n      var childViews = [];\n      models.forEach(function(model) {\n        if (!model.get('_isAvailable')) return;\n\n        nthChild++;\n        model.set('_nthChild', nthChild);\n\n        var ChildView = (model.get('_type') === 'menu' && model.get('_boxMenu') && model.get('_boxMenu')._renderAsGroup) ?\n          BoxMenuGroupView :\n          BoxMenuItemView;\n\n        var $parentContainer = this.$(this.constructor.childContainer);\n        var childView = new ChildView({ model: model });\n\n        childViews.push(childView);\n\n        $parentContainer.append(childView.$el);\n\n      }.bind(this));\n\n      this.setChildViews(childViews);\n\n    },\n\n    setStyles: function() {\n      this.setBackgroundImage();\n      this.setBackgroundStyles();\n      this.processHeader();\n    },\n\n    setBackgroundImage: function() {\n      var config = this.model.get('_boxMenu');\n      var backgroundImages = config && config._backgroundImage;\n\n      if (!backgroundImages) return;\n\n      var backgroundImage;\n\n      switch (Adapt.device.screenSize) {\n        case 'large':\n          backgroundImage = backgroundImages._large;\n          break;\n        case 'medium':\n          backgroundImage = backgroundImages._medium;\n          break;\n        default:\n          backgroundImage = backgroundImages._small;\n      }\n\n      if (backgroundImage) {\n        this.$el\n          .addClass('has-bg-image')\n          .css('background-image', 'url(' + backgroundImage + ')');\n      } else {\n        this.$el\n          .removeClass('has-bg-image')\n          .css('background-image', '');\n      }\n    },\n\n    setBackgroundStyles: function () {\n      var config = this.model.get('_boxMenu');\n      var styles = config && config._backgroundStyles;\n\n      if (!styles) return;\n\n      this.$el.css({\n        'background-repeat': styles._backgroundRepeat,\n        'background-size': styles._backgroundSize,\n        'background-position': styles._backgroundPosition\n      });\n    },\n\n    processHeader: function() {\n      var config = this.model.get('_boxMenu');\n      var header = config && config._menuHeader;\n\n      if (!header) return;\n\n      var $header = this.$('.menu__header');\n\n      this.setHeaderBackgroundImage(header, $header);\n      this.setHeaderBackgroundStyles(header, $header);\n      this.setHeaderMinimumHeight(header, $header);\n    },\n\n    setHeaderBackgroundImage: function(config, $header) {\n      var backgroundImages = config._backgroundImage;\n\n      if (!backgroundImages) return;\n\n      var backgroundImage;\n\n      switch (Adapt.device.screenSize) {\n        case 'large':\n          backgroundImage = backgroundImages._large;\n          break;\n        case 'medium':\n          backgroundImage = backgroundImages._medium;\n          break;\n        default:\n          backgroundImage = backgroundImages._small;\n      }\n\n      if (backgroundImage) {\n        $header\n          .addClass('has-bg-image')\n          .css('background-image', 'url(' + backgroundImage + ')');\n      } else {\n        $header\n          .removeClass('has-bg-image')\n          .css('background-image', '');\n      }\n    },\n\n    setHeaderBackgroundStyles: function (config, $header) {\n      var styles = config._backgroundStyles;\n\n      if (!styles) return;\n\n      $header.css({\n        'background-repeat': styles._backgroundRepeat,\n        'background-size': styles._backgroundSize,\n        'background-position': styles._backgroundPosition\n      });\n    },\n\n    setHeaderMinimumHeight: function(config, $header) {\n      var minimumHeights = config._minimumHeights;\n\n      if (!minimumHeights) return;\n\n      var minimumHeight;\n\n      switch (Adapt.device.screenSize) {\n        case 'large':\n          minimumHeight = minimumHeights._large;\n          break;\n        case 'medium':\n          minimumHeight = minimumHeights._medium;\n          break;\n        default:\n          minimumHeight = minimumHeights._small;\n      }\n\n      if (minimumHeight) {\n        $header\n          .addClass('has-min-height')\n          .css('min-height', minimumHeight + 'px');\n      } else {\n        $header\n          .removeClass('has-min-height')\n          .css('min-height', '');\n      }\n    }\n\n  }, {\n    className: 'boxmenu',\n    template: 'boxMenu'\n  });\n\n  // Use as default \"_type\": \"course\" or \"_type\": \"menu\" view.\n  // Note: This is necessary to maintain legacy behaviour in the AAT where\n  // only one menu is usable per course and the course / menu is assumed to be\n  // a core model and use the only installed MenuView.\n  Adapt.register('course menu', {\n    view: BoxMenuView\n  });\n\n  // Use for \"_component\": \"boxMenu\", or \"_view\": \"boxMenu\" and \"_model\": \"boxMenu\"\n  Adapt.register('boxMenu', {\n    view: BoxMenuView,\n    model: MenuModel.extend({})\n  });\n\n});\n","define([\n  'core/js/adapt'\n], function(Adapt) {\n\n  var ThemeView = Backbone.View.extend({\n\n    className: function() {},\n\n    initialize: function() {\n      this.setStyles();\n\n      this.listenTo(Adapt, {\n        'device:changed': this.onDeviceResize,\n        'remove': this.remove\n      });\n    },\n\n    onDeviceResize: function() {\n      this.setStyles();\n    },\n\n    remove: function() {\n      Backbone.View.prototype.remove.call(this);\n\n      this.onRemove();\n    },\n\n    setStyles: function() {\n      this.setClasses();\n      this.setBackgroundImage();\n      this.setBackgroundStyles();\n      this.setMinimumHeight();\n      this.setResponsiveClasses();\n      this.setCustomStyles();\n    },\n\n    setClasses: function() {\n      this.$el.addClass(this.className());\n    },\n\n    setBackgroundImage: function() {\n      var backgroundImages = this.model.get('_backgroundImage');\n\n      if (!backgroundImages) return;\n\n      var backgroundImage;\n\n      switch (Adapt.device.screenSize) {\n        case 'large':\n          backgroundImage = backgroundImages._large;\n          break;\n        case 'medium':\n          backgroundImage = backgroundImages._medium;\n          break;\n        default:\n          backgroundImage = backgroundImages._small;\n      }\n\n      if (backgroundImage) {\n        this.$el\n          .addClass('has-bg-image')\n          .css('background-image', 'url(' + backgroundImage + ')');\n      } else {\n        this.$el\n          .removeClass('has-bg-image')\n          .css('background-image', '');\n      }\n    },\n\n    setBackgroundStyles: function () {\n      var styles = this.model.get('_backgroundStyles');\n\n      if (!styles) return;\n\n      this.$el.css({\n        'background-repeat': styles._backgroundRepeat,\n        'background-size': styles._backgroundSize,\n        'background-position': styles._backgroundPosition\n      });\n    },\n\n    setMinimumHeight: function() {\n      var minimumHeights = this.model.get('_minimumHeights');\n\n      if (!minimumHeights) return;\n\n      var minimumHeight;\n\n      switch (Adapt.device.screenSize) {\n        case 'large':\n          minimumHeight = minimumHeights._large;\n          break;\n        case 'medium':\n          minimumHeight = minimumHeights._medium;\n          break;\n        default:\n          minimumHeight = minimumHeights._small;\n      }\n\n      if (minimumHeight) {\n        this.$el\n          .addClass('has-min-height')\n          .css('min-height', minimumHeight + 'px');\n      } else {\n        this.$el\n          .removeClass('has-min-height')\n          .css('min-height', '');\n      }\n    },\n\n    setResponsiveClasses: function() {\n      const responsiveClasses = this.model.get('_responsiveClasses');\n      if (!responsiveClasses) return;\n\n      this.$el\n        .removeClass(Object.values(responsiveClasses))\n        .addClass(responsiveClasses[`_${Adapt.device.screenSize}`]);\n    },\n\n    setCustomStyles: function() {},\n\n    onRemove: function() {}\n\n  });\n\n  return ThemeView;\n\n});\n","define([\n  './themeView',\n  'core/js/adapt'\n], function(ThemeView, Adapt) {\n\n  var ThemePageView = ThemeView.extend({\n\n    className: function() {},\n\n    setCustomStyles: function() {\n      this.processHeader();\n    },\n\n    processHeader: function() {\n      var header = this.model.get('_pageHeader');\n\n      if (!header) return;\n\n      var $header = this.$('.page__header');\n\n      this.setHeaderBackgroundImage(header, $header);\n      this.setHeaderBackgroundStyles(header, $header);\n      this.setHeaderMinimumHeight(header, $header);\n    },\n\n    setHeaderBackgroundImage: function(config, $header) {\n      var backgroundImages = config._backgroundImage;\n\n      if (!backgroundImages) return;\n\n      var backgroundImage;\n\n      switch (Adapt.device.screenSize) {\n        case 'large':\n          backgroundImage = backgroundImages._large;\n          break;\n        case 'medium':\n          backgroundImage = backgroundImages._medium;\n          break;\n        default:\n          backgroundImage = backgroundImages._small;\n      }\n\n      if (backgroundImage) {\n        $header\n          .addClass('has-bg-image')\n          .css('background-image', 'url(' + backgroundImage + ')');\n      } else {\n        $header\n          .removeClass('has-bg-image')\n          .css('background-image', '');\n      }\n    },\n\n    setHeaderBackgroundStyles: function (config, $header) {\n      var styles = config._backgroundStyles;\n\n      if (!styles) return;\n\n      $header.css({\n        'background-repeat': styles._backgroundRepeat,\n        'background-size': styles._backgroundSize,\n        'background-position': styles._backgroundPosition\n      });\n    },\n\n    setHeaderMinimumHeight: function(config, $header) {\n      var minimumHeights = config._minimumHeights;\n\n      if (!minimumHeights) return;\n\n      var minimumHeight;\n\n      switch (Adapt.device.screenSize) {\n        case 'large':\n          minimumHeight = minimumHeights._large;\n          break;\n        case 'medium':\n          minimumHeight = minimumHeights._medium;\n          break;\n        default:\n          minimumHeight = minimumHeights._small;\n      }\n\n      if (minimumHeight) {\n        $header\n          .addClass('has-min-height')\n          .css('min-height', minimumHeight + 'px');\n      } else {\n        $header\n          .removeClass('has-min-height')\n          .css('min-height', '');\n      }\n    },\n\n    onRemove: function() {}\n\n  });\n\n  return ThemePageView;\n\n});\n","define([\n  './themeView'\n], function(ThemeView) {\n\n  var ThemeArticleView = ThemeView.extend({\n\n    className: function() {},\n\n    setCustomStyles: function() {},\n\n    onRemove: function() {}\n\n  });\n\n  return ThemeArticleView;\n\n});\n","define([\n  './themeView'\n], function(ThemeView) {\n\n  var ThemeBlockView = ThemeView.extend({\n\n    className: function() {\n      return this.model.get('_isDividerBlock') ? 'is-divider-block' : '';\n    },\n\n    setCustomStyles: function() {},\n\n    onRemove: function() {}\n\n  });\n\n  return ThemeBlockView;\n\n});\n","define([\n  'core/js/adapt',\n  './themePageView',\n  './themeArticleView',\n  './themeBlockView',\n  './themeView'\n], function(Adapt, ThemePageView, ThemeArticleView, ThemeBlockView, ThemeView) {\n\n  function onDataReady() {\n    $('html').addClass(Adapt.course.get('_courseStyle'));\n  }\n\n  function onPostRender(view) {\n    var model = view.model;\n    var theme = model.get('_vanilla');\n\n    if (!theme) return;\n\n    switch (model.get('_type')) {\n      case 'page':\n        new ThemePageView({ model: new Backbone.Model(theme), el: view.$el });\n        break;\n      case 'article':\n        new ThemeArticleView({ model: new Backbone.Model(theme), el: view.$el });\n        break;\n      case 'block':\n        new ThemeBlockView({ model: new Backbone.Model(theme), el: view.$el });\n        break;\n      default:\n        new ThemeView({ model: new Backbone.Model(theme), el: view.$el });\n    }\n  }\n\n  Adapt.on({\n    'app:dataReady': onDataReady,\n    'pageView:postRender articleView:postRender blockView:postRender': onPostRender\n  });\n});\n","import Adapt from 'core/js/adapt';\r\nimport {\r\n  compile,\r\n  classes,\r\n  helper,\r\n  html\r\n} from 'core/js/reactHelpers';\r\nimport React from 'react';\r\n\r\nexport default function(model, view) {\r\n  const data = model.toJSON();\r\n  data._globals = Adapt.course.get('_globals');\r\n  // Create references to un-controlled view containers\r\n  view.jsxHeading = view.jsxHeading || React.createRef();\r\n  view.jsxComponentDescription = view.jsxComponentDescription || React.createRef();\r\n  const {\r\n    displayTitle,\r\n    body,\r\n    instruction,\r\n    mobileInstruction,\r\n    _component,\r\n    _disableAccessibilityState\r\n  } = data;\r\n  const type = _component.toLowerCase();\r\n  const sizedInstruction = (mobileInstruction && Adapt.device.screenSize !== 'large') ?\r\n    mobileInstruction :\r\n    instruction;\r\n  return (displayTitle || body || sizedInstruction) && (\r\n    <div className={classes(['component__header', `${type}__header`])}>\r\n      <div className={classes(['component__header-inner', `${type}__header-inner`])}>\r\n        {displayTitle &&\r\n        <div className={classes(['component__title', `${type}__title`])}>\r\n\r\n          {!_disableAccessibilityState &&\r\n          <div className=\"js-heading\" ref={view.jsxHeading}></div>\r\n          }\r\n\r\n          <div className={classes(['component__title-inner', `${type}__title-inner`])} aria-hidden={!_disableAccessibilityState}>\r\n            {html(compile(displayTitle, data))}\r\n          </div>\r\n\r\n        </div>\r\n        }\r\n\r\n        {html(helper('component_description', data), view.jsxComponentDescription)}\r\n\r\n        {body &&\r\n        <div className={classes(['component__body', `${type}__body`])}>\r\n          <div className={classes(['component__body-inner', `${type}__body-inner`])}>\r\n            {html(compile(body, data))}\r\n          </div>\r\n        </div>\r\n        }\r\n\r\n        {sizedInstruction &&\r\n        <div className={classes(['component__instruction', `${type}__instruction`])}>\r\n          <div className={classes(['component__instruction-inner', `${type}__instruction-inner`])}>\r\n            {html(compile(sizedInstruction, data))}\r\n          </div>\r\n        </div>\r\n        }\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import Adapt from 'core/js/adapt';\r\nimport 'core/js/templates';\r\nimport 'core/js/fixes';\r\nimport 'core/js/accessibility';\r\nimport 'core/js/data';\r\nimport 'core/js/offlineStorage';\r\nimport 'core/js/logging';\r\nimport 'core/js/tracking';\r\nimport 'core/js/device';\r\nimport 'core/js/drawer';\r\nimport 'core/js/notify';\r\nimport 'core/js/router';\r\nimport 'core/js/models/lockingModel';\r\nimport 'core/js/mpabc';\r\nimport 'core/js/helpers';\r\nimport 'core/js/scrolling';\r\nimport 'core/js/headings';\r\nimport 'core/js/navigation';\r\nimport 'plugins';\r\n\r\n$('body').append(Handlebars.templates.loading());\r\n\r\nAdapt.data.on('ready', function triggerInit() {\r\n  Adapt.log.debug('Calling Adapt.init');\r\n\r\n  Adapt.init();\r\n\r\n  Adapt.off('adaptCollection:dataLoaded courseModel:dataLoaded');\r\n}).init();\r\n"],"names":["_waitCount","_callbackHandle","being","begin","bind","end","isWaiting","trigger","clearTimeout","setTimeout","callback","Promise","resolve","once","_","defer","Backbone","Controller","attrName","attrVal","options","stopProcessing","isLocking","arguments","isSettingValueForSpecificPlugin","pluginName","console","error","defaults","undefined","_lockedAttributes","lockingValue","isAttemptingToLock","setLockState","skipcheck","totalLockValue","getLockCount","defaultLockValue","_lockedAttributesValues","Object","keys","length","isCheckingGeneralLockingState","isUsingLockedAttributes","Boolean","lockedAttributes","result","isAttributeALockingAttribute","hasOwnProperty","shouldSkipCheck","isGettingValueForSpecificPlugin","lockingAttributeValues","values","lockingAttributeValuesSum","reduce","sum","value","Model","AdaptSingleton","loadScript","window","__loadScript","location","store","setupWait","_canScroll","_outstandingCompletionChecks","_pluginWaitCount","_isStarted","_shouldDestroyContentObjects","log","deprecated","addDirection","disableAnimation","deferUntilCompletionChecked","History","started","history","start","set","outstandingChecks","get","checkIfAnyChecksOutstanding","model","off","on","wait","Wait","beginWait","endWait","ready","isEventListening","_events","listenTo","isWaitingForPlugins","name","object","Array","isArray","forEach","register","split","view","View","template","isModelSetAndInvalid","prototype","Function","Error","isViewSetAndInvalid","assign","nameModelViewOrData","toJSON","foundName","entries","key","entry","names","_view","_component","_type","filter","find","pop","getViewName","warnOnce","isBackboneView","nameModelOrData","isViewOnlyQuestion","_isQuestionType","_model","getModelName","isBackboneModel","id","data","findById","parentView","idPathToView","currentLocationId","_currentId","currentLocationModel","getAncestorModels","modelId","unshift","warn","foundView","currentId","childViews","getChildViews","trackingPosition","findByTrackingPosition","relativeString","splitIndex","search","type","slice","replace","offset","parseInt","trim","defaultDirection","config","$","addClass","attr","disableAnimationArray","i","l","is","toggleClass","currentView","setOnChildren","queue","destroy","LockingModel","mode","args","onRender","cb","intercept","Handlebars","templates","partials","preRenderEvent","TemplateRenderEvent","Adapt","postRenderEvent","hierarchy","iterator","props","children","child","clone","isDeep","modifier","cloned","descriptors","getOwnPropertyDescriptors","descriptor","defineProperty","$$typeof","writable","component","html","ref","node","HTMLReactParser","render","compile","output","helper","helpers","call","string","classes","flatten","join","_imgLazyLoad","applyImgLoadingFix","findImgTag","hasLoadingAttr","event","imgTagsFound","match","img","test","hasImageTagWithNoLoadingAttr","loading","_onBlur","_onClick","$body","_attachEventListeners","addEventListener","a11y","_isEnabled","_options","_isFocusNextOnDisabled","$element","target","removeAttr","currentTarget","focusNext","isAriaDisabled","closest","preventDefault","stopImmediatePropagation","_isFocusOnClickEnabled","$stack","toArray","parents","$focusable","_tabbableElements","focus","preventScroll","_onKeyDown","$html","showOnKeys","document","_start","_isFocusOutlineDisabled","_isFocusOutlineKeyboardOnlyEnabled","keyCode","_focusOutlineKeyboardOnlyIgnore","removeClass","_warned","_warnFirstOnly","hash","map","String","_warn","_canWarn","concat","_hasWarned","removed","_onTouchStart","_onTouchEnd","_onScrollEvent","_scrollDisabledElements","$window","_preventScrollOnKeys","_ignoreKeysOnElementsMatching","_isRunning","_touchStartEventObject","$elements","add","_checkRunning","clear","not","_stop","passive","fix","_preventScroll","$target","isGesture","touches","scrollingParent","_getScrollingParent","scroll","isTouchEvent","hasTouchStartEvent","originalEvent","directionY","_getScrollDirection","$parent","_isScrollable","_isScrolling","scrollType","css","pointerEvents","scrollTop","Math","ceil","innerHeight","outerHeight","scrollHeight","hasScrollingSpace","deltaY","_getScrollDelta","startOriginalEvent","currentY","pageY","previousY","hasDeltaY","wheelDeltaY","wheelDelta","removeEventListener","bindAll","_focusguard","_onWrapAround","_isPopupWrapFocusEnabled","stopPropagation","focusFirst","_floorStack","_focusStack","_tabIndexes","_ariaHiddens","_elementUIDIndex","ignoreInternalTrigger","opened","closed","$popupElement","silent","activeElement","_addPopupLayer","_isPopupManagementEnabled","push","_tabbableElementsExcludes","$branch","$siblings","siblings","each","index","item","$item","elementUID","a11y_uid","tabindex","ariaHidden","_isPopupTabIndexManagementEnabled","_isPopupAriaHiddenManagementEnabled","$items","_ariaHiddenExcludes","$focusElement","$previousFocusElement","_removeLastPopupLayer","previousTabIndex","previousAriaHidden","$original","fn","isFixedPostion","a11y_aria_label","limitedScrollTo","a11y_text","a11y_selected","a11y_on","isOn","$tabbable","findTabbable","toggleAccessible","a11y_only","scrollDisable","_isScrollDisableEnabled","scrollEnable","a11y_popup","popupOpened","a11y_cntrl","withDisabled","toggleEnabled","a11y_cntrl_enabled","toggleAccessibleEnabled","isReadable","findForward","selector","_findFirstForward","findWalk","_findFindForwardDescendant","focusNoScroll","returnOnly","findFirstReadable","focusOrNext","a11y_focus","dontDefer","a11y_alert","a11y_update","text","toggleHidden","a11y_popdown","$focusTarget","popupClosed","a11y_normalize","normalize","a11y_remove_breaks","removeBreaks","A11y","_isFocusAssignmentEnabled","_isAriaHiddenManagementEnabled","_focusableElements","_readableElements","_wrapStyleElements","isTabbable","_htmlCharRegex","_browserFocus","BrowserFocus","_keyboardFocusOutline","KeyboardFocusOutline","_wrapFocus","WrapFocus","_popup","Popup","_scroll","Scroll","Log","_removeLegacyElements","listenToOnce","_onConfigDataLoaded","_setupNoSelect","_onNavigationStart","_onNavigationEnd","_isActive","offlineStorage","isEnabled","_addFocuserDiv","_isReady","_disableTextSelectOnClasses","isMatch","some","className","append","$legacyElements","$navigationElements","remove","isHidden","isAccessibleEnabled","first","element","checkParents","isNotVisible","hasNativeFocusOrIsScreenReadable","childNodes","c","cl","childNode","isTextNode","nodeType","isOnlyWhiteSpace","nodeValue","$tag","$found","_findFirstForwardDescendant","nextAll","sibling","$sibling","reverse","parent","$notFound","stack","stackIndexPosition","childIndexPosition","stackEntry","$stackItem","splice","FocusOptions","perform","y","e","device","browser","scrollTo","htmls","isString","$div","stackIndex","outputs","nodes","usable","isStyleElement","apply","rtnText","outerHTML","textContent","enable","disable","setCloseTo","models","loadedData","Collection","LOG_LEVEL","ENUM","Logging","_config","_level","INFO","asLowerCase","_console","onLoadConfigData","loadConfig","debug","has","checkQueryStringOverride","matches","override","toUpperCase","_log","DEBUG","WARN","ERROR","FATAL","level","configLevel","isLogLevelAllowed","_logToConsole","shouldLogToConsole","asUpperCase","jsonext","attrs","url","fetch","success","isLoaded","version","semver","satisfies","includePrerelease","plugin","screenSize","large","medium","small","_forceRouteLocking","_canLoadData","_disableAnimation","paramMappings","dir","lang","params","URLSearchParams","passedVal","setValuesFromURLParams","canBubble","deepPath","timeStamp","json","attributes","_children","_parent","extend","_canShowFeedback","_classes","_canReset","_canRequestChild","_isComplete","_isInteractionComplete","_isA11yRegionEnabled","_isA11yCompletionDescriptionEnabled","_requireCompletionOf","_isResetOnRevisit","_isAvailable","_isOptional","_isRendered","_isVisible","_isLocked","_isHidden","firstDescendant","getAllDescendantModels","nearestTrackingIdModel","trackingId","trackingIdDescendants","indexInTrackingIdDescendants","findIndex","descendant","trackingIdAncestors","ancestorDistance","ancestor","hasManagedChildren","setupChildListeners","init","checkCompletionStatus","checkInteractionCompletionStatus","checkLocking","setupTrackables","originalTrackableStateFunction","triggerTrackableState","compose","isQueued","debounce","changed","trackablePropertyNames","changedPropertyNames","isTrackable","includes","getChildren","onAll","bubble","checkReadyStatus","onIsComplete","trackable","resultExtend","pick","state","getTrackableState","force","getAvailableChildModels","checkingCompletion","checkCompletionStatusFor","completionAttribute","completed","requireCompletionOf","every","checkedCompletion","typeGroup","hasUpperCase","isPluralized","lowerCased","toLowerCase","singular","singularLowerCased","pluralizedLowerCaseTypes","typeGroups","getTypeGroups","intersection","_typeGroups","parentClass","getPrototypeOf","getTypeGroup","uniq","s","ancestorType","getParent","isTypeGroup","findAncestor","descendants","allDescendantsModels","returnedDescendants","where","property","isParentFirst","subDescendants","rootModel","limitParentId","course","relativeDescriptor","parseRelativeString","searchBackwards","moveBy","abs","movementCount","hasDescendantsOfType","findDescendantModels","pageDescendants","modelIndex","pageDescendant","isFilterFunction","loop","totalOfType","count","isSelf","_childrenCollection","childrenCollection","comparator","sort","setChildren","_parentModel","parentId","setParent","shouldIncludeChild","context","passSiblingsAndIncludeSelf","_hasSiblingsAndSelf","siblingsCollection","lockType","setSequentialLocking","setUnlockFirstLocking","setLockLastLocking","setCustomLocking","j","isFirstChildComplete","lastIndex","shouldLock","lockedBy","isResetOnRevisit","reset","ModelClass","constructor","clonedModel","clonedId","hasId","shouldAssignUniqueId","cid","uniqueId","cidPrefix","deepClone","setupModel","ModelEvent","addPath","isParentCourse","AdaptModel","MenuModel","ContentObjectModel","CourseModel","StartController","replaceState","getStartHash","startIds","startId","_skipIfComplete","alwaysForce","getStartId","isRouteSpecified","href","indexOf","shouldForceStartId","shouldNavigateToStartId","_className","skipIfComplete","_id","hasClass","startController","loadCourseData","setStartLocation","returnToStartLocation","Data","getModelClass","parse","onAdded","onRemoved","_byAdaptID","build","BuildModel","whenReady","loadConfigData","ConfigModel","onLoadCourseData","onLanguageChange","onDirectionChange","direction","language","newLanguage","courseFolder","loadManifestFiles","triggerDataLoaded","triggerDataReady","triggerInit","path","reject","getJSON","__path__","fail","languagePath","manifestPath","manifest","all","filePath","allFileData","allModelData","fileData","modelData","router","navigate","isReady","trackingIdModel","AdaptCollection","OfflineStorage","handler","_handler","save","serialize","JSON","stringify","deserialize","COMPLETION_STATE","Tracking","_requireContentCompleted","_requireAssessmentCompleted","_assessmentState","setupEventListeners","onAssessmentComplete","onAssessmentRestored","checkCompletion","assessmentState","completionData","getCompletionData","status","INCOMPLETE","assessment","isPass","PASSED","FAILED","COMPLETED","tracking","Device","touch","Modernizr","touchevents","screenWidth","getScreenWidth","screenHeight","getScreenHeight","Bowser","OS","getOperatingSystem","osVersion","osversion","renderingEngine","getRenderingEngine","onWindowResize","onConfigDataLoaded","browserString","getAppleDeviceType","pixelDensity","checkScreenSize","orientation","screenSizeConfig","screensizeEmThreshold","baseFontSize","mediumEmBreakpoint","smallEmBreakpoint","fontSize","parseFloat","screenSizeEmWidth","isAppleDevice","getAppleScreenWidth","innerWidth","width","getAppleScreenHeight","height","flags","os","platform","navigator","previousWidth","previousHeight","newScreenSize","userAgent","MSStream","screen","devicePixelRatio","DrawerItemView","role","el","appendTo","eventCallback","DrawerView","drawerDir","drawerDuration","_duration","toggleDrawer","openCustomView","onCloseDrawer","onRemove","onKeyUp","setupEscapeKey","which","drawer","_globals","prependTo","shadowTemplate","shadow","postRender","checkIfDrawerIsAvailable","hasBackButton","_hasBackButton","_isCustomViewVisible","showDrawer","isEmptyDrawer","collection","hideDrawer","$toElement","emptyDrawer","$el","renderItems","hideDrawerBackButton","complete","addShadowEvent","velocity","opacity","duration","easing","_showEasing","empty","_hideEasing","removeShadowEvent","one","childContainer","childView","DrawerCollection","Drawer","addItem","drawerObject","triggerCustomView","updateIndexPosition","updatePushPosition","preRender","hasBeenRemoved","delay","closePush","elementHeight","navigationHeight","currentIndex","flippedIndex","positionLowerPush","_showIcon","_timeout","NotifyModel","onPushAdded","onRemovePush","checkPushCanShow","canShowPush","showPush","availablePushNotifications","NotifyPushView","inactivePushNotifications","isForced","isStoppedImmediate","isStoppedNext","hasRequestChild","immediate","stopNext","AdaptView","toggleVisibility","onIsCompleteChange","isReact","_classSet","Set","_isRemoved","setupOnScreenHandler","addChildren","eventName","startsWith","updateViewProperties","ReactDOM","classesToAdd","classesToRemove","delete","_setAttributes","onscreen","m","minVerticalInview","_percentInviewVertical","percentInviewVertical","nthChild","addDescendants","addedCount","_getAddChildEvent","subsequentModels","ChildView","getViewClass","addChildView","setChildViews","$parentContainer","addedDescendantCount","onReadyChange","stopListening","isRequestChild","ChildEvent","canRequestChild","close","findDescendantViews","descendantComponents","preRemove","for","unmountComponentAtNode","isComplete","_childViews","indexBy","isOpen","hasOpened","closeNotify","resetNotifySize","cancelNotify","notify","showNotify","resizeNotify","windowHeight","notifyHeight","isFullWindow","addSubView","$previousActiveElement","imageready","onLoaded","onOpened","inview","subView","prepend","check","stackItem","onCloseReady","removeSubView","views","Notify","_stack","notifyPushes","NotifyPushCollection","_deprecated","notifyObject","create","_isCancellable","_showCloseButton","_closeOnShadowClick","NotifyView","_canNavigate","_shouldNavigateFocus","Router","_isBackward","_navigationRoot","_isCircularNavigationInProgress","showLoading","$wrapper","setDocumentTitle","navigateToArguments","show","hide","currentModel","_currentModel","hasSubTitle","title","escapedTitle","v","handleRoute","handleId","handlePluginRouter","action","pluginLocation","updateLocation","isContentObject","navigateToId","isRoot","_isMenuDisabled","_previousId","navigateBack","isCourse","handleNavigationFocus","ViewClass","isMenu","invoke","isScrolling","navigateToElement","currentLocation","_previousModel","_previousContentType","_contentType","_currentLocation","_lastVisitedType","_lastVisitedMenu","_lastVisitedPage","setGlobalClasses","htmlClasses","currentClasses","_previousClasses","back","route","previousModel","navigateToParent","parentModel","settings","currentModelId","shouldReplace","contentObject","contentObjectId","isNotInCurrentContentObject","renderTo","disableScrollToAnimation","offsetTop","scrolling","isLegacyScrolling","top","left","axis","RouterModel","loadSubset","groupBy","ArticleModel","BlockModel","ComponentModel","_isA11yComponentDescriptionEnabled","_userAnswer","_attemptStates","onAdaptInitialize","restoreUserAnswers","resetUserAnswer","trackables","types","trackableType","n","booleans","numbers","Number","arrays","getAttemptState","shift","getAttemptObject","attemptStates","states","PageModel","setVisibility","lock","_isTriggeredReady","performIsReady","unlock","styleOptions","isRenderToSelf","ids","forceUntilId","addingId","PageView","$pageLabel","ContentObjectView","ArticleView","setHidden","BlockView","MPABC","waitForDataLoaded","loaded","onDataLoaded","setupSubsetCollections","contentObjects","AdaptSubsetCollection","articles","blocks","components","mpabc","defaultAriaLevels","lowercase","capitalise","charAt","inc","dec","odd","equals","block","compare","operator","inverse","math","lvalue","rvalue","any","specified","none","toString","root","compile_a11y_text","compile_a11y_normalize","compile_a11y_remove_breaks","import_globals","import_adapt","adapt","directImport","indexedImport","importArray","importIndex","i1","l1","component_description","isNotDefined","_components","hasOverride","description","ariaRegion","SafeString","a11y_aria_label_relative","a11y_aria_image","texts","a11y_wrap_focus","cfg","a11y_attrs_heading","levelOrType","_ariaLevel","isNaN","_ariaLevels","a11y_attrs_tabbable","a11y_alt_text","visible","alternatives","if_value_equals","lowerCase","registerHelper","Scrolling","$app","_checkApp","_loadConfig","limitTo","_limitToSelector","isIncluded","_addStyling","_fixJQuery","_fixScrollTo","_fixBrowser","selectorScrollTop","body","selectorOffset","coordinates","elementOffset","isCorrectedContainer","scrollLeft","appOffset","selectorScrollTo","app","x","HeadingView","customHeadingType","Headings","onViewRender","$headingSeats","NavigationView","hideNavigationButton","_accessibility","insertBefore","currentEvent","navigateToPreviousRoute","navigateToHomeRoute","skipNavigation","shouldHide","NavigationController","addNavigationBar","adaptConfig","_isDefaultNavigationDisabled","navigation","_isVisited","isActive","isVisited","_items","setUpItems","booleanArray","items","_index","ItemModel","findWhere","getVisitedItems","storeUserAnswer","areAllItemsCompleted","setCompletionStatus","toggleActive","getItem","activeItem","getActiveItem","AccordionModel","ItemsComponentModel","_shouldCollapseItems","_toggleSpeed","previousActiveItem","toggleVisited","ComponentView","inviewElementSelector","$inviewElement","inviewCallback","onInview","visiblePartX","visiblePartY","hasSeenTop","hasSeenBottom","removeInviewListener","AccordionView","checkIfResetOnRevisit","resetActiveItems","onItemsActiveChange","onItemsVisitedChange","setReadyStatus","setupInviewCompletion","toggleItemsState","toggleItem","getItemElement","shouldExpand","stop","slideUp","slideDown","AssessmentResultsModel","onAssessmentReset","assessmentModel","getState","allowResetIfPassed","_state","attempts","attemptsSpent","attemptsLeft","score","scoreAsPercent","maxScore","setFeedbackBand","checkRetryEnabled","setFeedbackText","scoreProp","isPercentageBased","bands","sortBy","isScoreInBandRange","_score","canResetInPage","feedbackBand","isRetryEnabled","_allowRetry","isAttemptsLeft","showRetry","_isRetryEnabled","retryFeedback","feedback","isVisibleBeforeCompletion","wasVisible","isAttemptInProgress","attemptInProgress","hasHadAttempt","isVisible","resetType","_feedbackBand","AssessmentResultsView","setLocking","unsetLocking","addClassesToArticle","checkIfAssessmentComplete","wasReset","_routeToAssessment","articleId","BlankView","BUTTON_STATE","textPropertyName","onButtonStateChanged","onFeedbackMessageChanged","onAttemptsChanged","onCanSubmitChange","buttons","refresh","isSubmitted","buttonState","checkResetSubmittedState","SHOW_CORRECT_ANSWER","correctAnswer","getCorrectAnswerAsText","updateAnswerLiveRegion","HIDE_CORRECT_ANSWER","userAnswer","getUserAnswerAsText","SHOW_FEEDBACK","changedAttribute","updateAttemptsCount","$buttonsAction","CORRECT","INCORRECT","propertyName","asString","ariaLabel","buttonText","canShowFeedback","isInteractionComplete","shouldDisplayAttempts","attemptsString","remainingAttemptText","remainingAttemptsText","showMarking","answer","shouldShowMarking","isCorrect","ariaLabels","_ariaLabels","answeredCorrectly","answeredIncorrectly","checkFeedbackState","QuestionModel","_shouldDisplayAttempts","_canShowModelAnswer","_canShowMarking","_canSubmit","_isSubmitted","_questionWeight","setupDefaultSettings","setupWeightSettings","setupButtonSettings","globalButtons","componentButtons","canSubmit","canShowModelAnswer","SUBMIT","RESET","setupCorrectFeedback","isPartlyCorrect","setupPartlyCorrectFeedback","setupIncorrectFeedback","feedbackTitle","getFeedbackTitle","feedbackMessage","correct","_partlyCorrect","final","setAttemptSpecificFeedback","_incorrect","notFinal","_attemptsLeft","_isCorrect","_buttonState","addAttemptObject","QuestionView","onEnabledChanged","_runModelCompatibleFunction","setupQuestion","disableQuestion","enableQuestion","resetQuestionOnRevisit","onHideCorrectAnswerClicked","onResetClicked","addButtonsView","onQuestionRendered","buttonsView","ButtonsView","onButtonStateUpdate","onSubmitClicked","onShowCorrectAnswerClicked","showFeedback","showInstructionError","onCannotSubmit","removeInstructionError","recordInteraction","resize","onSubmitted","setQuestionAsSubmitted","checkQuestionCompletion","setQuestionAsReset","resetQuestion","checkCanSubmit","getButtonState","setQuestionAsShowCorrect","showCorrectAnswer","setQuestionAsHideCorrect","hideCorrectAnswer","lookForViewOnlyFunction","ViewOnlyQuestionViewCompatibilityLayer","getInteractionObject","getResponse","getResponseType","updateAttempts","_isInViewOnlyCompatibleMode","markQuestion","setScore","updateButtons","setupFeedback","checkForFunction","hasCompatibleVersion","usingCompatibleVersion","McqView","events","isCorrectAnswerShown","initialize","update","setupRandomisation","onKeyPress","onItemSelect","onItemFocus","isInteractive","onItemBlur","itemModel","shouldSelect","isSingleSelect","isAtActiveLimit","getLastActiveItem","resetItems","updateSelection","updateMarking","isSelected","prop","canShowMarking","$itemInput","shouldBeSelected","incorrect","selectedAnswer","unselectedAnswer","BlendedItemsComponentQuestionModel","getOwnPropertyNames","itemModels","shuffle","activeItems","getActiveItems","a","b","_numberOfRequiredAnswers","_numberOfIncorrectAnswers","_isAtLeastOneCorrectSelection","_numberOfCorrectAnswers","itemShouldBeActive","hasRightNumberOfCorrectAnswers","hasNoIncorrectAnswers","questionWeight","setupIndividualFeedback","selectedItem","selectedItems","interactions","correctResponsesPattern","choices","correctItems","activeIndexes","globals","ariaAnswer","ariaCorrectAnswer","ariaCorrectAnswers","correctOptions","_shouldBeSelected","correctOption","ariaUserAnswer","ariaUserAnswers","ItemsQuestionModel","Gmcq","Mcq","resizeImage","onDeviceResize","setUpColumns","imageWidth","$img","newSrc","columns","isLarge","GraphicView","setupInView","imageSrc","HotgraphicPopupView","onControlClick","applyNavigationClasses","updatePageCount","handleTabs","itemCount","canCycleThroughPagination","shouldEnableBack","shouldEnableNext","$controls","_hotgraphic","popupPagination","labelText","itemNumber","totalItems","applyItemClasses","handleFocus","getNextIndex","setItemState","nextItem","HotGraphicView","setUpViewData","setUpModelData","setUpEventListeners","popupView","_isPopupOpen","reRender","replaceWithNarrative","NarrativeView","prepareNarrativeModel","newNarrative","$container","findViewByModelId","_wasHotgraphic","originalBody","originalInstruction","$pin","visitedLabel","visited","innerHTML","openPopup","popup","onPopupClosed","HotgraphicView","DropDownItem","$inner","isPlaceholder","onClick","select","$button","getValue","deselectAll","setActiveDescendantId","selected","$input","val","deselect","removeActiveDescendantId","reselect","getIndex","option","getNext","getPrevious","getFirst","getLast","scrollToItem","placeholder","DropDown","getDefaults","setUpElements","addEventListeners","toggleOpen","load","openList","closeList","$list","$options","DropDownOption","onStartInteraction","click","onButtonClick","onListBlur","onKeyDown","wasOpen","getFirstSelectedItem","open","blurTimeout","handleBlur","toggleDisabled","isEmpty","removeEventListeners","offsetLeft","outerWidth","getBoundingClientRect","isOffscreen","clientHeight","pos","MatchingView","dropdowns","dropdown","onPostRemove","onOptionSelected","setUpDropdowns","selectedOption","_isSelected","itemIndex","optionIndex","setOptionSelected","eq","resetAll","selectValue","_selected","answerArray","MatchingModel","setupQuestionItemIndexes","tempUserAnswer","o","_tempUserAnswer","numberOfCorrectAnswers","itemLength","source","questionIndex","responses","correctAnswerTemplate","_matching","itemText","userAnswerTemplate","mepPrototype","mejs","MediaElementPlayer","detectFullscreenMode","vendorPrefix","getVendorPrefix","fsEventName","fullScreenEventHandler","elementName","froogaloopAdded","purge","d","MepDefaults","keyActions","defaultSeekForwardInterval","defaultSeekBackwardInterval","MediaView","playerOptions","toggleCaptionsButtonWhenOnlyOne","onScreenSizeChanged","onDeviceChanged","onMediaStop","_isMediaEnded","_isMediaPlaying","media","protocol","setupPlayer","addMejsButtonClass","modelOptions","pluginPath","flashName","flashScriptAccess","features","onPlayerReady","startLanguage","checkForSupportedCCLanguage","alwaysShowControls","hideVideoControlsOnLoad","addMediaTypeClass","addThirdPartyFixes","mediaelementplayer","cleanUpPlayer","_media","mp3","mp4","ogv","webm","typeClass","ogg","getScript","done","completionEvent","mediaElement","onMediaElementSeeking","onMediaElementTimeUpdate","onMediaElementPlay","onMediaElementPause","onMediaElementEnded","listenForCaptionsChange","srclang","player","selectedTrack","onCaptionsChanged","setTrack","$inputs","cc","queueGlobalEvent","onMediaElementInview","isInView","paused","pause","maxViewed","currentTime","clickToPlayPause","onOverlayClick","onMediaElementClick","play","isPaused","isRemoved","playerId","players","src","pluginElement","domObject","hasTouch","MediaFeatures","setupPlayPauseToggle","addThirdPartyAfterFixes","cleanUpPlayerAfter","setVolume","$transcriptBodyContainer","$buttonText","inlineTranscriptButton","inlineTranscriptCloseButton","_setCompletionOnView","eventType","time","Date","now","lastEvent","timeSinceLastEvent","debounceTime","eventTimeout","triggerGlobalEvent","eventObj","pluginType","isVideo","_isInitial","renderMode","calculateWidths","setStage","setFocus","$straplineHeaderElm","hasStraplineTransition","isLargeMode","focusOnNarrativeElement","dataIndexAttr","$elementToFocus","MODE","LARGE","SMALL","calculateMode","setupNarrative","replaceInstructions","_totalWidth","_itemWidth","previousMode","evaluateNavigation","replaceWithHotgraphic","resizeControl","evaluateCompletion","prepareHotgraphicModel","newHotgraphic","instruction","cssValue","$sliderElm","indexSelector","$slideGraphics","$narrativeItems","$narrativeStraplineButtons","shouldShowInstructionError","moveSliderToIndex","active","isAtStart","isAtEnd","$left","$right","ariaLabelsGlobals","narrativeGlobals","_narrative","ariaLabelPrevious","previous","ariaLabelNext","next","prevTitle","nextTitle","currentItem","$btn","setActiveItem","prevItemIndex","SliderView","setAllItemsEnabled","deselectAllItems","selectItem","getIndexFromValue","$sliderScaleMarker","$slider","rangeslider","polyfill","onSlide","handleSlide","oldValue","_deferEnable","position","pixels","mapIndexToPixels","animateToPosition","setupRangeslider","setScalePositions","showScaleMarker","newPosition","mobileHA","itemValue","scaleStart","scaleEnd","round","mapValue","$widthObject","numberOfItems","low","high","range","inputLow","inputHigh","outputLow","outputHigh","normal","normalise","newItemIndex","max","min","setSliderValue","getValueFromIndex","animate","change","resetControlStyles","normalisedPosition","$markers","$scaler","showScaleNumbers","$numbers","scaleWidth","$number","newLeft","showScale","showLabels","remapSliderBar","answers","getCorrectAnswers","middleAnswer","floor","showModelAnswers","correctAnswerArray","$parentDiv","startingLeft","fadeIn","userAnswerIndex","showNumber","$scaleMarker","SliderModel","setupModelItems","selectDefaultItem","num","step","dp","getDecimalPlaces","toFixed","_bottom","_top","answerSingle","answerMultiple","bottom","_slider","ariaCorrectAnswerRange","answerTemplate","TextView","setupInview","getInviewElementSelector","TextInputView","clearValidationError","showValidationError","correctAnswers","_answers","onInputChanged","setItemUserAnswer","TextInputModel","genericAnswerIndexOffset","_answerIndex","genericAnswers","answerIndex","markGenericAnswers","markSpecificAnswers","contains","pluck","usedAnswerIndexes","answerGroup","checkAnswerIsCorrect","cleanupUserAnswer","possibleAnswers","uAnswer","matched","cAnswer","answerIsCorrect","AssessmentView","AdaptArticleView","isAssessmentEnabled","_setupEventListeners","getConfig","_questions","_onAssessmentComplete","_onAssessmentReset","_onRemove","_removeEventListeners","QuestionBank","quizBankid","numQuestionBlocks","uniqueQuestions","_articleId","_numQuestionBlocks","_uniqueQuestions","questionBlocks","unUsedQuestionBlocks","usedQuestionBlocks","getID","addBlock","getRandomQuestionBlocks","checkResetUnunsedBlocks","question","getRandomQuestion","random","questionBlock","givenIdCount","assessmentConfigDefaults","_resetType","_suppressMarking","_isPercentageBased","_scoreToPass","_includeInTotalScore","_assessmentWeight","_reloadPageOnReset","_attempts","_allowResetIfPassed","AssessmentModel","_postInitialize","assessmentConfig","_currentQuestionComponents","_originalChildModels","_questionBanks","_forceResetOnRevisit","_currentQuestionComponentIds","_assessmentCompleteInSession","_attemptInProgress","_isAssessmentComplete","_numberOfQuestionsAnswered","_lastAttemptScoreAsPercent","_attemptsSpent","_onDataReady","comp","_setAssessmentOwnershipOnChildrenModels","_updateQuestionsState","childConfig","_isPartOfAssessment","_assessmentId","blockModel","_setupAssessmentData","shouldResetAssessment","shouldResetQuestions","quizModels","_banks","_split","_setupBankedAssessment","_randomisation","_setupRandomisedAssessment","_resetQuestions","finalise","_overrideQuestionComponentSettings","_setupQuestionListeners","_checkNumberOfQuestionsAnswered","saveState","_setupBanks","questionModels","bankId","questionBank","questions","banks","bank","blockAssessmentConfig","_quizBankID","randomisationModel","blockModels","_blockCount","newSettings","_getMarkingSettings","questionConfig","questionComponents","_onQuestionCompleted","numberOfQuestionsAnswered","_removeQuestionListeners","questionModel","_checkAssessmentComplete","allQuestionsAnswered","_spendAttempt","_getScoreAsPercent","_getScore","_getMaxScore","_scoreAsPercent","_maxScore","_checkIsPass","_isMarkingSuppressionEnabled","_isAttemptsLeft","_overrideMarkingSettings","_refreshQuestions","questionComponent","scoreToPass","markingSettings","_shouldSuppressMarking","newMarkingSettings","_getLastAttemptScoreAsPercent","_checkReloadPage","_reloadPage","syncIterations","qs","len","_setCompletionStatus","_checkIfQuestionsWereRestored","wereQuestionsRestored","_isResetInProgress","isPageReload","getSaveState","banksActive","randomisationActive","isInteger","blockTrackingIds","blockCompletion","blockData","dataPackage","setRestoreState","restoreState","_trackingId","blockIndex","blockQuestions","pageId","includeInTotalScore","assessmentWeight","lastAttemptScoreAsPercent","assessmentsConfigDefaults","_isDefaultsLoaded","_assessments","_byPageId","_byAssessmentId","_onAssessmentsComplete","_checkResetAssessmentsOnRevisit","_handleRoute","assessmentId","_getStateByAssessmentId","_setPageProgress","_checkAssessmentsComplete","_restoreModelState","_saveStateModel","toObject","pageAssessmentModels","_getAssessmentByPageId","resetAllAssessments","allAssessmentHaveReset","numberOfAssessments","numberOfResetAssessments","forceAssessmentReset","haveAllModelsReset","_restoredCount","allAssessmentsComplete","assessmentToPostBack","_getStatesByAssessmentId","assessmentStates","_setupSingleAssessmentConfiguration","assessmentsConfig","k","assessments","assessmentsTotal","assessmentsPassed","pageModel","_subProgressTotal","_subProgressComplete","_addToAssessmentIdMap","_setupQuestionNumbering","getRelatedQuestions","currentAssessmentId","currentAssessment","getQuestionNumber","related","getTotalQuestions","totalAssessments","assessmentsComplete","Events","ArticleViewInitialize","AdaptAssessmentArticleView","ArticleModelInitialize","AdaptAssessmentArticleModel","returnValue","Bookmarking","bookmarkLevel","restoredLocationID","currentLocationID","checkIsEnabled","checkRestoreLocation","courseBookmarkModel","_onScroll","checkLocation","setupMenu","setupPage","restoreLocation","isAlreadyOnScreen","_showPrompt","navigateToPrevious","showPrompt","locationOnscreen","isLocationOnscreen","percentInview","isLocationFullyInview","_buttons","yes","no","navigateCancel","prompt","_prompts","promptText","_callbackEvent","isSinglePage","setLocationID","menuView","menuModel","resetLocationID","defaultLevel","bookmarkModel","isInherit","pageView","pageBookmarkModel","getBookmarkLevel","releaseViews","possibleViewIds","desc","highestOnscreen","highestOnscreenLocation","measurements","setupHelpers","LanguagePickerView","initializeNavigation","onLanguageClick","destroyNavigation","setLanguage","navigationView","LanguagePickerDrawerView","onDoChangeLanguage","onDontChangeLanguage","getLanguageDetails","promptObject","_attributes","_direction","warningTitle","warningMessage","$finishFocus","setTrackedData","LanguagePickerNavView","tagName","classNames","customClass","LanguagePickerModel","displayTitle","_languages","trackedData","locationId","markLanguageAsSelected","_language","_activeLanguage","_defaultDirection","isTrackedDataEmpty","setTrackableState","isEqual","compact","stateObject","restoreModel","languagePickerModel","onConfigLoaded","setupNavigationView","onOfflineStorageReady","storedLanguage","showLanguagePickerView","languagePickerView","courseGlobals","_extensions","navigationBarLabel","_languagePicker","languagePickerNavView","Completion","subProgressCompleted","subProgressTotal","nonAssessmentCompleted","nonAssessmentTotal","assessmentCompleted","assessmentTotal","calculateCompletion","contentObjectModel","completion","viewType","availableChildren","filterAvailableChildren","getPageLevelProgressEnabledModels","nonAssessmentComponents","getNonAssessmentComponents","getComponentsCompleted","assessmentComponents","getAssessmentComponents","getComponentsInteractionCompleted","_excludeAssessments","showPageCompletionCourse","_showPageCompletion","showPageCompletionPage","completionObject","unavailableInHierarchy","calculatePercentageComplete","total","percentageComplete","PageLevelProgressIndicatorView","calculatePercentage","addClasses","setPercentageComplete","checkAria","getRenderData","percentage","PageLevelProgressItemView","addIndicator","PageLevelProgressView","scrollToPageElement","currentComponentSelector","$children","PageLevelProgressNavigationView","deferredUpdate","updateProgressBar","refreshProgressBar","indicatorView","_getPageCompletionPercentage","_pageLevelProgress","pageLevelProgressIndicatorBar","completionCalculations","repopulate","onProgressClicked","PageLevelProgressCollection","_pageModel","allDescendants","currentPageItems","availableItems","enabledProgressItems","PageLevelProgress","onDataReady","getCourseConfig","coursePLPConfig","headerIndicatorTypes","headerIndicatorEventNames","renderHeaderIndicatorView","renderMenuItemIndicatorView","renderNavigationView","onCompletionChange","completionState","hasChanged","_previousCompletionState","_isCompletionIndicatorEnabled","pageConfig","$headings","insertAfter","pageLevelProgress","_getMenuItemCompletionPercentage","pageLevelProgressMenuBar","_isShownInNavigationBar","pagePLPConfig","after","ResourcesView","resources","onFilterClicked","resources_has_type","hasType","matcher","resources_has_multiple_types","allSameType","resources_get_column_count","resources_force_download","resource","_forceDownload","filename","setupResources","resourcesData","resourcesModel","resourcesCollection","initResources","courseResources","drawerOrder","_drawerOrder","Logger","logArr","registeredViews","str","LOG_TYPE_INFO","updateViews","LOG_TYPE_WARN","LOG_TYPE_ERROR","LOG_TYPE_DEBUG","instance","ScormError","CLIENT_COULD_NOT_CONNECT","SERVER_STATUS_UNSUPPORTED","CLIENT_STATUS_UNSUPPORTED","CLIENT_COULD_NOT_COMMIT","CLIENT_NOT_CONNECTED","CLIENT_COULD_NOT_FINISH","CLIENT_COULD_NOT_GET_PROPERTY","CLIENT_COULD_NOT_SET_PROPERTY","CLIENT_INVALID_CHOICE_VALUE","defaultMessages","pressOk","ScormWrapper","setCompletedWhenFailed","commitOnStatusChange","commitOnAnyChange","timedCommitFrequency","maxCommitRetries","commitRetryDelay","commitRetryPending","commitRetries","lastCommitSuccessTime","exitStateIfIncomplete","exitStateIfComplete","timedCommitIntervalID","retryCommitTimeoutID","logOutputWin","startTime","endTime","lmsConnected","finishCalled","logger","getInstance","scorm","pipwerks","SCORM","handleExitMode","suppressErrors","debouncedCommit","commit","__debug","showDebugWindow","API","__offlineAPIWrapper","API_1484_11","handleError","initTimedCommit","isSCORM2004","setValue","setIncomplete","setCompleted","setPassed","setFailed","minScore","scaledScore","isSupported","initRetryCommit","errorCode","getCode","errorInfo","getInfo","diagnosticInfo","getDiagnosticInfo","clearInterval","convertToSCORM2004Time","getTime","getExitState","convertToSCORM12Time","quit","response","latency","info","recordInteractionMultipleChoice","recordInteractionMatching","recordInteractionScorm2004","recordInteractionScorm12","recordInteractionFillIn","setInterval","doRetryCommit","messages","_messages","message","confirm","cmiPrefix","getInteractionCount","getCMITime","getISO8601Timestamp","checkResponse","scormRecordInteraction","maxLength","substr","msConvert","msPerSec","msPerMin","msPerHour","ms","secs","mins","hrs","padWithZeroes","csConvert","csPerSec","csPerMin","csPerHour","csPerDay","days","hours","cs","seconds","hms","date","getHours","getMinutes","sec","getSeconds","toISOString","numToPad","padBy","responseType","self","checkIdentifier","r","identifiers","completionStatus","isIncomplete","exitState","ZeroString","makeZeroString","zeroPadRightToLength","padLength","zeroPadLeftToLength","zeroPadRightToMultiple","multiple","binaryToUnsignedInteger","binary","binaryLength","integer","shiftUnsignedIntegerFromBinary","shiftBinary","shifted","unsignedIntegerToBinary","byteArrayToString","array","arrayLength","fromCharCode","stringToByteArray","stringLength","charCodeAt","BYTE_BIT_LENGTH","binaryToBase64","bytesCount","charCodes","base64","btoa","base64ToBinary","atob","logs","usedTypes","typeLengths","binarySamples","AbstractValueType","binaryTypeLength","binaryType","FixedIntegerType","esType","valueBinaryLength","minValue","maxValue","pow","logStats","FixedBooleanType","bool","LengthAndValueBinary","bitSizes","maxValues","sizeBinaryLength","parentName","sizeIndex","sizeBinary","valueLength","integerBinary","VariableIntegerType","isNegative","integerBitSizes","valueToBinary","shiftValueFromBinary","VariableArrayType","valueType","findValueTypeFromValues","shiftValueTypeFromBinary","VariableSignedIntegerType","signBinary","VariableDecimalType","isFloat","decimal","decimalBitSizes","float","parts","higherInteger","lowerInteger","integerValueBinary","decimalValueBinary","arrayType","booleanType","integerTypes","decimalTypes","ValueTypes","nameIndex","esTypeOf","findValueTypeFromName","findValueTypeFromValue","isValueInValueTypeRange","esTypes","uniqESTypes","isRangeInValueTypeRange","convertValuesToNumbers","Converter","err","typeName","clearLog","hasInitialType","printLog","valueFromBinary","SCORMSuspendData","ComponentSerializer","trackingIdType","shouldStoreResponses","shouldStoreAttempts","isContainer","modelState","hasUserAnswer","isUserAnswerArray","hasAttemptStates","trackingIdMap","setAttemptObject","attemptObject","StatefulSession","_trackingIdType","_componentSerializer","_shouldStoreResponses","_shouldStoreAttempts","_shouldRecordInteractions","beginSession","restoreSession","spoor","_tracking","_advancedSettings","setVersion","_showDebugWindow","_scormVersion","isBoolean","_suppressErrors","_commitOnStatusChange","_commitOnAnyChange","isFinite","_timedCommitFrequency","_maxCommitRetries","_commitRetryDelay","_exitStateIfIncomplete","_exitStateIfComplete","setupLearnerInfo","restoreSessionState","_learnerInfo","sessionPairs","hasNoPairs","_isAssessmentPassed","q","debouncedSaveSession","saveSessionState","onLanguageChanged","onQuestionRecordInteraction","onTrackingComplete","advancedSettings","shouldCommitOnVisibilityChange","_commitOnVisibilityChangeHidden","onVisibilityChange","endSession","courseState","componentStates","printCompletionInformation","suspendData","courseComplete","assessmentPassed","trackingIdModels","trackingIds","completionString","markers","mark","_reporting","_resetStatusOnLanguageChange","visibilityState","questionView","getLatency","stateModel","shouldSubmitScore","_shouldSubmitScore","scoreArgs","_onTrackingCriteriaMet","_onAssessmentFailure","finish","statefulSession","temporaryStore","suspendDataStore","suspendDataRestored","useTemporaryStore","getCustomStates","getLessonLocation","getScore","getStatus","student","getStudentName","learnerInfo","getLearnerInfo","getCustomState","stateArray","_isCourseComplete","questionsState","isObject","setLessonLocation","setStatus","dataAsString","setSuspendData","isSuspendDataStoreEmpty","getSuspendData","dataAsJSON","getStudentId","firstname","lastname","hasName","isNameCommaSeparated","isNameSpaceSeparated","separator","nameParts","part","Spoor","_prepare","require","onKeyCombo","TrickleView","isSteplocked","AdaptEvents","onKill","onPreRender","onPostRender","onStepLock","onStepUnlock","trickle","getCompletionAttribute","isElementEnabled","getModelConfig","isArticleWithOnChildren","_onChildren","continueToNext","isSteplocking","_stepLocking","detachFromElement","undelegateEvents","articleModel","currentDescendantIndex","currentLocksOnDescendant","currentDescendant","isPageEnabled","detachFromPage","setupDescendants","haveDescendantsGotTrickle","addClassToHtml","trickleConfig","descendantViews","getDescendants","descendantsChildFirst","descendantsParentFirst","setDescendantsTrickleDefaults","filterComponents","setModelConfig","setupArticleOnChildren","articleTrickleConfig","articleBlocks","blockTrickleConfig","_isFinal","_isStart","onDescendantPreRender","onUnwait","onWait","onContinue","onSkip","onPageReady","descendantView","gotoNextDescendant","finished","lastDescendant","TrickleButtonView","isStepLocking","hasStepLocked","isStepLocked","isStepLockFinished","hasStepPreCompleted","isWaitingForClick","allowVisible","allowEnabled","overlayShownCount","setupPreRender","setupButtonVisible","setupButtonEnabled","_button","_styleBeforeCompletion","_autoHide","_isFullWidth","_isCompletionRequired","_isDisabled","debounceCheckAutoHide","setupStepLocking","_completionAttribute","onOverlay","onUnoverlay","onUpdate","onCompletion","checkButtonAutoHideSync","checkButtonAutoHide","setButtonVisible","isJustOffscreen","checkButtonEnabled","setButtonEnabled","HTMLElement","isSameNode","isViewMatch","isButtonEnabled","isCompleteAndShouldRelock","_isLockedOnRevisit","stepCompleted","setupOnScreenListener","_styleAfterClick","$newEl","replaceWith","setElement","TrickleButtonHandler","buttonViews","onAppDataReady","isTrickleEnabled","setupConfigDefaults","ButtonView","_hasIcon","startText","finalText","_isLocking","TrickleCompletionHandler","isCompleted","stepModel","onDescendants","_wasCompletedPreRender","isModelComplete","TrickleNotifyHandler","isNotifyOpen","onNotifyOpened","onNotifyClosed","TrickleBodyResizeHandler","stepView","onAdaptInitialized","onResize","preventWrapperScroll","onTrickleResize","onFinished","wrapper","getElementById","pageYOffset","TrickleTutorHandler","stepLockedId","isTutorOpen","onTutorOpened","onTutorClosed","alertObject","isOriginStepLocked","hasStepLockedParent","TrickleVisibilityHandler","trickleModel","onVisibility","trickleModelId","trickleType","atIndex","componentModel","TrickleDone","onDone","Trickle","getCourseModel","isCourseEnabled","setupListeners","onPagePreRender","fromModel","shouldScrollPage","isAutoScrollOff","_autoScroll","hasTrickleButton","_scrollTo","scrollToId","relativeModel","findRelativeModel","_scrollDuration","hasScrolled","DOMModifier","elementFilter","onElementAdd","onElementRemove","list","arr","elementNodes","foundNodes","observer","MutationObserver","added","observe","childList","subtree","_name","namedConfig","_src","hasUserPaused","isDataReady","setUpListeners","onScreenChange","isOffScreen","_onScreenPercentInviewVertical","onOffScreen","onOnScreen","_offScreenPause","_offScreenRewind","rewind","_autoPlay","isFinished","audioTag","currentSeconds","globalAudio","audioContext","Audio","onTimeUpdate","sourceNode","createMediaElementSource","connect","destination","$player","_globalAudio","resume","then","togglePlayPause","_onPauseRewind","disconnect","destroyPlayer","GlobalAudio","isResumed","setUpAudioContext","setUp","AudioContext","webkitAudioContext","isTrusted","checkOnScreen","getAttribute","div","AudioView","MenuItemView","MenuView","BoxMenuItemView","onClickMenuItemButton","BoxMenuGroupView","BoxMenuView","setStyles","_renderAsGroup","setBackgroundImage","setBackgroundStyles","processHeader","backgroundImages","_backgroundImage","backgroundImage","_large","_medium","_small","styles","_backgroundStyles","_backgroundRepeat","_backgroundSize","_backgroundPosition","header","_menuHeader","$header","setHeaderBackgroundImage","setHeaderBackgroundStyles","setHeaderMinimumHeight","minimumHeights","_minimumHeights","minimumHeight","ThemeView","setClasses","setMinimumHeight","setResponsiveClasses","setCustomStyles","responsiveClasses","ThemePageView","ThemeArticleView","ThemeBlockView","theme","jsxHeading","React","createRef","jsxComponentDescription","mobileInstruction","_disableAccessibilityState","sizedInstruction"],"mappings":"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"}